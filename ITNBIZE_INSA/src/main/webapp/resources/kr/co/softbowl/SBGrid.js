function SBGrid(){}SBGrid.getGrid=function(a){if(typeof document.SBHE_allElement=="undefined"){return null}return document.SBHE_allElement.m_htCollection[a]};SBGrid.DEF=function(){};SBGrid.UT=function(){};SBGrid.CT=function(){};SBGrid.DS=function(){};SBGrid.DEF.__LANGUAGE="kr";SBGrid.DEF.__chromeFrame=false;SBGrid.DEF.__useBinding=false;var agt=navigator.userAgent.toLowerCase();SBGrid.DEF.is_major=parseInt(navigator.appVersion);SBGrid.DEF.is_minor=parseFloat(navigator.appVersion);SBGrid.DEF.is_moz=((agt.indexOf("mozilla")!=-1)&&(agt.indexOf("spoofer")==-1)&&(agt.indexOf("compatible")==-1)&&(agt.indexOf("opera")==-1)&&(agt.indexOf("webtv")==-1)&&(agt.indexOf("hotjava")==-1));SBGrid.DEF.is_moz2=(SBGrid.DEF.is_moz&&(SBGrid.DEF.is_major==2));SBGrid.DEF.is_moz3=(SBGrid.DEF.is_moz&&(SBGrid.DEF.is_major==3));SBGrid.DEF.is_moz4=(SBGrid.DEF.is_moz&&(SBGrid.DEF.is_major==4));SBGrid.DEF.is_gecko=(agt.indexOf("gecko")!=-1);SBGrid.DEF.is_firefox=(agt.indexOf("firefox")!=-1);SBGrid.DEF.is_nav2=SBGrid.DEF.is_moz2;SBGrid.DEF.is_nav3=SBGrid.DEF.is_moz3;SBGrid.DEF.is_nav4=SBGrid.DEF.is_moz4;SBGrid.DEF.is_nav4up=(SBGrid.DEF.is_nav4||((SBGrid.DEF.is_major>=4)&&(agt.indexOf("netscape")!=-1)));SBGrid.DEF.is_nav=(SBGrid.DEF.is_nav2||SBGrid.DEF.is_nav3||SBGrid.DEF.is_nav4);SBGrid.DEF.is_mozilla=(SBGrid.DEF.is_moz&&SBGrid.DEF.is_gecko);SBGrid.DEF.is_mozilla1=(SBGrid.DEF.is_moz&&SBGrid.DEF.is_gecko&&(agt.indexOf("rv:1")!=-1));SBGrid.DEF.is_ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));SBGrid.DEF.is_ie6=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==4)&&(agt.indexOf("msie 6.")!=-1));SBGrid.DEF.is_ie7=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==4)&&(agt.indexOf("msie 7.")!=-1));if(SBGrid.DEF.is_ie7){SBGrid.DEF.is_ie6=false}SBGrid.DEF.is_ie8=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==4)&&(agt.indexOf("msie 8.")!=-1));if(SBGrid.DEF.is_ie8){SBGrid.DEF.is_ie6=false;SBGrid.DEF.is_ie7=false}SBGrid.DEF.is_ie9=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==5)&&(agt.indexOf("msie 9.")!=-1));if(SBGrid.DEF.is_ie9){SBGrid.DEF.is_ie6=false;SBGrid.DEF.is_ie7=false;SBGrid.DEF.is_ie8=false;SBGrid.DEF.is_ie10=false}SBGrid.DEF.is_ie10=(SBGrid.DEF.is_ie&&(SBGrid.DEF.is_major==5)&&(agt.indexOf("msie 10.")!=-1));if(SBGrid.DEF.is_ie10){SBGrid.DEF.is_ie6=false;SBGrid.DEF.is_ie7=false;SBGrid.DEF.is_ie8=false;SBGrid.DEF.is_ie9=false}SBGrid.DEF.is_opera=(agt.indexOf("opera")!=-1);SBGrid.DEF.is_safari=((agt.indexOf("safari")!=-1));SBGrid.DEF.is_chrome=!SBGrid.DEF.is_ie&&(agt.indexOf("chrome")!=-1)?true:false;SBGrid.DEF.is_crOs=SBGrid.DEF.is_chrome&&(agt.indexOf("csos")!=-1);SBGrid.DEF.is_chromeFrame=!SBGrid.DEF.is_ie&&SBGrid.DEF.is_chrome&&SBGrid.DEF.__chromeFrame;SBGrid.DEF.is_webkit=SBGrid.DEF.is_safari||SBGrid.DEF.is_chrome;SBGrid.DEF.is_mozBrowser=SBGrid.DEF.is_firefox||SBGrid.DEF.is_opera;SBGrid.DEF.is_ipad=(SBGrid.DEF.is_safari&&(agt.indexOf("ipad")!=-1));SBGrid.DEF.is_iphone=(SBGrid.DEF.is_safari&&(agt.indexOf("iphone")!=-1));SBGrid.DEF.is_apple=(SBGrid.DEF.is_ipad||SBGrid.DEF.is_iphone);SBGrid.DEF.is_android=(agt.indexOf("android")!=-1);SBGrid.DEF.is_opera_mini=(agt.indexOf("opera mini")!=-1);SBGrid.DEF.is_smartphone=false;SBGrid.DEF.Lan_Month="월";SBGrid.DEF.Lan_Day="일";SBGrid.DEF.Lan_Monday="월";SBGrid.DEF.Lan_Tuesday="화";SBGrid.DEF.Lan_Wednesday="수";SBGrid.DEF.Lan_Thursday="목";SBGrid.DEF.Lan_Friday="금";SBGrid.DEF.Lan_Saturday="토";SBGrid.DEF.Lan_Sunday="일";SBGrid.DEF.Lan_Today="오늘";SBGrid.DEF.Lan_DefaultFontFamily="gulim, arial";if(typeof SBGrid.DEF.__LANGUAGE!="undefined"&&"jp"==SBGrid.DEF.__LANGUAGE){SBGrid.DEF.Lan_Year="年 ";SBGrid.DEF.Lan_Month="月";SBGrid.DEF.Lan_Day="日";SBGrid.DEF.Lan_Monday="月";SBGrid.DEF.Lan_Tuesday="火";SBGrid.DEF.Lan_Wednesday="水";SBGrid.DEF.Lan_Thursday="木";SBGrid.DEF.Lan_Friday="金";SBGrid.DEF.Lan_Saturday="土";SBGrid.DEF.Lan_Sunday="日";SBGrid.DEF.Lan_Today="今日";SBGrid.DEF.Lan_DefaultFontFamily="MS Gothic, arial"}else{if(typeof SBGrid.DEF.__LANGUAGE!="undefined"&&"us"==SBGrid.DEF.__LANGUAGE){SBGrid.DEF.Lan_Year=".";SBGrid.DEF.Lan_Month="";SBGrid.DEF.Lan_Day="";SBGrid.DEF.Lan_Monday="Mon";SBGrid.DEF.Lan_Tuesday="Tue";SBGrid.DEF.Lan_Wednesday="Wed";SBGrid.DEF.Lan_Thursday="Thu";SBGrid.DEF.Lan_Friday="Fri";SBGrid.DEF.Lan_Saturday="Sat";SBGrid.DEF.Lan_Sunday="Sun";SBGrid.DEF.Lan_Today="Today";SBGrid.DEF.Lan_DefaultFontFamily="arial"}}SBGrid.CF=function(){};SBGrid.CF.Init=function(a){var b=a.id;a.m_heControl=document.getElementById("SBHE_"+b);if(null!=a.m_heControl){a.m_heControl.parentWindow=window}b=null;a=null};SBGrid.CF.UnInit=function(a){a.m_heControl=null;a=null};SBGrid.CF.GetLabel=function(a){var b=a.label;if(null!=b&&typeof b=="string"){a=null;return String(b)}else{a=null;return""}};SBGrid.CF.SetLabel=function(a,c,b){if(null!=a.m_heControl){if(b){a.m_heControl.title=c}a.m_heControl.setAttribute("label",c)}a.label=c;a=null;c=null};SBGrid.CF.SetLabelChange=function(a,b){if(null!=a.m_heControl){a.m_heControl.innerHTML=b}a=null;b=null};SBGrid.CF.GetValue=function(a){var b=a.value;if(null!=b&&typeof b=="string"){a=null;return String(b)}else{a=null;return""}};SBGrid.CF.SetValue=function(a,b){a.value=b;a=null;strLabel=null};SBGrid.CF.SetHtmlElement=function(a,b){a.m_heControl=b;a=null;b=null};SBGrid.CF.GetSelect=function(a){return a.selected};SBGrid.CF.SetSelect=function(b,a){a=null!=a?a:b.m_bSelect;b.selected=a;var c=b.getElement();if(null!=c){c.setSelect(a)}b=null;c=null;a=null};SBGrid.CF.GridInit=function(a){var c=a.id;a.m_heControl=document.getElementById("SBHE_"+c);var b=document.getElementById(c+"_data");if(b){a.m_heDataControl=b;b=null}c=null;a=null};SBGrid.CF.GridUnInit=function(a){a.m_heControl=null;a.m_heDataControl=null;a=null};SBGrid.CF.GridSetMergeType=function(a,b){if(SBGrid.DEF.SBSM_COLHIDE==a.mergeType){return}if(b){a.mergeType=SBGrid.DEF.SBSM_NORMAL}else{a.mergeType=SBGrid.DEF.SBSM_LOCK}a=null;b=null};SBGrid.CF.GridSetFixedWindowText=function(a,c){if(null==a.m_heControl){return}a.text=c;var b=a.m_heControl;if(b){if(a.parent.autoResize){b.innerHTML='<span style="border-color: transparent;">'+c+"</span>"}else{b.innerHTML='<span style="border-color: transparent;"><span style="white-space:nowrap;">'+c+"</span></span>"}}b=null;a=null;c=null};SBGrid.CF.GridGetWindowText=function(a){if(SBGrid.DEF.is_ie){return a.m_heControl.innerText}else{return a.m_heControl.textContent}};SBGrid.CF.GridSetWindowText=function(o,m,c,l){var b=o.getElement();if(o.m_heDataControl){if(null==m){m=""}if(c){if(null==m){m=""}m=m.formatting(l)}else{if(null==m){m=""}var b=o.m_objElement;l=b.getAttribute("format");m=m.formatting(l);var g=SBGrid.DEF.formatStatus(l);if(4==g&&""!=b.attribute.roundmode&&""!=b.attribute.roundposition){m=SBGrid.DEF.getRoundMode(m,b.attribute.roundmode,b.attribute.roundposition)}}if(SBGrid.DEF.is_ie){if(m==o.m_heDataControl.outerText){return}}else{if(m==o.m_heDataControl.textContent){return}}if(SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().preserveWhitespace){m=m.replace(/\s/g,"&nbsp;")}if(""!=m&&(-1!=b.attribute.secretendposition||-1!=b.attribute.secretstartposition)){var d=-1==b.attribute.secretstartposition?0:b.attribute.secretstartposition;var a=-1==b.attribute.secretendposition?m.length:b.attribute.secretendposition;if(a>d){var n=b.attribute.secretmark;var h=m.substr(0,d);var e=m.substr(a,m.length);for(var f=d;f<a;f++){h+=n}m=h+e;strmark=null;h=null;e=null}d=null;a=null}if(o.parent.autoResize){o.m_heDataControl.innerHTML=m}else{o.m_heDataControl.innerHTML='<span style="white-space:nowrap;">'+m+"</span>"}}b=null;o=null;m=null;c=null;l=null};SBGrid.CF.GridSetTextRefresh=function(r,i,f){var n=i,m;m=f;if(m!=""&&m!="undefined"&&m!=null){if(i==m[0]){i=m[1]}}if(null!=i){var a=r.getElement();if(SBGrid.DEF.SBIT_CHECK==a.getInputType()||SBGrid.DEF.SBIT_RADIO==a.getInputType()){if(a){var q=(i==a.getTrueValue())?true:false;var p=q?a.getTrueValue():a.getFalseValue();if(q){a.m_nBeforeSelectRow=r.row}r.setBoolState(q);r.setWindowText(i);q=null;p=null}}else{if(SBGrid.DEF.SBIT_COMBO==a.getInputType()){if(a){var h=a.m_objCombo;if(a.m_bIsCellCombo&&h.isnodeset){var c=r.getAttribute("nodeset");if(null!=c){h.nodeset=c;h.reBuild()}else{if(null!=a.m_strComboNodeSet&a.m_strComboNodeSet!=h.nodeset){h.nodeset=a.m_strComboNodeSet;h.refresh()}}c=null}n=h.getLableByValue(i);r.setWindowText(n);h=null}}else{if(SBGrid.DEF.SBIT_IMAGE==a.getInputType()){var l=a.getImageUri(),g=a.getImageWidth(),b=a.getImageHeight(),e=a.getImageStyle(),d=a.getImageClickFuncName(),o=a.getImageAlt();if(l!=null&&l!=""&&l!="undefined"){i=l}r.setImage(i,d,g,b,e,o)}else{r.setWindowText(i)}}}a=null}if("label"==r.parent.m_strTooltip){if(null!=r.m_heControl){r.m_heControl.title=n}}else{if("true"==r.parent.m_strTooltip){if(null!=r.m_heControl){r.m_heControl.title=i}}}n=null;r=null;i=null;f=null;m=null};SBGrid.CF.GridSetBoolState=function(a,g,d,b,f){a.boolstate=g;if(d){a.setText(strValue)}if(null!=a.m_heControl){var c=a.m_heControl.firstChild;if(c){var e=a.m_objElement;if(SBGrid.DEF.SBIT_CHECK==e.getInputType()){c.src=a.boolstate?e.getAttribute("checkimage"):e.getAttribute("uncheckimage")}else{if(SBGrid.DEF.SBIT_RADIO==e.getInputType()){c.src=a.boolstate?e.getAttribute("selectimage"):e.getAttribute("unselectimage")}}e=null}c=null}a=null;g=null;d=null;b=null;f=null};SBGrid.CF.GridChangeRowHeadUpdate=function(a,c){var b=a.m_heControl.firstChild;if(null!=b){switch(c){case SBGrid.DEF.SBGS_INSERT:case SBGrid.DEF.SBGS_INSERTANDNEW:b.style.backgroundImage="url("+a.parent.m_strInsertFlagImage+")";break;case SBGrid.DEF.SBGS_UPDATE:b.style.backgroundImage="url("+a.parent.m_strUpdateFlagImage+")";break;case SBGrid.DEF.SBGS_DELETE:case SBGrid.DEF.SBGS_DELETEANDUPDATE:b.style.backgroundImage="url("+a.parent.m_strDeleteFlagImage+")";break;default:b.style.backgroundImage="url("+a.parent.m_strNormalFlagImage+")";break}}b=null;a=null;c=null};SBGrid.CF.GridChangeRowHeadSelect=function(b,a){var c=b.m_heControl.firstChild;if(null!=c){if(a){c.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHSelect+")"}else{c.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHBlank+")"}}c=null;b=null;a=null};SBGrid.CF.GridGetText=function(b){if(b.m_jsonObject){return b.m_jsonObject[b.m_objElement.attribute.ref]+""}else{if(b.m_xnNodeElement){return SBGrid.UT.XmlLib.getTextValue(b.m_xnNodeElement)}else{var a=b.text;if(a){return a}}}return""};SBGrid.CF.GridSetText=function(a,c){if(a.m_jsonObject){a.m_jsonObject[a.m_objElement.attribute.ref]=c+""}else{if(a.m_xnNodeElement){SBGrid.UT.XmlLib.setTextValue(a.m_xnNodeElement,c)}else{a.text=c}}var b=a.getElement();var d=(c==b.getTrueValue())?true:false;a.setBoolState(d);a=null;c=null};SBGrid.CF.GridSetFixedCheck=function(a,c){if(SBGrid.DEF.SBIT_CHECK==a.m_objElement.getInputType()){var b=c?a.m_objElement.getTrueValue():a.m_objElement.getFalseValue();SBGrid.CF.GridSetBoolState(a,c);SBGrid.CF.GridSetText(a,b)}};SBGrid.CF.xnTextNodeDelete=function(a){var b=a.firstChild;while(null!=b){if(null==b.nodeValue){SBGrid.CF.xnTextNodeDelete(b)}else{b.nodeValue=""}b=b.nextSibling}};SBGrid.DEF.cssName="";SBGrid.DEF.imgWait="kr/co/softbowl/image/datagrid/wait.png";SBGrid.DEF.imgCheck="kr/co/softbowl/image/checkbox/check.png";SBGrid.DEF.imgUnCheck="kr/co/softbowl/image/checkbox/uncheck.png";SBGrid.DEF.imgGridButton="kr/co/softbowl/image/datagrid/button.png";SBGrid.DEF.imgRadio="kr/co/softbowl/image/radio/radio.png";SBGrid.DEF.imgUnRadio="kr/co/softbowl/image/radio/unradio.png";SBGrid.DEF.imgButton="kr/co/softbowl/image/input/button.png";SBGrid.DEF.imgCombo="kr/co/softbowl/image/combo/combo.gif";SBGrid.DEF.imgTreeCheck="kr/co/softbowl/image/treeview/check.gif";SBGrid.DEF.imgTreeUnCheck="kr/co/softbowl/image/treeview/uncheck.gif";SBGrid.DEF.imgRHDelete="kr/co/softbowl/image/datagrid/rowHeaderDelete.png";SBGrid.DEF.imgRHInsert="kr/co/softbowl/image/datagrid/rowHeaderInsert.png";SBGrid.DEF.imgRHNew="kr/co/softbowl/image/datagrid/rowHeaderNew.png";SBGrid.DEF.imgRHUpdate="kr/co/softbowl/image/datagrid/rowHeaderUpdate.png";SBGrid.DEF.imgRHSelect="kr/co/softbowl/image/datagrid/rowHeaderSelect.png";SBGrid.DEF.imgRHBlank="kr/co/softbowl/image/datagrid/rowHeaderBlank.png";SBGrid.DEF.imgGridExpansion="kr/co/softbowl/image/datagrid/gridExpansion.png";SBGrid.DEF.imgGridReturn="kr/co/softbowl/image/datagrid/gridReturn.png";SBGrid.DEF.imgGlobalExpansion="kr/co/softbowl/image/global/buttonExpansion.png";SBGrid.DEF.imgGlobalReturn="kr/co/softbowl/image/global/buttonReturn.png";SBGrid.DEF.SB_CS_NORMAL=0;SBGrid.DEF.SB_CS_FOCUS=1;SBGrid.DEF.SB_CS_SELECT=2;SBGrid.DEF.SB_CS_HOVER=4;SBGrid.DEF.SB_CS_DOWN=8;SBGrid.DEF.SB_CS_DISABLE=16;SBGrid.DEF.SB_CS_ACTIVE=32;SBGrid.DEF.SB_NONE=0;SBGrid.DEF.SB_SINGLE=1;SBGrid.DEF.SB_MULTIPLE=2;SBGrid.DEF.SBKE_NONE=0;SBGrid.DEF.SBKE_NEXT=1;SBGrid.DEF.SBKE_PREVIOUS=2;SBGrid.DEF.SBKE_MOVETOP=3;SBGrid.DEF.SBKE_MOVEBOTTOM=4;SBGrid.DEF.SBSM_FREE=1;SBGrid.DEF.SBSM_BYROW=2;SBGrid.DEF.SBSM_BYCOL=3;SBGrid.DEF.SBSM_LIST=4;SBGrid.DEF.SBRS_NONE=1;SBGrid.DEF.SBRS_VERT=2;SBGrid.DEF.SBRS_HORZ=4;SBGrid.DEF.SBRH_SEQ=1;SBGrid.DEF.SBRH_SELECT=2;SBGrid.DEF.SBRH_UPDATE=3;SBGrid.DEF.SBRH_REVERSESEQ=4;SBGrid.DEF.SBCH_TEXT=1;SBGrid.DEF.SBCH_ROWINS=2;SBGrid.DEF.SBCH_ROWDEL=4;SBGrid.DEF.SBGS_ALL=-1;SBGrid.DEF.SBGS_NEW=0;SBGrid.DEF.SBGS_INSERT=1;SBGrid.DEF.SBGS_UPDATE=2;SBGrid.DEF.SBGS_DELETE=4;SBGrid.DEF.SBGS_INSERTANDNEW=3;SBGrid.DEF.SBGS_DELETEANDINSERT=5;SBGrid.DEF.SBGS_DELETEANDUPDATE=6;SBGrid.DEF.SBEB_NONE=0;SBGrid.DEF.SBEB_SORT=1;SBGrid.DEF.SBEB_MOVE=2;SBGrid.DEF.SBEB_SORT_MOVE=3;SBGrid.DEF.SBEB_SORT_SHOW=4;SBGrid.DEF.SBEB_SORT_SHOW_MOVE=5;SBGrid.DEF.SBEB_UI_FILTERING=1;SBGrid.DEF.SBEB_UI_HIDE=2;SBGrid.DEF.SBEB_UI_FILTERING_HIDE=3;SBGrid.DEF.SBEB_UI_FILTERING_SHOW=4;SBGrid.DEF.SBEB_UI_HIDE_SHOW=5;SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW=6;SBGrid.DEF.SBST_NONE=0;SBGrid.DEF.SBST_ASC=1;SBGrid.DEF.SBST_DESC=2;SBGrid.DEF.SBST_USERSORT=3;SBGrid.DEF.SBIT_OUTPUT=0;SBGrid.DEF.SBIT_INPUT=1;SBGrid.DEF.SBIT_COMBO=2;SBGrid.DEF.SBIT_CHECK=3;SBGrid.DEF.SBIT_RADIO=4;SBGrid.DEF.SBIT_INPUTBUTTON=5;SBGrid.DEF.SBIT_INPUTDATE=6;SBGrid.DEF.SBIT_SORTARROW=7;SBGrid.DEF.SBIT_TEXTAREA=8;SBGrid.DEF.SBIT_BROWSER=9;SBGrid.DEF.SBIT_INIT=10;SBGrid.DEF.SBIT_INPUTSPIN=11;SBGrid.DEF.SBIT_COUNT=12;SBGrid.DEF.SBIT_IMAGE=13;SBGrid.DEF.SB_APPEARANCE=["checkbox","radio","listbox","dcombo"];SBGrid.DEF.SB_NONE_EDIT=0;SBGrid.DEF.SB_POPUP_SEARCH=1;SBGrid.DEF.SB_NO_POPUP_SEARCH=2;SBGrid.DEF.SB_INPUT=3;SBGrid.DEF.SB_POPUP_INPUT=4;SBGrid.DEF.SB_CSS_NULL=0;SBGrid.DEF.SB_CSS_FIRST=SBGrid.DEF.SB_CSS_NULL;SBGrid.DEF.SB_CSS_USER=1;SBGrid.DEF.SB_CSS_UNIVERSAL=2;SBGrid.DEF.SB_CSS_TYPE=3;SBGrid.DEF.SB_CSS_DYNAMIC_PSEUDO=4;SBGrid.DEF.SB_CSS_ID=5;SBGrid.DEF.SB_CSS_DESCENDANT=6;SBGrid.DEF.SB_CSS_CHILD=7;SBGrid.DEF.SB_CSS_GROUP=8;SBGrid.DEF.SB_AS_NULL=0;SBGrid.DEF.SB_AS_EXIST=1;SBGrid.DEF.SB_AS_EQUAL=2;SBGrid.DEF.SB_HNS=1;SBGrid.DEF.SB_HID=16;SBGrid.DEF.SB_HCLASS=256;SBGrid.DEF.SB_gChildList=new Array();SBGrid.DEF.SBEA_HSB_AS_EVENT=1;SBGrid.DEF.SBEA_ACTION=2;SBGrid.DEF.SBEA_HSB_AS_DOM=32;SBGrid.DEF.SBEA_CONTROL_BASE=256;SBGrid.DEF.SBEA_CONTROL=(SBGrid.DEF.SBEA_CONTROL_BASE|SBGrid.DEF.SBEA_HSB_AS_EVENT);SBGrid.DEF.SBEA_HSB_AS_FORMAT=512;SBGrid.DEF.SBEA_HSB_AS_TEXT=1024;SBGrid.DEF.SBEA_GROUP_BASE=4096;SBGrid.DEF.SBEA_GROUP=(SBGrid.DEF.SBEA_CONTROL|SBGrid.DEF.SBEA_GROUP_BASE);SBGrid.DEF.SBEA_PI_BASE=65536;SBGrid.DEF.SBSM_NORMAL=0;SBGrid.DEF.SBSM_MERGED=1;SBGrid.DEF.SBSM_HIDE=2;SBGrid.DEF.SBSM_LOCK=3;SBGrid.DEF.SBSM_COLHIDE=4;SBGrid.DEF.SBSM_USER_LOCK=5;SBGrid.DEF.SBCT_EDIT=1;SBGrid.DEF.SBCT_BUTTON=2;SBGrid.DEF.SBCT_VIEW=3;SBGrid.DEF.SB_KOREAN="";SBGrid.DEF.SBLE_GRID="";SBGrid.DEF.SBLE_BUTTON="";SBGrid.DEF.bParsed=false;SBGrid.DEF.bDragDrop=false;SBGrid.DEF.bShowPop=true;SBGrid.DEF.bIsDragMode=false;SBGrid.DEF.m_arAccesskey=new Array();SBGrid.DEF.bIsResizeFlg=false;SBGrid.DEF.bIsAfterMouseUpFlg=true;SBGrid.DEF.nMouseEventStatus=SBGrid.DEF.SB_MOUSE_EVENT_NONE;SBGrid.DEF.DEBUG_MODE_ALERT=0;SBGrid.DEF.DEBUG_MODE_CONSOLE=1;SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE=2;SBGrid.DEF.DEBUG_MODE_NONE=3;SBGrid.DEF.DEBUG_MODE=SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE;SBGrid.EVT=function(){this.name;this.handler;this.propagate;this.defaultAction};SBGrid.EVT.BUTTON_LEFT=1;SBGrid.EVT.BUTTON_MIDDLE=2;SBGrid.EVT.BUTTON_RIGHT=3;SBGrid.EVT.BACKSPACE=8;SBGrid.EVT.TAB=9;SBGrid.EVT.ENTER=13;SBGrid.EVT.SHIFT=16;SBGrid.EVT.CONTROL=17;SBGrid.EVT.ALT=18;SBGrid.EVT.PAUSE_BREAK=19;SBGrid.EVT.CAPSLOCK=20;SBGrid.EVT.ESC=27;SBGrid.EVT.SPACE=32;SBGrid.EVT.PAGEUP=33;SBGrid.EVT.PAGEDOWN=34;SBGrid.EVT.END=35;SBGrid.EVT.HOME=36;SBGrid.EVT.LEFT=37;SBGrid.EVT.UP=38;SBGrid.EVT.RIGHT=39;SBGrid.EVT.DOWN=40;SBGrid.EVT.INSERT=45;SBGrid.EVT.DELETE=46;SBGrid.EVT.ZERO=48;SBGrid.EVT.ONE=49;SBGrid.EVT.TWO=50;SBGrid.EVT.THREE=51;SBGrid.EVT.FOUR=52;SBGrid.EVT.FIVE=53;SBGrid.EVT.SIX=54;SBGrid.EVT.SEVEN=55;SBGrid.EVT.EIGHT=56;SBGrid.EVT.NINE=57;SBGrid.EVT.A=65;SBGrid.EVT.B=66;SBGrid.EVT.C=67;SBGrid.EVT.D=68;SBGrid.EVT.E=69;SBGrid.EVT.F=70;SBGrid.EVT.G=71;SBGrid.EVT.H=72;SBGrid.EVT.I=73;SBGrid.EVT.J=74;SBGrid.EVT.K=75;SBGrid.EVT.L=76;SBGrid.EVT.M=77;SBGrid.EVT.N=78;SBGrid.EVT.O=79;SBGrid.EVT.P=80;SBGrid.EVT.Q=81;SBGrid.EVT.R=82;SBGrid.EVT.S=83;SBGrid.EVT.T=84;SBGrid.EVT.U=85;SBGrid.EVT.V=86;SBGrid.EVT.W=87;SBGrid.EVT.X=88;SBGrid.EVT.Y=89;SBGrid.EVT.Z=90;SBGrid.EVT.F1=112;SBGrid.EVT.F2=113;SBGrid.EVT.F3=114;SBGrid.EVT.F4=115;SBGrid.EVT.F5=116;SBGrid.EVT.F6=117;SBGrid.EVT.F7=118;SBGrid.EVT.F8=119;SBGrid.EVT.F9=120;SBGrid.EVT.F10=121;SBGrid.EVT.F11=122;SBGrid.EVT.F12=123;SBGrid.EVT.TRANSLANGUAGE=229;SBGrid.DS.Hashtable=function(){};SBGrid.DS.Collection=function(){this.m_htCollection=new SBGrid.DS.Hashtable();this.m_arOrder=new Array();this.length=0};SBGrid.DS.Collection.prototype.add=function(b,a){if(null==this.m_htCollection[b]){this.m_arOrder.push(b)}this.m_htCollection[b]=a;this.length=this.m_arOrder.length;b=null;a=null};SBGrid.DS.Collection.prototype.count=function(){return this.m_arOrder.length};SBGrid.DS.Collection.prototype.exists=function(a){return(null!=this.m_htCollection[a])};SBGrid.DS.Collection.prototype.item=function(a){switch(typeof(a)){case"string":return this.m_htCollection[a];default:return this.m_htCollection[this.m_arOrder[a]]}};SBGrid.DS.Collection.prototype.keys=function(){return this.m_arOrder};SBGrid.DS.Collection.prototype.remove=function(b){delete this.m_htCollection[b];var a=SBGrid.DEF.arrFind_Value(this.m_arOrder,b);if(0<=a){this.m_arOrder.splice(a,1)}this.length=this.m_arOrder.length};SBGrid.DS.Collection.prototype.removeAll=function(){this.m_htCollection=new SBGrid.DS.Hashtable();this.m_arOrder=new Array();this.length=0};SBGrid.DEF.SB_ITEMLIST=new SBGrid.DS.Hashtable();SBGrid.DEF.SB_STYLELIST=new SBGrid.DS.Hashtable();SBGrid.DEF.SB_STYLELIST.left=true;SBGrid.DEF.SB_STYLELIST.right=true;SBGrid.DEF.SB_STYLELIST.top=true;SBGrid.DEF.SB_STYLELIST.bottom=true;SBGrid.DEF.SB_STYLELIST.width=true;SBGrid.DEF.SB_STYLELIST.height=true;SBGrid.DEF.SB_STYLELIST["font-family"]=true;SBGrid.DEF.SB_STYLELIST["font-size"]=true;SBGrid.DEF.SB_STYLELIST["font-weight"]=true;SBGrid.DEF.SB_STYLELIST["font-style"]=true;SBGrid.DEF.SB_STYLELIST["text-decoration"]=true;SBGrid.DEF.SB_STYLELIST.color=true;SBGrid.DEF.SB_STYLELIST["text-align"]=true;SBGrid.DEF.SB_STYLELIST["vertical-align"]=true;SBGrid.DEF.SB_STYLELIST["word-wrap"]=true;SBGrid.DEF.SB_STYLELIST["line-spacing"]=true;SBGrid.DEF.SB_STYLELIST["letter-spacing"]=true;SBGrid.DEF.SB_STYLELIST.padding=true;SBGrid.DEF.SB_STYLELIST["padding-left"]=true;SBGrid.DEF.SB_STYLELIST["padding-top"]=true;SBGrid.DEF.SB_STYLELIST["padding-right"]=true;SBGrid.DEF.SB_STYLELIST["padding-bottom"]=true;SBGrid.DEF.SB_STYLELIST["background-color"]=true;SBGrid.DEF.SB_STYLELIST["background-image"]=true;SBGrid.DEF.SB_STYLELIST["background-repeat"]=true;SBGrid.DEF.SB_STYLELIST["background-position"]=true;SBGrid.DEF.SB_STYLELIST["border-color"]=true;SBGrid.DEF.SB_STYLELIST["border-left-color"]=true;SBGrid.DEF.SB_STYLELIST["border-top-color"]=true;SBGrid.DEF.SB_STYLELIST["border-right-color"]=true;SBGrid.DEF.SB_STYLELIST["border-bottom-color"]=true;SBGrid.DEF.SB_STYLELIST["border-width"]=true;SBGrid.DEF.SB_STYLELIST["border-left-width"]=true;SBGrid.DEF.SB_STYLELIST["border-top-width"]=true;SBGrid.DEF.SB_STYLELIST["border-right-width"]=true;SBGrid.DEF.SB_STYLELIST["border-bottom-width"]=true;SBGrid.DEF.SB_STYLELIST["border-style"]=true;SBGrid.DEF.SB_STYLELIST["border-left-style"]=true;SBGrid.DEF.SB_STYLELIST["border-top-style"]=true;SBGrid.DEF.SB_STYLELIST["border-right-style"]=true;SBGrid.DEF.SB_STYLELIST["border-bottom-style"]=true;SBGrid.DEF.SB_STYLELIST.margin=true;SBGrid.DEF.SB_STYLELIST["margin-left"]=true;SBGrid.DEF.SB_STYLELIST["margin-top"]=true;SBGrid.DEF.SB_STYLELIST["margin-right"]=true;SBGrid.DEF.SB_STYLELIST["margin-bottom"]=true;SBGrid.DEF.SB_STYLELIST.opacity=true;SBGrid.DEF.SB_STYLELIST.clip=true;SBGrid.DEF.SB_STYLELIST.gradient=true;SBGrid.DEF.SB_STYLELIST.cursor=true;SBGrid.DEF.SB_STYLELIST["focus-rect"]=true;SBGrid.DEF.SB_STYLELIST.unloadmark=true;SBGrid.DEF.SB_STYLELIST.display=true;SBGrid.DEF.SB_STYLELIST.overflow=true;SBGrid.DEF.SB_STYLELIST["background-repeat"]=true;SBGrid.DEF.SB_TAGLIST=new SBGrid.DS.Hashtable();SBGrid.DEF.SB_TAGLIST["xhtml:body"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:caption"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:output"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:input"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:secret"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:select"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:select1"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:group"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:datagrid"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:textarea"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:calendar"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:table"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:img"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:object"]=true;SBGrid.DEF.SB_TAGLIST["softbowl:file"]=true;SBGrid.DEF.SB_SRC_CHECKICON="./kr/co/softbowl/image/checkbox/check.png";SBGrid.DEF.SB_SRC_UNCHECKICON="./kr/co/softbowl/image/checkbox/uncheck.png";SBGrid.DEF.STR_SBGRID_ID;SBGrid.DEF.SB_REF_ATTR=new SBGrid.DS.Hashtable();SBGrid.DS.DOMNodeList=function(){this.length=0;this.m_arNode=new Array();this.m_nIterator=0};SBGrid.DS.DOMNodeList.prototype.add=function(a){this.m_arNode.push(a);this.length=this.m_arNode.length};SBGrid.DS.DOMNodeList.prototype.item=function(a){if(0>a&&this.length<=a){return null}return this.m_arNode[a]};SBGrid.DS.DOMNodeList.prototype.nextNode=function(){if(0>this.m_nIterator&&this.length<=this.m_nIterator){return null}return this.m_arNode[this.m_nIterator++]};SBGrid.DS.DOMNodeList.prototype.removeNext=function(){this.m_arNode.splice(this.m_nIterator++,1);this.length=this.m_arNode.length};SBGrid.DS.DOMNodeList.prototype.removeAll=function(){this.m_arNode=new Array();this.m_nIterator=0;this.length=this.m_arNode.length};SBGrid.DS.DOMNodeList.prototype.reset=function(){this.m_nIterator=0};SBGrid.DEF.fextractDupArr=function(d){for(var b=0;b<d.length;b++){var c=0;for(var a=0;a<d.length;a++){if(d[b]!=d[a]){continue}else{c++;if(c>1){spliced=d.splice(a,1)}}}}return d};SBGrid.DEF.arrFind_Value=function(b,a){for(var c=0;c<b.length;c++){var d=b[c];if(d==a){return c}}return -1};SBGrid.DEF.arrRemoveAt=function(b,a){return b.splice(a,1)};SBGrid.DEF.arrBinarySearch=function(f,b){var a=0,e=b.length-1,c,d;while(a<=e){c=Math.floor((a+e)/2);if(b[c]<f){a=c+1;continue}if(b[c]>f){e=c-1;continue}return c}return -1};SBGrid.DEF.arrIntersection=function(b,a){var c=new Array();while(b.length>0&&a.length>0){if(b[0]<a[0]){b.shift()}else{if(b[0]>a[0]){a.shift()}else{c.push(b.shift());a.shift()}}}return c};SBGrid.DEF.arrUnion=function(d,b){var e=new Array();for(var c=0;c<b.length;c++){if(SBGrid.DEF.arrBinarySearch(b[c],d)==-1){e.push(b[c])}}var a=d.concat(e);a.sort(SBGrid.DEF.numberASC);return a};SBGrid.DEF.arrDifferenceOfSets=function(d,b){for(var c=0;c<b.length;c++){var a=SBGrid.DEF.arrBinarySearch(b[c],d);if(a!=-1){d.splice(a,1)}}return d};SBGrid.DEF.numberASC=function(d,c){return d-c};SBGrid.DEF.numberorder=function(d,c){return d[0]-c[0]};SBGrid.DEF.giveHex=function(a){switch(a){case 10:return"A";case 11:return"B";case 12:return"C";case 13:return"D";case 14:return"E";case 15:return"E";default:return String(a)}};String.prototype.textCharConvert=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){return}a=a.replace(/\\n/g,"\n");a=a.replace(/\\r/g,"\r");a=a.replace(/\\t/g,"\t");return a};String.prototype.newlineCharConvert=function(){var a=this;if(!(typeof this=="object"&&this instanceof String)){return}a=a.replace(/\&/g,"&amp;");a=a.replace(/\</g,"&lt;");a=a.replace(/\>/g,"&gt;");a=a.split(" ").join("&nbsp;");a=a.split("\n").join("<br>");a=a.split("\r").join("");a=a.split("\t").join("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");return a};String.prototype.invertRGB=function(){var e=this;if(!(typeof this=="object"&&this instanceof String)){return}if(-1!=this.indexOf("rgb")){var d=this.substring(this.indexOf("(")+1,this.length);var b=d.split(/\,/g);e="#";for(var c=0;c<b.length;c++){e+=SBGrid.DEF.giveHex(Math.floor(parseInt(b[c])/16));e+=SBGrid.DEF.giveHex(parseInt(b[c])%16)}}var a="";for(var c=0;c<e.length;c++){switch(e.charAt(c)){case"F":case"f":a+="0";break;case"E":case"e":a+="1";break;case"D":case"d":a+="2";break;case"C":case"c":a+="3";break;case"B":case"b":a+="4";break;case"A":case"a":a+="5";break;case"9":a+="6";break;case"8":a+="7";break;case"7":a+="8";break;case"6":a+="9";break;case"5":a+="A";break;case"4":a+="B";break;case"3":a+="C";break;case"2":a+="D";break;case"1":a+="E";break;case"0":a+="F";break;default:a+=e.charAt(c);break}}return a};String.prototype.formatting=function(n){if(!(typeof this=="object"&&this instanceof String)){return}if(""==n){return this}var a=this;var d="";if(/\((\D+)\)/.test(n)){d=n.substring(n.indexOf("("),n.indexOf(")")+1);n=n.substring(d.length,n.length)}var g="";var o="";if(/\'(\D+)\'/.test(n)){g=n.substring(n.indexOf("'"),n.lastIndexOf("'")+1);n=n.substring(0,n.length-g.length);o=g.substring(1,g.length-1)}if(n.indexOf("9#")){n=n.replace("9#","#")}if("-1"==n.indexOf("#")&&"-1"==n.indexOf("0")){return SBGrid.DEF.inputValidateCheck(n,a,d)}else{var q="";var f=n.indexOf(".");var m="-1"!=n.indexOf(",")?1:0;m="-1"!=f?(m+2):m;var c=false;switch(m){case 2:case 3:c=true;break}if(""!=d){d=d.charAt(1);if(d!=a.charAt(0)){d=""}}var l="";if(-1!=f){while("0"==n.charAt((f+1))){l+="0";f++}}else{if(-1!=a.indexOf(".")){a=a.substring(0,a.indexOf("."))}}var e=0;a=a.replace(/[^.\d]/g,"");if("9#"!=n){for(var h=0;h<a.length;h++){if("0"!=a.charAt(h)){e=h;if(0!=h&&"."==a.charAt(h)){e--}break}}}a=a.substring(e,a.length);switch(m){case 0:q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern3(a,n,l);break;case 1:q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern2(a,c,l);break;case 2:q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern3(a,n,l);break;case 3:if(-1==a.indexOf(".")){q=SBGrid.DEF.inputMoneyUnitValidateCheckPattern2(a,c,l);if(""!=l){q+="."+l}}else{var b=a.indexOf(".");q+=SBGrid.DEF.inputMoneyUnitValidateCheckPattern2(a.substring(0,b),c,l);q+=".";var p=SBGrid.DEF.inputMoneyUnitValidateCheckPattern1(a.substring(b+1,a.length),l);q+=p}break}if(""!=d){q=d+q}if(null!=o&&""!=o){q+=o}return q}};String.prototype.isRegular=function(b){if(!(typeof this=="object"&&this instanceof String)){return}var a=this.match(b);if(null!=a){return true}else{return false}};String.prototype.insertAttribute=function(b,d){if(!b||!d){return this}var c=this;var a=c.lastIndexOf(">");if(-1==a){return this}var c=c.substring(0,a);c=c+" "+b+'="'+d+'">';return c};String.prototype.isEmpty=function(){if(0<this.length){return false}return true};String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};String.prototype.replaceAll=function(b,a){if(!(typeof this=="object"&&this instanceof String)){return}return this.split(b).join(a)};String.prototype.getByte=function(){if(!(typeof this=="object"&&this instanceof String)){return}var b=0;for(var a=0;a<this.length;a++){if(this.charCodeAt(a)>127){b+=2}else{b++}}return b};String.prototype.setByteWithStrLength=function(d){var b=0;var c="";for(var a=0;a<this.length&&b<d;a++){if(this.charCodeAt(a)>127){b+=2;c+=this.charAt(a)}else{b++;c+=this.charAt(a)}}return c};String.prototype.changeExtension=function(d,c){if(!(typeof this=="object"&&this instanceof String)){return}var a=this.lastIndexOf(".");if(a>0&&a<this.length&&d==this.substr(a+1)){var b=this.substring(0,a);return b+"."+c}return this};SBGrid.UT.URIEncoder=function(){};SBGrid.UT.URIEncoder.encode=function(e,b){b=b.toUpperCase();if(""==b||"UTF-8"==b||"UTF-16"==b){return encodeURIComponent(e)}else{var c=new SBGrid.UT.HttpClient();var d="encode="+b+"&value="+encodeURIComponent(e);var a=c.post(SBGrid.DEF.__getAppName()+"kr/co/softbowl/jsp/encoding.jsp",d);if(null!=a){return a.trim()}}return e};SBGrid.DS.Point=function(b,a){this.m_nX=b;this.m_nY=a};SBGrid.DS.Point.prototype.clone=function(){return new SBGrid.DS.Point(this.m_nX,this.m_nY)};SBGrid.DS.Point.prototype.getX=function(){return this.m_nX};SBGrid.DS.Point.prototype.setX=function(a){this.m_nX=a};SBGrid.DS.Point.prototype.getY=function(){return this.m_nY};SBGrid.DS.Point.prototype.setY=function(a){this.m_nY=a};SBGrid.DEF.getRoundMode=function(f,a,e){var h=f.split(/\./g);var d=Number(e);if(d<0&&null!=h[1]){if(Math.abs(d)>h[1].length){return f}else{if("round"==a){if(parseInt(h[1].charAt(Math.abs(d)-1))>4){a="ceil"}else{a="floor"}}if("ceil"==a){if(-1==d){return String(Number(h[0])+1)}else{var g="0.";for(var c=0;c<(Math.abs(d)-1);c++){if((c+1)==(Math.abs(d)-1)){g+="1";break}else{g+="0"}}if("1"==h[1].substring(0,Math.abs(d)-1)){return h[0]+".2"}var b=Number(h[0]+"."+h[1].substring(0,Math.abs(d)-1))+Number(g);return String(b.toFixed(Math.abs(d)-1))}}else{if(-1==d){return h[0]}else{return h[0]+"."+h[1].substring(0,Math.abs(d)-1)}}}}else{if(d>0){if(d>h[0].length){return f}else{if("round"==a){if(parseInt(h[0].charAt(h[0].length-d))>4){a="ceil"}else{a="floor"}}if("ceil"==a){if(h[0].length==d){return String(Math.pow(10,d))}else{var g=h[0].substring(0,h[0].length-d);for(var c=0;c<d;c++){g+="0"}return String(Number(g)+Math.pow(10,d))}}else{if(h[0].length==d){return"0"}else{var g=h[0].substring(0,h[0].length-d);for(var c=0;c<d;c++){g+="0"}return g}}}}else{return f}}return f};SBGrid.DS.Rectangle=function(d,c,b,a){this.m_nX=d;this.m_nY=c;this.m_nWidth=b;this.m_nHeight=a;this.m_nBottom;this.m_nRight;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getX=function(){return this.m_nX};SBGrid.DS.Rectangle.prototype.getY=function(){return this.m_nY};SBGrid.DS.Rectangle.prototype.setX=function(a){this.m_nX=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.setY=function(a){this.m_nY=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getWidth=function(){return this.m_nWidth};SBGrid.DS.Rectangle.prototype.setWidth=function(a){this.m_nWidth=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getHeight=function(){return this.m_nHeight};SBGrid.DS.Rectangle.prototype.setHeight=function(a){this.m_nHeight=a;this.adjustButtomRight()};SBGrid.DS.Rectangle.prototype.getBottom=function(){return this.m_nBottom};SBGrid.DS.Rectangle.prototype.getRight=function(){return this.m_nRight};SBGrid.DS.Rectangle.prototype.adjustButtomRight=function(){this.m_nRight=this.m_nX+this.m_nWidth;this.m_nBottom=this.m_nY+this.m_nHeight};SBGrid.DS.Rectangle.prototype.isContainsPoint=function(a){if(null!=a&&a instanceof Point){if(this.m_nX<=a.getX()&&this.m_nRight>=a.getX()&&this.m_nY<=a.getY()&&this.m_nBottom>=a.getY()){return true}}return false};SBGrid.DEF.inputValidateCheck=function(h,a,c){var l="";var b="";var d=0;var g=0;var e=h.length;if(""!=c){c=c.charAt(1);if(c!=a.charAt(0)){c=""}}reSpecialChar=/\s/g;a=a.replace(reSpecialChar,"");reSpecialChar=/\W/g;a=a.replace(reSpecialChar,"");for(var f=0;f<e;f++){if(d!=e&&""!=a.charAt(g)){if("9"!=h.charAt(d)&&"y"!=h.charAt(d)&&"m"!=h.charAt(d)&&"d"!=h.charAt(d)&&"h"!=h.charAt(d)&&"n"!=h.charAt(d)&&"s"!=h.charAt(d)&&"A"!=h.charAt(d)&&"a"!=h.charAt(d)&&"C"!=h.charAt(d)&&"L"!=h.charAt(d)){l=l+h.charAt(d);d++}else{for(;g<a.length;g++){b=SBGrid.DEF.validateFormat(d,a.charAt(g),h,a);if(""!=b){l=l+b;g++;if("9"!=h.charAt(d+1)&&"y"!=h.charAt(d+1)&&"m"!=h.charAt(d+1)&&"d"!=h.charAt(d+1)&&"h"!=h.charAt(d+1)&&"n"!=h.charAt(d+1)&&"s"!=h.charAt(d+1)&&"A"!=h.charAt(d+1)&&"a"!=h.charAt(d+1)&&"C"!=h.charAt(d+1)&&"L"!=h.charAt(d+1)){l=l+h.charAt(d+1);d++}break}}d++}}}if(""!=c){l=c+l}return l};SBGrid.DEF.validateFormat=function(a,e,c,b){var d=e.charCodeAt(0);switch(c.charAt(a)){case"9":if(d>=48&&d<=57){return String.fromCharCode(d)}return"";case"y":if(d>=48&&d<=57){return String.fromCharCode(d)}return"";case"m":if("m"==c.charAt(a+1)){if(d>=48&&d<=49){return String.fromCharCode(d)}}else{if("m"==c.charAt(a-1)&&"1"==b.charAt(a-1)){if(d>=48&&d<=50){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}}return"";case"d":if("d"==c.charAt(a+1)){if("m"==c.charAt(a-2)&&"2"==b.charAt(a-2)&&(("m"==c.charAt(a-3)&&"0"==b.charAt(a-3))||"m"!=c.charAt(a-3))){if(d>=48&&d<=50){return String.fromCharCode(d)}}else{if(d>=48&&d<=51){return String.fromCharCode(d)}}}else{if("d"==c.charAt(a-1)&&"3"!=b.charAt(a-1)){if(d>=48&&d<=57){return String.fromCharCode(d)}}else{if("d"==c.charAt(a-1)&&"3"==b.charAt(a-1)){if(d>=48&&d<=49){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}}}return"";case"h":if("h"==c.charAt(a+1)){if(d>=48&&d<=50){return String.fromCharCode(d)}}else{if("h"==c.charAt(a-1)&&"2"==b.charAt(a-1)){if(d>=48&&d<=52){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}}return"";case"n":if("n"==c.charAt(a+1)){if(d>=48&&d<=53){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}return"";case"s":if("s"==c.charAt(a+1)){if(d>=48&&d<=53){return String.fromCharCode(d)}}else{if(d>=48&&d<=57){return String.fromCharCode(d)}}return"";case"A":if((d>=48&&d<=57)||(d>=65&&d<=90)||(d>=97&&d<=129)){return e}return"";case"a":if((d==32)||(d>=48&&d<=57)||(d>=65&&d<=90)||(d>=97&&d<=129)){return e}return"";case"C":if((d>=48&&d<=112)||d>185||(d>=97&&d<=129)){return e}return"";case"L":if((d>=65&&d<=90)||(d>=97&&d<=129)){return e}return"";default:alert("미구현");return""}};SBGrid.DEF.inputMoneyUnitValidateCheckPattern1=function(a,d){var c="";var e=a.length;e=0==d.length?e:d.length;for(var b=0;b<e;b++){if(""!=a.charAt(b)){c+=a.charAt(b);continue}else{c+="0"}}return c};SBGrid.DEF.inputMoneyUnitValidateCheckPattern2=function(a,b,g){var l="";a=a.replace(/\D/g,"");var e=a.length;var c=e%3;var h=(e/2)-1;var n=0;var f=0;var m=false;for(var d=0;d<e;d++){if(0==d&&a.charCodeAt(d)==48){l=a.charAt(d)}else{if(c==n){if(e>3&&c!=0){l=l+",";m=true}else{if(e>3){m=true}}}if(3==f){l=l+",";f=0}l+=a.charAt(d);n++;if(m){f++}}}if(""==l&&b&&""!=g){l="0"}return l};SBGrid.DEF.inputMoneyUnitValidateCheckPattern3=function(b,h,e){var d="";b=b.replace(/[^\.\d]/g,"");var g=0==e.length?0:e.length;var f=b.length;for(var c=0;c<f;c++){d+=b.charAt(c)}if(""==d&&"0"==h.replace(/[^\.\d]/g,"").charAt(0)){d="0"}if(-1!=b.indexOf(".")){var a=b.substring(b.indexOf("."),f).length;for(var c=a;c<=g;c++){d+="0"}}else{if(0<g){d+=".";for(var c=0;c<g;c++){d+="0"}}}return d};SBGrid.DEF.formatStatus=function(a){if(""==a){return 0}var b;if("-1"==a.indexOf("#")&&"-1"==a.indexOf("0")){return 1}else{b="-1"!=a.indexOf(",")?3:2;b="-1"!=a.indexOf(".")?(b+2):b;return b}};SBGrid.DS.CaretPosition=function(){var b=null;var a=null};SBGrid.DEF.getCaretPosition=function(a){var d=new SBGrid.DS.CaretPosition();if(document.selection){var e=document.selection.createRange().getBookmark();var b=a.createTextRange();b.moveToBookmark(e);var c=a.createTextRange();c.collapse(true);c.setEndPoint("EndToStart",b);d.start=c.text.length;d.end=c.text.length+b.text.length}else{if(a.selectionStart||a.selectionStart=="0"){d.start=a.selectionStart;d.end=a.selectionEnd}}return d};SBGrid.DEF.setCaretPosition=function(a,c,f){try{if(document.selection){a.blur();a.focus();a.value=a.value;var b=a.createTextRange();b.moveStart("character",-a.value.length);b.moveEnd("character",-a.value.length);b.moveStart("character",c);b.moveEnd("character",f-c);b.select()}else{if(a.selectionStart||a.selectionStart=="0"){a.selectionStart=null;a.selectionEnd=null;a.selectionStart=c;a.selectionEnd=f;a.focus()}}}catch(d){SBGrid.DEF.errorMsg("SBGrid.DEF.setCaretPosition::"+d)}};SBGrid.DEF.getSelectionText=function(a){var b="";if(document.selection){b=document.selection.createRange();return b.text}else{if(null!=a&&null!=a.selectionStart){return a.value.substring(a.selectionStart,a.selectionEnd)}else{return window.getSelection()}}};SBGrid.DEF.setSelectionText=function(b,a){if(document.selection){var d=document.selection.createRange();d.text=a}else{var c=b.selectionStart;var e=0!=b.selectionStart?b.value.substring(0,b.selectionStart):"";var f=b.value.substring(b.selectionEnd,b.value.length);b.value=e+a+f;b.focus();b.selectionStart=c;b.selectionEnd=c+a.length}};SBGrid.DEF.getInputKeyCode=function(a){if((48<=a&&57>=a)||(65<=a&&90>=a)||(96<=a&&111>=a)||(219<=a&&222>=a)||(186<=a&&192>=a)||32==a||229==a){return true}return false};SBGrid.DEF.__initWindowAndDocSize=function(){window.nViewportWidth=null;window.nViewportHeight=null;if(typeof window.innerWidth!="undefined"){window.nViewportWidth=window.innerWidth;window.nViewportHeight=window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){window.nViewportWidth=document.documentElement.clientWidth;window.nViewportHeight=document.documentElement.clientHeight}else{window.nViewportWidth=document.getElementsByTagName("body")[0].clientWidth;window.nViewportHeight=document.getElementsByTagName("body")[0].clientHeight}}};SBGrid.DEF.errorMsg=function(a){if(window.console){console.log(a)}};SBGrid.DEF.APIerrorMsg=function(a,b,d){if(d<0||d>3){d=SBGrid.DEF.DEBUGMODE_ALERT_CONSOLE}var c="SBGrid API '"+a+"()' ERROR!!\n";c+=b;if(d==SBGrid.DEF.DEBUG_MODE_CONSOLE||d==SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE){SBGrid.DEF.errorMsg(c)}if(d==SBGrid.DEF.DEBUG_MODE_ALERT||d==SBGrid.DEF.DEBUG_MODE_ALERT_CONSOLE){alert(c)}};SBGrid.DEF.makeStyleSheetClass=function(c,e){if(null==e||""==e){return}var a=document.styleSheets.length;var d=document.styleSheets[a-1];var b=SBGrid.DEF.is_ie?d.rules.length:d.cssRules.length;if(document.all){d.addRule("."+c,e,b)}else{d.insertRule("."+c+"{"+e+"}",b)}};SBGrid.DEF.findToMakeStyleSheet=function(c){var a=document.styleSheets.length;var e=document.styleSheets[a-1];var g=SBGrid.DEF.is_ie?e.rules:e.cssRules;var b=g.length;var f=null;for(var d=0;d<b;d++){if(g.item(d).selectorText==("."+c)){return g.item(d)}}if(document.all){e.addRule("."+c,"background-color:",b)}else{e.insertRule("."+c+"{}",b)}return g.item(b)};SBGrid.DEF.uploadUsingPOST=function(c,b){var d=new XMLHttpRequest();d.onreadystatechange=function(){if(4==this.readyState){if(200==this.status){var n=this.responseText;if(null!=n||!n.isEmpty()){n=n.trim();if(n){var f=SBGrid.UT.XmlLib.loadXMLFromString(n);if(f.selectSingleNode("/root")){var p=f.selectSingleNode("/root/tagName");var g=f.selectSingleNode("/root/fileName");var h=f.selectSingleNode("/root/tempName");var e=f.selectSingleNode("/root/filePath");var m=SBGrid.UT.XmlLib.getTextValue(p);var o=SBGrid.UT.XmlLib.getTextValue(g);var i=SBGrid.UT.XmlLib.getTextValue(h).replaceAll(SBGrid.UT.XmlLib.getTextValue(e),"");var l=document.SBHE_controls.item(m.substring(3,m.lastIndexOf(".")));l.setAttachedFile(o,i)}l.dispatch("onfileselected")}}}else{throw new Error(this.status)}}};d.open("POST",SBGrid.DEF.__getAppName()+"/FileUpload.tfs",true);var a=new FormData();a.append(c,b);d.send(a)};SBGrid.DEF.RGB_convert=function(c){var e=c.toString(16);var d="";var a=e.length;for(var b=a;b<6;b++){d+="0"}d+=e;e=d.substring(4,6)+d.substring(2,4)+d.substring(0,2);return e};SBGrid.DEF.__initDocument=function(){document.SBHE_allElement=new SBGrid.DS.Collection();document.SBHE_controls=new SBGrid.DS.Collection()};SBGrid.DEF.__initControls=function(){for(var b=0;b<document.SBHE_controls.length;b++){var a=document.SBHE_controls.item(b);if(null!=a){a.init()}}};SBGrid.DEF.__appendAll=function(b,a){document.SBHE_allElement.add(b,a)};SBGrid.DEF.__removeAll=function(a){document.SBHE_allElement.remove(a)};SBGrid.DEF.__appendControl=function(b,a){document.SBHE_controls.add(b,a)};SBGrid.DEF.__removeControl=function(a){document.SBHE_controls.remove(a)};createSBDataGrid=function(e){if(arguments.length!=1){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof e!="object"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if parameter's type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}else{if(!(e.strParentId)||!(document.getElementById(e.strParentId))){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strParentId' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return}var d=document.getElementById(e.strParentId);if(d.tagName=="BODY"||e.strParentId=="body"){SBGrid.CT.DataGrid.initEngine(e.strParentId)}else{if(d.tagName=="DIV"){var b="body";if(document.body.id!=null&&document.body.id!=""){b=document.body.id}else{document.body.id=b}SBGrid.CT.DataGrid.initEngine(b);var a=SBGrid.DS.SBBody.createChild("softbowl:DIV","id:"+e.strParentId)}}if(!(e.strAlert)){e.strAlert=""}else{if((typeof e.strAlert)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strAlert' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strHelp)){e.strHelp=""}else{if((typeof e.strHelp)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strHelp' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strHint)){e.strHint=""}else{if((typeof e.strHint)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strHint' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bAllowBigSelection)){e.bAllowBigSelection=false}else{if((typeof e.bAllowBigSelection)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowBigSelection' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bAllowSelection)){e.bAllowSelection=true}else{if((typeof e.bAllowSelection)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowSelection' property's type is  'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bAllowUserResize)){e.bAllowUserResize=true}else{if((typeof e.bAllowUserResize)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAllowUserResize' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bAutoResize)){e.bAutoResize=false}else{if((typeof e.bAutoResize)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAutoResize' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bAutoSizeMouse)){e.bAutoSizeMouse=false}else{if((typeof e.bAutoSizeMouse)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAutoSizeMouse' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bAutoResizeCaption)){e.bAutoResizeCaption=false}else{if((typeof e.bAutoResizeCaption)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bAutoResizeCaption' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strCaption)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strCaption' property of SBGrid.\nex> 'caption1^caption2^caption3'",SBGrid.DEF.DEBUG_MODE);return}else{if((typeof e.strCaption)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strCaption' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strColSep)){e.strColSep="^"}else{if((typeof e.strColSep)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strColSep' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strColWidth)){e.strColWidth="";var f=e.strCaption.split("^");for(var c=1;c<=f.length;c++){e.strColWidth+="100";if(c==f.length){break}e.strColWidth+=","}}else{if((typeof e.strColWidth)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strColWidth' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strDataType)){e.strDataType="xml"}else{if((typeof e.strDataType)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDataType' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nDefaultRows)){e.nDefaultRows=0}else{if((typeof e.nDefaultRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nDefaultRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bDisabled)){e.bDisabled=false}else{if((typeof e.bDisabled)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bDisabled' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bDragmode)){e.bDragmode=false}else{if((typeof e.bDragmode)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bDragmode' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bDropmode)){e.bDropmode=false}else{if((typeof e.bDropmode)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bDropmode' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bEllipsis)){e.bEllipsis=false}else{if((typeof e.bEllipsis)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bEllipsis' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strExplorerbar)){e.strExplorerbar=""}else{if((typeof e.strExplorerbar)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strExplorerbar' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strExplorerUI)){e.strExplorerUI=""}else{if((typeof e.strExplorerUI)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strExplorerUI' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strExtendLastCol)){e.strExtendLastCol="false"}else{if((typeof e.strExtendLastCol)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strExtendLastCol' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFixedCols)){e.nFixedCols=0}else{if((typeof e.nFixedCols)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFixedCols' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFrozenBottomRows)){e.nFrozenBottomRows=0}else{if((typeof e.nFrozenBottomRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFrozenBottomRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFrozenCols)){e.nFrozenCols=0}else{if((typeof e.nFrozenCols)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFrozenCols' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nFrozenRows)){e.nFrozenRows=0}else{if((typeof e.nFrozenRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nFrozenRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strId)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strId' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return}else{if((typeof e.strId)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strId' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strMergeCellFixedRows)){e.strMergeCellFixedRows="bycolrec"}else{if((typeof e.strMergeCellFixedRows)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strMergeCellFixedRows' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bMultiTotal)){e.bMultiTotal=true}else{if((typeof e.bMultiTotal)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bMultiTotal' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(e.strNodeSet){if((typeof e.strNodeSet)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}e.strJsonRef=""}if(e.strJsonRef){if((typeof e.strJsonRef)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strJsonRef' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}e.strNodeSet=""}if(!(e.bRemoveHScroll)){e.bRemoveHScroll=false}else{if((typeof e.bRemoveHScroll)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bRemoveHScroll' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bRemoveVScroll)){e.bRemoveVScroll=false}else{if((typeof e.bRemoveVScroll)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bRemoveVScroll' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.nRows)){e.nRows=0}else{if((typeof e.nRows)!="number"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'nRows' property's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strRowSep)){e.strRowSep="|"}else{if((typeof e.strRowSep)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strRowSep' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSelectFontColorStyle)){e.strSelectFontColorStyle="invert"}else{if((typeof e.strSelectFontColorStyle)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSelectFontColorStyle' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSelectImageStyle)){e.strSelectImageStyle="invert"}else{if((typeof e.strSelectImageStyle)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSelectImageStyle' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSelectMode)){e.strSelectMode="listbox"}else{if((typeof e.strSelectMode)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSelectMode' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strSubTotalPosition)){e.strSubTotalPosition="above"}else{if((typeof e.strSubTotalPosition)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSubTotalPosition' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strStyle)){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check 'strStyle' property of SBGrid.",SBGrid.DEF.DEBUG_MODE);return}else{if((typeof e.strStyle)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strStyle' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strToolTip)){e.strToolTip=""}else{if((typeof e.strToolTip)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strToolTip' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strVisibility)){e.strVisibility="visible"}else{if((typeof e.strVisibility)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strVisibility' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.bIsDecimalFormatInsert)){e.bIsDecimalFormatInsert=false}else{if((typeof e.bIsDecimalFormatInsert)!="boolean"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'bIsDecimalFormatInsert' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(!e.strUserDefineAttrib){e.strUserDefineAttrib="automerge:false;"}else{if((typeof e.strUserDefineAttrib)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strUserDefineAttrib' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}e.strUserDefineAttrib="automerge:false;"+e.strUserDefineAttrib}if(!(e.strSummary)){e.strSummary=""}else{if((typeof e.strSummary)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strSummary' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strDataReplace)){e.strDataReplace="undefined"}else{if((typeof e.strDataReplace)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDataReplace' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strDataHeight)){e.strDataHeight=""}else{if((typeof e.strDataHeight)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDataHeight' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strRowHeader)){e.strRowHeader=""}else{if((typeof e.strRowHeader)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strRowHeader' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strRowHeight)){e.strRowHeight=""}else{if((typeof e.strRowHeight)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strRowHeight' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strDeleteFlagImage)){e.strDeleteFlagImage=""}else{if((typeof e.strDeleteFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strDeleteFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strInsertFlagImage)){e.strInsertFlagImage=""}else{if((typeof e.strInsertFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strInsertFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strNormalFlagImage)){e.strNormalFlagImage=""}else{if((typeof e.strNormalFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strNormalFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(e.strUpdateFlagImage)){e.strUpdateFlagImage=""}else{if((typeof e.strUpdateFlagImage)!="string"){SBGrid.DEF.APIerrorMsg("createSBDataGrid","Please check if 'strUpdateFlagImage' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}return new SBGrid.CT.DataGrid(e.strParentId,e.strAlert,e.strHelp,e.strHint,e.bAllowBigSelection,e.bAllowSelection,e.bAllowUserResize,e.bAutoResize,e.bAutoSizeMouse,e.strBackColorAlternate,e.strBackColorFrozen,e.strCaption,e.strCaptionLayout,e.strClass,e.strColSep,e.strColWidth,e.strDataHeight,e.strDataType,e.nDefaultRows,e.strDeleteFlagImage,e.bDisabled,e.bDragmode,e.bDropmode,e.bEllipsis,e.strExplorerbar,e.strExplorerUI,e.strExtendLastCol,e.nFixedCols,e.strFocusColor,e.strForeColorFrozen,e.nFrozenBottomRows,e.nFrozenCols,e.nFrozenRows,e.strId,e.strInsertFlagImage,e.strMergeCells,e.strMergeCellsFixedCols,e.strMergeCellFixedRows,e.bMultiTotal,e.strNodeSet,e.strJsonRef,e.strNormalFlagImage,e.strOverflow,e.bRemoveHScroll,e.bRemoveVScroll,e.strRowHeader,e.strRowHeight,e.nRows,e.strRowSep,e.strScroll,e.strSelectFontColorStyle,e.strSelectImageStyle,e.strSelectMode,e.strSubTotalPosition,e.strStyle,"softbowl:datagrid",e.strToolTip,e.strUpdateFlagImage,e.strVisibility,e.strWallPaper,e.bIsDecimalFormatInsert,e.strUserDefineAttrib,e.strSummary,e.bAutoResizeCaption,e.strDataReplace)}};SBGrid.DEF.createSBGrid=function(a){if(arguments.length!=1){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}else{if(typeof a!="object"){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if parameter's type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}else{if(a.objSBGridInitInfo==null){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'objSBGridInitInfo' property is null.",SBGrid.DEF.DEBUG_MODE);return}if(a.arSBGridColumnInitInfo==null){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'arSBGridColumnInitInfo' property is null.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a.objSBGridInitInfo!="object"){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'objSBGridInitInfo' property's type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}if(!(a.arSBGridColumnInitInfo instanceof Array)){SBGrid.DEF.APIerrorMsg("createSBGrid","Please check if 'arSBGridColumnInitInfo' property's type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}var b=null;b=createSBDataGrid(a.objSBGridInitInfo);if(b){b.createColumns(a.arSBGridColumnInitInfo)}else{var c="SBGrid creating is failed.";alert(c)}return b}}};if(SBGrid.DEF.is_ie&&window==window.top){window.eval("var parent;")}SBGrid.DEF._W_getCurrentEvent=function(){return SBGrid.DEF.m_event};SBGrid.DEF._W_dummyEvent=function(){SBGrid.DEF.errorMsg("dummy does not support.")};SBGrid.DEF._W_onProcessEvent=function(g,n,l){if(!SBGrid.DEF.bParsed){return}if(SBGrid.DEF.m_event.name=="onfocus"){return}if(null==n&&null==l){n=SBGrid.DEF._W_getEventName(g);l="body"}var b=null;if(SBGrid.DEF.is_ie){b=g.srcElement}else{b=g.target}var m=window;var f=document;if(null!=b.parentWindow){m=b.parentWindow;f=b.parentWindow.document}SBGrid.DEF.initEvent(g,l);var a=n;var p=f.SBHE_allElement.m_htCollection[l];if(null!=p){if(null!=p.vscroll){p.vscroll.refresh();p.hscroll.refresh()}p.dispatch(a,SBGrid.DEF.m_event);if(SBGrid.DEF.is_smartphone&&"onscroll"==a&&p instanceof SBGrid.CT.HtmlBody){var h=document.SBHE_allElement.keys();for(var d=0;d<h.length;d++){var o=h[d];var c=document.SBHE_allElement.m_htCollection[o];if(null!=c&&c instanceof SBGrid.CT.DataGrid){c.moveGridExpansion()}else{if("softbowl:group"==c.elementName){c.moveGroupExpansion()}}}}}};SBGrid.DEF._W_onResize=function(f){if(!SBGrid.DEF.bShowPop){return}var b=document.SBHE_allElement.keys();for(var c=0;c<b.length;c++){var d=b[c];var a=document.SBHE_allElement.m_htCollection[d];if(null!=a&&(null!=this.SBDatagrid&&objElement instanceof this.SBDatagrid)){a.resize()}}SBGrid.DEF.__initWindowAndDocSize()};SBGrid.DEF._W_onBlurEvent=function(f){var d=document.activeElement;var c=SBGrid.DEF._W_findEventElement(d);if(d.id){if(SBGrid.DEF.SB_ITEMLIST[d.id]==true){return}}if(c){if(c.elementName=="xhtml:body"){var a;if(SBGrid.DEF.is_ie){a=f.srcElement}else{a=f.target}var b=SBGrid.DEF._W_findEventElement(a);if(null==b){return}if(b.elementName=="xhtml:body"){return}while(b&&b.elementName!="softbowl:datagrid"){b=b.parent}if(b){b.closePopUp()}}}};SBGrid.DEF._W_onProcessMouseEvent=function(o){var c=SBGrid.DEF._W_getEventName(o);if("onmouseup"==c){var s=""}if("onmousedown"==c){var p=""}if("ondragstart"==c){var d=SBGrid.DEF._W_getCurrentEvent();d.browserPreventDefault();d.browserStopPropagation();return}if("onmousemove"==c){if(SBGrid.DEF.bIsDragMode){SBGrid.DEF.bIsDragMode=false}else{if(SBGrid.DEF.bDragDrop&&"onmouseup"==c){SBGrid.DEF.bDragDrop=false;var u=null;for(var h=0;h<document.SBHE_controls.length;h++){u=document.SBHE_controls.item(h);u.setAttribute("cursor",u.getAttribute("cursor"))}var r=document.getElementById("dragstyle");if(null!=r){var n=r.parentNode;n.removeChild(r)}}var l;if(SBGrid.DEF.is_ie){l=o.srcElement}else{l=o.target}var t=SBGrid.DEF._W_findEventElement(l);if(null==t){return}if(null!=SBGrid.DEF.m_event.cursorOver&&"on"==SBGrid.DEF.m_event.cursorOver){t.dispatch("oncursor")}if((-1==o.x&&-1==o.y)||(null!=SBGrid.DEF.m_nOldEventX&&null!=SBGrid.DEF.m_nOldEventY)&&o.x==SBGrid.DEF.m_nOldEventX&&o.y==SBGrid.DEF.m_nOldEventY){if(null!=SBGrid.DEF.m_event.hint&&"ready"==SBGrid.DEF.m_event.hint){var g=false;if("softbowl:treeitem"==t.tag){if(""!=t.parent.getAttribute("hint")){g=true}}var f=t.parent.getAttribute("tooltip");if(""!=t.getAttribute("hint")||g||"true"==f||"label"==f){SBGrid.DEF.m_event.hint="none";SBGrid.DEF.m_event.hinting=true;t.dispatch("onshowhint");t.dispatch("softbowl-hint");SBGrid.DEF.m_event.showHint=window.setTimeout(function(){SBGrid.DEF.m_event.hinting=false;t.dispatch("onhidehint")},5000)}f=null}return}}}if(!SBGrid.DEF.bParsed){return}var l;if(SBGrid.DEF.is_ie){l=o.srcElement}else{l=o.target}var t=SBGrid.DEF._W_findEventElement(l);if(null!=t){var m=false;if(("onmousedown"==c||"onmouseup"==c)&&"softbowl:comboinput"==t.tag&&""==t.parent.getAttribute("editmode")){t=null!=t.parent?t.parent:t;m=true}if(t instanceof SBGrid.CT.ContextMenu){return}var q=t.getId();if(null!=t.m_parentWindow){SBGrid.DEF.initEvent(o,q)}else{SBGrid.DEF.initEvent(o,q)}if(m){SBGrid.DEF.m_event.browserStopPropagation();SBGrid.DEF.m_event.browserPreventDefault()}t.dispatch(c)}SBGrid.DEF.m_nOldEventX=o.x;SBGrid.DEF.m_nOldEventY=o.y};SBGrid.DEF._W_onProcessFocusedEvent=function(e){if(!SBGrid.DEF.bParsed){return}SBGrid.DEF.m_bIsAccesskey=false;if("keydown"==e.type){if(e.shiftKey){if(e.keyCode==13){var a=""}}}if("keypress"==e.type){var b=""}if("keyup"==e.type){if(0<SBGrid.DEF.m_arAccesskey.length){for(var i=0;i<SBGrid.DEF.m_arAccesskey.length;i++){if(e.keyCode==eval("SBGrid.EVT."+SBGrid.DEF.m_arAccesskey[i].accesskey)){switch(SBGrid.DEF.m_arAccesskey[i].combine){case"NONE":SBGrid.DEF.m_bIsAccesskey=true;break;case"CONTROL":if(e.ctrlKey){SBGrid.DEF.m_bIsAccesskey=true}break;case"SHIFT":if(e.shiftKey){SBGrid.DEF.m_bIsAccesskey=true}break}if(SBGrid.DEF.m_bIsAccesskey){setFocus(SBGrid.DEF.m_arAccesskey[i].target);break}}}}}var strEvent=SBGrid.DEF._W_getEventName(e);if(SBGrid.DEF.m_bIsAccesskey){strEvent="onaccesskey"}var strFocusId=SBGrid.DEF.m_event.focus;if(null!=strFocusId&&!strFocusId.isEmpty()){SBGrid.DEF.initEvent(e,strFocusId);var objFocused=SBGrid.DEF._W_findEventElement(document.SBHE_allElement.m_htCollection[strFocusId]);if("softbowl:cell"==objFocused.tag){objFocused=objFocused.getElement()}if(null!=objFocused){objFocused.dispatch(strEvent,SBGrid.DEF.m_event)}}};SBGrid.DEF._W_getEventName=function(a){switch(a.type){case"mousedown":return"onmousedown";case"mousemove":return"onmousemove";case"mouseup":return"onmouseup";case"dblclick":return"ondblclick";case"keydown":return"onkeydown";case"keypress":return"onkeypress";case"keyup":return"onkeyup";case"mousewheel":return"onmousewheel";case"DOMMouseScroll":return"onmousewheel";case"scroll":return"onscroll";case"dragstart":return"ondragstart";case"draggesture":return"ondragstart";case"dragenter":return"ondragenter";case"dragover":return"ondragover";case"dragleave":return"ondragleave";case"dragexit":return"ondragleave";case"drop":return"ondrop";case"dragdrop":return"ondrop";case"drag":return"ondrag";case"focus":alert("focus event 발생");case"click":return"onclick";case"change":return"onchange"}};SBGrid.DEF._W_findEventElement=function(c){if(null!=c){var b;var e;var f;var h=c;while(null!=h&&h.getAttribute){var g=h.getAttribute("id");if(g){b=g.replace("SBHE_","");if(b=="__SB_ContextMenu"){return null}if(null!=b){e=h.getAttribute("parentId");if(null!=e){f=true}else{f=false}var d=null;var i=null;if(null==h.parentWindow){d=document;i=window}else{d=h.parentWindow.document;i=h.parentWindow}var l=d.SBHE_allElement.m_htCollection[b];if(null!=l){if((null!=i.SBGrid.CT.Cell&&l instanceof i.SBGrid.CT.Cell)||(null!=i.SBGrid.CT.SelectCell&&l instanceof i.SBGrid.CT.SelectCell)||(null!=i.SBGrid.CT.SelectItem&&l instanceof i.SBGrid.CT.SelectItem)||(null!=i.SBGrid.CT.DataGridCell&&l instanceof i.SBGrid.CT.DataGridCell)){var a=l.parent;if(null!=a){a.setAttribute("row",l.row);a.setAttribute("col",l.col)}}else{if((null!=i.SBGrid.CT.DataGrid&&l instanceof SBGrid.CT.DataGrid)){l.mouseCol=-1;l.mouseRow=-1}else{if((null!=i.SBGrid.CT.Select&&l instanceof SBGrid.CT.Select)){if("minimal"!=l.getAttribute("appearance")){l.m_nSelectedRow=-1;l.m_nSelectedCol=-1}l.m_bScoll=f}}}return l.getElement()}}}if(SBGrid.DEF.is_firefox){h=h.parentNode}else{h=h.parentElement}}}return null};SBGrid.DEF.initEvent=function(c,b){SBGrid.DEF.m_event.name=SBGrid.DEF._W_getEventName(c);if(SBGrid.DEF.m_bIsAccesskey){SBGrid.DEF.m_event.name="onaccesskey"}SBGrid.DEF.m_event.target=b;SBGrid.DEF.m_event.altKey=c.altKey;SBGrid.DEF.m_event.ctrlKey=c.ctrlKey;SBGrid.DEF.m_event.shiftKey=c.shiftKey;SBGrid.DEF.m_event.metaKey=c.metaKey;SBGrid.DEF.m_event.keyCode=c.keyCode;if(SBGrid.DEF.is_ie){switch(c.button){case 1:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_LEFT;break;case 2:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_RIGHT;break;case 4:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_MIDDLE;break}}else{switch(c.button){case 0:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_LEFT;break;case 1:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_MIDDLE;break;case 2:SBGrid.DEF.m_event.button=SBGrid.EVT.BUTTON_RIGHT;break}}var a=document.SBHE_allElement.m_htCollection[b];if(null!=a.m_heControl){SBGrid.DEF.m_event.targetX=c.clientX-a.getClientLeft(true)-a.m_heControl.scrollLeft;SBGrid.DEF.m_event.targetY=c.clientY-a.getClientTop(true)-a.m_heControl.scrollTop}SBGrid.DEF.m_event.screenX=c.screenX;SBGrid.DEF.m_event.screenY=c.screenY;SBGrid.DEF.m_event.clientX=c.clientX;SBGrid.DEF.m_event.clientY=c.clientY;SBGrid.DEF.m_event.m_nRef=0;SBGrid.DEF.m_event.m_browserEvent=c;SBGrid.DEF.m_event.pTarget=a;if(c.wheelDelta){SBGrid.DEF.m_event.mouseWheel=c.wheelDelta/120}else{SBGrid.DEF.m_event.mouseWheel=-(c.detail/3)}};SBGrid.DEF.__attachEventHandler=function(strID){if(window.attachEvent){eval(strID+".attachEvent('onmousedown', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onmousemove', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onmouseup', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondblclick', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onkeydown', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".attachEvent('onkeypress', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".attachEvent('onkeyup', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".attachEvent('onmousewheel', SBGrid.DEF._W_onProcessFocusedEvent);");window.attachEvent("onresize",SBGrid.DEF._W_onResize);eval(strID+".attachEvent('onscroll', SBGrid.DEF._W_onProcessEvent);");eval(strID+".attachEvent('ondragstart', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondragenter', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondragover', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondragleave', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondrop', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('ondrag', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".attachEvent('onchange', SBGrid.DEF._W_onProcessMouseEvent);")}else{eval(strID+".addEventListener('mousedown', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('mousemove', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('mouseup', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dblclick', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('keydown', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('keypress', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('keyup', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('mousewheel', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".addEventListener('DOMMouseScroll', SBGrid.DEF._W_onProcessFocusedEvent, false);");window.addEventListener("resize",SBGrid.DEF._W_onResize,false);eval(strID+".addEventListener('scroll', SBGrid.DEF._W_onProcessEvent, false);");eval(strID+".addEventListener('dragstart', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('draggesture', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragenter', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragover', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragleave', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragexit', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('drop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('dragdrop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('drag', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".addEventListener('change', SBGrid.DEF._W_onProcessMouseEvent, false);")}};SBGrid.DEF.__removeEventHandler=function(strID){if(window.detachEvent){eval(strID+".detachEvent('onmousedown', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onmousemove', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onmouseup', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondblclick', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onkeydown', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".detachEvent('onkeypress', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".detachEvent('onkeyup', SBGrid.DEF._W_onProcessFocusedEvent);");eval(strID+".detachEvent('onmousewheel', SBGrid.DEF._W_onProcessFocusedEvent);");window.detachEvent("onresize",SBGrid.DEF._W_onResize);eval(strID+".detachEvent('onscroll', SBGrid.DEF._W_onProcessEvent);");eval(strID+".detachEvent('ondragstart', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondragenter', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondragover', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondragleave', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondrop', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('ondrag', SBGrid.DEF._W_onProcessMouseEvent);");eval(strID+".detachEvent('onchange', SBGrid.DEF._W_onProcessMouseEvent);")}else{eval(strID+".removeEventListener('mousedown', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('mousemove', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('mouseup', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dblclick', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('keydown', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('keypress', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('keyup', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('mousewheel', SBGrid.DEF._W_onProcessFocusedEvent, false);");eval(strID+".removeEventListener('DOMMouseScroll', SBGrid.DEF._W_onProcessFocusedEvent, false);");window.removeEventListener("resize",SBGrid.DEF._W_onResize,false);eval(strID+".removeEventListener('scroll', SBGrid.DEF._W_onProcessEvent, false);");eval(strID+".removeEventListener('dragstart', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('draggesture', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragenter', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragover', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragleave', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragexit', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('drop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('dragdrop', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('drag', SBGrid.DEF._W_onProcessMouseEvent, false);");eval(strID+".removeEventListener('change', SBGrid.DEF._W_onProcessMouseEvent, false);")}};SBGrid.DEF.__initWindow=function(){window.visible=true;SBGrid.DEF.m_nDelayTime=null;SBGrid.DEF.m_arGlobalEventFireList=SBGrid.DEF.makeGlobalEventFireList();SBGrid.DEF.m_event={name:"",target:"",currentTarget:"",relatedTarget:"",propagate:"",defaultAction:"",description:"",hover:"",down:"",focus:"",drag:"",capture:"",altKey:"",ctrlKey:"",shiftKey:"",metaKey:"",keyCode:"",button:"",x:-1,y:-1,clientX:-1,clientY:-1,screenX:-1,screenY:-1,targetX:-1,targetY:-1,pTarget:null,dropData:"",dropDataType:"",m_nRef:0,m_browserEvent:null,preventDefault:function(){this.defaultAction="cancel"},routeDefault:function(){this.defaultAction="perform"},stopPropagation:function(){this.propagate="stop"},browserPreventDefault:function(){if(SBGrid.DEF.is_ie){this.m_browserEvent.returnValue=false}else{this.m_browserEvent.preventDefault()}},browserStopPropagation:function(){if(SBGrid.DEF.is_ie){this.m_browserEvent.cancelBubble=true}else{this.m_browserEvent.stopPropagation()}}};SBGrid.DEF.bParsed=true;SBGrid.DEF.m_strPrevClickElement;SBGrid.DEF.m_objPrevClickDate};SBGrid.DEF.setFocus=function(c){var b=SBGrid.DEF.m_event.focus;if(b==c){return}var d=document.SBHE_allElement.m_htCollection[b];if(null!=d){d=d.getElement();SBGrid.DEF.m_event.relatedTarget=c;d.dispatch("onblur",SBGrid.DEF.m_event);if(d.getState(SBGrid.DEF.SB_CS_DISABLE)){SBGrid.DEF.m_event.focus=""}if(!SBGrid.DEF.m_event.focus.isEmpty()){return}}var a=document.SBHE_allElement.m_htCollection[c];if(null!=a){a=a.getElement();SBGrid.DEF.m_event.relatedTarget=b;a.dispatch("onfocus",SBGrid.DEF.m_event);if(SBGrid.DEF.m_event.focus!=c){return}}SBGrid.DEF.m_event.relatedTarget=""};SBGrid.DEF.isSmartPhoneDblClick=function(c){var a=false;if(SBGrid.DEF.is_smartphone){var b=new Date().getTime();if(SBGrid.DEF.m_strPrevClickElement==c&&b<SBGrid.DEF.m_objPrevClickDate+1000){a=true}}return a};SBGrid.DEF.setPermitResize=function(a){SBGrid.DEF.bShowPop=a};SBGrid.DEF.setPrevClickInfo=function(b,a){if(SBGrid.DEF.is_smartphone){SBGrid.DEF.m_strPrevClickElement=b;SBGrid.DEF.m_objPrevClickDate=a}};SBGrid.DEF.removePrevClickInfo=function(){if(SBGrid.DEF.is_smartphone){SBGrid.DEF.m_strPrevClickElement=null;SBGrid.DEF.m_objPrevClickDate=null}};SBGrid.DEF.makeGlobalEventFireList=function(){var a=new SBGrid.DS.Hashtable();if(window.onaccesskey){a.onaccesskey=true}if(window.onblur){a.onblur=true}if(window.onclick){a.onclick=true}if(window.ondblclick){a.ondblclick=true}if(window.ondelayclick){a.ondelayclick=true}if(window.onfocus){a.onfocus=true}if(window.onhidehint){a.onhidehint=true}if(window.onload){a.onload=true}if(window.onmousedown){a.onmousedown=true}if(window.onmouseup){a.onmouseup=true}if(window.onmousemove){a.onmousemove=true}if(window.onmouseout){a.onmouseout=true}if(window.onmouseover){a.onmouseover=true}if(window.onmousewheel){a.onmousewheel=true}if(window.onscroll){a.onscroll=true}if(window.onscrolldown){a.onscrolldown=true}if(window.onscrollpagedown){a.onscrollpagedown=true}if(window.onscrollpageup){a.onscrollpageup=true}if(window.onscrollpos){a.onscrollpos=true}if(window.onscrolltrack){a.onscrolltrack=true}if(window.onscrollup){a.onscrollup=true}if(window.onshowhint){a.onshowhint=true}if(window.onhint){a.onhint=true}if(window.oninvalid){a.oninvalid=true}if(window.onoptional){a.onoptional=true}if(window.onreadonly){a.onreadonly=true}if(window.onreadwrite){a.onreadwrite=true}if(window.onvalid){a.onvalid=true}if(window.oncopy){a.oncopy=true}if(window.ondayselect){a.ondayselect=true}if(window.onnextmonth){a.onnextmonth=true}if(window.onprevmonth){a.onprevmonth=true}if(window.onaftermovecolumn){a.onaftermovecolumn=true}if(window.onafteruserresize){a.onafteruserresize=true}if(window.onbeforemovecolumn){a.onbeforemovecolumn=true}if(window.onbeforeuserresize){a.onbeforeuserresize=true}if(window.onbuttonclick){a.onbuttonclick=true}if(window.onendedit){a.onendedit=true}if(window.onentercell){a.onentercell=true}if(window.onstartedit){a.onstartedit=true}if(window.onrowchanged){a.onrowchanged=true}if(window.ongridrebuild){a.ongridrebuild=true}if(window.onvaluechanged){a.onvaluechanged=true}if(window.onbuttonclick){a.onbuttonclick=true}if(window.onkeypress){a.onkeypress=true}if(window.onkeydown){a.onkeydown=true}if(window.onkeyup){a.onkeyup=true}if(window.oninvalidformat){a.oninvalidformat=true}if(window.onmaxlength){a.onmaxlength=true}if(window.onvalidformat){a.onvalidformat=true}if(window.ondeselect){a.ondeselect=true}if(window.onselect){a.onselect=true}return a};SBGrid.EVTUtil={DOMReady:function(a){if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false)}else{window.setTimeout(a,0)}},addHandler:function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.addEvent){a.addEvent("on"+c,b)}else{a["on"+c]=b}}},removeHandler:function(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b)}else{if(a.detachEvent){a.detachEvent("on"+c,b)}else{a["on"+c]=null}}},getEventObj:function(a){return a?a:window.event},getEventTarget:function(a){return a.target?a.target:a.srcElement},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=false}};SBGrid.DEF.setPopupMenu=function(o,c,b,p,r){var d=document.getElementById("SbgridContextMenu");if(null!=d){document.body.removeChild(d)}if(o){var f="";var n="";f=document.createElement("ul");f.id="SbgridContextMenu";document.body.appendChild(f);var h=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,c+"/"+b);var q=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,c+"/"+p);var l=h.length;var a=q.length;var m=l>=a?a:l;for(var g=0;g<m;g++){n=n+'<li onclick="'+SBGrid.DS.XMLStorage.getUniqueStorage().getValue(q.item(g))+'" >'+SBGrid.DS.XMLStorage.getUniqueStorage().getValue(h.item(g))+"</li>"}f.innerHTML=n;var e=new SBGrid.DEF._W_ContextMenu(event.srcElement,"SbgridContextMenu",function(i){})}};SBGrid.DEF._W_ContextMenu=function(b,d,a){var c=this,e=true;c.clickTarget=null;c.target=b;c.menu=document.getElementById(d);if(c.target){SBGrid.EVTUtil.addHandler(c.target,"contextmenu",function(f){if(e){f=SBGrid.EVTUtil.getEventObj(f);f.target=SBGrid.EVTUtil.getEventTarget(f);c.menu.style.top=f.clientY+"px";c.menu.style.left=f.clientX+"px";c.menu.style.display="block";c.clickTarget=f.target;if(typeof a=="function"){a(f)}SBGrid.EVTUtil.preventDefault(f)}});SBGrid.EVTUtil.addHandler(document.documentElement,"click",function(f){if(e){c.menu.style.display="none"}})}c.EnableContextMenu=function(f){e=f==true?true:false}};SBGrid.DEF.DOMAIN="./";SBGrid.DEF.__getAppName=function(){return SBGrid.DEF.DOMAIN};SBGrid.DEF.__deepCopy=function(d){if(Object.prototype.toString.call(d)==="[object Array]"){var b=[],c=0,a=d.length;for(;c<a;c++){b[c]=arguments.callee(d[c])}return b}if(typeof d==="object"){var b={},c;for(c in d){b[c]=arguments.callee(d[c])}return b}return d};SBGrid.DEF.isExistObject=function(strJSON){try{var obj=eval(strJSON);obj=null;return true}catch(e){return false}};SBGrid.DEF.destroy=function(objTarget){if(objTarget==null){return}var arPropertyList=[];for(var strPropertyName in objTarget){arPropertyList.push(strPropertyName);var strPropertyType}for(var i=0;i<arPropertyList.length;i++){var strPropertyName=arPropertyList[i];eval("objTarget."+strPropertyName+" = null;")}eval("objTarget = null;")};(function(s,o,i){if(document.implementation.hasFeature("XPath","3.0")&&!document.createNSResolver){function q(d){this.e=d;this.i=0;this.js=["with(XPath){return ","}"];this.expression(1,1)||this.error();return new Function("n","nsr",this.js.join(""))}q.ie=/MSIE/.test(navigator.userAgent);q.prototype={match:function(p,e){var d,f;if(!(d=p.exec(this.e.substr(this.i)))||(typeof e=="number"&&!(f=d[e]))||(typeof e=="object"&&!(f=e[d[1]]))){return false}this.m=d;this.i+=d[0].length;return f||d},error:function(f){f=(f||"Syntax error")+" at index "+this.i+": "+this.e.substr(this.i);var p;try{p=new m(51,f)}catch(d){p=new Error(f)}throw p},step:function(d,v,p,w){var f=3;if(this.match(/^(\/\/?|\.\.?|@)\s*/,1)){switch(this.m[1]){case"/":if(p){this.error()}if(!w){return this.step(d,v,1)}this.js.splice(d,0,' axis(axes["',"document-root",'"],');f+=this.nodeTypes.node.call(this,d+f);p=1;break;case"//":if(p){this.error()}this.js.splice(d,0,' axis(axes["',"descendant-or-self",'"],');f+=this.nodeTypes.node.call(this,d+f);p=1;break;case".":if(!p&&!w){this.error()}this.js.splice(d,0,' axis(axes["',"self",'"],');f+=this.nodeTypes.node.call(this,d+f);p=0;break;case"..":if(!p&&!w){this.error()}this.js.splice(d,0,' axis(axes["',"parent",'"],');f+=this.nodeTypes.node.call(this,d+f);p=0;break;case"@":if(!p&&!w){this.error()}this.js.splice(d,0,' axis(axes["',"attribute",'"],');f+=this.nodeTest(d+f,"node")||this.error("Missing nodeTest after @");p=0}}else{if(!p&&!w){return p?this.error():0}else{if(this.match(/^([ㄱ-ㅎ가-힣a-z]+(?:-[ㄱ-ㅎ가-힣a-z]+)*)\s*::\s*/,q.axes)){this.js.splice(d,0,' axis(axes["',this.m[1],'"],');f+=this.nodeTest(d+f,(this.m[1]=="attribute")?"node":"element")||this.error("Missing nodeTest after ::");p=0}else{if(f=this.nodeTest(d,"element")){this.js.splice(d,0,' axis(axes["',"child",'"],');f+=3;p=0}else{return 0}}}}for(var e;e=this.predicate(d+f);f+=e){}if(w){this.js.splice(v+f++,0,w)}f+=this.step(d,v+f,p);this.js.splice(v+f++,0,")");return f},expression:function(d,f,v){var w,e=this.operand(d);while(w=this.match(/^(or|and|!?=|[<>]=?|[|*+-]|div|mod)\s*/,this.operators)){if(v&&v[0]>=w[0]){this.i-=this.m[0].length;break}this.js.splice(d,0,w[1]);e++;this.js.splice(d+e++,0,w[2]);e+=this.expression(d+e,f,w)||this.error("Missing operand");this.js.splice(d+e++,0,w[3])}return e},operand:function(d){if(this.match(/^(-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)|"[^"]*"|'[^']*')\s*/,1)){this.js.splice(d,0,this.m[1]);return 1}var p;if(p=this.match(/^([ㄱ-ㅎ가-힣a-z]+(?:-[ㄱ-ㅎ가-힣a-z]+)*)\s*\(\s*/,this.functions)){var f=1,e;this.js.splice(d,0,p[1]);do{if(e){this.js.splice(d+f++,0,",")}f+=(e=this.expression(d+f,d+f))}while(e&&this.match(/^,\s*/));this.match(/^\)\s*/)||this.error("Missing (");if(p[0]){if(e){this.js.splice(d+f++,0,",")}this.js.splice(d+f++,0,p[0])}if(p[2]){this.js.splice(d+f++,0,p[2])}else{if(e>1){this.error("Function has arguments")}}f+=this.step(d,d+f);return f}if(this.match(/^\(\s*/)){var f=1;this.js.splice(d,0,"(");f+=this.expression(d+f,d+f);this.match(/^\)\s*/)||this.error("Missing )");this.js.splice(d+f++,")");return f}return this.step(d,d,0,"[n]")},operators:{"|":[1,"union(",",",")"],or:[1,"bool(",")||bool(",")"],and:[2,"bool(",")&&bool(",")"],"=":[3,"compare(eq,",",",")"],"!=":[3,"compare(ne,",",",")"],"<":[4,"compare(lt,",",",")"],">":[4,"compare(gt,",",",")"],"<=":[4,"compare(le,",",",")"],">=":[4,"compare(ge,",",",")"],"+":[5,"number(",")+number(",")"],"-":[5,"number(",")-number(",")"],"*":[6,"number(",")*number(",")"],div:[6,"number(",")/number(",")"],mod:[6,"number(",")%number(",")"]},functions:{last:[0,"nl.length"],position:[0,"(i+1)"],count:["nl","(",".length||0)"],id:["n","id(",")"],"local-name":["nl","localName(",")"],"namespace-uri":["nl","namespaceURI(",")"],name:["nl","qName(",")"],string:["n","string(",")"],concat:[0,"concat(",")"],"starts-with":[0,"startsWith(",")"],contains:[0,"contains(",")"],"substring-before":[0,"substringBefore(",")"],"substring-after":[0,"substringAfter(",")"],substring:[0,"substring(",")"],"string-length":["n","string(",").length"],"normalize-space":["n","normalizeSpace(",")"],translate:[0,"translate(",")"],"boolean":[0,"bool(",")"],not:[0,"!bool(",")"],"true":[0,"true "],"false":[0,"false "],number:["n","number(",")"],floor:[0,"Math.floor(number(","))"],ceiling:[0,"Math.ceil(number(","))"],round:[0,"Math.round(number(","))"],sum:[0,"sum(",")"]},predicate:function(d){var e=0;if(this.match(/^\[\s*/)){if(e=this.expression(d,d)){this.js.splice(d,0,"function(n,i,nl){with(XPath){var r=");e++;this.js.splice(d+e++,0,';return typeof r=="number"?Math.round(r)==i+1:bool(r)}},')}this.match(/^\]\s*/)||this.error("Missing ]")}return e},nodeTest:function(d,e){var f;if(f=this.match(/^([ㄱ-ㅎ가-힣a-z]+(?:-[ㄱ-ㅎ가-힣a-z]+)*)\(([^)]*)\)\s*/,this.nodeTypes)){return f.call(this,d,this.m[2])}if(this.match(/^\*\s*/)){return this.nodeTypes[e].call(this,d)}return this.nodeName(d)},nodeType:function(d,e){this.js.splice(d,0,"function(n){return n.nodeType==",e,"},");return 3},nodeTypes:{node:function(d){this.js.splice(d,0,"null,");return 1},element:function(d){return this.nodeType(d,1)},attribute:function(d){return this.nodeType(d,2)},text:function(d){return this.nodeType(d,3)},"processing-instruction":function(d,e){if(!e){return this.nodeType(d,7)}this.js.splice(d,0,"function(n){return n.nodeType==7&&n.target==",e,"},");return 3},comment:function(d){return this.nodeType(d,8)}},nodeName:function(d){if(!this.match(/^([ㄱ-ㅎ가-힣a-zA-Z0-9_]+(?:-?[ㄱ-ㅎ가-힣a-zA-Z0-9]+)*)(?::([ㄱ-ㅎ가-힣a-zA-Z0-9_]+(?:-?[ㄱ-ㅎ가-힣a-zA-Z0-9]+)*))?\s*/,1)){return 0}if(this.m[2]){this.js.splice(d,0,'function(n){if(!nsr)throw new XPathException(14);return "',this.m[2],'"==',q.ie?"n.baseName":"n.localName",'&&nsr.lookupNamespaceURI("',this.m[1],'")==n.namespaceURI},');return 7}else{this.js.splice(d,0,"function(n){return/^",this.m[1],"$/i.test(n.nodeName)},");return 3}}};q.order=function(e,f){var d=e.compareDocumentPosition?e.compareDocumentPosition(f):q.compareDocumentPosition.call(e,f);if(d&32){e=Array.prototype.indexOf.call(e.attributes,e);f=Array.prototype.indexOf.call(f.attributes,f);return(e<f)?-1:(e>f)?1:0}if(!d){if(e==f){return 0}if((e=e.ownerElement)&&(f=f.ownerElement)){return q.order(e,f)}return q.ie?1:0}return 3-((d&6)||3)};q.compare=function(v,e,w){if(e instanceof Array&&w instanceof Array){var d=e.map(this.string),f=w.map(this.string);for(e=d.length;--e>=0;){for(w=f.length;--w>=0;){if(!v(d[e],f[w])){return false}}}return true}if(e instanceof Array){for(var p=e.length;--p>=0;){if(!v(this[typeof w](e[p]),w)){return false}}return e.length>0}if(w instanceof Array){for(var p=w.length;--p>=0;){if(!v(e,this[typeof e](w[p]))){return false}}return w.length>0}if(typeof e=="boolean"||typeof w=="boolean"){return v(this.bool(e),this.bool(w))}if(typeof e=="number"||typeof w=="number"){return v(this.number(e),this.number(w))}return v(this.string(e),this.string(w))};q.eq=function(d,e){return d==e};q.ne=function(d,e){return d!=e};q.lt=function(d,e){return d<e};q.gt=function(d,e){return d>e};q.le=function(d,e){return d<=e};q.ge=function(d,e){return d>=e};q.id=function(f,r){if(arguments.length==1){r=f}var d=[];for(var p=this.string(f).split(/\s+/),e=p.length;--e>=0;){if(f=(r.ownerDocument||r).getElementById(p[e])){d.push(f)}}return d.sort(this.order)};q.localName=new Function("nl","return (nl.length&&nl[0]."+(q.ie?"baseName":"localName")+')||""');q.namespaceURI=function(d){return(d.length&&d[0].namespaceURI)||""};q.qName=function(d){return(d.length&&d[0].nodeName)||""};q.union=function(f,d){if(!f.length){return d}if(!d.length){return f}var e=[],r=f.length-1,p=d.length-1;for(;;){switch(this.order(f[r],d[p])){case -1:e.unshift(d[p--]);break;case 0:p--;case 1:e.unshift(f[r--]);break;default:throw new Error("Invalid order")}if(r<0){if(++p>0){e.unshift.apply(e,e.slice.call(d,0,p))}break}if(p<0){if(++r>0){e.unshift.apply(e,e.slice.call(f,0,r))}break}}return e};q.string=q.object=function(d){if(d instanceof Array&&typeof(d=d[0])=="undefined"){return""}if(typeof d=="string"){return d}switch(d.nodeType){case 1:case 9:case 11:return Array.prototype.map.call(d.childNodes,this.string,this).join("");default:return d.nodeValue||""}return String(d)};q.concat=function(){return Array.prototype.map.call(arguments,this.string,this).join("")};q.startsWith=function(e,d){return this.string(e).substr(0,(d=this.string(d)).length)==d};q.contains=function(e,d){return this.string(e).indexOf(this.string(d))!=-1};q.substringBefore=function(e,d){e=this.string(e);d=e.indexOf(this.string(d));return d!=-1?e.substr(0,d):""};q.substringAfter=function(e,d){e=this.string(e);d=this.string(d);var f=e.indexOf(d);return f!=-1?e.substr(f+d.length):""};q.substring=function(f,e,d){f=this.string(f);e=Math.round(this.number(e))-1;return(arguments.length==2)?f.substr(e<0?0:e):f.substr(e<0?0:e,Math.round(this.number(d))-Math.max(0,-e))};q.normalizeSpace=function(d){return this.string(d).replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g," ")};q.translate=function(p,e,y){p=this.string(p);e=this.string(e);y=this.string(y);var w=[],f=p.length,v=0,r,d;while(--f>=0){if((r=e.indexOf(d=p.charAt(v++)))==-1||(d=y.charAt(r))){w.push(d)}}return w.join("")};q.bool=q["boolean"]=function(d){if(typeof d=="boolean"){return d}if(d instanceof Array||typeof d=="string"){return d.length>0}return Boolean(d)};q.number=function(d){if(d instanceof Array&&typeof(d=d[0])=="undefined"){return 0}if(typeof d=="number"){return d}if(typeof d=="boolean"){return d?1:0}return Number(this.string(d))};q.sum=function(d){var f=0,e=d.length;while(--e>=0){f+=this.number(d[e])}return f};q.walk=function(p,e){var d,f=p.firstChild;while(f){e.push(f);if(d=f.firstChild){f=d}else{for(d=f;!(f=d.nextSibling)&&(d=d.parentNode)&&(d!=p);){}}}return e};q.axes={ancestor:function(e){var d=[];while(e=e.parentNode){d.unshift(e)}return d},"ancestor-or-self":function(e){var d=[];do{d.unshift(e)}while(e=e.parentNode);return d},attribute:new Function("n","var nl = [], a = n.attributes;if(a){attr:for(var x,i=a.length;--i>=0;){if(!(x=a[i]).specified){"+(q.ie?'switch(x.nodeName){case"selected":case"value":if(x.nodeValue)break;default:continue attr;}':"continue;")+"}nl.unshift(x);}}return nl;"),child:function(d){return d.childNodes||[]},descendant:function(d){return this.walk(d,[])},"descendant-or-self":function(d){return this.walk(d,[d])},following:function(f){var e=[],d;while(f){if(d=f.nextSibling){e.push(f=d);if(d=f.firstChild){e.push(f=d)}}else{f=f.parentNode}}return e},"following-sibling":function(e){var d=[];while(e=e.nextSibling){d.push(e)}return d},parent:function(d){return d.parentNode?[d.parentNode]:[]},preceding:function(r){var e=[],d,f=r.parentNode;while(r){if(d=r.previousSibling){for(r=d;d=r.lastChild;r=d){}e.unshift(r)}else{if(r=r.parentNode){if(r==f){f=f.parentNode}else{e.unshift(r)}}}}return e},"preceding-sibling":function(e){var d=[];while(e=e.previousSibling){d.unshift(e)}return d},self:function(d){return[d]},"document-root":function(d){return[d.ownerDocument||d]}};q.axis=function(A,z){var d,B,y=arguments.length-1,e=arguments[y],v=Array.prototype;for(var w=0,p,f=e.length;--f>=0;){B=A.call(this,e[w++]);if(z&&B.length){B=v.filter.call(B,z,this)}for(p=2;p<y&&B.length;B=v.filter.call(B,arguments[p++],this)){}d=d?this.union(d,B):B}return d||[]};q.cache={};function b(x){if(this==x){return 0}if(this.nodeType==2&&x.nodeType==2){return(this.ownerElement&&this.ownerElement==x.ownerElement)?32:0}var d=this.ownerElement||this,p=x.ownerElement||x;if(d.sourceIndex>=0&&p.sourceIndex>=0&&d.contains&&p.contains){return(((d.contains(p)&&16)||(p.contains(d)&&8))|((d.sourceIndex<p.sourceIndex&&4)||(p.sourceIndex<d.sourceIndex&&2)))||1}var v=d,w=p,e=0,f=0;while(v=v.parentNode){e++}while(w=w.parentNode){f++}if(e>f){while(e--!=f){d=d.parentNode}if(d==p){return 2|8}}else{if(f>e){while(f--!=e){p=p.parentNode}if(p==d){return 4|16}}}while((v=d.parentNode)!=(w=p.parentNode)){if(!(d=v)||!(p=w)){return 1}}while(d=d.nextSibling){if(d==p){return 4}}return 2}if(s.Node){var u=s.Node.prototype;if(i||!u.compareDocumentPosition){u.compareDocumentPosition=b}if(i||!u.contains){u.contains=function(d){return Boolean(this.compareDocumentPosition(d)&16)}}}else{q.compareDocumentPosition=b}if(i||!s.XPathException){function m(e,d){this.name="XPathException";this.code=e;this.message=d}var n=m,c=new Error;c.toString=function(){return this.name+":"+this.message};n.prototype=c;n.NAMESPACE_ERR=14;n.INVALID_EXPRESSION_ERR=51;n.TYPE_ERR=52;s.XPathException=n}if(i||!s.XPathNSResolver){function h(p){this.ns={};for(var d,e,f=p.attributes.length;--f>=0;){if(d=/xmlns:(.+)/.exec((e=p.attributes[f]).nodeName)){this.ns[d[1]]=e.nodeValue}}this.ns[""]=p.getAttribute("targetNamespace")}h.prototype={lookupNamespaceURI:function(d){return this.ns[d||""]}};s.XPathNSResolver=h}if(i||!s.XPathExpression){function t(f,d){this.fn=q.cache[f]||(q.cache[f]=new q(f));this.nsr=d}t.prototype={evaluate:function(e,d){return new g(this.fn(e,this.nsr),d)}};s.XPathExpression=t}if(i||!s.XPathResult){function g(e,d){if(d==0){switch(typeof e){default:d++;case"boolean":d++;case"string":d++;case"number":d++}}this.resultType=d;switch(d){case 1:this.numberValue=q.number(e);return;case 2:this.stringValue=q.string(e);return;case 3:this.booleanValue=q.bool(e);return;case 4:case 5:if(e instanceof Array){this.value=e;this.index=0;this.invalidIteratorState=false;return}break;case 6:case 7:if(e instanceof Array){this.value=e;this.snapshotLength=e.length;return}else{if(e instanceof NodeList){this.value=e;this.snapshotLength=e.length;return}}break;case 8:case 9:if(e instanceof Array){this.singleNodeValue=e[0];return}}throw new m(52)}var a=g;a.ANY_TYPE=0;a.NUMBER_TYPE=1;a.STRING_TYPE=2;a.BOOLEAN_TYPE=3;a.UNORDERED_NODE_ITERATOR_TYPE=4;a.ORDERED_NODE_ITERATOR_TYPE=5;a.UNORDERED_NODE_SNAPSHOT_TYPE=6;a.ORDERED_NODE_SNAPSHOT_TYPE=7;a.ANY_UNORDERED_NODE_TYPE=8;a.FIRST_ORDERED_NODE_TYPE=9;a.prototype={iterateNext:function(){switch(this.resultType){case 4:case 5:return this.value[this.index++]}throw new m(52)},snapshotItem:function(d){switch(this.resultType){case 6:case 7:return this.value[d]}throw new m(52)}};s.XPathResult=a}if(i||!s.XPathEvaluator){function l(){}var n=l;n.prototype={createExpression:function(f,d){return new t(f,d)},createNSResolver:function(d){return new h(d)},evaluate:function(p,r,f,d){return new t(p,f).evaluate(r,d)}};n.install=function(p,e){for(var d in l.prototype){if(e||!p[d]){p[d]=l.prototype[d]}}};s.XPathEvaluator=n;if(s.Document){n.install(s.Document.prototype,i)}else{n.install(document,i)}s.XPath=q}}})(window,document,/WebKit/.test(navigator.userAgent));SBGrid.UT.XmlLib=function(){};SBGrid.UT.XmlLib.loadXMLFromString=function(c,a){var b=null;if(SBGrid.DEF.is_ie){b=new ActiveXObject("Microsoft.XMLDOM");b.async=false;b.resolveExternals=true;b.validateOnParse=false;b.preserveWhiteSpace=true;b.loadXML(c);b.setProperty("SelectionLanguage","XPath")}else{var d=new DOMParser();b=d.parseFromString(c,"text/xml")}return b};SBGrid.UT.XmlLib.createXML=function(a){var b=null;if(SBGrid.DEF.is_ie){b=new ActiveXObject("Microsoft.XMLDOM");b.async=false;b.resolveExternals=true;b.validateOnParse=false;b.documentElement=b.createElement(a)}else{b=document.implementation.createDocument("",a,null)}return b};SBGrid.UT.XmlLib.serializeToString=function(b){var c=null;if(SBGrid.DEF.is_ie){c=b.xml}else{var a=new XMLSerializer();c=a.serializeToString(b)}return c};SBGrid.UT.XmlLib.getAttribute=function(c,a){if(null!=c){var d=c.attributes.length;for(var b=0;b<d;b++){if(c.attributes[b].nodeName==a){return c.attributes[b].value}}}return null};SBGrid.UT.XmlLib.setAttribute=function(b,a,c){b.setAttribute(a,c)};SBGrid.UT.XmlLib.createChild=function(b,a){var d=b.ownerDocument;var c=d.createElement(a);b.appendChild(c);return c};SBGrid.UT.XmlLib.createChildWithValue=function(b,a,d){if(null==d){d=""}var c=SBGrid.UT.XmlLib.createChild(b,a);SBGrid.UT.XmlLib.setTextValue(c,d);return c};SBGrid.UT.XmlLib.getTextValue=function(a){var c="";try{if(null!=a.firstChild){if(SBGrid.DEF.Sbgrid_Node.TEXT_NODE==a.firstChild.nodeType||SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE==a.firstChild.nodeType){c=a.firstChild.nodeValue}}else{if(SBGrid.DEF.Sbgrid_Node.TEXT_NODE==a.nodeType||SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE==a.nodeType){c=a.textContent}}}catch(b){}return c};SBGrid.UT.XmlLib.importChildNode=function(c,d,a){var b=SBGrid.UT.XmlLib.importNode(c.ownerDocument,d,a);c.appendChild(b);return b};SBGrid.UT.XmlLib.importNode=function(c,b,a){if(c.importNode){return c.importNode(b,a)}else{return SBGrid.UT.XmlLib.importNodeOld(c,b,a)}};SBGrid.UT.XmlLib.importNodeOld=function(g,e,b){b=(b==null)?true:b;var f=function(o,n,l){if(b){for(var h=0;h<n.childNodes.length;h++){var m=SBGrid.UT.XmlLib.importNode(o,n.childNodes.item(h),true);l.appendChild(m)}}};var d=null;switch(e.nodeType){case SBGrid.DEF.Sbgrid_Node.ATTRIBUTE_NODE:if(null!=g.createAttributeNS){d=g.createAttributeNS(e.namespaceURI,e.nodeName)}else{d=g.createAttribute(e.nodeName)}d.value=e.value;break;case SBGrid.DEF.Sbgrid_Node.DOCUMENT_FRAGMENT_NODE:d=g.createDocumentFragment();f(g,e,d);break;case SBGrid.DEF.Sbgrid_Node.ELEMENT_NODE:if(null!=g.createElementNS){d=g.createElementNS(e.namespaceURI,e.tagName)}else{d=g.createElement(e.tagName)}for(var c=0;c<e.attributes.length;c++){var a=SBGrid.UT.XmlLib.importNode(g,e.attributes.item(c),b);if(null!=d.setAttributeNodeNS){d.setAttributeNodeNS(a)}else{d.setAttributeNode(a)}}f(g,e,d);break;case SBGrid.DEF.Sbgrid_Node.ENTITY_REFERENCE_NODE:d=e;break;case SBGrid.DEF.Sbgrid_Node.PROCESSING_INSTRUCTION_NODE:d=g.createProcessingInstruction(e.target,e.data);break;case SBGrid.DEF.Sbgrid_Node.TEXT_NODE:case SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE:case SBGrid.DEF.Sbgrid_Node.COMMENT_NODE:d=g.createTextNode(e.nodeValue);break;case SBGrid.DEF.Sbgrid_Node.DOCUMENT_NODE:case SBGrid.DEF.Sbgrid_Node.DOCUMENT_TYPE_NODE:case SBGrid.DEF.Sbgrid_Node.NOTATION_NODE:case SBGrid.DEF.Sbgrid_Node.ENTITY_NODE:throw"can not import "+e.tagName;break}return d};SBGrid.UT.XmlLib.setTextValue=function(b,d,a){if(b.hasChildNodes()&&(SBGrid.DEF.Sbgrid_Node.TEXT_NODE==b.firstChild.nodeType||SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE==b.firstChild.nodeType)&&!a){b.firstChild.nodeValue=d}else{var c=null;if(a){c=b.ownerDocument.createCDATASection(d)}else{c=b.ownerDocument.createTextNode(d)}b.appendChild(c)}};SBGrid.UT.XmlLib.createCDATASection=function(a,d){var b=a.ownerDocument;var c=b.createCDATASection(d);a.appendChild(c)};SBGrid.UT.XmlLib.transformToHTMLElement=function(a,d,c){try{if(SBGrid.DEF.is_ie){a.innerHTML=d.transformNode(c)}else{var g=new XSLTProcessor();g.importStylesheet(c);var b=g.transformToFragment(d,document);a.appendChild(b.firstChild);g.reset();return}}catch(f){window.alert(f+" SBGridSbgrid : transformToHTMLElement")}};SBGrid.UT.XmlLib.selectSingleNode=function(a,c){if(null==a||c.isEmpty()){return null}var b=null;b=a.selectSingleNode(c);return b};SBGrid.UT.XmlLib.selectNodes=function(b,d){if(typeof(d)!="string"){return null}if(null==b||d.isEmpty()){return null}var a=null;try{a=b.selectNodes(d)}catch(c){}return a};SBGrid.UT.XmlLib.hasChildNodesExceptText=function(c){if(c.hasChildNodes()){var d=c.childNodes;for(var a=0;a<d.length;a++){var b=d[a];if(SBGrid.DEF.Sbgrid_Node.TEXT_NODE!=b.nodeType&&SBGrid.DEF.Sbgrid_Node.CDATA_SECTION_NODE!=b.nodeType){return true}}}return false};SBGrid.UT.XmlLib.getRootElementNode=function(e){var a;if(null!=e){if(SBGrid.DEF.Sbgrid_Node.DOCUMENT_NODE==e.nodeType){var d=e.childNodes;for(var b=0;b<d.length;b++){var c=d[b];if(SBGrid.DEF.Sbgrid_Node.PROCESSING_INSTRUCTION_NODE!=c.nodeType){a=c;break}}}else{if(SBGrid.DEF.Sbgrid_Node.PROCESSING_INSTRUCTION_NODE!=c.nodeType){a=c}}}return a};if(!SBGrid.DEF.Sbgrid_Node){SBGrid.DEF.Sbgrid_Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var objNSResolver=null;if(document.implementation.hasFeature("XPath","3.0")){if(document.createNSResolver){objNSResolver=document.createNSResolver(document.documentElement)}XMLDocument.prototype.selectNodes=function(a,g){try{if(!g){g=this}var d=new SBGrid.DS.DOMNodeList();if(this.createNSResolver){var b=this.evaluate(a,g,objNSResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var c=0;c<b.snapshotLength;c++){d.add(b.snapshotItem(c))}b=null}return d}catch(f){SBGrid.DEF.errorMsg(f+" SBGridSbgrid : selectNodes")}};Element.prototype.selectNodes=function(a){if(this.ownerDocument.selectNodes){return this.ownerDocument.selectNodes(a,this)}else{throw"Web Browser not Support Element.selectNodes()"}};XMLDocument.prototype.selectSingleNode=function(a,d){try{if(!d){d=this}if(this.createNSResolver){var b=this.evaluate(a,d,objNSResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return b.singleNodeValue}return null}catch(c){SBGrid.DEF.errorMsg(c+" SBGridSbgrid : selectSingleNode")}};Element.prototype.selectSingleNode=function(a){if(this.ownerDocument.selectSingleNode){return this.ownerDocument.selectSingleNode(a,this)}else{throw"Web Browser not Support Element.selectSingleNode()"}}}SBGrid.UT.HtmlLib=function(){};SBGrid.UT.HtmlLib.getStyle=function(c,a){if(null!=c&&null!=a&&0<a.length){switch(a){case"left":return SBGrid.DEF.is_ie?c.currentStyle.left:window.getComputedStyle(c,null).left;case"right":return SBGrid.DEF.is_ie?c.currentStyle.right:window.getComputedStyle(c,null).right;case"top":return SBGrid.DEF.is_ie?c.currentStyle.top:window.getComputedStyle(c,null).top;case"bottom":return SBGrid.DEF.is_ie?c.currentStyle.bottom:window.getComputedStyle(c,null).bottom;case"width":return SBGrid.DEF.is_ie?c.currentStyle.width:window.getComputedStyle(c,null).width;case"height":return SBGrid.DEF.is_ie?c.currentStyle.height:window.getComputedStyle(c,null).height;case"font-family":return SBGrid.DEF.is_ie?c.currentStyle.fontFamily:window.getComputedStyle(c,null).fontFamily;case"font-size":return SBGrid.DEF.is_ie?c.currentStyle.fontSize:window.getComputedStyle(c,null).fontSize;case"font-weight":return SBGrid.DEF.is_ie?c.currentStyle.fontWeight:window.getComputedStyle(c,null).fontWeight;case"font-style":return SBGrid.DEF.is_ie?c.currentStyle.fontStyle:window.getComputedStyle(c,null).fontStyle;case"text-decoration":return SBGrid.DEF.is_ie?c.currentStyle.textDecoration:window.getComputedStyle(c,null).textDecoration;case"color":return SBGrid.DEF.is_ie?c.currentStyle.color:window.getComputedStyle(c,null).color;case"text-align":return SBGrid.DEF.is_ie?c.currentStyle.textAlign:window.getComputedStyle(c,null).textAlign;case"vertical-align":return SBGrid.DEF.is_ie?c.currentStyle.verticalAlign:window.getComputedStyle(c,null).verticalAlign;case"word-wrap":return SBGrid.DEF.is_ie?c.currentStyle.wordWrap:window.getComputedStyle(c,null).wordWrap;case"line-spacing":return SBGrid.DEF.is_ie?c.currentStyle.lineSpacing:window.getComputedStyle(c,null).lineSpacing;case"letter-spacing":return SBGrid.DEF.is_ie?c.currentStyle.letterSpacing:window.getComputedStyle(c,null).letterSpacing;case"padding":return SBGrid.DEF.is_ie?c.currentStyle.padding:window.getComputedStyle(c,null).padding;case"padding-left":return SBGrid.DEF.is_ie?c.currentStyle.paddingLeft:window.getComputedStyle(c,null).paddingLeft;case"padding-top":return SBGrid.DEF.is_ie?c.currentStyle.paddingTop:window.getComputedStyle(c,null).paddingTop;case"padding-right":return SBGrid.DEF.is_ie?c.currentStyle.paddingRight:window.getComputedStyle(c,null).paddingRight;case"padding-bottom":return SBGrid.DEF.is_ie?c.currentStyle.paddingBottom:window.getComputedStyle(c,null).paddingBottom;case"background-color":return SBGrid.DEF.is_ie?c.currentStyle.backgroundColor:window.getComputedStyle(c,null).backgroundColor;case"background-image":return SBGrid.DEF.is_ie?c.currentStyle.backgroundImage:window.getComputedStyle(c,null).backgroundImage;case"background-repeat":return SBGrid.DEF.is_ie?c.currentStyle.backgroundRepeat:window.getComputedStyle(c,null).backgroundRepeat;case"background-position":var b=SBGrid.DEF.is_ie?c.currentStyle.backgroundPosition:window.getComputedStyle(c,null).backgroundPosition;if("left center"==b){b="center left"}else{if("right center"==b){b="center right"}}return b;case"border-color":return SBGrid.DEF.is_ie?c.currentStyle.borderColor:window.getComputedStyle(c,null).borderColor;case"border-left-color":return SBGrid.DEF.is_ie?c.currentStyle.borderLeftColor:window.getComputedStyle(c,null).borderLeftColor;case"border-top-color":return SBGrid.DEF.is_ie?c.currentStyle.borderTopColor:window.getComputedStyle(c,null).borderTopColor;case"border-right-color":return SBGrid.DEF.is_ie?c.currentStyle.borderRightColor:window.getComputedStyle(c,null).borderRightColor;case"border-bottom-color":return SBGrid.DEF.is_ie?c.currentStyle.borderBottomColor:window.getComputedStyle(c,null).borderBottomColor;case"border-width":return SBGrid.DEF.is_ie?c.currentStyle.borderWidth:window.getComputedStyle(c,null).borderWidth;case"border-left-width":return SBGrid.DEF.is_ie?c.currentStyle.borderLeftWidth:window.getComputedStyle(c,null).borderLeftWidth;case"border-top-width":return SBGrid.DEF.is_ie?c.currentStyle.borderTopWidth:window.getComputedStyle(c,null).borderTopWidth;case"border-right-width":return SBGrid.DEF.is_ie?c.currentStyle.borderRightWidth:window.getComputedStyle(c,null).borderRightWidth;case"border-bottom-width":return SBGrid.DEF.is_ie?c.currentStyle.borderBottomWidth:window.getComputedStyle(c,null).borderBottomWidth;case"border-style":return SBGrid.DEF.is_ie?c.currentStyle.borderStyle:window.getComputedStyle(c,null).borderStyle;case"border-left-style":return SBGrid.DEF.is_ie?c.currentStyle.borderLeftStyle:window.getComputedStyle(c,null).borderLeftStyle;case"border-top-style":return SBGrid.DEF.is_ie?c.currentStyle.borderTopStyle:window.getComputedStyle(c,null).borderTopStyle;case"border-right-style":return SBGrid.DEF.is_ie?c.currentStyle.borderRightStyle:window.getComputedStyle(c,null).borderRightStyle;case"border-bottom-style":return SBGrid.DEF.is_ie?c.currentStyle.borderBottomStyle:window.getComputedStyle(c,null).borderBottomStyle;case"margin":return SBGrid.DEF.is_ie?c.currentStyle.margin:window.getComputedStyle(c,null).margin;case"margin-left":return SBGrid.DEF.is_ie?c.currentStyle.marginLeft:window.getComputedStyle(c,null).marginLeft;case"margin-top":return SBGrid.DEF.is_ie?c.currentStyle.marginTop:window.getComputedStyle(c,null).marginTop;case"margin-right":return SBGrid.DEF.is_ie?c.currentStyle.marginRight:window.getComputedStyle(c,null).marginRight;case"margin-bottom":return SBGrid.DEF.is_ie?c.currentStyle.marginBottom:window.getComputedStyle(c,null).marginBottom;case"opacity":return SBGrid.DEF.is_ie?c.currentStyle.opacity*100:window.getComputedStyle(c,null).opacity*100;case"overflow":return SBGrid.DEF.is_ie?c.currentStyle.oveflow:window.getComputedStyle(c,null).oveflow;case"clip":return;case"gradient":return;case"cursor":return SBGrid.DEF.is_ie?c.currentStyle.cursor:window.getComputedStyle(c,null).cursor;case"focus-rect":return;case"unloadmark":return}}return null};SBGrid.UT.HtmlLib.setStyle=function(g,c,f){try{if(null!=g&&null!=c&&0<c.length&&null!=f){switch(c){case"width":if(-1==f.indexOf("%")){f=isFinite(f)?f+"px":f}g.style.width=f;break;case"height":if(-1==f.indexOf("%")){f=isFinite(f)?f+"px":f}g.style.height=f;break;case"left":g.style.left=isFinite(f)?f+"px":f;break;case"right":if(-1!=f.indexOf("%")){f=(100-parseFloat(f))+"%";g.style.right=f;break}g.style.right=isFinite(f)?f+"px":f;break;case"top":g.style.top=isFinite(f)?f+"px":f;break;case"bottom":if(-1!=f.indexOf("%")){f=(100-parseFloat(f))+"%";g.style.bottom=f;break}g.style.bottom=isFinite(f)?f+"px":f;break;case"font-family":g.style.fontFamily=f;break;case"font-size":f=isFinite(f)?f+"pt":f;g.style.fontSize=f;break;case"font-weight":g.style.fontWeight=f;break;case"font-style":g.style.fontStyle=f;break;case"text-decoration":g.style.textDecoration=f;break;case"color":f=""==f?"":f;g.style.color=f;break;case"text-align":g.style.textAlign=f;break;case"vertical-align":g.style.verticalAlign=f;break;case"word-wrap":g.style.wordWrap=f;break;case"line-spacing":g.style.lineSpacing=f;break;case"line-height":g.style.lineHeight=f;break;case"letter-spacing":g.style.letterSpacing=f;break;case"padding":g.style.padding=f;break;case"padding-left":g.style.paddingLeft=f;break;case"padding-top":g.style.paddingTop=f;break;case"padding-right":g.style.paddingRight=f;break;case"padding-bottom":g.style.paddingBottom=f;break;case"background-color":g.style.backgroundColor=f;break;case"background-image":if(""==f.trim()){g.style.backgroundImage=f;break}if(f.trim().substring(0,4)!="url("){f="url("+f+")"}g.style.backgroundImage=f;break;case"background-repeat":g.style.backgroundRepeat=f;break;case"background-position":if(""!=f){var b="";if(-1!=f.indexOf("left")){b="left"}else{if(-1!=f.indexOf("right")){b="right"}}var a="";if(-1!=f.indexOf("top")){a="top"}else{if(-1!=f.indexOf("bottom")){a="bottom"}}if(-1!=f.indexOf("center")){if("center"==f){if(""==b){b="center"}if(""==a){a="center"}}}if(""!=b&&""!=a){f=b+" "+a}else{if(""!=b&&""==a){f=b}else{if(""==b&&""!=a){f=a}else{if(""==b&&""==a){f="left center"}}}}}g.style.backgroundPosition=f;break;case"border-color":g.style.borderColor=f;break;case"border-left-color":g.style.borderLeftColor=f;break;case"border-top-color":g.style.borderTopColor=f;break;case"border-right-color":g.style.borderRightColor=f;break;case"border-bottom-color":g.style.borderBottomColor=f;break;case"border-width":g.style.borderWidth=f;break;case"border-left-width":g.style.borderLeftWidth=f;break;case"border-top-width":g.style.borderTopWidth=f;break;case"border-right-width":g.style.borderRightWidth=f;break;case"border-bottom-width":g.style.borderBottomWidth=f;break;case"border-style":g.style.borderStyle=f;break;case"border-left-style":g.style.borderLeftStyle=f;break;case"border-top-style":g.style.borderTopStyle=f;break;case"border-right-style":g.style.borderRightStyle=f;break;case"border-bottom-style":g.style.borderBottomStyle=f;break;case"margin":g.style.margin=f;break;case"margin-left":g.style.marginLeft=f;break;case"margin-top":g.style.marginTop=f;break;case"margin-right":g.style.marginRight=f;break;case"margin-bottom":g.style.marginBottom=f;break;case"opacity":if(SBGrid.DEF.is_ie){g.style.filter="alpha(opacity="+f+")"}else{if(1<f){var e=parseFloat(f)/100;f=e}g.style.opacity=f}break;case"overflow":g.style.overflow=f;break;case"clip":break;case"gradient":break;case"cursor":if("arrow"==f){f="default"}else{if("drag-move"==f){f="pointer"}else{if("h-resize"==f){f="col-resize"}else{if("v-resize"==f){f="row-resize"}else{if("no"==f){f="no-drop"}else{if("hand"==f){if(SBGrid.DEF.is_ie){f="hand"}else{f="pointer"}}else{if(""==f){f=""}else{f="default"}}}}}}}g.style.cursor=f;break;case"focus-rect":break;case"unloadmark":break}}}catch(d){}};SBGrid.UT.HtmlLib.setStyleFront=function(t,n,e){if(t){if("margin"==n){var p=t.style.marginLeft;var o=t.style.marginTop;var d=t.style.marginRight;var q=t.style.marginBottom;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=p){t.style.marginLeft=p}if(""!=o){t.style.marginTop=o}if(""!=d){t.style.marginRight=d}if(""!=q){t.style.marginBottom=q}}else{if("border-width"==n){var c=t.style.borderLeftWidth;var r=t.style.borderTopWidth;var a=t.style.borderRightWidth;var f=t.style.borderBottomWidth;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=c){t.style.borderLeftWidth=c}if(""!=r){t.style.borderTopWidth=r}if(""!=a){t.style.borderRightWidth=a}if(""!=f){t.style.borderBottomWidth=f}}else{if("border-style"==n){var l=t.style.borderLeftStyle;var u=t.style.borderTopStyle;var g=t.style.borderRightStyle;var m=t.style.borderBottomStyle;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=l){t.style.borderLeftStyle=l}if(""!=u){t.style.borderTopStyle=u}if(""!=g){t.style.borderRightStyle=g}if(""!=m){t.style.borderBottomStyle=m}}else{if("border-color"==n){var h=t.style.borderLeftColor;var s=t.style.borderTopColor;var b=t.style.borderRightColor;var i=t.style.borderBottomColor;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=h){t.style.borderLeftColor=h}if(""!=s){t.style.borderTopColor=s}if(""!=b){t.style.borderRightColor=b}if(""!=i){t.style.borderBottomColor=i}}else{if("padding"==n){var p=t.style.paddingLeft;var o=t.style.paddingTop;var d=t.style.paddingRight;var q=t.style.paddingBottom;SBGrid.UT.HtmlLib.setStyle(t,n,e);if(""!=p){t.style.paddingLeft=p}if(""!=o){t.style.paddingTop=o}if(""!=d){t.style.paddingRight=d}if(""!=q){t.style.paddingBottom=q}}}}}}}};SBGrid.UT.HttpClient=function(){this.m_objSubmit;this.m_objHttpFactory;this.m_objHttpRequest};SBGrid.UT.HttpClient.prototype.status=function(){if(4==this.m_objHttpRequest.readyState){return this.m_objHttpRequest.status}else{return null}};SBGrid.UT.HttpClient.prototype.post=function(h,a,f,c,b,g,e,d){return this._sendHttpRequest("POST",h,a,f,c,b,g,e,d)};SBGrid.UT.HttpClient.prototype.get=function(e,d,b,a,c){return this._sendHttpRequest("GET",e,null,d,b,a,false,null,c)};SBGrid.UT.HttpClient.prototype.put=function(e,a,d,c,b){return this._sendHttpRequest("PUT",e,a,d,c,b,false,null)};SBGrid.UT.HttpClient.prototype.deleteMethod=function(e,a,d,c,b){return this._sendHttpRequest("DELETE",e,a,d,c,b,false,null)};SBGrid.UT.HttpClient.prototype._sendHttpRequest=function(h,b,g,c,a,i,d,f,e){if(null==c){c=false}if(null==a||a.isEmpty()){a="application/x-www-form-urlencoded"}if(null==i||i.isEmpty()||!SBGrid.DEF.is_ie){i="UTF-8"}this.m_objHttpRequest=this._makeHttpRequest();if(c){if(null==e){this.m_objHttpRequest.m_objSubmit=this.m_objSubmit;this.m_objHttpRequest.onreadystatechange=SBGrid.UT.HttpClient.handleASyncHttpResponse}else{this.m_objHttpRequest.strId=this.id;this.m_objHttpRequest.onAfterSend=this.onAfterSend;this.m_objHttpRequest.onResponse=this.onResponse;this.m_objHttpRequest.onError=this.onError;this.m_objHttpRequest.onreadystatechange=SBGrid.UT.HttpClient.responseFunction}}this.m_objHttpRequest.open(h,b,c);if(d){this.m_objHttpRequest.setRequestHeader("Content-Type",a+"; boundary="+f)}else{this.m_objHttpRequest.setRequestHeader("Content-Type",a+";charset="+i)}this.m_objHttpRequest.send(g);if(!c){return this._handleSyncHttpResponse(b)}};SBGrid.UT.HttpClient.prototype._handleSyncHttpResponse=function(a){if(4==this.m_objHttpRequest.readyState){error.errorCode=this.m_objHttpRequest.status;error.description=this.m_objHttpRequest.statusText;if(200==this.m_objHttpRequest.status){if("text/html"==this.m_objHttpRequest.getResponseHeader("Content-Type")){}else{if(null!=window.console){if(!SBGrid.DEF.is_smartphone){if(null!=window.console){console.log(" Connect URL : "+a);console.log(" Connect STATUS : "+this.m_objHttpRequest.status);console.log(" Connect STATUS TEXT : "+this.m_objHttpRequest.statusText)}}else{if(null!=window.console){console.log(this.m_objHttpRequest.status+","+this.m_objHttpRequest.statusText+","+a)}}}return this.m_objHttpRequest.responseText}}else{if(!SBGrid.DEF.is_smartphone){if(null!=window.console){console.log(" Connect URL : "+a);console.log(" Connect STATUS : "+this.m_objHttpRequest.status);console.log(" Connect STATUS TEXT : "+this.m_objHttpRequest.statusText)}}else{if(null!=window.console){console.log(this.m_objHttpRequest.status+","+this.m_objHttpRequest.statusText+","+a)}}return null}}};SBGrid.UT.HttpClient.prototype._makeHttpRequest=function(){if(null!=this.m_objHttpFactory){return this.m_objHttpFactory()}for(var a=0;a<SBGrid.UT.HttpClient._HttpFactories.length;a++){try{var b=SBGrid.UT.HttpClient._HttpFactories[a];var d=b();if(null!=d){this.m_objHttpFactory=b;return d}}catch(c){continue}}SBGrid.UT.HttpClient._HttpFactories=function(){throw new Error("HttpRequest not supported")};SBGrid.UT.HttpClient._HttpFactories()};SBGrid.UT.HttpClient._HttpFactories=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];SBGrid.UT.HttpClient.handleASyncHttpResponse=function(){if(4==this.readyState){if(200==this.status){var a=this.responseText;if(null!=a&&!a.isEmpty()){var d=this.m_objSubmit.attribute.add;var h=this.m_objSubmit.attribute.type;var f=this.m_objSubmit.attribute.replace;var g=this.m_objSubmit.attribute.resultref;var c=false;if("/"==g.charAt(g.length-1)){g=g.substring(0,g.length-1);c=true}a=a.trim();if("custom"==h){var b=a;try{a=onaftersend(b);a=null==a?b:a}catch(e){a=b}}xnResultDoc=SBGrid.UT.XmlLib.loadXMLFromString(a);if(null!=xnResultDoc){if(null==xnResultDoc.firstChild||("root"!=xnResultDoc.firstChild.nodeName&&"xml"!=xnResultDoc.firstChild.nodeName)){}else{SBGrid.DS.XMLStorage.getUniqueStorage().updateData(SBGrid.UT.XmlLib.getRootElementNode(xnResultDoc),g,d,f,c);if(this.m_objSubmit.m_refresh){SBGrid.DS.XMLStorage.getUniqueStorage().refreshCurrentModel()}}}}this.m_objSubmit.m_objEndFunction()}else{throw new Error(this.status)}}};SBGrid.UT.HttpClient.prototype.send=function(objData){if(null==this.mediaType||null==this.method||null==this.URL){if(this.onError){try{eval(this.onError+"('"+this.id+"','')");return}catch(e){}}}var bIsJson=null==objData.ownerDocument;var strData;if("application/x-www-form-urlencoded"==this.mediaType){if(bIsJson){strData=SBGrid.DS.JsonStorage.getUniqueStorage()._getbSyncPostDataJson(objData,true,"","UTF-8",this.mediaType)}else{strData=SBGrid.DS.XMLStorage.getUniqueStorage()._getPostDataNode(objData,true,"","UTF-8",this.mediaType)}}else{if("application/xml"==this.mediaType||"text/xml"==this.mediaType||"application/json"==this.mediaType){if(bIsJson){strData=JSON.stringify(objData)}else{strData=SBGrid.UT.XmlLib.serializeToString(objData)}}else{return}}if("get"==this.method.toLowerCase()){strResult=this.get(this.URL+"?"+strData,true,this.mediaType,null,true)}else{if("post"==this.method.toLowerCase()){strResult=this.post(this.URL,strData,true,this.mediaType,null,false,null,true)}}};SBGrid.UT.HttpClient.responseFunction=function(){if(4==this.readyState){var strId=this.strId;var strOnError=this.onError;var strOnResponse=this.onResponse;var strOnAfterSend=this.onAfterSend;if(200==this.status){var strResult=this.responseText.trim();if(strOnResponse){strOnResponse=strOnResponse.trim();if(strOnAfterSend){strOnAfterSend=strOnAfterSend.trim()}var fnOnAfterSend=eval("window."+strOnAfterSend);var fnOnResponse=eval("window."+strOnResponse);try{var strReturnData=null;if(null!=fnOnAfterSend){strReturnData=fnOnAfterSend(strId,strResult,"");fnOnResponse(strId,strReturnData,"")}else{fnOnResponse(strId,strResult,"")}}catch(e){}}}else{if(strOnError){strOnError=strOnError.trim();var fnOnError=eval("window."+strOnError);try{if(null!=fnOnError){fnOnError(strId,"","")}}catch(e){}}}}};SBGrid.UT.Format=function(heControlId,strFormatData,bDecimalFormatInsert,strMaxLength){this.m_heControl=heControlId;this.m_strFormat;this.m_bIsDecimalFormatInsert=eval(bDecimalFormatInsert);this.m_nLength;this.m_bExistFormat=true;this.m_bIsDecimalFormatted=false;this.m_bExistMoneyUnitFormat=false;this.m_nMoneyUnitFormatPattern=0;this.m_strInputRealityData;this.m_strInputMaskData;this.m_nCaretStart;this.m_nCaretEnd;this.m_nMaxLength="-1"==strMaxLength?2147483647:Number(strMaxLength);this.m_bIsMaxLength="-1"==strMaxLength?false:true;this.m_strFormatYear;this.m_FormatManth;this.m_strDotZero="";this.m_bDeleteZero=false;this.init(strFormatData)};SBGrid.UT.Format.prototype.init=function(a,c){if(/\-|\/|\:|\$|\%|\ /.test(a.charAt(0))){a="'"+a.charAt(0)+"'"+a.substring(1,a.length)}this.m_strFormat=a;this.m_nLength=this.m_strFormat.length;if(null==c){c=false}if(0==this.m_nLength){this.m_bExistFormat=false;if(null==this.m_heControl.style.imeMode||""==this.m_heControl.style.imeMode){this.m_heControl.style.imeMode="auto"}this.m_heControl.maxLength=this.m_nMaxLength;return}else{this.m_bExistFormat=true;this.m_heControl.style.imeMode="disabled";this.m_strSelectionTypeMask="";if(this.m_bExistSelectionTypeMask=/\((\D+)\)/.test(this.m_strFormat)){this.m_strSelectionTypeMask=this.m_strFormat.substring(this.m_strFormat.indexOf("("),this.m_strFormat.indexOf(")")+1);this.m_strFormat=this.m_strFormat.substring(this.m_strSelectionTypeMask.length,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length}this.m_strAppearTypeMask="";if(/\'(\D+)\'/.test(this.m_strFormat)){this.m_strAppearTypeMask=this.m_strFormat.substring(this.m_strFormat.indexOf("'"),this.m_strFormat.lastIndexOf("'")+1);this.m_strFormat=this.m_strFormat.substring(this.m_strAppearTypeMask.length,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length;this.m_strAppearMask=this.m_strAppearTypeMask.substring(1,this.m_strAppearTypeMask.length-1)}this.m_bIsMasked=false;this.m_strMask="";if(null==this.m_strInputRealityData){this.m_strInputRealityData=""}else{if((""==this.m_strInputRealityData&&""!=this.m_heControl.value)||c){this.m_strInputRealityData=this.m_heControl.value}}this.m_strMask=-1!=this.m_strSelectionTypeMask.indexOf(this.m_strInputRealityData.charAt(0))?this.m_strInputRealityData.charAt(0):"";if(""!=this.m_strMask){this.m_bIsMasked=true}if(this.m_strFormat.indexOf("9#")){this.m_strFormat=this.m_strFormat.replace("9#","#")}if("-1"==this.m_strFormat.indexOf("#")&&"-1"==this.m_strFormat.indexOf("0")){this.m_bExistMoneyUnitFormat=false;this.m_heControl.maxLength=this.m_strFormat.length;this.inputValidateCheck()}else{this.m_bExistMoneyUnitFormat=true;this.m_heControl.maxLength=this.m_nMaxLength;var b=this.m_strFormat.indexOf(".");this.m_nMoneyUnitFormatPattern="-1"!=this.m_strFormat.indexOf(",")?1:0;this.m_nMoneyUnitFormatPattern="-1"!=b?(this.m_nMoneyUnitFormatPattern+2):this.m_nMoneyUnitFormatPattern;switch(this.m_nMoneyUnitFormatPattern){case 2:case 3:this.m_bIsDecimalFormatted=true;break;case 0:case 1:this.m_bIsDecimalFormatted=false;break}if(-1!=b){this.m_strDotZero="";while("0"==this.m_strFormat.charAt((b+1))){this.m_strDotZero+="0";b++}}else{if(-1!=this.m_strInputRealityData.indexOf(".")){this.m_strInputRealityData=this.m_strInputRealityData.substring(0,this.m_strInputRealityData.indexOf("."))}}this.inputMoneyUnitValidateCheck()}}};SBGrid.UT.Format.prototype.stopKeyEvent=function(a){if(SBGrid.DEF.is_ie){a.m_browserEvent.returnValue=false}else{a.m_browserEvent.preventDefault()}};SBGrid.UT.Format.prototype.moneyKeyCheck=function(b){if(8==b.keyCode||46==b.keyCode){var d=this.m_heControl.value;var l=SBGrid.DEF.getCaretPosition(this.m_heControl);this.m_nCaretStart=l.start;this.m_nCaretEnd=l.end;var f=d.substring(0,this.m_nCaretStart);var c=f.split(",").length-1;var g=d.split(",").length-1;var e=this.m_nCaretStart!=this.m_nCaretEnd?true:false;var m=this.m_nCaretStart-c;var i=this.m_nCaretEnd-c;if(this.m_strInputRealityData.length<m){if(8==b.keyCode){m=this.m_strInputRealityData.length;this.m_nCaretStart=m+c;i=this.m_strInputRealityData.length;this.m_nCaretEnd=i+c}else{this.stopKeyEvent(b);return}}var h=false;if(!e){if(8==b.keyCode){if(","==d.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}this.m_nCaretStart--;m--}else{if(46==b.keyCode){if(","==d.charAt(this.m_nCaretEnd)){this.m_nCaretEnd++;h=true}i++}}}if(e){var a=d.substring(this.m_nCaretStart,this.m_nCaretEnd);g-=a.split(",").length-1;i-=a.split(",").length-1;if(","==a.charAt(a.length-1)){g++;h=true}}if(","==d.charAt(this.m_nCaretEnd+1)){this.m_nCaretStart++}f=this.m_strInputRealityData.substring(0,m);strLastString=this.m_strInputRealityData.substring(i,this.m_strInputRealityData.length);this.m_strInputRealityData=f+strLastString;this.m_nCaretStart-=g;if(h){this.m_nCaretStart++}if(-1==this.m_strInputRealityData.indexOf(this.m_strMask)){this.m_strMask="";this.m_bIsMasked=false}this.stopKeyEvent(b);this.inputMoneyUnitValidateCheck();SBGrid.DEF.setCaretPosition(this.m_heControl,this.m_nCaretStart,this.m_nCaretStart)}else{this.stopKeyEvent(b)}};SBGrid.UT.Format.prototype.keypressFormatting=function(b){if(this.m_bExistFormat){var g=this.m_heControl.value;var l=g.length;var o=SBGrid.DEF.getCaretPosition(this.m_heControl);this.m_nCaretStart=o.start;this.m_nCaretEnd=o.end;if(this.m_bExistSelectionTypeMask&&!this.m_bIsMasked&&0==this.m_nCaretStart){this.m_strMask=-1!=this.m_strSelectionTypeMask.indexOf(String.fromCharCode(b.keyCode))?String.fromCharCode(b.keyCode):"";if(""!=this.m_strMask){this.m_strFormat=this.m_strMask+this.m_strFormat;this.m_nLength=this.m_strFormat.length;this.m_bIsMasked=true}}var h=this.m_nCaretStart!=this.m_nCaretEnd?true:false;var m="";var q="";var c=0;if(8==b.keyCode){if(h){this.stopKeyEvent(b);m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretEnd,l).replace(/\W/g,"")}else{if("9"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"y"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"m"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"d"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"h"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"n"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"s"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"A"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"a"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"C"!=this.m_strFormat.charAt(this.m_nCaretStart-1)&&"L"!=this.m_strFormat.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}this.stopKeyEvent(b);c--;m=g.substring(0,this.m_nCaretStart-1);q=g.substring(this.m_nCaretStart,l).replace(/\W/g,"")}if(0==this.m_nCaretStart&&""!=this.m_strMask){this.m_strFormat=this.m_strFormat.substring(1,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length;this.m_strMask="";this.m_bIsMasked=false}}else{if(46==b.keyCode){if(h){this.stopKeyEvent(b);m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretEnd,l).replace(/\W/g,"")}else{var r=0;if("9"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"y"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"m"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"d"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"h"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"n"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"s"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"A"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"a"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"C"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"L"!=this.m_strFormat.charAt(this.m_nCaretStart)){if(0!=this.m_nCaretStart&&""==this.m_strMask){r++}}this.stopKeyEvent(b);m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretStart+r+1,l).replace(/\W/g,"")}if(0==this.m_nCaretStart&&""!=this.m_strMask){r--;this.m_strFormat=this.m_strFormat.substring(1,this.m_strFormat.length);this.m_nLength=this.m_strFormat.length;this.m_strMask="";this.m_bIsMasked=false}}else{m=g.substring(0,this.m_nCaretStart);q=g.substring(this.m_nCaretEnd,l);var s=true;if("9"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"y"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"m"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"d"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"h"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"n"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"s"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"A"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"a"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"C"!=this.m_strFormat.charAt(this.m_nCaretStart)&&"L"!=this.m_strFormat.charAt(this.m_nCaretStart)){if(this.m_strFormat.charAt(this.m_nCaretStart)==String.fromCharCode(b.keyCode)){s=false;m+=this.m_strFormat.charAt(this.m_nCaretStart)}else{s=true;m+=this.m_strFormat.charAt(this.m_nCaretStart);this.m_nCaretStart++}}var p=this.validateFormat(this.m_nCaretStart,String.fromCharCode(b.keyCode),b);this.stopKeyEvent(b);if(""==p&&s){return}m+=p;this.m_nCaretStart++}}var f=0;var a="";for(var n=this.m_nCaretStart+c;n<this.m_nLength;n++){if("9"!=this.m_strFormat.charAt(n)&&"y"!=this.m_strFormat.charAt(n)&&"m"!=this.m_strFormat.charAt(n)&&"d"!=this.m_strFormat.charAt(n)&&"h"!=this.m_strFormat.charAt(n)&&"n"!=this.m_strFormat.charAt(n)&&"s"!=this.m_strFormat.charAt(n)&&"A"!=this.m_strFormat.charAt(n)&&"a"!=this.m_strFormat.charAt(n)&&"C"!=this.m_strFormat.charAt(n)&&"L"!=this.m_strFormat.charAt(n)){a+=this.m_strFormat.charAt(n)}else{if(""!=q.charAt(f)){var d=this.validateFormat(n,q.charAt(f),b);if(""!=d){a+=d;m+=a;f++;a=""}else{break}}else{break}}}var e=this.dayFormatCheck(m);if(e||8==b.keyCode||46==b.keyCode){this.m_heControl.value=m;if(""!=this.m_strMask){m=m.substring(1,m.length);if("C"!=this.m_strFormat.charAt(this.m_nCaretStart)){m=m.replace(/\W/g,"")}m=this.m_strMask+m}else{if("C"!=this.m_strFormat.charAt(this.m_nCaretStart)){m=m.replace(/\W/g,"")}}this.m_strInputRealityData=m;if(8==b.keyCode){this.m_nCaretStart--}SBGrid.DEF.setCaretPosition(this.m_heControl,this.m_nCaretStart,this.m_nCaretStart)}}};SBGrid.UT.Format.prototype.keypressMoneyUnitFormatting=function(c){if(this.m_bExistFormat){if(SBGrid.DEF.is_firefox){c.keyCode=c.m_browserEvent.keyCode>c.m_browserEvent.charCode?c.m_browserEvent.keyCode:c.m_browserEvent.charCode;if(0==c.m_browserEvent.charCode){return}}if(SBGrid.DEF.is_opera){c.keyCode=c.m_browserEvent.keyCode>c.m_browserEvent.which?c.m_browserEvent.keyCode:c.m_browserEvent.which;if(0==c.m_browserEvent.which){return}}var r=SBGrid.DEF.getCaretPosition(this.m_heControl);this.m_nCaretStart=r.start;this.m_nCaretEnd=r.end;if(typeof this.m_strAppearMask!="undefined"){if(""!=this.m_strAppearMask&&this.m_nCaretStart<this.m_strAppearMask.length){this.m_nCaretStart=this.m_strAppearMask.length}}if("."==this.m_strInputRealityData.charAt(0)&&/\d/.test(this.m_strInputRealityData.charAt(1))){this.m_nCaretStart--;this.m_nCaretEnd--}var a=false;if(0==this.m_nCaretStart&&(this.m_nCaretStart!=this.m_nCaretEnd?true:false)){this.m_bIsMasked=false;if(""!=this.m_strAppearMask){this.m_bIsAppearMaskDel=true}}var l=this.m_heControl.value.replace(this.m_strAppearMask,"");var d=-1!=this.m_heControl.value.indexOf(this.m_strAppearMask)?this.m_strAppearMask.length:0;if(this.m_bIsMasked){d=-1!=this.m_heControl.value.indexOf(this.m_strMask)?this.m_strMask.length:d}this.m_nCaretStart-=d;this.m_nCaretEnd-=d;if(this.m_bExistSelectionTypeMask&&!this.m_bIsMasked&&(0==this.m_nCaretStart||0==parseFloat(l.length==0?0:l))){this.m_strMask=-1!=this.m_strSelectionTypeMask.indexOf(String.fromCharCode(c.keyCode))?String.fromCharCode(c.keyCode):"";if(""!=this.m_strMask){this.m_bIsMasked=true;a=true}}if((c.keyCode>=48&&c.keyCode<=57)||c.keyCode==46||a){var f=this.m_strInputRealityData;var g=f.length;var o=this.m_heControl.value.split(",").length-1;var e=l.substring(0,this.m_nCaretEnd).split(",").length-1;var q=this.m_nCaretStart-e;var p=this.m_nCaretEnd-e;if(((-1!=f.indexOf(".")&&-1==f.substring(q,p).indexOf("."))||!this.m_bIsDecimalFormatted)&&"."==String.fromCharCode(c.keyCode)){this.stopKeyEvent(c);return}o-=(l.substring(this.m_nCaretStart,this.m_nCaretEnd).split(",").length-1);if(q>g){q=g;this.m_nCaretStart=g+o}if(p>g){p=g;this.m_nCaretEnd=g+o}var s=String.fromCharCode(c.keyCode);if(/\D/.test(s)&&a){this.m_nCaretStart=0}this.m_nCaretStart++;this.m_nCaretStart-=o;var h=f.substring(0,q);var t=f.substring(p,g);if(-1!=h.indexOf(".")){if(this.m_bIsDecimalFormatInsert){f=h+s+t.substring(1,t.length)}else{f=h+s+t}if(""!=this.m_strDotZero){f=f.substring(0,f.indexOf(".")+1+this.m_strDotZero.length)}}else{f=h+s+t}if("."==f.charAt(0)){this.m_nCaretStart++}var n=false;if("00"==f.substring(0,2)&&(0!=this.m_nMoneyUnitFormatPattern&&2!=this.m_nMoneyUnitFormatPattern)){f=f.substring(1,f.length);this.m_nCaretStart--}else{if(0!=this.m_nMoneyUnitFormatPattern&&2!=this.m_nMoneyUnitFormatPattern){var b=-1;for(var m=0;m<f.length;m++){if("0"==f.charAt(m)){b++}else{break}}if(-1<b&&"."!=f.charAt(1)){f=f.substring(b+1,f.length);if(""==f){f="0"}else{n=true}}}}this.m_strInputRealityData=f;this.inputMoneyUnitValidateCheck();this.m_nCaretStart+=d;this.m_nCaretEnd+=d;if(","==this.m_heControl.value.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}if(n){this.m_nCaretStart--}this.stopKeyEvent(c);if(this.m_bIsAppearMaskDel){this.m_nCareteStart++;this.m_bIsAppearMaskDel=false}SBGrid.DEF.setCaretPosition(this.m_heControl,this.m_nCaretStart,this.m_nCaretStart)}else{this.stopKeyEvent(c)}}};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheckPattern1=function(c){var b="";var d=c.length;d=0==this.m_strDotZero.length?c.length:this.m_strDotZero.length;for(var a=0;a<d;a++){if(""!=c.charAt(a)){b+=c.charAt(a);continue}else{b+="0"}}return b};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheckPattern2=function(c){var g="";c=c.replace(/\D/g,"");var f=c.length;var a=f%3;var e=(f/2)-1;var l=0;var d=0;var h=false;for(var b=0;b<f;b++){if(0==b&&c.charCodeAt(b)==48){g=c.charAt(b)}else{if(a==l){if(f>3&&a!=0){this.m_nCaretStart++;g=g+",";h=true}else{if(f>3){h=true}}}if(3==d){this.m_nCaretStart++;g=g+",";d=0}g+=c.charAt(b);l++;if(h){d++}}}if(""==g&&this.m_bIsDecimalFormatted&&""!=this.m_strDotZero){g="0"}if(","==g.charAt(this.m_nCaretStart-1)){this.m_nCaretStart--}return g};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheckPattern3=function(d){var c="";d=d.replace(/[^\.\d]/g,"");var f=0==this.m_strDotZero.length?0:this.m_strDotZero.length;var e=d.length;for(var b=0;b<e;b++){c+=d.charAt(b)}if(""==c&&"0"==this.m_strFormat.replace(/[^\.\d]/g,"").charAt(0)){c="0"}if(-1!=d.indexOf(".")){var a=d.substring(d.indexOf("."),e).length;for(var b=a;b<=f;b++){c+="0"}}else{if(0<f){c+=".";for(var b=0;b<f;b++){c+="0"}}}return c};SBGrid.UT.Format.prototype.inputMoneyUnitValidateCheck=function(){var e="";var d=this.m_strInputRealityData;var b=0;d=d.replace(/[^.\d]/g,"");if("9#"!=this.m_strFormat){for(var c=0;c<d.length;c++){if("0"!=d.charAt(c)){b=c;if(0!=c&&"."==d.charAt(c)){b--}break}}}d=d.substring(b,d.length);var f=d.length;switch(this.m_nMoneyUnitFormatPattern){case 0:e=this.inputMoneyUnitValidateCheckPattern3(d);break;case 1:e=this.inputMoneyUnitValidateCheckPattern2(d);break;case 2:e=this.inputMoneyUnitValidateCheckPattern3(d);break;case 3:if(-1==this.m_strInputRealityData.indexOf(".")){e=this.inputMoneyUnitValidateCheckPattern2(d);if(""!=this.m_strDotZero){e+="."+this.m_strDotZero}}else{var a=d.indexOf(".");e+=this.inputMoneyUnitValidateCheckPattern2(d.substring(0,a));e+=".";var g=this.inputMoneyUnitValidateCheckPattern1(d.substring(a+1,f));e+=g}break}if((this.m_bIsMasked&&""!=this.m_strMask)||d.indexOf()){e=this.m_strMask+e}if(null!=this.m_strAppearMask&&""!=this.m_strAppearMask){e=this.m_strAppearMask+e}this.m_strInputMaskData=e;this.m_heControl.value=e};SBGrid.UT.Format.prototype.inputValidateCheck=function(){var e="";var b="";this.m_strInputRealityData="";this.m_strInputMaskData="";var f=0;var g=0;var d=this.m_heControl.value;var a=d.length;reSpecialChar=/\s/g;d=d.replace(reSpecialChar,"");this.m_nCaretStart=this.m_nCaretStart-(a-d.length);reSpecialChar=/\W/g;d=d.replace(reSpecialChar,"");for(var c=0;c<this.m_nLength;c++){if(f!=this.m_nLength&&""!=d.charAt(g)){if("9"!=this.m_strFormat.charAt(f)&&"y"!=this.m_strFormat.charAt(f)&&"m"!=this.m_strFormat.charAt(f)&&"d"!=this.m_strFormat.charAt(f)&&"h"!=this.m_strFormat.charAt(f)&&"n"!=this.m_strFormat.charAt(f)&&"s"!=this.m_strFormat.charAt(f)&&"A"!=this.m_strFormat.charAt(f)&&"a"!=this.m_strFormat.charAt(f)&&"C"!=this.m_strFormat.charAt(f)&&"L"!=this.m_strFormat.charAt(f)){e=e+this.m_strFormat.charAt(f);f++}else{for(;g<d.length;g++){b=this.validateFormat(f,d.charAt(g));if(""!=b){e=e+b;this.m_strInputRealityData=this.m_strInputRealityData+b;g++;if("9"!=this.m_strFormat.charAt(f+1)&&"y"!=this.m_strFormat.charAt(f+1)&&"m"!=this.m_strFormat.charAt(f+1)&&"d"!=this.m_strFormat.charAt(f+1)&&"h"!=this.m_strFormat.charAt(f+1)&&"n"!=this.m_strFormat.charAt(f+1)&&"s"!=this.m_strFormat.charAt(f+1)&&"A"!=this.m_strFormat.charAt(f+1)&&"a"!=this.m_strFormat.charAt(f+1)&&"C"!=this.m_strFormat.charAt(f+1)&&"L"!=this.m_strFormat.charAt(f+1)){e=e+this.m_strFormat.charAt(f+1);f++;if(this.m_nCaretStart==f||this.m_nCaretStart==this.m_heControl.value.length){this.m_nCaretStart++}}break}else{this.m_nCaretStart--}}f++}}}if(""!=this.m_bIsMasked){this.m_strInputRealityData=this.m_strMask+this.m_strInputRealityData;this.m_strFormat=this.m_strMask+this.m_strFormat;e=this.m_strMask+e}this.m_strInputMaskData=e;this.m_heControl.value=e};SBGrid.UT.Format.prototype.dayFormatCheck=function(l){if(-1!=this.m_strFormat.indexOf("yyyy")&&-1!=this.m_strFormat.indexOf("mm")&&-1!=this.m_strFormat.indexOf("dd")){var g=new SBGrid.DS.Hashtable();var m=this.m_strFormat.split(/\W/g);var h=l.split(/\W/g);for(var e=0;e<m.length;e++){g[m[e]]=null!=h[e]?h[e]:"0"}if(0!=g.mm){var f=parseInt(parseFloat(g.yyyy));var d=parseInt(parseFloat(g.mm));var c=parseInt(parseFloat(g.dd));var b="312931303130313130313031";var a=b.substring(((d-1)*2),((d-1)*2+2));if(g.yyyy.length>3&&(d==2)&&!((((f%4==0)&&(f%100!=0))||(f%400==0)))){a="28"}if(c<=parseInt(parseFloat(a))){return true}else{return false}}}return true};SBGrid.UT.Format.prototype.validateFormat=function(a,d,b){var c;if(""==d){c=b.keyCode;if(c>=96&&c<=105){c=c-48}}else{c=d.charCodeAt(0)}switch(this.m_strFormat.charAt(a)){case"9":if(c>=48&&c<=57){return String.fromCharCode(c)}return"";case"y":if("y"==this.m_strFormat.charAt(a-3)&&"0"==this.m_heControl.value.charAt(a-1)&&"0"==this.m_heControl.value.charAt(a-2)&&"0"==this.m_heControl.value.charAt(a-3)){if(c>=49&&c<=57){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}return"";case"m":if("m"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=49){return String.fromCharCode(c)}}else{if("m"==this.m_strFormat.charAt(a-1)&&"1"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)){if(c>=48&&c<=50){return String.fromCharCode(c)}}else{if(c>=49&&c<=57){return String.fromCharCode(c)}}}return"";case"d":if("d"==this.m_strFormat.charAt(a+1)){if("m"==this.m_strFormat.charAt(a-2)&&"2"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)&&(("m"==this.m_strFormat.charAt(a-3)&&"0"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-2))||"m"!=this.m_strFormat.charAt(a-3))){if(c>=48&&c<=50){return String.fromCharCode(c)}}else{if(c>=48&&c<=51){return String.fromCharCode(c)}}}else{if("d"==this.m_strFormat.charAt(a-1)&&"3"!=this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)){if(c>=48&&c<=57){return String.fromCharCode(c)}}else{if("d"==this.m_strFormat.charAt(a-1)&&"3"==this.m_strInputRealityData.charAt(this.m_strInputRealityData.length-1)){if(c>=48&&c<=49){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}}}return"";case"h":if("h"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=50){return String.fromCharCode(c)}}else{if("h"==this.m_strFormat.charAt(a-1)&&"2"==this.m_heControl.value.charAt(a-1)){if(c>=48&&c<=52){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}}return"";case"n":if("n"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=53){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}return"";case"s":if("s"==this.m_strFormat.charAt(a+1)){if(c>=48&&c<=53){return String.fromCharCode(c)}}else{if(c>=48&&c<=57){return String.fromCharCode(c)}}return"";case"A":if((c>=48&&c<=57)||(c>=65&&c<=90)||(c>=97&&c<=129)){return d}return"";case"a":if((c==32)||(c>=48&&c<=57)||(c>=65&&c<=90)||(c>=97&&c<=129)){return d}return"";case"C":return d;case"L":if((c>=65&&c<=90)||(c>=97&&c<=129)){return d}return"";default:return""}};SBGrid.UT.Format.prototype.getLength=function(){return this.m_nLength};SBGrid.UT.Format.prototype.getFormatString=function(){return this.m_strFormat};SBGrid.UT.Format.prototype.getFormatInputData=function(){return this.m_strInputRealityData};SBGrid.UT.Format.prototype.getFormatInputMaskData=function(){return this.m_strInputMaskData};SBGrid.UT.Format.prototype.getFormatExist=function(){return this.m_bExistFormat};SBGrid.UT.Format.prototype.setFormatExist=function(a){return this.m_bExistFormat=a};SBGrid.UT.Format.prototype.getMoneyUnitFormatExist=function(){return this.m_bExistMoneyUnitFormat};function xPathOperation(strOperation,xnNode){var strCalculation=strOperation;strCalculation=strCalculation.replaceAll("&quot;",'"');var strReg=/(([a-z]|\d|\)|\'|\"|\s)\=([a-z]|\d|\/|\(|\'|\"|\s))/g;var alOperator=strCalculation.match(strReg);if(null!=alOperator){for(var i=0;i<alOperator.length;i++){var strOperatorTempData=alOperator[i];strOperatorTempData=strOperatorTempData.replace(/\=/g,"==");strCalculation=strCalculation.replaceAll(alOperator[i],strOperatorTempData)}}while(true){var rePattern=/(([a-z]+)\-([a-z]+)\-(([a-z]+)(\s+|))\(((([A-Za-z]|\d|\&\&|\|\||\%|\/|\+|\-||\=\=|\!\=|\*|\<|\<\=|\>|\>|\'|\"|\,|\.|\s)+)|)\))|(([a-z]+)\-(([a-z]+)(\s+|))\(((([A-Za-z]|\d|\&\&|\|\||\%|\/|\+|\-||\=\=|\!\=|\*|\<|\<\=|\>|\>|\'|\"|\,|\.|\s)+)|)\))|((([a-z]+)(\s+|))\(((([A-Za-z]|\d|\&\&|\|\||\%|\/|\+|\-||\=\=|\!\=|\*|\<|\<\=|\>|\>|\'|\"|\,|\.|\s)+)|)\))/g;var alFunctionResult=strCalculation.match(rePattern);if(null!=alFunctionResult){alFunctionResult=SBGrid.DEF.fextractDupArr(alFunctionResult);for(var i=0;i<alFunctionResult.length;i++){try{var strTransValue=alFunctionResult[i].replaceAll("-","_");if(-1!=strTransValue.indexOf("/")){var bXpathNodeFunctionExist=false;if(strTransValue.isRegular(/(avg|min|max|sum|position|last|count|text|node|namespace\_uri|local\_name|name)(\s+|)\(/g)){bXpathNodeFunctionExist=true}var strRefPattern=/(\.\.|(\/(\w+(\[\d\]|))))+/g;var alRefAddress=strTransValue.match(strRefPattern);if(null!=alRefAddress){alRefAddress=SBGrid.DEF.fextractDupArr(alRefAddress);for(var j=0;j<alRefAddress.length;j++){if(!bXpathNodeFunctionExist){if(null!=xnNode&&alRefAddress[j].isRegular(/\.\.\//g)){var strTempData=SBGrid.UT.XmlLib.getTextValue(xnNode.selectSingleNode(alRefAddress[j]))}else{var strTempData=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(alRefAddress[j])}}else{var strTempData=alRefAddress[j]}if(!isFinite(strTempData)){strTempData='"'+strTempData+'"'}strTransValue=strTransValue.replaceAll(alRefAddress[j],strTempData)}}}var resultValue=window.eval("xPath_"+strTransValue.trim());strCalculation=strCalculation.replaceAll(alFunctionResult[i],String(resultValue))}catch(e){if(-1!=strOperation.indexOf("count(")){return"0"}else{return""}}}}else{break}}if(strCalculation.isRegular(/(\s|\))(and|or|mod|div)(\s|\()/g)){var alTransMathMark=strCalculation.match(/(\s|\))(and|or|mod|div)(\s|\()/g);alTransMathMark=SBGrid.DEF.fextractDupArr(alTransMathMark);for(var i=0;i<alTransMathMark.length;i++){strCalculation=strCalculation.replaceAll(alTransMathMark[i],alTransMathMark[i].replace(/and/g," && ").replace(/or/g," || ").replace(/mod/g," % ").replace(/div/g," / "))}}var bOperation=false;if(strCalculation.isRegular(/(\&\&)|(\|\|)|(\%)|(\/)|(\+)|(\-)|(\=\=)|(\!\=)|(\*)|(\<)|(\<\=)|(\>)|(\>\=)/g)){bOperation=true}rePattern=/(\.\.|(\/(\w+(\[\d\]|))))+/g;var alXpathResult=strCalculation.match(rePattern);if(null!=alXpathResult){alXpathResult=SBGrid.DEF.fextractDupArr(alXpathResult);for(var i=0;i<alXpathResult.length;i++){if(-1!=alXpathResult[i].indexOf("/")){if(null!=xnNode&&alXpathResult[i].isRegular(/\.\.\//g)){var resultValue=SBGrid.UT.XmlLib.getTextValue(xnNode.selectSingleNode(alXpathResult[i]))}else{var resultValue=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(alXpathResult[i])}if(bOperation){if(resultValue.isEmpty()){strCalculation=strCalculation.replaceAll(alXpathResult[i],"0")}else{strCalculation=strCalculation.replaceAll(alXpathResult[i],resultValue)}}else{strCalculation=strCalculation.replaceAll(alXpathResult[i],resultValue)}}}}var reStringNumberPattern=/(\"|\')(\d+)(\"|\')/g;var alStringNumberResult=strCalculation.match(reStringNumberPattern);if(null!=alStringNumberResult){alStringNumberResult=SBGrid.DEF.fextractDupArr(alStringNumberResult);for(var j=0;j<alStringNumberResult.length;j++){strCalculation=strCalculation.replaceAll(alStringNumberResult[j],alStringNumberResult[j].replace(/\'|\"/g,""))}}if(bOperation){try{var strEnddingCalculate=window.eval(strCalculation);if(strCalculation.isRegular(/\&\&|\|\|/g)){if(Number(strEnddingCalculate)){return Number(strEnddingCalculate)?true:false}else{return strEnddingCalculate}}else{return strEnddingCalculate}}catch(e){if(-1!=strOperation.indexOf("count(")){return"0"}else{return""}}}else{return strCalculation}}function xPath_name(a){var b=a.split(/\//g);return String(b[b.length-1])}function xPath_local_name(a){var b=a.split(/\//g);return String(b[b.length-1])}function xPath_count(b){var a=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);return String(a.length)}function xPath_boolean(a){strTransString=xPath_string(a);if("0"!=strTransString&&"false"!=strTransString){return true}else{return false}}function xPath_not(a){if(a){return false}else{return true}}function xPath_true(){return true}function xPath_false(){return false}function xPath_string(a){if(a){var b=String(a);return b}return""}function xPath_string_length(a){if(a){a=xPath_string(a);return a.length}return 0}function xPath_concat(){var b="";for(var a=0;a<arguments.length;a++){b+=xPath_string(arguments[a])}return b}function xPath_starts_with(a,b){a=xPath_string(a);b=xPath_string(b);if(0==a.indexOf(b)){return true}else{return false}}function xPath_contains(a,b){a=xPath_string(a);b=xPath_string(b);if(-1!=a.indexOf(b)){return true}else{return false}}function xPath_substring(a,b,c){a=xPath_string(a);return a.substring(b-1,c)}function xPath_substring_before(b,a){b=xPath_string(b);strsecondData=xPath_string(strsecondData);var c=b.indexOf(a);return b.substring(0,c)}function xPath_substring_after(b,a){b=xPath_string(b);strsecondData=xPath_string(strsecondData);var c=b.indexOf(a);return b.substring(c+1,b.length)}function xPath_normalize_space(a){a=xPath_string(a);return a.trim()}function xPath_translate(b,a,c){b=xPath_string(b);strsecondData=xPath_string(strsecondData);c=xPath_string(c);return b.replaceAll(a,c)}function xPath_number(a){a=xPath_string(a);return Number(a)}function xPath_ceiling(a){return Math.ceil(xPath_number(a))}function xPath_floor(a){return Math.floor(xPath_number(a))}function xPath_round(a){return Math.round(xPath_number(a))}function xPath_avg(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e+=Number(d)}}}return String((e/alRefNode.length))}function xPath_min(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e=e<=Number(d)?e:Number(d)}}}return String(e)}function xPath_max(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e=e>=Number(d)?e:Number(d)}}}return String(e)}function xPath_sum(b){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);var e=0;for(var a=0;a<c.length;a++){var d=SBGrid.UT.XmlLib.getTextValue(c.item(a));if(""!=d){if(isFinite(d)){e+=Number(d)}}}return String(e)}function xPath_days_from_date(a){if(a.isRegular(/[0-9][0-9][0-9][0-9]\-[0-9][0-9]\-[0-9][0-9]/g)){a=a.replace(/\-/g,"/");return String(Math.round(Math.abs(Date.parse(a)/1000/60/60/24)))}else{return""}}function xPath_seconds_from_datetime(a){if(a.isRegular(/[0-9][0-9][0-9][0-9]\-[0-9][0-9]\-[0-9][0-9]/g)){a=a.replace(/\-/g,"/");return String(Math.round(Math.abs(Date.parse(a)/1000)))}else{return""}}function xPath_seconds(a){}function xPath_months(a){}function xPath_luhn(b){b=xPath_string(b);if(12<=b.length&&19>=b.length){for(var a=0;a<b.length;a++){if(isNaN(b.substring(a,a+1))){return false}}return true}else{return false}}function xPath_if(c,b,a){if(c){return xPath_string(b)}else{return xPath_string(a)}}function xPath_boolean_from_string(a){strTransString=xPath_string(a);if("0"==strTransString||"false"==strTransString){return false}else{if("1"==strTransString||"true"==strTransString){return true}}return""}function xPath_power(a,b){strBase=xPath_string(a);strExponent=xPath_string(b);return Math.pow(Number(strBase),Number(strExponent))}function xPath_now(){var c=new Date();var f=c.getUTCFullYear();var g=c.getMonth();g=9>(g)?"0"+(g+1):(g+1);var b=c.getDate();b=10>(b)?"0"+(b):(b);var a=c.getHours();a=10>(a)?"0"+(a):(a);var d=c.getMinutes();d=10>(d)?"0"+(d):(d);var e=c.getSeconds();e=10>(e)?"0"+(e):(e);return f+"-"+g+"-"+b+"T"+a+":"+d+":"+e+"Z"}SBGrid.CT.ElementBase=function(b,d,c){if(!d){return}this.children=new SBGrid.DS.Collection();this.elementName=c;this.parent;this.id=d;this.tag=c;this.text;this.parentId=b;this.m_strLocalTag=c;var a=this.m_strLocalTag.indexOf(":");if(-1!=a){this.m_strLocalTag=this.m_strLocalTag.substr(a+1)}this.m_objElement=null;this.setParent(b);SBGrid.DEF.__appendAll(d,this)};SBGrid.CT.ElementBase.prototype.getElement=function(){if(this.m_objElement){this.m_objElement.setRefElement(this)}return this.m_objElement};SBGrid.CT.ElementBase.prototype.setElement=function(a){this.m_objElement=a};SBGrid.CT.ElementBase.prototype.getAttribute=function(a){return null};SBGrid.CT.ElementBase.prototype.setAttribute=function(a,b){return};SBGrid.CT.ElementBase.prototype.getId=function(){return this.getAttribute("id")};SBGrid.CT.ElementBase.prototype.getTag=function(){return this.tag};SBGrid.CT.ElementBase.prototype.getLocalTag=function(){return this.m_strLocalTag};SBGrid.CT.ElementBase.prototype.getParent=function(){return this.parent};SBGrid.CT.ElementBase.prototype.setParent=function(a){if(this instanceof SBGrid.CT.ElementBase){var b=document.SBHE_allElement.m_htCollection[a];this.parent=b;if(b instanceof SBGrid.CT.ElementBase){if(this instanceof SBGrid.DS.XMLStorage){if(b.children.exists(this.id)){return}}b.setChild(this.id,this)}}};SBGrid.CT.ElementBase.prototype.setChild=function(b,a){this.children.add(b,a)};SBGrid.CT.ElementBase.prototype.getElementName=function(){return this.elementName};SBGrid.CT.ElementBase.prototype.getText=function(){return this.text};SBGrid.CT.ElementBase.prototype.setText=function(a){this.text=a;this.attribute.text=a};SBGrid.CT.ElementBase.prototype.isChild=function(b){var a=document.SBHE_allElement.m_htCollection[b];if(!a){return false}return(this==a.parent)};SBGrid.CT.ElementBase.prototype.isDescendants=function(d,a){var c=document.SBHE_allElement.m_htCollection[d];if(!c){return false}var b;if(a){b=c}else{b=c.parent}while(b){if(this==b){return true}b=b.parent}return false};SBGrid.CT.Attribute=function(a,c,b){if(!c){return}SBGrid.CT.ElementBase.call(this,a,c,b);this.attribute=new SBGrid.DS.Hashtable();this.m_initStyleList=new SBGrid.DS.Hashtable();this.attribute.id=c;this.attribute.tag=b;this.m_htHoverStyle=null;this.m_htDownStyle=null;this.m_htFocusStyle=null;this.m_htDisableStyle=null;this.m_htSelectStyle=null};SBGrid.CT.Attribute.prototype=new SBGrid.CT.ElementBase;SBGrid.CT.Attribute.prototype.initStyle=function(a){if(null!=this.m_initStyleList[a]){SBGrid.UT.HtmlLib.setStyle(this.m_heControl,a,this.m_initStyleList[a]);this.attribute[a]=this.m_initStyleList[a]}else{SBGrid.UT.HtmlLib.setStyle(this.m_heControl,a,"");this.attribute[a]=""}};SBGrid.CT.Attribute.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.Attribute.prototype.setAttribute=function(c,a){if(SBGrid.DEF.SB_STYLELIST[c]){SBGrid.UT.HtmlLib.setStyle(this.m_heControl,c,a)}else{if("style"==c){var e=a.split(";");for(var b=0;b<e.length-1;b++){var d=e[b].split(":");this.setAttribute(d[0].replace(" ",""),d[1].replace(" ",""))}return}}this.attribute[c]=a};SBGrid.CT.Attribute.prototype.applyDefaultStyle=function(){};SBGrid.CT.Attribute.prototype.setChildStyle=function(){};SBGrid.CT.Attribute.prototype.setNotObjToChildStyle=function(){if(!this.parent||!this.parent.m_heControl){return}if(!this.attribute["font-family"]){this.setAttribute("font-family",this.parent.m_heControl.style.fontFamily)}if(!this.attribute["font-size"]){this.setAttribute("font-size",this.parent.m_heControl.style.fontSize)}if(!this.attribute["font-weight"]){this.setAttribute("font-weight",this.parent.m_heControl.style.fontWeight)}if(!this.attribute["font-style"]){this.setAttribute("font-style",this.parent.m_heControl.style.fontStyle)}if(!this.attribute["text-decoration"]){this.setAttribute("text-decoration",this.parent.m_heControl.style.textDecoration)}if(!this.attribute.color){this.setAttribute("color",this.parent.m_heControl.style.color)}if(!this.attribute["line-height"]){this.setAttribute("line-height",this.parent.m_heControl.style.lineHeight)}if(!this.attribute["letter-spacing"]){this.setAttribute("line-height",this.parent.m_heControl.style.letterSpacing)}if(!this.attribute["background-repeat"]){this.setAttribute("line-height",this.parent.m_heControl.style.backgroundRepeat)}if(!this.attribute.cursor){this.setAttribute("line-height",this.parent.m_heControl.style.cursor)}};SBGrid.CT.Attribute.createAttribute=function(b,a){return b};SBGrid.CT.Attribute.prototype.setHoverStyle=function(a){this.m_htHoverStyle=a};SBGrid.CT.Attribute.prototype.getHoverAttribute=function(b){var a=null;if(null!=this.m_htHoverStyle){return this.m_htHoverStyle[b]}return a};SBGrid.CT.Attribute.prototype.setHoverAttribute=function(b,a){if(null==this.m_htHoverStyle){this.m_htHoverStyle=new SBGrid.DS.Hashtable()}this.m_htHoverStyle[b]=a};SBGrid.CT.Attribute.prototype.setDownStyle=function(a){this.m_htDownStyle=a};SBGrid.CT.Attribute.prototype.getDownAttribute=function(b){var a=null;if(null!=this.m_htDownStyle){return this.m_htDownStyle[b]}return a};SBGrid.CT.Attribute.prototype.setDownAttribute=function(b,a){if(null==this.m_htDownStyle){this.m_htDownStyle=new SBGrid.DS.Hashtable()}this.m_htDownStyle[b]=a};SBGrid.CT.Attribute.prototype.setFocusStyle=function(a){this.m_htFocusStyle=a};SBGrid.CT.Attribute.prototype.getFocusAttribute=function(b){var a=null;if(null!=this.m_htFocusStyle){return this.m_htFocusStyle[b]}return a};SBGrid.CT.Attribute.prototype.setFocusAttribute=function(b,a){if(null==this.m_htFocusStyle){this.m_htFocusStyle=new SBGrid.DS.Hashtable()}this.m_htFocusStyle[b]=a};SBGrid.CT.Attribute.prototype.setDisableStyle=function(a){this.m_htDisableStyle=a};SBGrid.CT.Attribute.prototype.getDisableAttribute=function(b){var a=null;if(null!=this.m_htDisableStyle){return this.m_htDisableStyle[b]}return a};SBGrid.CT.Attribute.prototype.setDisableAttribute=function(b,a){if(null==this.m_htDisableStyle){this.m_htDisableStyle=new SBGrid.DS.Hashtable()}this.m_htDisableStyle[b]=a};SBGrid.CT.Attribute.prototype.setSelectStyle=function(a){this.m_htSelectStyle=a};SBGrid.CT.Attribute.prototype.getSelectAttribute=function(b){var a=null;if(null!=this.m_htSelectStyle){return this.m_htSelectStyle[b]}return a};SBGrid.CT.Attribute.prototype.setSelectAttribute=function(b,a){if(null==this.m_htSelectStyle){this.m_htSelectStyle=new SBGrid.DS.Hashtable()}this.m_htSelectStyle[b]=a};SBGrid.CT.Attribute.prototype.getSelectAttribute=function(a){if(null==this.m_htSelectStyle){return""}return this.m_htSelectStyle[a]};SBGrid.CT.Element=function(a,c,b){if(!c){return}SBGrid.CT.Attribute.call(this,a,c,b);this.m_hmEvent=new SBGrid.DS.Hashtable();this.m_objRefElement=null};SBGrid.CT.Element.prototype=new SBGrid.CT.Attribute;SBGrid.CT.Element.prototype.init=function(){};SBGrid.CT.Element.prototype.getElement=function(){return this};SBGrid.CT.Element.prototype.getRefElement=function(){return this.m_objRefElement};SBGrid.CT.Element.prototype.setRefElement=function(a){this.m_objRefElement=a};SBGrid.CT.Element.prototype.isCSSValid=function(b){var a=false;if((null==this.attribute[b]||""==this.attribute[b])&&(null==SBGrid.UT.HtmlLib.getStyle(this.m_heControl,b)||""==SBGrid.UT.HtmlLib.getStyle(this.m_heControl,b))){a=true}return a};SBGrid.CT.Element.prototype.createChild=function(strElementName,strAttribute){strAttribute=strAttribute.trim();if(";"==strAttribute.charAt(strAttribute.length-1)){strAttribute=strAttribute.substring(0,strAttribute.length-1)}var arAttribute=strAttribute.split(";");var strStyle="";var clAttribute=new SBGrid.DS.Collection();var strAttributeName;var strAttributeValue;for(var i=0;i<arAttribute.length;i++){if(null!=arAttribute[i]&&""!=arAttribute[i]){var arAttributeUnit=arAttribute[i].split(":");if(3==arAttributeUnit.length){arAttributeUnit[1]=arAttributeUnit[1]+":"+arAttributeUnit[2];arAttributeUnit.splice(2,1)}else{if(2!=arAttributeUnit.length){continue}}strAttributeName=arAttributeUnit[0].trim();strAttributeValue=arAttributeUnit[1].trim();if(null!=strAttributeValue&&""!=strAttributeValue){clAttribute.add(strAttributeName,strAttributeValue);if(SBGrid.DEF.SB_STYLELIST[strAttributeName]){strStyle+=strAttributeName+":"+strAttributeValue+";"}}}}if(this.m_clCSSName){var arKeys=this.m_clCSSName.keys();for(var i=0;i<this.m_clCSSName.length;i++){clAttribute.add(arKeys[i],this.m_clCSSName.item(arKeys[i]))}}var objChild;var strId=clAttribute.item("id");if(document.SBHE_allElement.m_htCollection[strId]){return document.SBHE_allElement.m_htCollection[strId]}if(null==strId){if(null==this.m_nChildCount){this.m_nChildCount=1}clAttribute.add("id",this.id+"_children"+this.m_nChildCount);this.m_nChildCount++}if("softbowl:input"==strElementName){objChild=SBGrid.CT.Input.create(this.id,clAttribute,strStyle)}else{if("softbowl:inputbutton"==strElementName){objChild=SBGrid.CT.InputButton.create(this.id,clAttribute,strStyle)}else{if("softbowl:calendar"==strElementName){objChild=SBGrid.CT.Calendar.create(this.id,clAttribute,strStyle)}else{if("softbowl:caption"==strElementName){objChild=SBGrid.CT.Caption.create(this.id,clAttribute,strStyle)}else{if("softbowl:output"==strElementName){objChild=SBGrid.CT.Output.create(this.id,clAttribute,strStyle)}else{if("softbowl:secret"==strElementName){objChild=SBGrid.CT.Secret.create(this.id,clAttribute,strStyle)}else{if("softbowl:textarea"==strElementName){objChild=SBGrid.CT.TextArea.create(this.id,clAttribute,strStyle)}else{if("softbowl:button"==strElementName){objChild=SBGrid.CT.Button.create(this.id,clAttribute,strStyle)}else{if("softbowl:select"==strElementName){objChild=SBGrid.CT.Select.create(this.id,clAttribute,strStyle)}else{if("softbowl:select1"==strElementName){objChild=SBGrid.CT.Select1.create(this.id,clAttribute,strStyle)}else{if("softbowl:selectitem"==strElementName){objChild=SBGrid.CT.SelectItem.create(this.id,clAttribute,strStyle)}else{if("softbowl:comboinput"==strElementName){objChild=SBGrid.CT.Input.create(this.id,clAttribute,strStyle)}else{if("softbowl:combobutton"==strElementName){objChild=SBGrid.CT.Button.create(this.id,clAttribute,strStyle)}else{if("softbowl:img"==strElementName){objChild=SBGrid.CT.Img.create(this.id,clAttribute,strStyle)}else{if("softbowl:group"==strElementName){objChild=SBGrid.CT.Group.create(this.id,clAttribute,strStyle)}else{if("softbowl:datagrid"==strElementName){}else{if("softbowl:gridfixedcell"==strElementName){objChild=SBGrid.CT.GridFixedCell.create(this.id,clAttribute,strStyle)}else{if("softbowl:col"==strElementName){objChild=SBGrid.CT.GridCol.create(this.id,clAttribute,strStyle)}else{if("softbowl:gridinput"==strElementName){objChild=SBGrid.CT.GridInput.create(this.id,clAttribute,strStyle)}else{if("softbowl:choices"==strElementName){objChild=SBGrid.DS.Choices.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:itemset"==strElementName){objChild=SBGrid.DS.Itemset.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:label"==strElementName){objChild=SBGrid.DS.Label.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:value"==strElementName){objChild=SBGrid.DS.Value.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:depth"==strElementName){objChild=SBGrid.DS.Depth.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:image"==strElementName){objChild=SBGrid.CT.Image.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:selectedimage"==strElementName){objChild=SBGrid.CT.SelectedImage.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:expandedimage"==strElementName){objChild=SBGrid.CT.ExpandedImage.create(this.id,clAttribute,strStyle);return objChild}else{if("softbowl:DIV"==strElementName){objChild=SBGrid.CT.DIV.create(this.id,clAttribute,strStyle);return objChild}else{return null}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(objChild){objChild.init();if(48<=objChild.id.charCodeAt(0)&&objChild.id.charCodeAt(0)<=57){SBGrid.DEF.errorMsg("동적 생성하려는 control 의 id 가 숫자로 시작됩니다. ["+objChild.id+"]")}else{if(-1==objChild.id.indexOf(".")){window.eval("try{window."+objChild.id+" = document.SBHE_allElement.item('"+objChild.id+"');}catch(e){}")}}}return objChild};SBGrid.CT.Element.prototype.removeChild=function(h){var l=this.children.item(h);if(!h||!l){return}var a=l.children;if(null!=a){var c=a.length;for(var d=0;d<c;d++){var g=a.item(0).id;l.removeChild(g)}}var m=l.m_heControl;if(m){var b=m.parentNode;if(b){if("IFRAME"==l.m_heControl.tagName){try{l.m_heControl.src=""}catch(f){}}b.removeChild(l.m_heControl)}}if(document.getElementById("SBHE_"+h+"_allitem")){document.getElementById("SBHE_"+h+"_allitem").parentNode.removeChild(document.getElementById("SBHE_"+h+"_allitem"));SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=false}this.children.remove(h);document.SBHE_allElement.remove(h)};SBGrid.CT.Element.prototype.getAbility=function(){return 0};SBGrid.CT.Element.prototype.isEnable=function(){return true};SBGrid.CT.Element.prototype.getAttribute=function(a){var b="";if(this.m_objRefElement){b=this.m_objRefElement.getAttribute(a)}if(null==b||""==b||-1<a.indexOf("align")||-1<a.indexOf("font")){b=SBGrid.CT.Attribute.prototype.getAttribute.call(this,a);if(null==b){b=""}}return b};SBGrid.CT.Element.prototype.setAttribute=function(b,a){SBGrid.CT.Attribute.prototype.setAttribute.call(this,b,a);switch(b){case"onselect":this.addEventListener("onselect",this.id+"_softbowl_select","","");break;case"ondeselect":this.addEventListener("ondeselect",this.id+"_softbowl_deselect","","");break;case"softbowl-noneselect":this.addEventListener("softbowl-noneselect",this.id+"_softbowl_noneselect","","");break;case"onendedit":this.addEventListener("onendedit",this.id+"_onendedit","","");break;case"onmouseactivate":this.addEventListener("onmouseactivate",this.id+"_onmouseactivate","","");break;case"onmousemove":this.addEventListener("onmousemove",this.id+"_onmousemove","","");break;case"onmousedown":this.addEventListener("onmousedown",this.id+"_onmousedown","","");break;case"onmouseenter":this.addEventListener("onmouseenter",this.id+"_onmouseenter","","");break;case"onmouseup":this.addEventListener("onmouseup",this.id+"_onmouseup","","");break;case"oncursor":this.addEventListener("oncursor",this.id+"_oncursor","","");break;case"onmouseover":this.addEventListener("onmouseover",this.id+"_onmouseover","","");break;case"onmouseout":this.addEventListener("onmouseout",this.id+"_onmouseout","","");break;case"onclick":this.addEventListener("onclick",this.id+"_onclick","","");break;case"ondblclick":this.addEventListener("ondblclick",this.id+"_ondblclick","","");break;case"onblur":this.addEventListener("onblur",this.id+"_onblur","","");break;case"onkeypress":this.addEventListener("onkeypress",this.id+"_onkeypress","","");break;case"onkeydown":this.addEventListener("onkeydown",this.id+"_onkeydown","","");break;case"onkeyup":this.addEventListener("onkeyup",this.id+"_onkeyup","","");break;case"onscrolldown":this.addEventListener("onscrolldown",this.id+"_onscrolldown","","");break;case"onscrollup":this.addEventListener("onscrollup",this.id+"_onscrollup","","");break;case"onscrollpagedown":this.addEventListener("onscrollpagedown",this.id+"_onscrollpagedown","","");break;case"onscrollpageup":this.addEventListener("onscrollpageup",this.id+"_onscrollpageup","","");break;case"onscrollpos":this.addEventListener("onscrollpos",this.id+"_onscrollpos","","");break;case"onscrolltrack":this.addEventListener("onscrolltrack",this.id+"_onscrolltrack","","");break;case"onscrolltrackdown":this.addEventListener("onscrolltrackdown",this.id+"_onscrolltrackdown","","");break;case"onscrolltrackup":this.addEventListener("onscrolltrackup",this.id+"_onscrolltrackup","","");break;case"onscroll":this.addEventListener("onscroll",this.id+"_onscroll","","");break;case"onmousewheel":this.addEventListener("onmousewheel",this.id+"_onmousewheel","","");break;case"ontimer":this.addEventListener("ontimer",this.id+"_ontimer","","");break;case"onnext":this.addEventListener("onnext",this.id+"_onnext","","");break;case"onprevious":this.addEventListener("onprevious",this.id+"_onprevious","","");break;case"oninvalid":this.addEventListener("oninvalid",this.id+"_softbowl_invalid","","");break;case"onoptional":this.addEventListener("onoptional",this.id+"_softbowl_optional","","");break;case"onreadonly":this.addEventListener("onreadonly",this.id+"_softbowl_readonly","","");break;case"onreadwrite":this.addEventListener("onreadwrite",this.id+"_softbowl_readwrite","","");break;case"onrequired":this.addEventListener("onrequired",this.id+"_softbowl_required","","");break;case"onvalid":this.addEventListener("onvalid",this.id+"_softbowl_valid","","");break;case"onenabled":this.addEventListener("onenabled",this.id+"_softbowl_enabled","","");break;case"ondisabled":this.addEventListener("ondisabled",this.id+"_softbowl_disabled","","");break;case"ondragenter":this.addEventListener("ondragenter",this.id+"_ondragenter","","");break;case"ondragleave":this.addEventListener("ondragleave",this.id+"_ondragleave","","");break;case"ondrop":this.addEventListener("ondrop",this.id+"_ondrop","","");break;case"ondragover":this.addEventListener("ondragover",this.id+"_ondragover","","");break;case"ondragstart":this.addEventListener("ondragstart",this.id+"_ondragstart","","");break;case"onscrollmax":this.addEventListener("onscrollmax",this.id+"_onscrollmax","","");break;case"onscrollmin":this.addEventListener("onscrollmin",this.id+"_onscrollmin","","");break;case"onbeforeedit":this.addEventListener("onbeforeedit",this.id+"_onbeforeedit","","");break;case"onstartedit":this.addEventListener("onstartedit",this.id+"_onstartedit","","");break;case"onentercell":this.addEventListener("onentercell",this.id+"_onentercell","","");break;case"onleavecell":this.addEventListener("onleavecell",this.id+"_onleavecell","","");break;case"onafteredit":this.addEventListener("onafteredit",this.id+"_onafteredit","","");break;case"onbeforeuserresize":this.addEventListener("onbeforeuserresize",this.id+"_onbeforeuserresize","","");break;case"onafteruserresize":this.addEventListener("onafteruserresize",this.id+"_onafteruserresize","","");break;case"onbeforemovecolumn":this.addEventListener("onbeforemovecolumn",this.id+"_onbeforemovecolumn","","");break;case"onaftermovecolumn":this.addEventListener("onaftermovecolumn",this.id+"_onaftermovecolumn","","");break;case"onimestart":this.addEventListener("onimestart",this.id+"_onimestart","","");break;case"onspinupbuttonclick":this.addEventListener("onspinupbuttonclick",this.id+"_onspinupbuttonclick","","");break;case"onspindownbuttonclick":this.addEventListener("onspindownbuttonclick",this.id+"_onspindownbuttonclick","","");break;case"onbuttonclick":this.addEventListener("onbuttonclick",this.id+"_onbuttonclick","","");break;case"ondayselect":this.addEventListener("ondayselect",this.id+"_ondayselect","","");break;case"oncolorselect":this.addEventListener("oncolorselect",this.id+"_oncolorselect","","");break;case"onautomaticcolor":this.addEventListener("onautomaticcolor",this.id+"_onautomaticcolor","","");break;case"oncustomcolor":this.addEventListener("oncustomcolor",this.id+"_oncustomcolor","","");break;case"onhidepopup":this.addEventListener("onhidepopup",this.id+"_onhidepopup","","");break;case"onbeforevalidation":this.addEventListener("onbeforevalidation",this.id+"_onbeforevalidation","","");break;case"oninvalidformat":this.addEventListener("oninvalidformat",this.id+"_oninvalidformat","","");break;case"onglobalmousedown":this.addEventListener("onglobalmousedown",this.id+"_onglobalmousedown","","");break;case"onrowchanged":this.addEventListener("onrowchanged",this.id+"_onrowchanged","","");break}};SBGrid.CT.Element.prototype.setText=function(a){SBGrid.CT.ElementBase.prototype.setText.call(this,a);this.attribute.text=a};SBGrid.CT.Element.prototype.dispatch=function(o,d,f,n){var c=SBGrid.DEF._W_getCurrentEvent();var g=c.name;var m=c.target;var e=c.currentTarget;var a=c.description;var h=c.propagate;var l=c.defaultAction;c.name=o;c.target=this.getId();c.currentTarget=c.target;if(null!=d){c.description=d}if(null!=f){c.propagate=f}if(null!=n){c.defaultAction=n}if(SBGrid.DEF.is_smartphone&&"onclick"==o){if(SBGrid.DEF.isSmartPhoneDblClick(this.getId())){SBGrid.DEF.removePrevClickInfo();this.dispatch("ondblclick");return}else{var b=new Date();SBGrid.DEF.setPrevClickInfo(this.getId(),b.getTime())}}c.m_nRef++;if(c.m_nRef>32){c.m_nRef--;return}if(""!=c.capture){var i=document.SBHE_allElement.m_htCollection[c.capture];if(null!=i&&SBGrid.DEF.SBEA_HSB_AS_EVENT&i.getAbility()){if("cancel"!=c.defaultAction){i.onCapture(c)}}}this.internalDispatch(o);c.name=g;c.target=m;c.currentTarget=e;c.description=a;c.propagate=h;c.defaultAction=l;c.m_nRef--};SBGrid.CT.Element.prototype.addEventListener=function(i,b,a,f,h,e,d){var g=new SBGrid.EVT();g.name=i;g.handler=b;g.propagate=a;g.defaultAction=f;if("inPacking_destroy"==b){g.ref=h}else{if("inPacking_dispatch"==b){g.dispatchtarget=h;g.dispatchtargetname=e}else{if("inPacking_load"==b){g.resource=h;g.show=e}else{if("inPacking_message"==b){g.src=h;g.level=e;g.text=d}else{if("inPacking_reset"==b){g.model=h}else{if("inPacking_send"==b){g.submission=h}else{if("inPacking_setfocus"==b){g.control=h}else{if("inPacking_setvalue"==b){g.ref=h;g.value=e}else{if("inPacking_toggle"==b){g.togglecase=h}}}}}}}}}var c=this.m_hmEvent[i];if(c){if(-1==c[0].handler.indexOf("_model")){return}else{if(1<c.length){return}}c.push(g)}else{c=new Array();c.push(g);this.m_hmEvent[i]=c}};SBGrid.CT.Element.prototype.eventAddAttribute=function(b,a){b.handler=a.handler;b.propagate=a.propagate;b.defaultAction=a.defaultAction;if("inPacking_destroy"==b.handler){b.ref=a.ref}else{if("inPacking_dispatch"==b.handler){b.dispatchtarget=a.dispatchtarget;b.dispatchtargetname=a.dispatchtargetname}else{if("inPacking_load"==b.handler){b.resource=a.resource;b.show=a.show}else{if("inPacking_message"==b.handler){b.src=a.src;b.level=a.level;b.text=a.text}else{if("inPacking_reset"==b.handler){b.text=a.model}else{if("inPacking_send"==b.handler){b.submission=a.submission}else{if("inPacking_setfocus"==b.handler){b.control=a.control}else{if("inPacking_setvalue"==b.handler){b.ref=a.ref;b.value=a.value}else{if("inPacking_toggle"==b.handler){b.togglecase=a.togglecase}}}}}}}}}return b};SBGrid.CT.Element.prototype.internalDispatch=function(f){var d=SBGrid.DEF._W_getCurrentEvent();d.name=f;d.currentTarget=this.getId();d.propagate="";d.defaultAction="";this.preTranslateEvent(d);var e="";if(d.name){e=d.name;e=e.replaceAll("-","_")}if(!("stop"==d.propagate)){this.fireEvent(e)}var c=this.m_hmEvent[f];if(c&&!("stop"==d.propagate)){for(var b=0;b<c.length;b++){var a=c[b];this.runAction(this.eventAddAttribute(d,a))}}if(!("cancel"==d.defaultAction)){this.defaultAction(f,d)}if(!("stop"==d.propagate)){this.bubbles(f,d)}else{this.m_bStopPropagation=true}d.handler="";d.description="";d.propagate="";d.defaultAction=""};SBGrid.CT.Element.prototype.preTranslateEvent=function(a){};SBGrid.CT.Element.prototype.runAction=function(event){if(""!=event.handler){var strFunction="if (window."+event.handler+"){"+event.handler+"(event);}";eval(strFunction)}if(null!=this.getAttribute(event.name)){eval(this.getAttribute(event.name))}};SBGrid.CT.Element.prototype.fireEvent=function(strFunctionName){if(SBGrid.DEF.m_arGlobalEventFireList[strFunctionName]){var strFunction=strFunctionName+"();";eval(strFunction)}};SBGrid.CT.Element.getSelector=function(c,d,b){var a=c.split(".");if(1==a.length){return c}if(2==a.length){return a[0]}};SBGrid.CT.Element.createClassName=function(g,m){var o="";var n=SBGrid.DEF.cssName.split(";");var l="";if("select1"==m){if(g.exists("appearance")){var c=g.item("appearance");if("full"==c){l="radio"}else{if("minimal"==c){l="combo"}}}}else{if("select"==m){if(g.exists("appearance")){var c=g.item("appearance");if("full"==c){l="checkbox"}else{if("compact"==c){l="listbox"}}}}else{if("treeview"==m){l="treeitem"}else{if("input"==m){l="inputbutton"}}}}for(var e=0;e<n.length;e++){var h=n[e];if(""==h){continue}var d=h.split(":");var b=d[0].split("_");var f=b[0];var a=b[1];if(-1!=f.indexOf(".")){f=SBGrid.CT.Element.getSelector(f,m,g)}if("class"==f){if(m==a){if(g.exists("class")&&""!=g.item("class")){g.add("class",g.item("class")+" "+d[1])}else{g.add("class",d[1])}}else{if(l==a){if(g.exists("class")&&""!=g.item("class")){g.add("class",g.item("class")+" "+d[1])}else{g.add("class",d[1])}}}}else{if(m==f){g.add(d[0],d[1])}else{if(""!=l){if(l==f||l==f){g.add(d[0],d[1])}}}}}return g};SBGrid.CT.Element.prototype.bubbles=function(c,b){var a=this.parent;if(null!=a&&a instanceof SBGrid.CT.Element&&(a.getAbility()&SBGrid.DEF.SBEA_HSB_AS_EVENT)){a.internalDispatch(c,b)}};SBGrid.CT.Element.prototype.onCapture=function(){};SBGrid.CT.Element.createAttribute=function(b,a){b=SBGrid.CT.Attribute.createAttribute(b,a);return b};SBGrid.DS.XMLStorage=function(a,d,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.attribute.autocdata=d=false;this.autocdata;this.instances=new SBGrid.DS.Collection();this.property=new SBGrid.DS.Hashtable();this.propertyReg;this.registry;this.m_objTabIndex=new Array();this.m_objHttpClient=new SBGrid.UT.HttpClient();this.m_objCurrentSubmission;this.m_bDoneUnload=false;this.m_hmInstanceData=null;this.m_bHasUploadFile=false;this.m_strSessionId="";this.m_resetRoot=null;if(SBGrid.DS.XMLStorage.isEmptyUniqueStorage()){SBGrid.DS.XMLStorage.setUniqueStorage(this)}};SBGrid.DS.XMLStorage.prototype=new SBGrid.CT.Element;SBGrid.DS.XMLStorage.m_UniqueStorage=null;SBGrid.DS.XMLStorage.isEmptyUniqueStorage=function(){return SBGrid.DS.XMLStorage.m_UniqueStorage==null};SBGrid.DS.XMLStorage.getUniqueStorage=function(){if(SBGrid.DS.XMLStorage.isEmptyUniqueStorage()){new SBGrid.DS.XMLStorage("head",false,"model1","softbowl:model");new SBGrid.DS.Instance("model1","instance1",false,"softbowl:instance","","","<root></root>")}return SBGrid.DS.XMLStorage.m_UniqueStorage};SBGrid.DS.XMLStorage.setUniqueStorage=function(a){SBGrid.DS.XMLStorage.m_UniqueStorage=a};SBGrid.DS.XMLStorage.prototype.getId=function(){return this.id};SBGrid.DS.XMLStorage.prototype.alert=function(c,a,b){if(b){if(32|4==b){return true==confirm(c)?6:7}}else{window.alert(c)}return 1};SBGrid.DS.XMLStorage.prototype.copyNode=function(c,e){var a=null;if("string"==typeof(c)){a=this.getInstanceSinglePart(null,c)}else{a=c}var g=null;if("string"==typeof(e)){g=this.getInstanceSinglePart(null,e)}else{g=e}if(null!=a&&null!=g){var f=a.childNodes;if(null!=f){for(var b=f.length-1;b>=0;b--){var d=f[b];if(null!=d){a.removeChild(f[b])}}}f=g.childNodes;if(null!=f){for(var b=0;b<f.length;b++){var d=f[b];if(null!=d){a.appendChild(d.cloneNode(true))}}}}};SBGrid.DS.XMLStorage.prototype.destroy=function(b){var c=null;if("string"==typeof(b)){c=this.getInstanceSinglePart(null,b)}else{c=b}if(null!=c){var a=c.parentNode;if(null!=a){a.removeChild(c)}}};SBGrid.DS.XMLStorage.prototype.duplicate=function(c,d,g){var f=null;if("string"==typeof(c)){f=this.getInstanceSinglePart(null,c)}else{f=c}var b=null;if("string"==typeof(d)){b=this.getInstanceSinglePart(null,d)}else{b=d}if(null!=f&&null!=b){var e=b.cloneNode(true);if(null==g||g.isEmpty()){f.appendChild(e)}else{var a=SBGrid.UT.XmlLib.selectSingleNode(f,g);if(null!=f){f.insertBefore(e,a)}}}};SBGrid.DS.XMLStorage.prototype.getValue=function(b){if("string"==typeof(b)){var c=this.getInstance();if(null!=c){var a=c.documentElement;if(null!=a){var d=SBGrid.UT.XmlLib.selectSingleNode(a,b);if(null!=d){return SBGrid.UT.XmlLib.getTextValue(d)}}}return""}else{return SBGrid.UT.XmlLib.getTextValue(b)}};SBGrid.DS.XMLStorage.prototype.getXPathValue=function(b){if(SBGrid.DEF.is_ie){return xPathOperation(b)}else{var a=SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().documentElement.evaluate(b,instance1.documentElement,null,XPathResult.STRING_TYPE,null);return a.stringValue}};SBGrid.DS.XMLStorage.prototype.makeNodeSearch=function(i,n,a){if(null==i||""==i){return false}var m=this.getInstanceDocument();if(!m){return null}var d=m.selectSingleNode(i);if(d){if(null!=i&&""!=i&&null!=n){if(a){SBGrid.UT.XmlLib.createCDATASection(d,n)}else{SBGrid.UT.XmlLib.setTextValue(d,n)}}return null}else{var c=i.lastIndexOf("/");var h=i.substring(c+1,i.length);var g="";if(-1==c){g="/root"}else{g=i.substring(0,c)}var e=null;var o=h.indexOf("[");if(-1!=o){var b=o+1;var p=h.indexOf("]");e=h.substring(b,p);if(isFinite(e)){e=parseInt(e);h=h.substr(0,o)}}var f=m.createElement(h);if(null!=i&&""!=i){if(null!=n){if(a){SBGrid.UT.XmlLib.createCDATASection(f,n)}else{SBGrid.UT.XmlLib.setTextValue(f,n)}}}var l=m.selectSingleNode(g);if(l){l.appendChild(f);return f}else{return this.makeNodeSearch(g).appendChild(f)}}};SBGrid.DS.XMLStorage.prototype.makeNode=function(g){if(null==g||""==g){return false}g=g.trim();var e="";var l=false;if(0==g.indexOf("instance('")){e=g.substr("instance('".length);var a=e.indexOf("'");if(0>a){return false}e=e.substring(a+1);l=true}var h=this.getInstanceDocument();if(!h){return false}var c=h.firstChild;var d=c.childNodes;var f;var b;var m;var i=g;if(!l){if(-1!=a){this.makeNodeSearch(g)}}return true};SBGrid.DS.XMLStorage.prototype.searchNode=function(g,f){var c=null;if(!g){return null}if(-1!=f.indexOf("[")){var h=f.indexOf("[");var a=f.indexOf("]");if(isFinite(f.substring(h+1,a))){c=Number(f.substring(h+1,a));f=f.substr(0,h)}}var e=0;for(var b=0;b<g.length;b++){var d=g.item(b);if(null!=d&&f==d.nodeName){e++;if(null==c){return d}else{if(e==c){return d}}}}return null};SBGrid.DS.XMLStorage.prototype.makeValue=function(i,m,a){if(null==i||""==i){return false}i=i.trim();var f="";var o=false;var h=this.getInstance();if(0==i.indexOf("instance('")){f=i.substr("instance('".length);var b=f.indexOf("'");if(0>b){return false}f=f.substring(b+1);o=true}var l=this.getInstanceDocument();if(!l){return false}var d=l.firstChild;var e=d.childNodes;var g;var c;var p;var n=i;if(!o){if(-1!=b){this.makeNodeSearch(i,m,a)}}};SBGrid.DS.XMLStorage.prototype.propertynames=function(d){var b="";if(null==d){d=""}var c=0;for(var a in this.property){b+=(a+d);c++}if(0<c){b=b.substr(0,b.length-d.length)}return b};SBGrid.DS.XMLStorage.prototype.refreshCurrentModel=function(a){if(null==a){a=true}if(a){this.recalculate();this.refresh()}else{this.refresh()}};SBGrid.DS.XMLStorage.prototype.recalculate=function(){var a=this.children.keys();for(var b=0;b<a.length;b++){var d=a[b];var c=this.children.item(d);if(c instanceof SBGrid.CT.Bind){c.bindExecute()}}};SBGrid.DS.XMLStorage.prototype.refresh=function(){var b=this.children.keys();for(var d=0;d<b.length;d++){var e=b[d];var a=this.children.item(e);if(null!=a){if(a.refresh){a.refresh()}}}var c=SBGrid.DS.SBBody;if(null==c){c=document.SBHE_allElement("body")}if(null!=c){c.refresh()}};SBGrid.DS.XMLStorage.prototype.refreshpart=function(){var a=this.instances.item("instance1");if(null!=a){if(0<arguments.length){var f=arguments[0];var b=document.SBHE_controls.keys();for(var c=0;c<b.length;c++){var e=b[c];var d=document.SBHE_controls.item(e);if(0==d.getAttribute("ref").indexOf(f)||0==d.getAttribute("nodeset").indexOf(f)){d.refresh()}}}}};SBGrid.DS.XMLStorage.prototype.removenode=function(a){this.removeNode(a)};SBGrid.DS.XMLStorage.prototype.removeNode=function(a){var d=this.getInstanceDocument();if(null!=d){var b=SBGrid.UT.XmlLib.selectSingleNode(d,a);if(null!=b){var c=b.parentNode;if(null!=c){c.removeChild(b)}}}};SBGrid.DS.XMLStorage.prototype.selectSingleNode=function(a){var c=this.getInstanceDocument();var b=null;if(null!=c){b=SBGrid.UT.XmlLib.selectSingleNode(c,a)}return b};SBGrid.DS.XMLStorage.prototype.selectNodes=function(b){var c=this.getInstanceDocument();var a=null;if(null!=c){a=SBGrid.UT.XmlLib.selectNodes(c,b)}return a};SBGrid.DS.XMLStorage.prototype.removeNodeset=function(a){var f=this.getInstanceDocument();if(null!=f){var c=SBGrid.UT.XmlLib.selectNodes(f,a);for(var b=0;b<c.length;b++){var d=c.item(b);if(null!=d){var e=d.parentNode;if(null!=e){e.removeChild(d)}}}}};SBGrid.DS.XMLStorage.prototype.resetInstanceNode=function(a){if(null==a||""==a){return}var f=this.getInstanceDocument();if(null!=f){var e;var g;var c=SBGrid.UT.XmlLib.selectNodes(f,a);for(var b=0;b<c.length;b++){var d=c.item(b);if(null!=d){if(0==b){SBGrid.CF.xnTextNodeDelete(d)}else{e=d.parentNode;if(null!=e){e.removeChild(d)}}}}}};SBGrid.DS.XMLStorage.prototype.getAttribute=function(a){switch(a){case"id":break;default:return"";break}};SBGrid.DS.XMLStorage.prototype.setAttribute=function(b,a){SBGrid.CT.Element.prototype.setAttribute.call(this,b,a)};SBGrid.DS.XMLStorage.prototype.makeLightGridObject=function(strResult,strLightgridId){var strHeader;var strColDefine;var strLightGridData;var arTemp;var arLightGridRowData=new Array();var arLightGridColData;var arCellData;var objLigthGrid;var objRowData;var strLightGridRowData;var nDataColIdx=0;try{arTemp=strResult.split("|");strHeader=arTemp[0];strColDefine=arTemp[1];objLightGrid=document.SBHE_controls.item(strLightgridId);if(objLightGrid.m_bRowHeader){nDataColIdx=1}if(arTemp.length>2){for(var i=2;i<arTemp.length-1;i++){arLightGridColData=arTemp[i].split("^");for(var j=0;j<objLightGrid.m_arColumn.length-nDataColIdx;j++){if(j<arLightGridColData.length){arCellData=arLightGridColData[j].split("!")}else{arCellData=["",""]}arCellData[0]=arCellData[0].replaceAll('"','\\"').replaceAll("\r","\\\r").replaceAll("\n","\\\n");if(j==0){strLightGridRowData=objLightGrid.m_arColumn[j+nDataColIdx].attribute.ref+':"'+arCellData[0]+'"'}else{strLightGridRowData=strLightGridRowData+","+objLightGrid.m_arColumn[j+nDataColIdx].attribute.ref+':"'+arCellData[0]+'"'}}strLightGridRowData="{"+strLightGridRowData+"}";eval("objRowData = "+strLightGridRowData+";");arLightGridRowData.push(objRowData)}eval(strLightgridId+"_delimeterData = arLightGridRowData;");objLightGrid.refreshForHasInstance()}}catch(e){throw new Error("LightGrid Data Make Error")}};SBGrid.DS.XMLStorage.prototype.setValue=function(b,f,d){if(null==d||""==d){d=false}var c=this.getInstance();if(null!=c){var a=c.documentElement;if(null!=a){if(typeof(b)!="string"){SBGrid.UT.XmlLib.setTextValue(b,f,d);c.synchronize()}else{var e=SBGrid.UT.XmlLib.selectSingleNode(a,b);if(null!=e){SBGrid.UT.XmlLib.setTextValue(e,f,d);c.synchronize()}}}}};SBGrid.DS.XMLStorage.prototype.setXPathValue=function(a,b){this.setValue(a,xPathOperation(b))};SBGrid.DS.XMLStorage.prototype.urlencode=function(b,a){return SBGrid.UT.URIEncoder.encode(b,a)};SBGrid.DS.XMLStorage.prototype.isProcessAutoCdata=function(a){a=a+"";if(a.indexOf("&")>0||a.indexOf("<")>0||a.indexOf(">")>0||a.indexOf("'")>0||a.indexOf('"')>0){return true}return false};SBGrid.DS.XMLStorage.prototype.getInstancePart=function(c,b){var a=this.getInstanceDocument(c);return SBGrid.UT.XmlLib.selectNodes(a,b)};SBGrid.DS.XMLStorage.prototype.getInstanceSinglePart=function(c,b){var a=this.getInstanceDocument(c);if(null!=a){var d=SBGrid.UT.XmlLib.selectSingleNode(a,b);return d}return null};SBGrid.DS.XMLStorage.prototype.getInstance=function(d){var c=null;if(0!=this.instances.count()){if(null==d||""==d){var a=this.instances.keys();for(var b=0;b<a.length;b++){var e=a[b];c=this.instances.item(e);if(null!=c){break}}}else{c=this.instances.item(d)}}return c};SBGrid.DS.XMLStorage.prototype.getInstanceDocument=function(b){var c=null;var a=this.getInstance(b);if(null!=a){c=a.documentElement}return c};SBGrid.DS.XMLStorage.prototype.initChildren=function(){var a=this.children.keys();for(var b=0;b<a.length;b++){var d=a[b];var c=this.children.item(d);if(null!=c&&c.init){c.init()}}SBGrid.DEF.__initControls()};SBGrid.DS.XMLStorage.prototype.getTabIndex=function(){return this.m_objTabIndex};SBGrid.DS.XMLStorage.prototype.initTabIndex=function(){for(var a=0;a<this.m_objTabIndex.length;a++){if(this.m_objTabIndex[a]&&this.m_objTabIndex[a].m_heControl){this.m_objTabIndex[a].m_TabIndex=a;this.m_objTabIndex[a].m_heControl.tabIndex=a+1}}};SBGrid.DS.XMLStorage.prototype.replaceTabIndex=function(c,b,a){if(null!=c){this.removeTabIndex(c)}this.addTabIndex(b,a);this.initTabIndex()};SBGrid.DS.XMLStorage.prototype.removeTabIndex=function(a){this.m_objTabIndex.splice(a,1)};SBGrid.DS.XMLStorage.prototype.addTabIndex=function(c,a){if(-1!=c){if(0==this.m_objTabIndex.length){this.m_objTabIndex.push(a);return}for(var b=0;b<this.m_objTabIndex.length;b++){if(c<this.m_objTabIndex[b].navIndex){this.m_objTabIndex.splice(b,0,a);return}}this.m_objTabIndex.push(a)}};SBGrid.DS.XMLStorage.prototype._synchronizeInstances=function(){var a=this.instances.keys();for(var c=0;c<a.length;c++){var d=a[c];var b=this.instances.item(d);if(null!=b){b.synchronize()}}};SBGrid.DS.XMLStorage.prototype.setParentData=function(h,b){if(!h){return}else{if(SBGrid.DEF.Sbgrid_Node.DOCUMENT_NODE==h.nodeType){h=h.firstChild}}var l=this.getInstanceDocument();if(null!=l){var a=SBGrid.UT.XmlLib.selectSingleNode(l,b);if(a&&h){var e=a.childNodes;if(e){var g=e.length;for(var c=0;c<g;c++){a.removeChild(a.lastChild)}}var f=h.childNodes;if(f){for(var c=0;c<f.length;c++){var d=f[c];a.appendChild(d.cloneNode(true))}this._synchronizeInstances()}}}};SBGrid.DS.XMLStorage.prototype.cloneInstances=function(){if(0!=this.instances.count()){var a=this.instances.keys();for(var c=0;c<a.length;c++){var d=a[c];var b=this.instances.item(d);if(null!=b){b.cloneInstances()}}}};SBGrid.DS.XMLStorage.prototype.defaultAction=function(b,a){switch(b){case"softbowl-refresh":this.refresh();break}};SBGrid.DS.XMLStorage.appendInstance=function(f,d,b){var h=document.SBHE_allElement.m_htCollection[b];if(!h){h=model}if(h.instances.exists(f)){var a=h.instances.item(f);if(null!=a){var g=d.root.childNodes;for(var c=0;c<g.length;c++){var e=g[c];SBGrid.UT.XmlLib.importChildNode(a.root,e,true)}}}else{h.instances.add(f,d)}};SBGrid.DS.XMLStorage.prototype.loadXML=function(b){var a=this.getInstance();if(null!=a){a.loadXML(b)}};SBGrid.DS.JsonStorage=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.instances=new SBGrid.DS.Collection();this.property=new SBGrid.DS.Hashtable();this.propertyReg;this.registry;this.m_objTabIndex=new Array();this.m_objHttpClient=new SBGrid.UT.HttpClient();this.m_objCurrentSubmission;this.m_bDoneUnload=false;this.m_hmInstanceData=null;this.m_bHasUploadFile=false;this.m_strSessionId="";this.m_resetRoot=null;if(SBGrid.DS.JsonStorage.isEmptyUniqueStorage()){SBGrid.DS.JsonStorage.setUniqueStorage(this)}};SBGrid.DS.JsonStorage.prototype=new SBGrid.CT.Element;SBGrid.DS.JsonStorage.m_UniqueStorage=null;SBGrid.DS.JsonStorage.isEmptyUniqueStorage=function(){return SBGrid.DS.JsonStorage.m_UniqueStorage==null};SBGrid.DS.JsonStorage.getUniqueStorage=function(){if(SBGrid.DS.JsonStorage.isEmptyUniqueStorage()){new SBGrid.DS.JsonStorage("head","json1","softbowl:json")}return SBGrid.DS.JsonStorage.m_UniqueStorage};SBGrid.DS.JsonStorage.setUniqueStorage=function(a){SBGrid.DS.JsonStorage.m_UniqueStorage=a};SBGrid.DS.JsonStorage.prototype.getId=function(){return this.id};SBGrid.DS.JsonStorage.prototype.copyJson=function(d,c){d.splice(0,d.length);var b=JSON.parse(JSON.stringify(c));for(var a=0;a<b.length;a++){d[a]=b[a]}};SBGrid.DS.JsonStorage.prototype.removeJson=function(b,a){if(a==null||a<0||b.length<a){a=-1}b.splice(a,1)};SBGrid.DS.JsonStorage.prototype.destroy=function(b){var c=null;if("string"==typeof(b)){c=this.getInstanceSinglePart(null,b)}else{c=b}if(null!=c){var a=c.parentNode;if(null!=a){a.removeChild(c)}}};SBGrid.DS.JsonStorage.prototype.duplicate=function(c,d,g){var f=null;if("string"==typeof(c)){f=this.getInstanceSinglePart(null,c)}else{f=c}var b=null;if("string"==typeof(d)){b=this.getInstanceSinglePart(null,d)}else{b=d}if(null!=f&&null!=b){var e=b.cloneNode(true);if(null==g||g.isEmpty()){f.appendChild(e)}else{var a=SBGrid.UT.XmlLib.selectSingleNode(f,g);if(null!=f){f.insertBefore(e,a)}}}};SBGrid.DS.JsonStorage.prototype.getValue=function(strRef){if(strRef!=""&&strRef!=null){try{var strTemp=eval(strRef);return strTemp+""}catch(e){return""}}return""};SBGrid.DS.JsonStorage.prototype.cloneJson=function(a){if(a!=null){return JSON.parse(JSON.stringify(a))}};SBGrid.DS.JsonStorage.prototype.appendJson=function(f,m,l,e){if(l==null||l==""||0>l||f.length<l){l=f.length}var c;var b=JSON.stringify(f);if(b.charAt(0)!="["){c=JSON.parse("["+b+"]")}else{c=JSON.parse(b)}var g=this.cloneJson(m);c.splice(l,0,g);for(var d=0;d<c.length;d++){f[d]=c[d]}if(null!=e){var a=e.m_arUpdateDeleteList;var h=new Array();for(var d=e.fixedRows;d<e.m_nRealRows;d++){h[d]=e.getRowStatus(d)}e.refresh();e.m_arUpdateDeleteList=a;for(var d=e.fixedRows;d<e.m_nRealRows;d++){if(d<l+1){e.setRowStatus(d,h[d]);continue}else{if(d==l+1){e.setRowStatus(d,1);continue}}e.setRowStatus(d+1,h[d-1])}}};SBGrid.DS.JsonStorage.prototype.propertynames=function(d){var b="";if(null==d){d=""}var c=0;for(var a in this.property){b+=(a+d);c++}if(0<c){b=b.substr(0,b.length-d.length)}return b};SBGrid.DS.JsonStorage.prototype.recalculate=function(){var a=this.children.keys();for(var b=0;b<a.length;b++){var d=a[b];var c=this.children.item(d);if(c instanceof SBGrid.CT.Bind){c.bindExecute()}}};SBGrid.DS.JsonStorage.prototype.refresh=function(){var b=this.children.keys();for(var d=0;d<b.length;d++){var e=b[d];var a=this.children.item(e);if(null!=a){if(a.refresh){a.refresh()}}}var c=SBGrid.DS.SBBody;if(null==c){c=document.SBHE_allElement("body")}if(null!=c){c.refresh()}};SBGrid.DS.JsonStorage.prototype.getAttribute=function(a){};SBGrid.DS.JsonStorage.prototype.setAttribute=function(b,a){};SBGrid.DS.JsonStorage.prototype.makeLightGridObject=function(strResult,strMediaTypes){try{if("application/json"==strMediaTypes){return jQuery.parseJSON(strResult)}var objLightGridData={status:null,column:null,data:null};var arResult=strResult.substring(0,strResult.length-1).split("|");var strHeader=arResult[0];strHeader=strHeader.replaceAll("\\^","__SB_CAP_");var arHeader=strHeader.split("^");objLightGridData.status={row:parseInt(arHeader[1]),col:parseInt(arHeader[2])};var arCaptionNames=arHeader[3].split("__SB_CAP_");var arColumnWidths=arHeader[4].split(",");var arColumnTypes=new Array();var arColumnStyles=new Array();var arColumnInfo=arResult[1].split("^");for(var i=0;i<parseInt(arHeader[2]);i++){var strColumnStyle=arColumnInfo[i].split("!")[1];strColumnStyle=(""==strColumnStyle&&null==strColumnStyle)?"":strColumnStyle;arColumnStyles.push(strColumnStyle);var strColumnType=arColumnInfo[i].split("!")[0];strColumnType=(""==strColumnType&&null==strColumnType)?"":strColumnType;arColumnTypes.push(strColumnType)}var strCaptionData="objLightGridData.column = [";for(var i=0;i<parseInt(arHeader[2]);i++){strCaptionData+="{";strCaptionData+="width:"+parseInt(arColumnWidths[i])+", style:'"+arColumnStyles[i]+"', type:'"+arColumnTypes[i]+"', caption:'"+arCaptionNames[i];if(i!=parseInt(arHeader[2])-1){strCaptionData+="'}, "}else{strCaptionData+="'}"}}eval(strCaptionData+"]");var strBodyData="objLightGridData.data = [";for(var i=2;i<arResult.length;i++){var strRowData=arResult[i].substring(0,arResult[i].length-1);var arColData=strRowData.split("^");strBodyData+="[";for(var j=0;j<parseInt(arHeader[2]);j++){var strColData=(""==arColData[j]||null==arColData[j])?"":arColData[j];strBodyData+="{D:'"+strColData;if(j!=parseInt(arHeader[2])-1){strBodyData+="'}, "}else{strBodyData+="'}"}}if(i!=arResult.length-1){strBodyData+="], "}else{strBodyData+="]"}}eval(strBodyData+="]");return objLightGridData}catch(e){return null}};SBGrid.DS.JsonStorage.prototype.setValue=function(strRef,strValue){if(strRef!=""&&strRef!=null){var arrTemp=strValue.split("\r\n");strTemp=arrTemp.join("\\n");eval(strRef+"='"+strTemp+"';")}};SBGrid.DS.JsonStorage.prototype.initChildren=function(){var a=this.children.keys();for(var b=0;b<a.length;b++){var d=a[b];var c=this.children.item(d);if(null!=c&&c.init){c.init()}}SBGrid.DEF.__initControls()};SBGrid.DS.JsonStorage.prototype.getTabIndex=function(){return this.m_objTabIndex};SBGrid.DS.JsonStorage.prototype.initTabIndex=function(){for(var a=0;a<this.m_objTabIndex.length;a++){if(this.m_objTabIndex[a]&&this.m_objTabIndex[a].m_heControl){this.m_objTabIndex[a].m_TabIndex=a;this.m_objTabIndex[a].m_heControl.tabIndex=a+1}}};SBGrid.DS.JsonStorage.prototype.replaceTabIndex=function(c,b,a){if(null!=c){this.removeTabIndex(c)}this.addTabIndex(b,a);this.initTabIndex()};SBGrid.DS.JsonStorage.prototype.removeTabIndex=function(a){this.m_objTabIndex.splice(a,1)};SBGrid.DS.JsonStorage.prototype.addTabIndex=function(c,a){if(-1!=c){if(0==this.m_objTabIndex.length){this.m_objTabIndex.push(a);return}for(var b=0;b<this.m_objTabIndex.length;b++){if(c<this.m_objTabIndex[b].navIndex){this.m_objTabIndex.splice(b,0,a);return}}this.m_objTabIndex.push(a)}};SBGrid.DS.JsonStorage.prototype.defaultAction=function(b,a){switch(b){case"softbowl-recalculate":this.recalculate();break;case"softbowl-refresh":this.refresh();break}};SBGrid.DS.WebDatabase=function(b,c,g,h,d,f,l,a,m){if(!c){return}SBGrid.CT.Element.call(this,b,c,g);this.attribute.name=h;this.attribute.version=d;this.attribute.displayName=f;this.attribute.estimatedSize=l;this.query=new SBGrid.DS.Hashtable();if(!(SBGrid.DEF.is_ie||SBGrid.DEF.is_firefox)){this.database=openDatabase(h,d,f,l,SBGrid.DS.WebDatabase.onError);this.database.transaction(function(n){for(var o=0;o<a.length;o++){n.executeSql(a[o],[],null,SBGrid.DS.WebDatabase.onError)}});for(var e=0;e<m.length;e++){this.query[m[e].strId]=m[e]}}else{SBGrid.DEF.errorMsg("WebDatabase을 지원하지 않습니다.")}};SBGrid.DS.WebDatabase.prototype=new SBGrid.CT.Element;SBGrid.DS.WebDatabase.prototype.execQueryString=function(strQuery,arParam,strJsonRef,strReturnType,objData,bIsCtrl){this.database.transaction(function(tx){tx.executeSql(strQuery,arParam,function(tx,results){var nLength=results.rows.length;if(null!=strJsonRef&&""!=strJsonRef){if(0==nLength){if("object"==strReturnType){eval(strJsonRef+"= null; ")}else{eval(strJsonRef+"= new Array(); ")}}else{if("object"==strReturnType){eval(strJsonRef+" = jQuery.extend({},results.rows.item(0));")}else{eval(strJsonRef+"= new Array();");for(var i=0;i<nLength;i++){eval(strJsonRef+"["+i+"]= jQuery.extend({},results.rows.item("+i+")); ")}}}}if(null!=objData){if(bIsCtrl){objData.refresh()}else{eval(objData+"();")}}},SBGrid.DS.WebDatabase.onError)})};SBGrid.DS.WebDatabase.prototype.execQueryStringToControl=function(d,b,e,c,a){this.execQueryString(d,b,e,c,a,true)};SBGrid.DS.WebDatabase.prototype.execQueryStringToFunction=function(d,a,e,b,c){this.execQueryString(d,a,e,b,c,false)};SBGrid.DS.WebDatabase.prototype.execQuery=function(strQueryId,objData,bIsCtrl){if(null!=this.query[strQueryId]){var objQueryData=this.query[strQueryId];this.database.transaction(function(tx){tx.executeSql(objQueryData.strQuertString,eval(objQueryData.strParam),function(tx,results){var nLength=results.rows.length;if(null!=objQueryData.strJsonRef&&""!=objQueryData.strJsonRef){if(0==nLength){if("object"==objQueryData.strReturnType){eval(objQueryData.strJsonRef+"= null; ")}else{eval(objQueryData.strJsonRef+"= new Array(); ")}}else{if("object"==objQueryData.strReturnType){eval(objQueryData.strJsonRef+"= jQuery.extend({},results.rows.item(0));")}else{eval(objQueryData.strJsonRef+"= new Array();");for(var i=0;i<nLength;i++){eval(objQueryData.strJsonRef+"["+i+"]= jQuery.extend({},results.rows.item("+i+")); ")}}}}if(null!=objData){if(bIsCtrl){objData.refresh()}else{eval(objData+"();")}}},SBGrid.DS.WebDatabase.onError)})}};SBGrid.DS.WebDatabase.prototype.execQueryToControl=function(b,a){this.execQuery(b,a,true)};SBGrid.DS.WebDatabase.prototype.execQueryToFunction=function(b,a){this.execQuery(b,a,false)};SBGrid.DS.WebDatabase.onError=function(a,b){SBGrid.DEF.errorMsg(b.message)};SBGrid.DS.Instance=function(c,f,e,d,a,b,g){if(!f){return}SBGrid.CT.Element.call(this,c,f,d);g=this._restore(g);this.attribute.preservewhitespace=e;this.preserveWhitespace=e;this.encoding=a;this.documentElement=SBGrid.UT.XmlLib.loadXMLFromString(g,e);this.root=this.documentElement.firstChild;this.version=b;this.xml=g;this.m_docClone;SBGrid.DS.XMLStorage.appendInstance(f,this,c)};SBGrid.DS.Instance.prototype=new SBGrid.CT.Element;SBGrid.DS.Instance.prototype.getXml=function(){return this.xml=SBGrid.UT.XmlLib.serializeToString(this.documentElement)};SBGrid.DS.Instance.prototype.getAbility=function(){return SBGrid.DEF.SBEA_HSB_AS_DOM};SBGrid.DS.Instance.prototype.synchronize=function(){this.xml=SBGrid.UT.XmlLib.serializeToString(this.documentElement);this.root=this.documentElement.firstChild};SBGrid.DS.Instance.prototype.createAttribute=function(){};SBGrid.DS.Instance.prototype.createElement=function(a){if(null!=a&&""!=a){return this.documentElement.createElement(a)}};SBGrid.DS.Instance.prototype.createNode=function(d,b,a){var c=null;if("element"==d){c=this.createElement(b)}else{if("attribute"==d){c=this.createAttribute(b)}}return c};SBGrid.DS.Instance.prototype.getElementsByTagName=function(){};SBGrid.DS.Instance.prototype.getXPathString=function(){};SBGrid.DS.Instance.prototype.load=function(){};SBGrid.DS.Instance.prototype.loadXML=function(a){this.xml=a;this.documentElement=SBGrid.UT.XmlLib.loadXMLFromString(a);this.root=this.documentElement.firstChild};SBGrid.DS.Instance.prototype.selectNodes=function(a){return SBGrid.UT.XmlLib.selectNodes(this.documentElement,a)};SBGrid.DS.Instance.prototype.selectNodesXml=function(a){var d="";var c=SBGrid.UT.XmlLib.selectNodes(this.documentElement,a);if(null!=c){for(var b=0;b<c.length;b++){d+=SBGrid.UT.XmlLib.serializeToString(c.item(b))}}return d};SBGrid.DS.Instance.prototype.selectSingleNode=function(a){return SBGrid.UT.XmlLib.selectSingleNode(this.documentElement,a)};SBGrid.DS.Instance.prototype.cloneInstances=function(){};SBGrid.DS.Instance.prototype.getXml=function(){this.synchronize();return this.xml};SBGrid.DS.Instance.prototype._restore=function(a){a=a.split("__SB_N").join("\n");a=a.split("__SB_T").join("\t");a=a.split("__SB_R").join("\r");return a};SBGrid.CT.Bind=function(b,l,f,h,i,m,a,c,e,d,g){if(!l){return}SBGrid.CT.Element.call(this,b,l,f);this.attribute.ref=h;this.attribute.calculate=i;this.attribute.constraint=m;this.attribute.readonly=a;this.attribute.relevant=c;this.attribute.required=e;this.attribute.type=d;this.attribute.script=g;this.bindExecute()};SBGrid.CT.Bind.prototype=new SBGrid.CT.Element;SBGrid.CT.Bind.prototype.bindExecute=function(){if(""!=this.attribute.ref){var strBaseRef=this.attribute.ref;var xlRefNode=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strBaseRef);if(null!=xlRefNode){for(var i=0;i<xlRefNode.length;i++){if(""!=this.attribute.calculate){if(1==xlRefNode.length){SBGrid.DS.XMLStorage.getUniqueStorage().setValue(this.attribute.ref,String(this.bindCalculate(this.transRefDot("calculate"))))}else{SBGrid.UT.XmlLib.setTextValue(xlRefNode.item(i),String(this.bindCalculate(this.attribute.calculate,xlRefNode.item(i))))}}if(""!=this.attribute.constraint){var nConstraintValue;if(1==xlRefNode.length){var nConstraintValue=this.bindCalculate(this.transRefDot("calculate"))}else{var nConstraintValue=this.bindCalculate(this.attribute.calculate,xlRefNode.item(i))}var bBindBoolValue=("0"!=nConstraintValue&&"false"!=nConstraintValue&&""!=nReadonlyValue)?true:false;if(bBindBoolValue){var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){if(this.booleanCheckType(this.attribute.type,this.attribute.ref)){objChild.dispatch("onvalid")}else{objChild.dispatch("oninvalid")}}}}}else{var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset.length;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.dispatch("oninvalid")}}}}}if(""!=this.attribute.readonly){var nReadonlyValue;if(1==xlRefNode.length){var nReadonlyValue=this.bindCalculate(this.transRefDot("readonly"))}else{var nReadonlyValue=this.bindCalculate(this.attribute.readonly,xlRefNode.item(i))}if("0"!=nReadonlyValue&&"false"!=nReadonlyValue&&""!=nReadonlyValue){var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset.length;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.dispatch("onreadonly");objChild.setDisabled(true)}}}}else{var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset.length;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.dispatch("onreadwrite");objChild.setDisabled(false)}}}}}if(""!=this.attribute.relevant){var nRelevantValue;if(1==xlRefNode.length){var nRelevantValue=this.bindCalculate(this.transRefDot("relevant"))}else{var nRelevantValue=this.bindCalculate(this.attribute.relevant,xlRefNode.item(i))}if("0"!=nRelevantValue&&"false"!=nRelevantValue&&""!=nReadonlyValue){var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset.length;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.setVisible(true)}}}}else{var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset.length;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){objChild.setVisible(false)}}}}}if(""!=this.attribute.required){var nRequiredValue;if(1==xlRefNode.length){var nRequiredValue=this.bindCalculate(this.transRefDot("required"))}else{var nRequiredValue=this.bindCalculate(this.attribute.required,xlRefNode.item(i))}var bBindBoolValue=("0"!=nRequiredValue&&"false"!=nRequiredValue&&""!=nReadonlyValue)?true:false;if(bBindBoolValue){var arKeyset=document.SBHE_allElement.keys();for(var j=0;j<arKeyset.length;j++){var strChildName=arKeyset[j];var objChild=document.SBHE_allElement.item(strChildName);if(!(objChild instanceof SBGrid.CT.Bind)){if(this.attribute.ref==objChild.attribute.ref){if(null!=objChild.attribute.required&&objChild.attribute.required){objChild.dispatch("onrequired")}else{if(null!=objChild.attribute.required&&!objChild.attribute.required){objChild.dispatch("onoptional")}}}}}}}}}this.attribute.ref=strBaseRef;if(""!=this.attribute.script){try{window.eval(this.attribute.script)}catch(e){return}}}};SBGrid.CT.Bind.prototype.transRefDot=function(c){var a=this.attribute.ref;var b=this.attribute[c];a=a.substring(0,a.lastIndexOf("/")+1);b=b.replace(/\.\.\//g,a);return b};SBGrid.CT.Bind.prototype.bindCalculate=function(b,a){return xPathOperation(b,a)};SBGrid.CT.Bind.prototype.booleanCheckType=function(b,a){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(a);switch(b){case"xsd:anyURI":return true;break;case"xsd:base64Binary":break;case"xsd:boolean":if("true"==c||"1"==c){return true}else{return false}break;case"xsd:byte":if(""!=c){return true}else{return false}break;case"xsd:date":break;case"xsd:dateTime":break;case"xsd:decimal":break;case"xsd:double":if(Number(c)){return true}else{return false}break;case"xsd:float":if(Number(c)){return true}else{return false}break;case"xsd:gDay":break;case"xsd:gMonth":break;case"xsd:gMonthDay":break;case"xsd:gYear":break;case"xsd:gYearMonth":break;case"xsd:hexBinary":break;case"xsd:int":if(Number(c)){return true}else{return false}break;case"xsd:integer":if(Number(c)){return true}else{return false}break;case"xsd:long":if(Number(c)){return true}else{return false}break;case"xsd:negativeInteger":break;case"xsd:nonNegativeInteger":break;case"xsd:nonPositiveInteger":break;case"xsd:positiveInteger":break;case"xsd:short":break;case"xsd:string":if(""!=String(c)){if(!Number(c)){return true}else{return false}}else{return false}break;case"xsd:time":break;case"xsd:unsignedByte":break;case"xsd:unsignedInt":break;case"xsd:unsignedLong":break;case"xsd:unsignedShort":break;default:return true;break}};SBGrid.CT.Bind.prototype.setAttribute=function(b,a){SBGrid.CT.Element.prototype.setAttribute.call(this,b,a);switch(b){case"ref":this.attribute.ref=a;break;case"calculate":this.attribute.calculate=a;break;case"constraint":this.attribute.constraint=a;break;case"readonly":this.attribute.readonly=a;break;case"relevant":this.attribute.relevant=a;break;case"required":this.attribute.required=a;break;case"type":this.attribute.type=a;break;case"script":this.attribute.script=a;break}};SBGrid.CT.Bind.create=function(a,b,c){var d=null;return SBGrid.CT.Bind.createObject(a,d,b,c)};SBGrid.CT.Bind.createObject=function(b,f,q,a){var r="";var l="softbowl:bind";var p="";var s="";var g="";var o="";var d="";var e="";var n="";var m="";for(var h=0;h<q.count();h++){var t=q.keys()[h];switch(t){case"id":r=q.item(t);break;case"calculate":p=q.item(t);break;case"constraint":s=q.item(t);break;case"readonly":g=q.item(t);break;case"ref":o=q.item(t);break;case"relevant":d=q.item(t);break;case"type":e=q.item(t);break;case"script":n=q.item(t);break;default:if(!SBGrid.DEF.SB_STYLELIST[t]){m+=t+":"+q.item(t)+"; "}break}}var c=new SBGrid.CT.Bind(b,r,l,o,p,s,g,d,strRequired,e,n,m);return c};SBGrid.CT.HtmlBind=function(a,i,d,f,c,l,g,b,h,e){if(i==null||i==""){return}this.m_strId=i;this.m_strJsonref=d;this.m_strJsonnodeset=f;this.m_strLabelref=c;this.m_strValueref=l;this.m_strSrcref=g;this.m_strTextref=b;this.m_strSubjectref=h;this.m_strTbodyControls=e;this.m_strTbodyInnerHtml="";this.m_heControl=document.getElementById(this.m_strId);if(null!=this.m_strTbodyControls&&undefined!=this.m_strTbodyControls&&""!=this.m_strTbodyControls){this.m_strTbodyControls=this.m_strTbodyControls.substring(0,this.m_strTbodyControls.length-1);this.tbodyControls=this.m_strTbodyControls.split("|")}this.m_heControl.htmlbind=this;if(this.m_heControl.attachEvent){if(this.m_heControl.type=="radio"){this.m_heControl.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setRadioValue(event,d)})}else{if(this.m_heControl.type=="checkbox"){this.m_heControl.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,d)})}else{if(this.m_heControl.nodeName=="INPUT"&&this.m_heControl.type=="range"){this.m_heControl.attachEvent("onmouseup",function(){SBGrid.CT.HtmlBind.setValue(event,l)});this.m_heControl.attachEvent("onkeyup",function(){SBGrid.CT.HtmlBind.setValue(event,l)});this.m_heControl.attachEvent("onmousewheel",function(){SBGrid.CT.HtmlBind.setValue(event,l)})}else{if(this.m_heControl.nodeName=="INPUT"){this.m_heControl.attachEvent("onblur",function(){SBGrid.CT.HtmlBind.setValue(event,l)})}else{if(this.m_heControl.nodeName=="TEXTAREA"){this.m_heControl.attachEvent("onblur",function(){SBGrid.CT.HtmlBind.setText(event,d)})}}}}}}else{if(this.m_heControl.type=="radio"){this.m_heControl.addEventListener("click",function(){SBGrid.CT.HtmlBind.setRadioValue(event,d)},false)}else{if(this.m_heControl.type=="checkbox"){this.m_heControl.addEventListener("click",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,d)},false)}else{if(this.m_heControl.nodeName=="INPUT"&&this.m_heControl.type=="range"){this.m_heControl.addEventListener("mouseup",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false);this.m_heControl.addEventListener("mousedown",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false);this.m_heControl.addEventListener("mousewheel",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false)}else{if(this.m_heControl.nodeName=="INPUT"){this.m_heControl.addEventListener("blur",function(){SBGrid.CT.HtmlBind.setValue(event,l)},false)}else{if(this.m_heControl.nodeName=="TEXTAREA"){this.m_heControl.addEventListener("blur",function(){SBGrid.CT.HtmlBind.setValue(event,b)},false)}}}}}}this.rebuild()};SBGrid.CT.HtmlBind.prototype.makeLegend=function(){if(this.m_strSubjectref!=""&&this.m_heControl.nodeName=="FIELDSET"){this.m_heControl.firstChild.nextSibling.innerHTML=eval(this.m_strSubjectref)}};SBGrid.CT.HtmlBind.prototype.makeRadio=function(){if(this.m_strJsonnodeset!=""&&this.m_heControl.nodeName=="INPUT"&&this.m_heControl.type=="radio"){var objNodeset=eval(this.m_strJsonnodeset);var strElement="";var xnPNode=this.m_heControl.parentNode;arrObj=window.document.getElementsByName(this.m_strId);xnPNode.innerHTML="";for(var i=0;i<objNodeset.length;i++){var h_rdo=document.createElement("input");h_rdo.type="radio";h_rdo.id=this.m_strId;h_rdo.name=this.m_strId;h_rdo.value=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strValueref);h_rdo.htmlbind=this;h_rdo.htmlbind.m_heControl=h_rdo;var strJsonRef=this.m_strJsonref;if(h_rdo.value==eval(strJsonRef)){h_rdo.checked=true}if(h_rdo.attachEvent){h_rdo.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setRadioValue(event,strJsonRef)})}else{h_rdo.addEventListener("click",function(){SBGrid.CT.HtmlBind.setRadioValue(event,strJsonRef)},false)}var strText=document.createTextNode(eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)+"");xnPNode.appendChild(h_rdo);xnPNode.appendChild(strText)}}};SBGrid.CT.HtmlBind.prototype.makeCheckbox=function(){if(this.m_strJsonnodeset!=""&&this.m_heControl.nodeName=="INPUT"&&this.m_heControl.type=="checkbox"){var objNodeset=eval(this.m_strJsonnodeset);var strElement="";var xnPNode=this.m_heControl.parentNode;arrObj=window.document.getElementsByName(this.m_strId);xnPNode.innerHTML="";for(var i=0;i<objNodeset.length;i++){var h_chk=document.createElement("input");h_chk.type="checkbox";h_chk.id=this.m_strId;h_chk.name=this.m_strId;h_chk.value=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strValueref);h_chk.htmlbind=this;h_chk.htmlbind.m_heControl=h_chk;var strJsonRef=this.m_strJsonref;var chkedVals=" "+eval(strJsonRef)+" ";if(-1!=chkedVals.indexOf(h_chk.value)){h_chk.checked=true}if(h_chk.attachEvent){h_chk.attachEvent("onclick",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,strJsonRef)})}else{h_chk.addEventListener("click",function(){SBGrid.CT.HtmlBind.setCheckboxValue(event,strJsonRef)},false)}var strText=document.createTextNode(eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)+"");xnPNode.appendChild(h_chk);xnPNode.appendChild(strText)}}};SBGrid.CT.HtmlBind.prototype.makeOption=function(){if(this.m_strJsonnodeset!=""&&(this.m_heControl.nodeName=="SELECT"||this.m_heControl.nodeName=="DATALIST")){var xnPNode=this.m_heControl;xnPNode.innerHTML="";try{var objNodeset=eval(this.m_strJsonnodeset);for(var i=0;i<objNodeset.length;i++){var h_optn=document.createElement("OPTION");if(this.m_heControl.nodeName=="DATALIST"&&""!=this.m_strLabelref){h_optn.label=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)}else{h_optn.text=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strLabelref)}h_optn.value=eval(this.m_strJsonnodeset+"["+i+"]."+this.m_strValueref);if(h_optn.value==eval(this.m_strJsonref)){h_optn.selected=true}this.m_heControl.appendChild(h_optn)}}catch(e){SBGrid.DEF.errorMsg("jsonref를 이용한 itemset 구성 오류")}}};SBGrid.CT.HtmlBind.prototype.makeTbody=function(){if(this.m_strJsonref!=""&&this.m_heControl.nodeName=="TABLE"){var heChilds=this.m_heControl.children;var heTbody;var strTbodyUnit;for(var i=0;i<heChilds.length;i++){var heChild=heChilds.item(i);if("TBODY"==heChild.nodeName){heTbody=heChild;if(this.m_strTbodyInnerHtml==""){this.m_strTbodyInnerHtml=heTbody.innerHTML}strTbodyUnit=this.m_strTbodyInnerHtml;for(var j=heChild.childNodes.length-1;j>=0;j--){heChild.removeChild(heChild.childNodes.item(j))}break}}var objNodeset=eval(this.m_strJsonref);var strTbodyContent="";var strTbodyUnitTmp="";for(var i=0;i<objNodeset.length;i++){strTbodyUnitTmp=strTbodyUnit;strTbodyUnitTmp=strTbodyUnit.replace(/id=\"(\w+)\"/g,'id="$1_'+(i+1)+'" name="$1_'+(i+1)+'"');strTbodyContent+=strTbodyUnitTmp}jQuery(heTbody).append(strTbodyContent);if(null!=this.tbodyControls&&undefined!=this.tbodyControls){for(var i=0;i<objNodeset.length;i++){for(var j=0;j<this.tbodyControls.length;j++){var tbodyControl=this.tbodyControls[j];var tbodyControlValArr=tbodyControl.split("^");var strParentId=this.m_heControl.id;var strId=tbodyControlValArr[1]+"_"+(i+1);var strJsonRef=tbodyControlValArr[2];var strJsonNodeSet=tbodyControlValArr[3];var strLabelRef=tbodyControlValArr[4];var strValueRef=tbodyControlValArr[5];var strSrcRef=tbodyControlValArr[6];var strTextRef=tbodyControlValArr[7];if(""!=strJsonRef){strJsonRef=this.m_strJsonref+"["+i+"]."+strJsonRef}if(""!=strJsonNodeSet){strJsonNodeSet=strJsonNodeSet}if(!("INPUT"==document.getElementById(strId).nodeName&&("checkbox"==document.getElementById(strId).type||"radio"==document.getElementById(strId).type))){if(""!=strLabelRef){strLabelRef=this.m_strJsonref+"["+i+"]."+strLabelRef}if(""!=strValueRef){strValueRef=this.m_strJsonref+"["+i+"]."+strValueRef}}if(""!=strSrcRef){strSrcRef=this.m_strJsonref+"["+i+"]."+strSrcRef}if(""!=strTextRef){strTextRef=this.m_strJsonref+"["+i+"]."+strTextRef}new SBGrid.CT.HtmlBind(strParentId,strId,strJsonRef,strJsonNodeSet,strLabelRef,strValueRef,strSrcRef,strTextRef,"")}}}}};SBGrid.CT.HtmlBind.prototype.assignSource=function(){if(this.m_strJsonref!=""&&(this.m_heControl.nodeName=="VIDEO"||this.m_heControl.nodeName=="AUDIO")){var strSeparator="";if(this.m_heControl.nodeName=="VIDEO"){strSeparator="video/"}else{strSeparator="audio/"}var heChilds=this.m_heControl.children;if(this.m_strJsonref!=""){for(var i=0;i<heChilds.length;i++){var heChild=heChilds.item(i);if("SOURCE"==heChild.nodeName){var heChildType=heChild.type;var heChildTypeExt="";if(-1==heChildType.indexOf(";")){heChildTypeExt=heChildType.substring(heChildType.indexOf(strSeparator)+strSeparator.length,heChildType.length)}else{if(heChildType.indexOf(strSeparator)<heChildType.indexOf(";")){heChildTypeExt=heChildType.substring(heChildType.indexOf(strSeparator)+strSeparator.length,heChildType.indexOf(";"))}else{heChildTypeExt=heChildType.substring(heChildType.indexOf(strSeparator)+strSeparator.lengths,heChildType.indexOf('"')).replaceAll(";","")}}heChildTypeExt=heChildTypeExt.trim()}try{heChild.src=eval(this.m_strJsonref+"."+heChildTypeExt)}catch(e){}}}else{heControl.src=""}}};SBGrid.CT.HtmlBind.prototype.init=function(){this.refresh()};SBGrid.CT.HtmlBind.prototype.refresh=function(){if(this.m_heControl.nodeName=="INPUT"){if(this.m_heControl.type=="text"||this.m_heControl.type==""||this.m_heControl.type=="select-one"||this.m_heControl.type=="range"||this.m_heControl.type=="number"||this.m_heControl.type=="date"||this.m_heControl.type=="month"||this.m_heControl.type=="time"||this.m_heControl.type=="datetime"||this.m_heControl.type=="datetime-local"||this.m_heControl.type=="week"){if(this.m_strJsonref!=""){try{this.m_heControl.value=eval(this.m_strJsonref)}catch(e){}}else{this.m_heControl.value=""}}}else{if(this.m_heControl.nodeName=="IMG"||this.m_heControl.nodeName=="IFRAME"){if(this.m_strSrcref!=""){try{this.m_heControl.src=eval(this.m_strSrcref)}catch(e){}}}else{if(this.m_heControl.nodeName=="A"){if(this.m_strSrcref!=""){try{this.m_heControl.href=eval(this.m_strSrcref)}catch(e){}}if(this.m_strTextref!=""){try{this.m_heControl.innerHTML=eval(this.m_strTextref)}catch(e){}}}else{if(this.m_heControl.nodeName=="BUTTON"||this.m_heControl.nodeName=="SPAN"||this.m_heControl.nodeName=="TEXTAREA"){if(this.m_strJsonref!=""){try{this.m_heControl.innerHTML=eval(this.m_strJsonref)}catch(e){}}}else{if(this.m_heControl.nodeName=="VIDEO"||this.m_heControl.nodeName=="AUDIO"){this.assignSource();this.m_heControl.load()}}}}}};SBGrid.CT.HtmlBind.prototype.rebuild=function(){if(this.m_heControl.nodeName=="INPUT"){if(this.m_heControl.type=="radio"){this.makeRadio()}else{if(this.m_heControl.type=="checkbox"){this.makeCheckbox()}else{this.refresh()}}}else{if(this.m_heControl.nodeName=="FIELDSET"){this.makeLegend()}else{if(this.m_heControl.nodeName=="SELECT"||this.m_heControl.nodeName=="DATALIST"){this.makeOption()}else{if(this.m_heControl.nodeName=="TABLE"){this.makeTbody()}else{this.refresh()}}}}};SBGrid.CT.HtmlBind.refresh=function(strId,strValueRef){var objControl=document.getElementById(strId);if(objControl.nodeName=="INPUT"||objControl.nodeName=="SELECT"){if(objControl.type=="text"||objControl.type==""||objControl.type=="select-one"||objControl.type=="range"||objControl.type=="number"||objControl.type=="date"||objControl.type=="month"||objControl.type=="time"||objControl.type=="datetime"||objControl.type=="datetime-local"||objControl.type=="week"){if(strValueRef!=""){try{objControl.value=eval(strValueRef)}catch(e){}}else{objControl.value=""}}}else{if(objControl.nodeName=="IMG"||objControl.nodeName=="IFRAME"){if(strJsonRef!=""){try{objControl.src=eval(strJsonRef)}catch(e){}}}else{if(objControl.nodeName=="A"){if(strJsonRef!=""){try{objControl.href=eval(strJsonRef)}catch(e){}}if(strTextRef!=""){try{objControl.innerHTML=eval(strJsonRef)}catch(e){}}}else{if(objControl.nodeName=="BUTTON"||objControl.nodeName=="SPAN"||objControl.nodeName=="TEXTAREA"){if(strJsonRef!=""){try{objControl.innerHTML=eval(strJsonRef)}catch(e){}}}else{if(objControl.nodeName=="VIDEO"||objControl.nodeName=="AUDIO"){this.assignSource();objControl.load()}}}}}};SBGrid.CT.HtmlBind.setValue=function(event,strJsonRef){if(strJsonRef!=""){var objControl=event.srcElement;if(objControl.nodeName=="INPUT"||objControl.nodeName=="SELECT"||objControl.nodeName=="FIELDSET"){if(objControl.type=="text"||objControl.type==""||objControl.type=="select-one"||objControl.type=="range"||objControl.type=="number"||objControl.type=="date"||objControl.type=="month"||objControl.type=="time"||objControl.type=="datetime"||objControl.type=="datetime-local"||objControl.type=="week"){eval(strJsonRef+"= '"+objControl.value+"';")}}}};SBGrid.CT.HtmlBind.setText=function(event,strJsonRef){if(strTextRef!=""){var objControl=event.srcElement;if(objControl.nodeName=="TEXTAREA"){eval(strTextRef+"= '"+objControl.innerHTML.replaceAll("\n","\\n")+"';")}}};SBGrid.CT.HtmlBind.setRadioValue=function(event,strJsonRef){eval(strJsonRef+" = "+event.srcElement.value+";")};SBGrid.CT.HtmlBind.setCheckboxValue=function(event,strJsonRef){var chkTagName=event.srcElement.name;var chkTagNameArr=document.getElementsByName(chkTagName);var chkVals="";for(var i=0;i<chkTagNameArr.length;i++){if(true==chkTagNameArr.item(i).checked){chkVals+=chkTagNameArr.item(i).value+" "}}eval(strJsonRef+' = "'+chkVals.substring(0,chkVals.length-1)+'";')};SBGrid.CT.Control=function(b,h,m,n,c,d,e,l,o,a,f,i,g){if(!l){return}SBGrid.CT.Element.call(this,b,l,f);this.attribute.alert=h;this.attribute.help=m;this.attribute.hint=n;this.attribute.accesskey=c;this.attribute["class"]=d;this.attribute.disabled=String(e);this.attribute.id=l;this.attribute.navindex=String(o);this.attribute.tag=f;this.attribute.visibility=i;this.disabled=e;this.hint=n;this.navIndex=o;this.visible=("hidden"!=i)?true:false;this.m_Resize=false;this.m_strClass=d;this.m_heControl;this.m_strStyle=a;this.m_clCSSName=new SBGrid.DS.Collection();this.m_strUserDefineAttrib=g;this.m_bDown=false;this.m_bDragStart=false;this.m_bLButtonDown=false;this.m_dwState=0;this.m_TabIndex;this.m_bDependentCtl=false;if("softbowl:col"!=this.attribute.tag){SBGrid.DEF.__appendControl(l,this)}this.m_arCSSUnitSet=new Array();this.m_jsonCssEvent={normal:"",down:"",focus:"",select:"",deselect:"",disable:"",dedisable:""};SBGrid.DS.XMLStorage.getUniqueStorage().addTabIndex(o,this)};SBGrid.CT.Control.prototype=new SBGrid.CT.Element;SBGrid.CT.Control.prototype.init=function(){if(null==this.m_heControl){this.m_heControl=document.getElementById("SBHE_"+this.id)}var f=null!=this.m_heControl?true:false;this.setStyleToAttribute();this.setUserDefineAttribute();if(SBGrid.DEF.is_ie7&&null!=this.m_heControl){var h="";var p="";var q="";var d=this.m_heControl.className;if(""!=d&&null!=d){var l=d.trim().split(" ");for(var m=0;m<l.length;m++){var n=l[m];if(-1!=n.indexOf("sbgrid_")){continue}var a=document.styleSheets;for(var g=1;g<a.length;g++){var c=a.item(g).rules;for(var e=0;e<c.length;e++){var b=c.item(e);var o=b.selectorText;if("*."+n+":focus"==o){p=b.style.cssText}else{if("*."+n+":active"==o){h=b.style.cssText}else{if("*."+n+":disable"==o){q=b.style.cssText}}}}}}this.m_jsonCssEvent.down=h;this.m_jsonCssEvent.focus=p;this.m_jsonCssEvent.disable=q}}this.m_jsonCssEvent.normal=this.m_strStyle;if(null!=this.attribute["z-index"]&&null!=this.m_heControl){this.m_heControl.style.zIndex=this.attribute["z-index"]}if(f){this.m_heControl.title=this.hint;if(1==this.navIndex){window.setTimeout("SBGrid.DEF.setFocus('"+this.id+"');",0)}if(!this.visible){this.m_heControl.style.visibility="hidden"}}this.disabled=false};SBGrid.CT.Control.prototype.setStyleToAttribute=function(){if(null!=this.m_strStyle&&""!=this.m_strStyle){var b="";this.m_strStyle=this.m_strStyle.trim();if(";"==this.m_strStyle.charAt(this.m_strStyle.length-1)){this.m_strStyle=this.m_strStyle.substring(0,this.m_strStyle.length-1)}var e=this.m_strStyle.split(";");for(var c=0;c<e.length;c++){if(null!=e[c]&&""!=e[c]){var d=e[c].split(":");var a=d[0];var f="";if(2<d.length){for(var c=1;c<d.length;c++){f+=d[c]+":"}f=f.substring(0,f.length-1)}else{f=d[1]}if(-1!=a.indexOf("background-image")&&-1==f.indexOf("url(")){f="url("+f+")"}b+=a+":"+f+";";this.attribute[d[0].trim()]=d[1].trim();this.m_initStyleList[d[0].trim()]=f}}this.m_strStyle=b}};SBGrid.CT.Control.prototype.setUserDefineAttribute=function(){if(null!=this.m_strUserDefineAttrib&&""!=this.m_strUserDefineAttrib){this.m_strUserDefineAttrib=this.m_strUserDefineAttrib.trim();if(";"==this.m_strUserDefineAttrib.charAt(this.m_strUserDefineAttrib.length-1)){this.m_strUserDefineAttrib=this.m_strUserDefineAttrib.substring(0,this.m_strUserDefineAttrib.length-1)}var g=this.m_strUserDefineAttrib.split(";");for(var f=0;f<g.length;f++){if(null!=g[f]&&""!=g[f]){var d=g[f].split(":");var e=d[0].trim();var a=d[1].trim();var c=this.elementName.substring(7);if(-1!=e.indexOf("class_")){this.m_clCSSName.add(e.replace("class_",c+"_"),a)}else{if(-1!=e.indexOf(c+"_")){this.m_clCSSName.add(e,a)}else{if(-1!=e.indexOf("select.")){var b=g[f].trim().substring(7);var h=this.m_jsonCssEvent.select;h=(""==h)?"":h+";";this.m_jsonCssEvent={select:h+b}}}}this.attribute[e]=a;e=null;a=null}}}};SBGrid.CT.Control.prototype.setClassName=function(){};SBGrid.CT.Control.prototype.isIndepandent=function(){return true};SBGrid.CT.Control.prototype.getAbility=function(){return SBGrid.DEF.SBEA_CONTROL};SBGrid.CT.Control.prototype.isEnable=function(){var a=this;while(null!=a&&(SBGrid.DEF.SBEA_CONTROL_BASE&a.getAbility())){if(a.getState(SBGrid.DEF.SB_CS_DISABLE)){return false}a=a.parent}return true};SBGrid.CT.Control.prototype.setRefElement=function(a){SBGrid.CT.Element.prototype.setRefElement.call(this,a);this.m_heControl=a.m_heControl};SBGrid.CT.Control.prototype.getClass=function(){return this.attribute["class"]};SBGrid.CT.Control.prototype.getHtmlElement=function(){return this.m_heControl};SBGrid.CT.Control.prototype.setHtmlElement=function(a){this.m_heControl=a};SBGrid.CT.Control.prototype.refresh=function(){if("true"==this.attribute.disabled){this.setDisabled(true)}};SBGrid.CT.Control.prototype.adjustDIVSize=function(){if(!SBGrid.DEF.is_ie&&this.m_heControl&&this.m_heControl.tagName.toLowerCase()=="div"){var d=this.attribute.width;if(d&&d.lastIndexOf("%")<0){var c=parseInt(this.attribute.width.replace("px",""));var e=this.m_heControl.offsetWidth-this.m_heControl.clientWidth;this.m_heControl.style.width=(c-e)+"px"}var a=this.attribute.height;if(a&&a.lastIndexOf("%")<0){var b=parseInt(this.attribute.height.replace("px",""));var e=this.m_heControl.offsetHeight-this.m_heControl.clientHeight;this.m_heControl.style.height=(b-e)+"px"}}};SBGrid.CT.Control.prototype.getBindingType=function(){return SBGrid.DEF.SB_NONE};SBGrid.CT.Control.prototype.setDisabled=function(d,c){var f=this;if(-1!=this.attribute.tag.indexOf("iviewer")){if(null==this.window){return}f=this.window.body;if(null==f){return}}if(null==c&&f.disabled==d){return}if(null==c){f.m_bThisDisabled=d}if(null==c&&!d){f.m_bThisDisabled=null}if(f.m_bThisDisabled&&c&&!d){return}f.disabled=d;f.attribute.disabled=String(d);if(null!=f.m_heControl){f.m_heControl.disabled=d;if(d){f.m_heControl.setAttribute("disabled",String(d))}else{f.m_heControl.removeAttribute("disabled")}}f.setState(SBGrid.DEF.SB_CS_DISABLE,d);f.m_strPDisabled=d?f.id:null;for(var b=0;b<f.children.length;b++){var e=f.children.item(b);var a=e.elementName;if(e instanceof SBGrid.CT.Control){if(-1!=e.id.indexOf("fixed-cell")){continue}e.setDisabled(d,true)}f.setChildDisabled(e,d)}};SBGrid.CT.Control.prototype.setChildDisabled=function(b,a){var c=null;if(this instanceof SBGrid.CT.Calendar){c=document.getElementById("SBHE_"+b.id)}else{if(this instanceof SBGrid.CT.Select){c=document.getElementById("SBHE_"+b.id)}}if(null!=c){if(a){c.setAttribute("disabled",String(a))}else{c.removeAttribute("disabled")}}};SBGrid.CT.Control.prototype.setHint=function(a){this.attribute.hint=a;this.hint=a;this.m_heControl.title=a;if("softbowl:select1"==this.tag){for(var b=0;b<this.children.length;b++){if(-1!=this.children.item(b).id.indexOf(".input")||-1!=this.children.item(b).id.indexOf(".button")){this.children.item(b).m_heControl.title=a}}}if("softbowl:calendar"==this.tag){for(var b=0;b<this.children.length;b++){var c="item"==this.children.item(b).id.substring(this.children.item(b).id.length-4,this.children.item(b).id.length);if(-1!=this.children.item(b).id.indexOf(".header")||-1!=this.children.item(b).id.indexOf(".prevyear")||-1!=this.children.item(b).id.indexOf(".prevmonth")||-1!=this.children.item(b).id.indexOf(".nextyear")||-1!=this.children.item(b).id.indexOf(".nextmonth")||-1!=this.children.item(b).id.indexOf(".today")||c){if(null!=this.children.item(b).m_heControl&&!c){this.children.item(b).m_heControl.title=a}this.children.item(b).hint=a}}this.init(true)}};SBGrid.CT.Control.prototype.setNavIndex=function(a){if(this.navIndex==a){return}else{SBGrid.DS.XMLStorage.getUniqueStorage().replaceTabIndex(this.m_TabIndex,a,this);this.navIndex=a;this.attribute.navindex=String(a)}};SBGrid.CT.Control.prototype.setVisible=function(a,b){this.visible=a;if(a){this.attribute.visibility="visible";if(null!=this.m_heControl){if(b){this.m_heControl.style.visibility="visible";return}this.m_heControl.style.visibility=""}if(this.parent instanceof SBGrid.CT.Input){this.setDisabled(this.parent.disabled)}}else{this.attribute.visibility="hidden";if(null!=this.m_heControl){this.m_heControl.style.visibility="hidden"}}return};SBGrid.CT.Control.prototype.initStyle=function(strStyle){if(null!=this.m_heControl){if(null!=strStyle){if("softbowl:bool"==this.attribute.tag&&"background-image"==strStyle){return}var strAttrStyle=strStyle;if("color"==strStyle||"width"==strStyle||"left"==strStyle||"right"==strStyle||"top"==strStyle||"bottom"==strStyle){if(0!=this.m_strStyle.indexOf(strStyle)){strStyle="[^\\-]"+strStyle}}var arFilter=eval(this.id+".m_strStyle.match(/"+strStyle+"\\:(\\s|)([^\\;]+)/)");var strInitStyle=null;if(null!=arFilter){strInitStyle=arFilter[0].split(":")[1].trim();this.setAttribute(strAttrStyle,strInitStyle)}else{this.setAttribute(strAttrStyle,"")}}}};SBGrid.CT.Control.prototype.refreshCurrentModel=function(c){if(SBGrid.DEF.__useBinding){var b=(null==c||-1!=c.indexOf("/"))?true:false;if(null==b){b=true}if(b){SBGrid.DS.XMLStorage.getUniqueStorage().recalculate();SBGrid.DS.XMLStorage.getUniqueStorage().refresh()}else{SBGrid.DS.XMLStorage.getUniqueStorage().refresh()}}else{var a=c;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[a]){for(strHtKey in SBGrid.DEF.SB_REF_ATTR[a]){if("parseJSON"!=strHtKey&&"toJSONString"!=strHtKey){SBGrid.DEF.SB_REF_ATTR[a][strHtKey].refresh()}}return}this.refresh(true)}else{this.refresh(true)}}};SBGrid.CT.Control.prototype.setPosition=function(a){this.m_heControl.style.top=a.getY()+"px";this.m_heControl.style.left=a.getX()+"px";this.m_heControl.style.width=a.getWidth()+"px";this.m_heControl.style.height=a.getHeight()+"px"};SBGrid.CT.Control.prototype.focus=function(){try{window.setTimeout("try{var heControlCtl = document.getElementById('SBHE_"+this.id+"');if (null != heControlCtl){heControlCtl.focus();}}catch(e){}",0)}catch(a){}};SBGrid.CT.Control.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"alert":this.attribute.alert=b;break;case"help":this.attribute.help=b;break;case"hint":this.attribute.hint=b;this.setHint(b);break;case"accesskey":this.attribute.accesskey=b;this.m_heControl.accessKey=b;break;case"class":if(this.elementName=="softbowl:caption"){jQuery(this.m_heControlText).removeClass(this.m_strClass).addClass(b)}else{jQuery(this.m_heControl).removeClass(this.m_strClass).addClass(b)}this.m_strClass=b;break;case"disabled":if("boolean"==typeof(b)){b=b+""}if("true"==b){this.setDisabled(true)}else{if("false"==b){this.setDisabled(false)}}break;case"navindex":this.setNavIndex(parseInt(b));break;case"visibility":if("visible"==b){this.visible=true;this.attribute.visibility=b;this.m_heControl.style.visibility=""}else{if("hidden"==b){this.visible=false;this.attribute.visibility=b;this.m_heControl.style.visibility="hidden"}}break;case"z-index":this.m_heControl.style.zIndex=b}};SBGrid.CT.Control.prototype.onFocus=function(a){if(!this.getState(SBGrid.DEF.SB_CS_ACTIVE)){this.setState(SBGrid.DEF.SB_CS_ACTIVE,true,a);this.dispatch("onactivate")}if(a.target==this.getId()){this.setState(SBGrid.DEF.SB_CS_FOCUS,true,a);if(null!=this.m_heControl){if(this.isFocusValid()){if(("minimal"==this.parent.getAttribute("appearance")&&""==this.parent.getAttribute("editmode"))){this.parent.focus()}else{this.focus()}}}}};SBGrid.CT.Control.prototype.onActivate=function(a){};SBGrid.CT.Control.prototype.onBlur=function(a){if(this.getState(SBGrid.DEF.SB_CS_ACTIVE)){this.setState(SBGrid.DEF.SB_CS_ACTIVE,false,a);this.dispatch("ondeactivate")}if(a.target==this.getId()){this.setState(SBGrid.DEF.SB_CS_FOCUS,false,a)}a.focus=""};SBGrid.CT.Control.prototype.onClick=function(a){if(null==SBGrid.DEF.m_nDelayTime){SBGrid.DEF.m_nDelayTime=window.setTimeout("var objElement = document.SBHE_allElement.m_htCollection['"+this.id+"'];if (null != objElement){objElement.dispatch('ondelayclick');};",500)}};SBGrid.CT.Control.prototype.onDelayClick=function(a){window.clearTimeout(SBGrid.DEF.m_nDelayTime);SBGrid.DEF.m_nDelayTime=null};SBGrid.CT.Control.prototype.onCursor=function(a){};SBGrid.CT.Control.prototype.onDblClick=function(a){window.clearTimeout(SBGrid.DEF.m_nDelayTime);SBGrid.DEF.m_nDelayTime=null;if(SBGrid.EVT.BUTTON_LEFT==a.button){this.setState(SBGrid.DEF.SB_CS_DOWN,true,a);m_bDown=0}};SBGrid.CT.Control.prototype.onKeyDown=function(a){if(a.target==this.getId()){if(!a.ctrlKey&&SBGrid.EVT.TAB==a.keyCode){if(!a.shiftKey){if(a.defaultAction!="cancle"){this.dispatch("onnext")}a.defaultAction="cancle"}else{this.dispatch("onprevious");a.defaultAction="cancle"}}else{if(SBGrid.EVT.F1==a.keyCode){this.dispatch("softbowl-help")}}}};SBGrid.CT.Control.prototype.onKeyUp=function(a){if("softbowl:comboinput"==this.tag&&this.parent.m_heItemList){if(SBGrid.EVT.UP!=a.keyCode&&SBGrid.EVT.DOWN!=a.keyCode&&SBGrid.EVT.ENTER!=a.keyCode&&SBGrid.EVT.ESC!=a.keyCode){this.parent.itemValidCheck(a)}}};SBGrid.CT.Control.prototype.onKeyPress=function(a){};SBGrid.CT.Control.prototype.compareStyle=function(b){var g=this.m_heControl.style.cssText;var l=g;if(""!=b&&null!=b){var f=g.split(";");var e=b.split(";");for(var d=0;d<e.length;d++){var a=false;var h=e[d].split(":");for(var c=0;c<f.length;c++){var m=f[c].split(":");if(m[0]==h[0]){l=l.replace(f[d],e[c]);a=true;break}}if(!a){l+="; "+e[d]}}}return l};SBGrid.CT.Control.prototype.onMouseDown=function(b){if(SBGrid.DEF.is_ie7){if(null!=this.m_jsonCssEvent.down&&""!=this.m_jsonCssEvent.down){strResultCssText=this.compareStyle(this.m_jsonCssEvent.down);this.m_heControl.style.cssText=strResultCssText}}var a=["input","textarea"];a=a.join("|");var c=SBGrid.DEF.is_firefox?b.m_browserEvent.target:b.m_browserEvent.srcElement;if(a.indexOf(c.tagName.toLowerCase())==-1||c.type=="checkbox"||c.type=="radio"){SBGrid.DS.SBBody.m_heControl.onselectstart=new Function("return false")}else{SBGrid.DS.SBBody.m_heControl.onselectstart=new Function("return true")}if(!SBGrid.DEF.is_smartphone){if("combo"==c.getAttribute("U_D_C_S")){c=null;return}}if(b.target==this.getId()){if(SBGrid.EVT.BUTTON_LEFT==b.button){this.setState(SBGrid.DEF.SB_CS_DOWN,true,b);this.m_bDown=true}SBGrid.DEF.setFocus(this.getId(),b)}this.m_bDragStart=false};SBGrid.CT.Control.prototype.onMouseEnter=function(a){if(a.target==this.getId()){if(!this.getState(SBGrid.DEF.SB_CS_HOVER)){this.setState(SBGrid.DEF.SB_CS_HOVER,true,a)}}SBGrid.DEF.m_event.hint="ready"};SBGrid.CT.Control.prototype.onMouseUp=function(f){if(SBGrid.DEF.is_ie7){if(this.parent.elementName!="xhtml:body"&&this.elementName!="xhtml:body"){if(null!=this.m_jsonCssEvent.focus){this.m_heControl.style.cssText=this.m_heControl.style.cssText+"; "+this.m_jsonCssEvent.focus}else{if(null!=this.m_jsonCssEvent.normal){this.m_heControl.style.cssText=this.m_jsonCssEvent.normal}}}}if(SBGrid.DEF.bDragDrop){SBGrid.DEF.bDragDrop=false;var b=null;for(var d=0;d<document.SBHE_controls.length;d++){b=document.SBHE_controls.item(d);b.setAttribute("cursor",b.getAttribute("cursor"))}var e=document.getElementById("dragstyle");if(null!=e){var a=e.parentNode;a.removeChild(e)}if(null!=f.validEnter&&f.validEnter){f.validEnter=false;this.dispatch("ondragleave");this.dispatch("ondrop")}}if(SBGrid.EVT.BUTTON_LEFT==f.button){var c=(f.down==this.getId())&&this.m_bDown;if(this.getState(SBGrid.DEF.SB_CS_DOWN)&&this.m_bDown){this.setState(SBGrid.DEF.SB_CS_DOWN,false,f);this.m_bDown=false}if(f.target==this.getId()&&c){this.dispatch("onclick")}}};SBGrid.CT.Control.prototype.onMouseMove=function(d){if(!d.capture.isEmpty()){return}if(null!=this.m_heControl){if(d.down&&SBGrid.DEF.bDragDrop){var f=document.SBHE_allElement.m_htCollection[this.getId()];var e=false;if(null!=f){if((f instanceof SBGrid.CT.Cell)||(f instanceof SBGrid.CT.DataGridCell)||(f instanceof SBGrid.CT.SelectCell)||(f instanceof SBGrid.CT.SelectItem)){var b=f.parent;if(null!=b){if(""!=b.getAttribute("dropmode")&&"false"!=b.getAttribute("dropmode")){e=true}}}else{if(""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){e=true}}if(null==document.getElementById("dragstyle")){var c=document.createElement("style");c.setAttribute("id","dragstyle");if(e){c.innerTEXT=".sbgrid_caption_td{cursor:pointer;}.sbgrid_calendar_body{cursor:pointer;}.sbgrid_combo_itemlist_table{cursor:pointer;}"}else{c.innerTEXT=".sbgrid_caption_td{cursor:not-allowed;}.sbgrid_calendar_body{cursor:not-allowed;}.sbgrid_combo_itemlist_table{cursor:not-allowed;}"}document.body.appendChild(c)}if(e){this.m_heControl.style.cursor="pointer";this.dispatch("ondragover")}else{this.m_heControl.style.cursor="not-allowed"}}this.dispatch("ondrag")}}if(d.target==this.getId()){if(d.hover!=this.getId()){if(!d.hover.isEmpty()){var a=document.SBHE_allElement.item(d.hover);if(null!=a){a=a.getElement();a.dispatch("onmouseout");SBGrid.DEF.m_event.hint="none";SBGrid.DEF.m_event.cursorOver="none";if(SBGrid.DEF.m_event.hinting){SBGrid.DEF.m_event.hinting=false;window.clearTimeout(SBGrid.DEF.m_event.showHint);a.dispatch("onhidehint")}}this.dispatch("onmouseenter")}this.dispatch("onmouseover")}}};SBGrid.CT.Control.prototype.onMouseOut=function(a){if(a.target==this.getId()&&this.getState(SBGrid.DEF.SB_CS_HOVER)){this.setState(SBGrid.DEF.SB_CS_HOVER,false,a)}if(SBGrid.DEF.bDragDrop){if(null!=a.validEnter&&a.validEnter){a.validEnter=false}}};SBGrid.CT.Control.prototype.onMouseOver=function(b){if(b.target==this.getId()){if(SBGrid.DEF.bDragDrop){var c=document.SBHE_allElement.m_htCollection[b.target];if(null!=c){if((c instanceof SBGrid.CT.Cell)||(c instanceof SBGrid.CT.DataGridCell)||(c instanceof SBGrid.CT.SelectCell)||(c instanceof SBGrid.CT.SelectItem)){var a=c.parent;if(null!=a){if("false"!=a.getAttribute("dropmode")){this.dispatch("ondragenter");b.validEnter=true;this.dispatch("ondragover")}}}if((c instanceof SBGrid.CT.Input)||(c instanceof SBGrid.CT.TextArea)||(c instanceof SBGrid.CT.Img)||(c instanceof SBGrid.CT.Select1&&"minimal"==c.attribute.appearance)){if("false"!=c.getAttribute("dropmode")){this.dispatch("ondragenter");b.validEnter=true;this.dispatch("ondragover")}}}}this.dispatch("oncursor");if(!this.getState(SBGrid.DEF.SB_CS_HOVER)){this.setState(SBGrid.DEF.SB_CS_HOVER,true,b)}SBGrid.DEF.m_event.hint="ready";SBGrid.DEF.m_event.cursorOver="on"}};SBGrid.CT.Control.prototype.onNext=function(e){if(e.target==this.getId()){var b=SBGrid.DS.XMLStorage.getUniqueStorage().getTabIndex();var a=SBGrid.DEF.arrFind_Value(b,this);if(0>a){if(null!=this.parent){a=SBGrid.DEF.arrFind_Value(b,this.parent)}}if(-1<=a){var f;for(var d=a;d<b.length;d++){if(d+1<b.length){for(var c=d;c<b.length;c++){f=b[c+1];if(f==null||typeof f=="undefined"){continue}if("hidden"==f.getAttribute("visibility")){f=b[0];continue}else{break}}}else{f=b[0]}if(null!=f&&(f.id!=e.target)){if(true==f.disabled){continue}SBGrid.DEF.setFocus(f.id);break}else{SBGrid.DEF.setFocus("body")}}}if(e.m_browserEvent.cancelable===undefined){e.m_browserEvent.returnValue=false}else{if(e.m_browserEvent.cancelable){e.m_browserEvent.preventDefault()}}}};SBGrid.CT.Control.prototype.onPrevious=function(c){if(c.target==this.getId()){var b=SBGrid.DS.XMLStorage.getUniqueStorage().getTabIndex();var a=SBGrid.DEF.arrFind_Value(b,this);if(0>a){if(null!=this.parent){a=SBGrid.DEF.arrFind_Value(b,this.parent)}}var d;if(0<=a-1){d=b[a-1]}else{if(0<=b.length-1){d=b[b.length-1]}}if(null!=d&&(d.id!=c.target)){SBGrid.DEF.setFocus(d.id)}else{SBGrid.DEF.setFocus("body")}if(c.m_browserEvent.cancelable===undefined){c.m_browserEvent.returnValue=false}else{if(c.m_browserEvent.cancelable){c.m_browserEvent.preventDefault()}}}};SBGrid.CT.Control.prototype.onScroll=function(a){};SBGrid.CT.Control.prototype.onScrollDown=function(a){};SBGrid.CT.Control.prototype.onScrollUp=function(a){};SBGrid.CT.Control.prototype.onMouseWheel=function(a){};SBGrid.CT.Control.prototype.onHint=function(a){};SBGrid.CT.Control.prototype.onInvalid=function(a){};SBGrid.CT.Control.prototype.onOptional=function(a){};SBGrid.CT.Control.prototype.onReadonly=function(a){};SBGrid.CT.Control.prototype.onReadWrite=function(a){};SBGrid.CT.Control.prototype.onRequired=function(a){};SBGrid.CT.Control.prototype.onvalid=function(a){};SBGrid.CT.Control.prototype.onDragStart=function(a){};SBGrid.CT.Control.prototype.onDragEnter=function(a){a.validEnter=true;if("softbowl:input"==this.tag||"softbowl:textarea"==this.tag){var b=SBGrid.DEF.getCaretPosition(this.m_heControl);this.m_nCaretEnd=b.end;SBGrid.DEF.setCaretPosition(this.m_heControl,this.m_nCaretEnd,this.m_nCaretEnd)}};SBGrid.CT.Control.prototype.onDragOver=function(a){};SBGrid.CT.Control.prototype.onDragLeave=function(a){a.validEnter=false;if("softbowl:input"==this.tag||"softbowl:textarea"==this.tag){this.m_heControl.blur()}};SBGrid.CT.Control.prototype.onDrop=function(a){};SBGrid.CT.Control.prototype.onDrag=function(a){};SBGrid.CT.Control.prototype.onShowHint=function(a){};SBGrid.CT.Control.prototype.onHideHint=function(a){};SBGrid.CT.Control.prototype.setState=function(b,d,c,e,a){if(d){switch(b){case SBGrid.DEF.SB_CS_HOVER:c.hover=this.getId();this.setAttribute("hover",true);break;case SBGrid.DEF.SB_CS_DOWN:c.down=this.getId();this.setAttribute("down",true);break;case SBGrid.DEF.SB_CS_FOCUS:c.focus=this.getId();this.setAttribute("focus",true);break;case SBGrid.DEF.SB_CS_SELECT:this.attribute.select="true";break;case SBGrid.DEF.SB_CS_DISABLE:this.attribute.disable="true";break}this.m_dwState|=b}else{switch(b){case SBGrid.DEF.SB_CS_HOVER:c.hover="";this.setAttribute("hover",false);break;case SBGrid.DEF.SB_CS_DOWN:c.down="";this.setAttribute("down",false);break;case SBGrid.DEF.SB_CS_FOCUS:c.focus="";this.setAttribute("focus",false);break;case SBGrid.DEF.SB_CS_SELECT:this.attribute.select="false";break;case SBGrid.DEF.SB_CS_DISABLE:this.attribute.disable="false";break}this.m_dwState&=~b}if(a){this.onStateChange(b,d)}};SBGrid.CT.Control.prototype.resetStyle=function(b,e){var a=null;if(SBGrid.DEF.SB_CS_NORMAL==b){a=this.attribute}else{if(b&SBGrid.DEF.SB_CS_DISABLE){if(b&SBGrid.DEF.SB_CS_SELECT){a=this.m_htSelectStyle}if(b&SBGrid.DEF.SB_CS_DISABLE){a=this.m_htDisableStyle}}else{if(b&SBGrid.DEF.SB_CS_HOVER){a=this.m_htHoverStyle}if(b&SBGrid.DEF.SB_CS_SELECT){a=this.m_htSelectStyle}if(b&SBGrid.DEF.SB_CS_FOCUS){a=this.m_htFocusStyle}if(b&SBGrid.DEF.SB_CS_DOWN){a=this.m_htDownStyle}}}if(null!=a){for(var f in a){var d=a[f];if(!e){d=this.attribute[f]}if(SBGrid.DEF.SB_STYLELIST[f]){SBGrid.UT.HtmlLib.setStyle(this.m_heControl,f,d)}}}else{if(null!=this.m_heControl){if(b&SBGrid.DEF.SB_CS_DISABLE){var c=this.getEditControls();if(1==c){if(!e){this.m_heControl.style.backgroundColor=null!=this.attribute["background-color"]?this.attribute["background-color"]:""}else{this.m_heControl.style.backgroundColor=null!=this.attribute["disable.background-color"]?this.attribute["disable.background-color"]:"#EBEBE4"}}else{if(2==c){if(!e){this.m_heControl.style.color=null!=this.attribute.color?this.attribute.color:"#000000"}else{this.m_heControl.style.color=null!=this.attribute["disable.background-color"]?this.attribute["disable.background-color"]:"#EBEBE4"}}}}}}};SBGrid.CT.Control.prototype.getState=function(a){return this.m_dwState&a};SBGrid.CT.Control.prototype.isFocusValid=function(a){var b=this.m_heControl;while(null!=b&&"HTML"!=b.tagName&&"SBHE_body"!=b.id){if("hidden"==b.style.visibility||"none"==b.style.display||true==b.disabled){return false}if(SBGrid.DEF.is_firefox){b=b.parentNode}else{b=b.parentElement}}return true};SBGrid.CT.Control.prototype.getEditControls=function(){var a=this.elementName;if("softbowl:input"==a||"softbowl:comboinput"==a||"softbowl:output"==a||"softbowl:secret"==a||"softbowl:textarea"==a){a=null;return SBGrid.DEF.SBCT_EDIT}else{if("softbowl:select1"==a||"minimal"==this.attribute.appearance){a=null;return SBGrid.DEF.SBCT_EDIT}else{if("softbowl:button"==a){a=null;return SBGrid.DEF.SBCT_BUTTON}else{a=null;return SBGrid.DEF.SBCT_VIEW}}}};SBGrid.CT.Control.prototype.defaultAction=function(b,a){if(!this.isEnable()){return}switch(b){case"onactivate":this.onActivate(a);break;case"onmouseactivate":this.onMouseActivate(a);break;case"onmousemove":this.onMouseMove(a);break;case"onmousedown":this.onMouseDown(a);break;case"onmouseenter":this.onMouseEnter(a);break;case"onmouseup":this.onMouseUp(a);break;case"oncursor":this.onCursor(a);break;case"onmouseover":this.onMouseOver(a);break;case"onmouseout":this.onMouseOut(a);break;case"onclick":this.onClick(a);break;case"ondelayclick":this.onDelayClick(a);break;case"ondblclick":this.onDblClick(a);break;case"onfocus":this.onFocus(a);break;case"onblur":this.onBlur(a);break;case"onkeypress":this.onKeyPress(a);break;case"onkeydown":this.onKeyDown(a);break;case"onkeyup":this.onKeyUp(a);break;case"onscrolldown":this.onScrollDown(a);break;case"onscrollup":this.onScrollUp(a);break;case"onscrollpagedown":this.onScrollPageDown(a);break;case"onscrollpageup":this.onScrollPageUp(a);break;case"onscrollpos":this.onScrollPos(a);break;case"onscrolltrack":this.onScrollTrack(a);break;case"onscrolltrackdown":this.onScrollTrackDown(a);break;case"onscrolltrackup":this.onScrollTrackUp(a);break;case"onscroll":this.onScroll(a);break;case"onmousewheel":this.onMouseWheel(a);break;case"ontimer":this.onTimer(a);break;case"onnext":this.onNext(a);break;case"onprevious":this.onPrevious(a);break;case"softbowl-hint":this.onHint(a);break;case"oninvalid":this.onInvalid(a);break;case"onoptional":this.onOptional(a);break;case"onreadonly":this.onReadonly(a);break;case"onreadwrite":this.onReadWrite(a);break;case"onrequired":this.onRequired(a);break;case"onvalid":this.onvalid(a);break;case"onenabled":this.onEnabled(a);break;case"ondisabled":this.onDisabled(a);break;case"ondragenter":this.onDragEnter(a);break;case"ondragleave":this.onDragLeave(a);break;case"ondrop":this.onDrop(a);break;case"ondrag":this.onDrag(a);break;case"ondragover":this.onDragOver(a);break;case"ondragstart":this.onDragStart(a);break;case"onscrollmax":this.onScrollMax(a);break;case"onscrollmin":this.onScrollMin(a);break;case"onhint":this.onHint(a);break;case"onshowhint":this.onShowHint(a);break;case"onhidehint":this.onHideHint(a);break}};SBGrid.CT.Control.prototype.getClientLeft=function(a){var b=0;var c=this.m_heControl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heControl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.Control.prototype.getClientTop=function(a){var c=0;var b=this.m_heControl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heControl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.Control.prototype.preTranslateEvent=function(e){var d=e.targetX;var b=e.targetY;var f=null;var c=document.SBHE_allElement;if(null!=c.item(e.target)){f=c.item(e.target).m_heControl}var a=null!=f?f.getAttribute("id"):null;if(a){a=a.replace("SBHE_","")}while(null!=f&&a!=e.currentTarget){d+=f.offsetLeft;b+=f.offsetTop;if(a!=e.target){d=d+f.clientLeft-f.scrollLeft;b=b+f.clientLeft-f.scrollTop}f=f.offsetParent;if(f){a=f.getAttribute("id");if(a){a=a.replace("SBHE_","")}}}if(null!=f&&e.target!=e.currentTarget){d-=f.scrollLeft;b-=f.scrollTop}e.x=d;e.y=b};SBGrid.CT.Control.prototype.hide=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heControl).hide(a[0]);break;case 2:jQuery(this.m_heControl).hide(a[0],a[1]);break;case 3:jQuery(this.m_heControl).hide(a[0],a[1],a[2]);break;default:jQuery(this.m_heControl).hide();break}};SBGrid.CT.Control.prototype.show=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heControl).show(a[0]);break;case 2:jQuery(this.m_heControl).show(a[0],a[1]);break;case 3:jQuery(this.m_heControl).show(a[0],a[1],a[2]);break;default:jQuery(this.m_heControl).show();break}};SBGrid.CT.Control.prototype.fadeIn=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heControl).fadeIn(a[0]);break;case 2:jQuery(this.m_heControl).fadeIn(a[0],a[1]);break;case 3:jQuery(this.m_heControl).fadeIn(a[0],a[1],a[2]);break;default:jQuery(this.m_heControl).fadeIn();break}};SBGrid.CT.Control.prototype.fadeOut=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heControl).fadeOut(a[0]);break;case 2:jQuery(this.m_heControl).fadeOut(a[0],a[1]);break;case 3:jQuery(this.m_heControl).fadeOut(a[0],a[1],a[2]);break;default:jQuery(this.m_heControl).fadeOut();break}};SBGrid.CT.Control.prototype.slideUp=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heControl).slideUp(a[0]);break;case 2:jQuery(this.m_heControl).slideUp(a[0],a[1]);break;case 3:jQuery(this.m_heControl).slideUp(a[0],a[1],a[2]);break;default:jQuery(this.m_heControl).slideUp();break}};SBGrid.CT.Control.prototype.slideDown=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heControl).slideDown(a[0]);break;case 2:jQuery(this.m_heControl).slideDown(a[0],a[1]);break;case 3:jQuery(this.m_heControl).slideDown(a[0],a[1],a[2]);break;default:jQuery(this.m_heControl).slideDown();break}};SBGrid.CT.Control.prototype.animate=function(){var a=arguments;switch(a.length){case 1:jQuery(this.m_heControl).animate(a[0]);break;case 2:jQuery(this.m_heControl).animate(a[0],a[1]);break;case 3:jQuery(this.m_heControl).animate(a[0],a[1],a[2]);break;case 4:jQuery(this.m_heControl).animate(a[0],a[1],a[2],a[3]);break;default:jQuery(this.m_heControl).animate();break}};SBGrid.CT.Control.createAttribute=function(d,a){var b=new Array();for(var c in a.m_htCollection){switch(c){case"id":d.setAttribute("id","SBHE_"+a.item("id"));break;case"disabled":break;case"clsid":d.setAttribute("CLASSID","clsid:"+a.item("clsid"));break;case"class":jQuery(d).addClass(a.item("class"));break;default:if(SBGrid.DEF.SB_STYLELIST[c]){b.push(c+":"+a.item(c)+";")}else{d.setAttribute(c,a.item(c))}}}d.style.cssText=b.join("");d=SBGrid.CT.Element.createAttribute(d,a);return d};SBGrid.CT.Control.prototype.getTypeName=function(b){if(typeof b=="string"){var a=b.indexOf(":");return b.substring(a+1)}else{return null}};SBGrid.CT.Control.prototype.GenerateID=function(b){var a;var d=this.getTypeName(b);if(d!=null){for(var c=0;;c++){a=d+String(c);if(this.findElement(a)==-1){break}}}else{a=null}return a};SBGrid.CT.Control.prototype.findElement=function(b){var a;for(var c=0;c<document.SBHE_controls.length;c++){a=document.SBHE_controls.item(c);var d=a.id;if(d==b){return c}}return -1};SBGrid.CT.Control.prototype.onScrollMax=function(a){};SBGrid.CT.Control.prototype.onScrollMin=function(a){};SBGrid.CT.BindableControl=function(b,l,p,q,d,c,e,g,o,r,m,f,a,h,n,i){if(!o){return}SBGrid.CT.Control.call(this,b,l,p,q,d,e,g,o,r,a,h,n,i);this.value="";this.attribute.bind=c;if(""!=this.parent.jsonref&&null!=this.parent.jsonref){this.attribute.jsonref=f}else{this.attribute.ref=m}if(""==this.attribute.ref){this.attribute.jsonref=f}this.attribute.required=null;this.m_xlRefNode=null;this.m_bBinded=false;this.m_bCanBind=true;this.m_bBase64=false;var c=this.getAttribute("bind");if(null!=c&&!c.isEmpty()){this.m_bBinded=true}var m;m=this.getAttribute("jsonref");if(m==""||m==null){if(SBGrid.DEF.SB_SINGLE==this.getBindingType()){m=this.getAttribute("ref")}else{if(SBGrid.DEF.SB_MULTIPLE==this.getBindingType()){m=this.getAttribute("nodeset")}}}if(null!=m&&!m.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[m]){SBGrid.DEF.SB_REF_ATTR[m]=new SBGrid.DS.Hashtable();SBGrid.DEF.SB_REF_ATTR[m][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[m][this.id]=this}this.m_bBinded=true}};SBGrid.CT.BindableControl.prototype=new SBGrid.CT.Control;SBGrid.CT.BindableControl.prototype.init=function(){SBGrid.CT.Control.prototype.init.call(this);this.m_xlRefNode=this.getControlNodeList()};SBGrid.CT.BindableControl.prototype.refresh=function(){SBGrid.CT.Control.prototype.refresh.call(this);this.m_xlRefNode=this.getControlNodeList()};SBGrid.CT.BindableControl.prototype.getRefNode=function(){var a=this.attribute.jsonref;if(null!=a&&!a.isEmpty()){return this.m_xlRefNode}else{return"string"==typeof(this.m_xlRefNode)?null:this.m_xlRefNode}};SBGrid.CT.BindableControl.prototype.setRefNode=function(a){this.m_xlRefNode=a};SBGrid.CT.BindableControl.prototype.isBinded=function(){return this.m_bBinded};SBGrid.CT.BindableControl.prototype.setBinded=function(a){this.m_bBinded=a};SBGrid.CT.BindableControl.prototype.isCanBind=function(){return this.m_bCanBind};SBGrid.CT.BindableControl.prototype.setCanBind=function(a){this.m_bCanBind=a};SBGrid.CT.BindableControl.prototype.getValue=function(){if(false){}else{var strJsonRef=this.attribute.jsonref;if(null!=strJsonRef&&!strJsonRef.isEmpty()){try{if(eval("typeof "+strJsonRef)!="undefined"){var strValue=String(eval(strJsonRef));if(null!=strValue){return strValue}}}catch(e){return""}}this.m_xlRefNode=this.getControlNodeList();if(null!=this.m_xlRefNode&&0<this.m_xlRefNode.length){return SBGrid.UT.XmlLib.getTextValue(this.m_xlRefNode.item(0))}if("softbowl:caption"==this.getElementName()){return this.getText()}else{if("softbowl:button"==this.getElementName()){return this.getText()}else{if("softbowl:treeview"==this.getElementName()){return this.getText()}}}return""}};SBGrid.CT.BindableControl.prototype.setValue=function(d){if(this.attribute.jsonref!=""&&this.attribute.jsonref!=null){try{SBGrid.DS.JsonStorage.getUniqueStorage().setValue(this.attribute.jsonref,d);this.refreshCurrentModel(this.attribute.jsonref)}catch(c){return}}else{if(null!=this.m_xlRefNode&&0<this.m_xlRefNode.length){var a=this.m_xlRefNode.item(0);var b=SBGrid.DS.XMLStorage.getUniqueStorage().attribute.autocdata;var f=SBGrid.DS.XMLStorage.getUniqueStorage().isProcessAutoCdata(d);if(b&&f){}else{SBGrid.UT.XmlLib.setTextValue(a,d)}}else{this.setText(d)}this.refreshCurrentModel(this.attribute.ref)}};SBGrid.CT.BindableControl.prototype.getControlNodeList=function(){if(null==SBGrid.DS.XMLStorage.getUniqueStorage()){return null}var strBind=this.getAttribute("bind");if(null!=strBind&&!strBind.isEmpty()){this.m_bBinded=true}else{var strRef;strRef=this.getAttribute("jsonref");if(strRef==""||strRef==null){if(SBGrid.DEF.SB_SINGLE==this.getBindingType()){strRef=this.getAttribute("ref")}else{if(SBGrid.DEF.SB_MULTIPLE==this.getBindingType()){strRef=this.getAttribute("nodeset")}}if(null!=strRef&&!strRef.isEmpty()){this.m_bBinded=true;return SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strRef)}}else{this.m_bBinded=true;try{var strReturn=eval(this.getAttribute("jsonref"));return strReturn}catch(e){return""}}}return null};SBGrid.CT.BindableControl.prototype.setAttribute=function(b,c){SBGrid.CT.Control.prototype.setAttribute.call(this,b,c);switch(b){case"bind":this.attribute.bind=c;break;case"ref":var a=this.attribute.ref;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[a]){SBGrid.DEF.SB_REF_ATTR[a][this.id]=null}}this.attribute.ref=c;if(null!=c&&!c.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[c]){SBGrid.DEF.SB_REF_ATTR[c]=new SBGrid.DS.Hashtable();SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}}this.m_bBinded=true;break;case"jsonref":var d=this.attribute.jsonref;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[d]){SBGrid.DEF.SB_REF_ATTR[d][this.id]=null}}this.attribute.jsonref=c;if(null!=c&&!c.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[c]){SBGrid.DEF.SB_REF_ATTR[c]=new SBGrid.DS.Hashtable();SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[c][this.id]=this}}this.m_bBinded=true;break}};SBGrid.CT.BindableControl.prototype.isBindControlByNode=function(c){this.m_xlRefNode=this.getControlNodeList();if(null!=this.m_xlRefNode){for(var b=0;b<this.m_xlRefNode.length;b++){var a=this.getAttribute("jsonref");if(a==""||a==null){var d=this.m_xlRefNode.item(b)}else{return false}if(c==d){return true}}}return false};SBGrid.CT.BindableControl.prototype.isBindControlByXPath=function(b){var a;a=this.getAttribute("jsonref");if(a==""||a==null){if(SBGrid.DEF.SB_SINGLE==this.getBindingType()){a=this.getAttribute("ref")}else{if(SBGrid.DEF.SB_MULTIPLE==this.getBindingType()){a=this.getAttribute("nodeset")}}}return(a==b)};SBGrid.CT.BindableControl.createAttribute=function(b,a){b=SBGrid.CT.Control.createAttribute(b,a);return b};SBGrid.CT.Caption=function(d,h,e,u,t,o,v,l,n,r,m,c,a,s,f,b,g,q,x,w,p,i){if(!a){return}SBGrid.CT.BindableControl.call(this,d,h,e,u,o,l,n,r,a,s,f,b,x,w,p,i);t=t.split("__SB_STR_N").join("\\n");t=t.split("__SB_STR_T").join("\\t");t=t.split("__SB_STR_R").join("\\r");t=t.split("__SB_N").join("\n");t=t.split("__SB_T").join("\t");t=t.split("__SB_R").join("\r");this.attribute.text=t;this.attribute.autoresize=String(v);this.attribute.ellipsis=String(m);this.attribute.format=c;this.attribute.roundmode=g;this.attribute.roundposition=String(q);this.ellipsis=m;this.label=t;this.m_heControlText=document.getElementById("SBHE_"+this.id+"_TEXT")};SBGrid.CT.Caption.prototype=new SBGrid.CT.BindableControl;SBGrid.CT.Caption.prototype.init=function(){SBGrid.CT.BindableControl.prototype.init.call(this);if("softbowl:caption"==this.attribute.tag||"softbowl:output"==this.attribute.tag||"softbowl:button"==this.attribute.tag){if("true"!=this.attribute.autoresize){if("softbowl:button"==this.attribute.tag){this.m_heControl.style.textOverflow="";this.m_heControl.style.overflow="hidden"}else{this.m_heControlText.style.textOverflow="";this.m_heControlText.style.overflow="hidden"}if(""!=this.attribute.ellipsis){this.setEllipsis(this.attribute.ellipsis)}}else{if("softbowl:button"==this.attribute.tag){this.m_heControlText.style.overflow="visible"}else{this.m_heControl.style.overflow="visible";this.m_heControl.style.width="";this.m_heControl.style.height=""}}}};SBGrid.CT.Caption.prototype.getAbility=function(){return SBGrid.DEF.SBEA_CONTROL|SBGrid.DEF.SBEA_HSB_AS_FORMAT|SBGrid.DEF.SBEA_HSB_AS_TEXT};SBGrid.CT.Caption.prototype.refresh=function(){if(null!=this.m_heControl){var b="";if(this.m_bBinded){b=this.getValue()}else{b=this.getAttribute("text")}this.value=b;var a=SBGrid.DEF.formatStatus(this.attribute.format);if(0!=a){if(null==b){b=""}b=b.formatting(this.attribute.format);if(4==a&&""!=this.attribute.roundmode&&""!=this.attribute.roundposition){b=SBGrid.DEF.getRoundMode(b,this.attribute.roundmode,this.attribute.roundposition)}}if(null!=this.m_heControlText){if(null==b){b=""}b=b.newlineCharConvert();this.m_heControlText.innerHTML=b;this.label=this.m_heControlText.innerText}}};SBGrid.CT.Caption.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Caption.prototype.setText=function(a){if("number"==typeof(a)){a=a+""}if(null!=this.m_heControlText){SBGrid.CT.BindableControl.prototype.setText.call(this,a);if(null==a){a=""}this.m_heControlText.innerHTML=a.newlineCharConvert()}};SBGrid.CT.Caption.prototype.setAttribute=function(b,c){SBGrid.CT.BindableControl.prototype.setAttribute.call(this,b,c);switch(b){case"text":if("softbowl:caption"==this.attribute.tag||"softbowl:output"==this.attribute.tag){this.text=c;this.attribute.text=c;this.setText(c);break}case"autoresize":if("true"==c.toString()){if("false"==this.attribute.autoresize){jQuery(this.m_heControl.firstChild).removeClass("sbgrid_table_fixed")}this.attribute.autoresize="true";this.m_heControl.style.overflow="visible";this.m_heControl.style.width="";this.m_heControl.style.height=""}else{if("false"==c){if("true"==this.attribute.autoresize){jQuery(this.m_heControl.firstChild).addClass("sbgrid_table_fixed")}this.attribute.autoresize="false";this.m_heControl.style.overflow="hidden";this.m_heControl.style.width=this.attribute.width;this.m_heControl.style.height=this.attribute.height}}break;case"ellipsis":var a="true"==c;this.setEllipsis(a);break;case"format":this.attribute.format=c;break;case"roundmode":this.attribute.roundmode=c;break;case"roundposition":this.attribute.roundposition=c;break}};SBGrid.CT.Caption.prototype.setEllipsis=function(a){a=String(a);this.ellipsis=a;this.attribute.ellipsis=a;var b=this.attribute.tag;if("softbowl:button"!=b){if("true"==a){this.m_heControlText.style.textOverflow="ellipsis";this.m_heControlText.style.whiteSpace="nowrap";if(SBGrid.DEF.is_ie7){this.m_heControlText.noWrap="nowrap"}}else{this.m_heControlText.style.textOverflow="clip";this.m_heControlText.style.whiteSpace="normal";if(SBGrid.DEF.is_ie7){this.m_heControlText.noWrap=""}}}else{if("true"==a){if(null!=this.m_heControlText){this.m_heControlText.style.textOverflow="ellipsis"}else{this.m_heControl.style.textOverflow="ellipsis"}this.m_heControlText.style.whiteSpace="nowrap";if(SBGrid.DEF.is_ie7){this.m_heControlText.noWrap=true}}else{if(null!=this.m_heControlText){this.m_heControlText.style.textOverflow="clip";this.m_heControlText.style.whiteSpace="normal"}this.m_heControl.style.textOverflow="clip";this.m_heControl.style.whiteSpace="normal";if(SBGrid.DEF.is_ie7){this.m_heControl.noWrap=false}}}};SBGrid.CT.Caption.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"caption");var e=SBGrid.CT.Caption.createMainNode(c);var b=document.getElementById("SBHE_"+a);b.appendChild(e);e=SBGrid.CT.Caption.createSubNodes(e,c);return SBGrid.CT.Caption.createObject(a,e,c,d)};SBGrid.CT.Caption.createMainNode=function(a){var b=document.createElement("span");jQuery(b).addClass("sbgrid_caption_div sbgrid_boxsizing");b=SBGrid.CT.Caption.createAttribute(b,a);return b};SBGrid.CT.Caption.createSubNodes=function(g,d){var f=d.item("id");var h=document.createElement("table");h.cellspacing="0";h.cellpadding="0";h.onclick=function(){};h.ondbclick=function(){};h.onmousedown=function(){};h.onmousemove=function(){};h.onmouseup=function(){};g.appendChild(h);var e=document.createElement("tbody");h.appendChild(e);var a=document.createElement("tr");var b=document.createElement("td");jQuery(e).addClass("sbgrid_caption_tbody");g=SBGrid.CT.BindableControl.createAttribute(g,d);var c=d.item("autoresize");if(null!=c){if("true"==c){jQuery(h).addClass("sbgrid_caption_table")}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}jQuery(b).addClass("sbgrid_caption_td");b.setAttribute("id","SBHE_"+f+"_TEXT");if(g.getAttribute("text")){jQuery(b).text(g.getAttribute("text").newlineCharConvert())}a.appendChild(b);e.appendChild(a);return g};SBGrid.CT.Caption.createObject=function(e,c,z,C){var m="";var f="";var B="";var A="";var u="";var q=false;var o="";var s="";var x=false;var r=false;var d="";var a="";var y=9007199254740992;var h="";var b="";var l="";var w=0;var v="visible";var n="";for(var t=0;t<z.count();t++){var g=z.keys()[t];switch(g){case"alert":m=z.item(g);break;case"help":f=z.item(g);break;case"hint":B=z.item(g);break;case"text":A=z.item(g);break;case"accesskey":u=z.item(g);break;case"autoreisze":if("true"==z.item(g)){q=true}break;case"bind":o=z.item(g);break;case"class":s=z.item(g);break;case"disabled":if("true"==z.item(g)){x=true}break;case"ellipsis":if("true"==z.item(g)){r=true}break;case"format":d=z.item(g);break;case"id":a=z.item(g);break;case"navindex":y=parseInt(z.item(g));break;case"ref":h=z.item(g);break;case"jsonref":b=z.item(g);break;case"roundmode":l=z.item(g);break;case"roundposition":w=parseInt(z.item(g));break;case"visibility":v=z.item(g);break;default:if(!SBGrid.DEF.SB_STYLELIST[g]){n+=g+":"+z.item(g)+"; "}break}}var p=new SBGrid.CT.Caption(e,m,f,B,A,u,q,o,s,x,r,d,a,y,h,b,l,w,C,"softbowl:caption",v,n);return p};SBGrid.CT.Caption.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);b.cellSpacing=0;b.cellPadding=0;return b};SBGrid.CT.Group=function(d,h,e,t,o,m,n,r,b,s,a,f,g,c,l,q,v,u,p,i){if(!b){return}SBGrid.CT.BindableControl.call(this,d,h,e,t,o,m,n,r,b,s,g,c,v,u,p,i);this.m_winPopup=null;this.m_bApplyPadding=false;this.attribute.overflow=a;this.attribute.popup=String(f);this.attribute.scroll=l;this.attribute.showeffect=q;this.selected;this.m_nSelectedRow=-1;this.m_nSelectedCol=-1;this.m_bScoll=false;if(SBGrid.DEF.is_smartphone){this.bIsExpansion=false}};SBGrid.CT.Group.prototype=new SBGrid.CT.BindableControl;SBGrid.CT.Group.prototype.init=function(){SBGrid.CT.BindableControl.prototype.init.call(this);if("xhtml:body"!=this.tag){var a=this.getAttribute("appearance");if("softbowl:input"!=this.tag&&"softbowl:comboinput"!=this.tag&&"minimal"!=a){if(null!=this.m_heControl){this.m_heControl.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', this.id.replace('SBHE_', ''))")}}}this.vscroll=new SBGrid.CT.ScrollBar(this.id,this.id+"_vscroll","softbowl:scrollbar","vscroll",-1!=this.attribute.tag.indexOf("datagrid"));this.hscroll=new SBGrid.CT.ScrollBar(this.id,this.id+"_hscroll","softbowl:scrollbar","hscroll",-1!=this.attribute.tag.indexOf("datagrid"));if(null!=this.m_heControl){this.vscroll.init();this.hscroll.init();if("softbowl:datagrid"!=this.tag){this.setAttribute("overflow",this.attribute.overflow);if("scroll"==this.attribute.overflow){this.setScroll(this.attribute.scroll)}}var c=false;var d=this;while("xhtml:body"!=d.elementName){if("softbowl:datagrid"==d.elementName){c=true;break}d=d.parent}if("softbowl:group"==this.attribute.tag){if(SBGrid.DEF.is_ie9){jQuery(this.m_heControl).removeClass("sbgrid_boxsizing");this.resizing()}}}if(SBGrid.DEF.is_smartphone){if(null!=this.m_heControl){this.m_nOriginWidth=this.m_heControl.offsetWidth;this.m_nOriginHeight=this.m_heControl.offsetHeight;var b=this.elementName;if("softbowl:group"==b){this.makeGroupExpansion()}}}};SBGrid.CT.Group.prototype.resizing=function(){var i=this.m_heControl;if(null!=i){var a=SBGrid.DEF.is_ie?i.currentStyle.width:window.getComputedStyle(i,null).width;if(-1==a.indexOf("%")){var e=SBGrid.DEF.is_ie?i.currentStyle.borderLeftWidth:window.getComputedStyle(i,null).borderLeftWidth;var d=SBGrid.DEF.is_ie?i.currentStyle.borderRightWidth:window.getComputedStyle(i,null).borderRightWidth;var f=(parseInt(a)-parseInt(e)-parseInt(d));i.style.width=1>f?parseInt(a):f+"px"}var g=SBGrid.DEF.is_ie?i.currentStyle.height:window.getComputedStyle(i,null).height;if(-1==g.indexOf("%")){var b=SBGrid.DEF.is_ie?i.currentStyle.borderTopWidth:window.getComputedStyle(i,null).borderTopWidth;var c=SBGrid.DEF.is_ie?i.currentStyle.borderBottomWidth:window.getComputedStyle(i,null).borderBottomWidth;var h=(parseInt(g)-parseInt(b)-parseInt(c));i.style.height=1>h?parseInt(g):h+"px"}}};SBGrid.CT.Group.prototype.applyDefaultStyle=function(){};SBGrid.CT.Group.prototype.getAbility=function(){return SBGrid.DEF.SBEA_GROUP};SBGrid.CT.Group.prototype.getPopup=function(){return this.m_winPopup};SBGrid.CT.Group.prototype.isApplyPadding=function(){return this.m_bApplyPadding};SBGrid.CT.Group.prototype.setApplyPadding=function(a){this.m_bApplyPadding=a};SBGrid.CT.Group.prototype.refresh=function(){SBGrid.CT.BindableControl.prototype.refresh.call(this);var a=this.children.keys();if(SBGrid.DEF.is_chrome){for(var b=0;b<a.length;b++){var d=a[b];var c=document.SBHE_allElement.item(d);if(null!=c&&c instanceof SBGrid.CT.Element&&c.refresh){c.refresh()}}}else{for(var b=0;b<this.children.length;b++){var d=a[b];var c=this.children.item(d);if(null!=c&&c instanceof SBGrid.CT.Element&&c.refresh){c.refresh()}}}};SBGrid.CT.Group.prototype.setAttribute=function(a,b){SBGrid.CT.BindableControl.prototype.setAttribute.call(this,a,b);switch(a){case"width":if("softbowl:group"==this.attribute.tag){this.resizing()}break;case"height":if("softbowl:group"==this.attribute.tag){this.resizing()}break;case"overflow":this.attribute.overflow=b;this.setOverflow(b);break;case"scroll":this.attribute.scroll=b;this.setScroll(b);break}};SBGrid.CT.Group.prototype.setSelected=function(a){if(a){this.onSelect()}else{this.onDeSelect()}};SBGrid.CT.Group.prototype.onSelect=function(a){this.selected=true;if(null!=this.m_jsonCssEvent.select){var b=this.compareStyle(this.m_jsonCssEvent.select);this.m_heControl.style.cssText=b}};SBGrid.CT.Group.prototype.onDeSelect=function(a){this.selected=false;if(null!=this.m_jsonCssEvent.normal){this.m_heControl.style.cssText=this.m_jsonCssEvent.normal}};SBGrid.CT.Group.prototype.setScroll=function(a){if("softbowl:datagrid"==this.tag){this.setScrollGrid(a);return}switch(a){case"vertical":this.m_heControl.style.overflowX="hidden";this.m_heControl.style.overflowY="scroll";break;case"horizontal":this.m_heControl.style.overflowX="scroll";this.m_heControl.style.overflowY="hidden";break;case"both":this.m_heControl.style.overflowX="scroll";this.m_heControl.style.overflowY="scroll";break;case"autovscroll":this.m_heControl.style.overflowX="hidden";this.m_heControl.style.overflowY="auto";break;case"autohscroll":this.m_heControl.style.overflowX="auto";this.m_heControl.style.overflowY="hidden";break;case"none":this.m_heControl.style.overflowX="visible";this.m_heControl.style.overflowY="visible";break;default:if(SBGrid.DEF.is_chrome){this.m_heControl.style.overflowX="";this.m_heControl.style.overflowY=""}else{this.m_heControl.style.overflowX="auto";this.m_heControl.style.overflowY="auto";if("softbowl:textarea"==this.tag){this.m_heControl.style.overflowX="hidden";this.m_heControl.style.overflowY="auto"}}break}};SBGrid.CT.Group.prototype.setOverflow=function(a){if("softbowl:datagrid"==this.tag){this.setOverflowGrid(a);return}switch(a){case"visible":this.m_heControl.style.overflowX="visible";this.m_heControl.style.overflowY="visible";break;case"hidden":this.m_heControl.style.overflowX="hidden";this.m_heControl.style.overflowY="hidden";break;case"scroll":this.m_heControl.style.overflowX="auto";this.m_heControl.style.overflowY="auto";break;default:break}};SBGrid.CT.Group.prototype.overflow=function(){var h=0;var c=0;var a=this;var b=false;while("xhtml:body"!=a.elementName){if(null!=a.m_heControl){h+=a.m_heControl.offsetLeft;c+=a.m_heControl.offsetTop}a=a.parent}h+=this.m_heControl.offsetWidth;c+=this.m_heControl.offsetHeight;a=this.parent;if("xhtml:html"==a.elementName){return}var g=0;var e=0;while("xhtml:body"!=a.elementName){if("softbowl:group"==a.elementName&&("visible"==a.getAttribute("overflow"))){if(null!=a.m_heControl){g=a.m_heControl.offsetLeft+a.m_heControl.offsetWidth;g=a.m_heControl.offsetTop+a.m_heControl.offsetHeight;var f=(h>g)?h:g;var d=(c>e)?c:e;a.setAttribute("width",f-a.m_heControl.offsetLeft);a.setAttribute("height",d-a.m_heControl.offsetTop)}}a=a.parent}};SBGrid.CT.Group.prototype.childReturnObj=function(b){var a=this.children.item(b);if(null!=a){return a}else{return null}};SBGrid.CT.Group.prototype.isChild=function(b){var a=this.children.item(b);if(null!=a){return true}else{return false}};SBGrid.CT.Group.prototype.isDescendants=function(d,a){if(null==a){a=false}var c=document.SBHE_allElement.item(d);if(null!=c){if(true==a){if(c==this){return true}}var b=c.parent;while(null!=b){if(b==this){return true}b=b.parent}return false}return false};SBGrid.CT.Group.prototype.setSelectedRow=function(a){this.m_nSelectedRow=a;this.attribute.row=a};SBGrid.CT.Group.prototype.setSelectedCol=function(a){this.m_nSelectedCol=a;this.attribute.col=a};SBGrid.CT.Group.prototype.getCellById=function(a){return this.children.m_htCollection[a]};SBGrid.CT.Group.prototype.getCell=function(a,c){var b=this.id+"_"+a+"_"+c;return this.children.m_htCollection[b]};SBGrid.CT.Group.prototype.isCell=function(b){var a=this.children.item(b);if(null!=a){return(this==a.parent)}return false};SBGrid.CT.Group.prototype.isScrollBar=function(c){var b=this.getClientLeft()+this.m_heControl.offsetWidth;var a=this.getClientTop()+this.m_heControl.offsetHeight;if(this._isVScroll()&&b-15<=c.clientX&&c.clientX<=b){return true}if(this._isHScroll()&&a-15<=c.clientY&&c.clientY<=a){return true}return false};SBGrid.CT.Group.prototype.isDragCellSelect=function(c,d,b){if(b.selected){var a=this.getCellContentRect(c,d);if((a.getBottom()-6)<=SBGrid.DEF.m_event.y){return true}}return false};SBGrid.CT.Group.prototype._isVScroll=function(){return this.m_heControl.clientHeight<this.m_heControl.scrollHeight};SBGrid.CT.Group.prototype._isHScroll=function(){return this.m_heControl.clientWidth<this.m_heControl.scrollWidth};SBGrid.CT.Group.prototype.getMouseRow=function(){return this.getAttribute("row")};SBGrid.CT.Group.prototype.setMouseRow=function(a){this.setAttribute("row",a)};SBGrid.CT.Group.prototype.getMouseCol=function(){return this.getAttribute("col")};SBGrid.CT.Group.prototype.setMouseCol=function(a){this.setAttribute("col",a)};SBGrid.CT.Group.create=function(a,d,e){d=SBGrid.CT.Element.createClassName(d,"group");var c=SBGrid.CT.Group.createMainNode(d);var b=document.getElementById(a);b.appendChild(c);c=SBGrid.CT.Group.createSubNodes(c,d);return SBGrid.CT.Group.createObject(a,c,d,e)};SBGrid.CT.Group.createMainNode=function(b){var a=document.createElement("div");a=SBGrid.CT.Group.createAttribute(a,b);jQuery(a).addClass("sbgrid_group");jQuery(a).addClass("sbgrid_boxsizing");return a};SBGrid.CT.Group.createSubNodes=function(a,b){return a};SBGrid.CT.Group.createObject=function(c,m,y,A){var l="";var d="";var z="";var t="";var p="";var r="";var w=false;var a="";var x=9007199254740992;var h="scroll";var f=false;var g="";var b="";var o="auto";var v="blend 300";var u="visible";var n="";for(var s=0;s<y.count();s++){var e=y.keys()[s];switch(e){case"alert":l=y.item(e);break;case"help":d=y.item(e);break;case"hint":z=y.item(e);break;case"accesskey":t=y.item(e);break;case"bind":p=y.item(e);case"class":r=y.item(e);break;case"disabled":if("true"==y.item(e)){w=true}break;case"id":a=y.item(e);break;case"navindex":x=parseInt(y.item(e));break;case"overflow":h=y.item(e);break;case"popup":if("true"==y.item(e)){f=true}break;case"ref":g=y.item(e);break;case"jsonref":b=y.item(e);break;case"scroll":o=y.item(e);break;case"showeffect":v=y.item(e);break;case"visibility":u=y.item(e);break;default:if(!SBGrid.DEF.SB_STYLELIST[e]){n+=e+":"+y.item(e)+"; "}break}}var q=new SBGrid.CT.Group(c,l,d,z,t,p,r,w,a,x,h,f,g,b,o,v,A,"softbowl:group",u,n);return q};SBGrid.CT.Group.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);return b};SBGrid.CT.Group.prototype.makeGroupExpansion=function(){var a=document.getElementById("__GROUP_EXPANSION_"+this.id);if(null==a){a=document.createElement("image");a.setAttribute("onclick",'SBGrid.CT.Group.onClickExpansion(event, "'+this.id+'")');a.setAttribute("id","__GROUP_EXPANSION_"+this.id);a.setAttribute("src",SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGolbalExpansion);a.style.position="absolute";a.style.top=(this.m_heControl.offsetTop+this.m_heControl.offsetHeight-20)+"px";a.style.left=(this.m_heControl.offsetLeft+this.m_heControl.offsetWidth-20)+"px";if("visible"==this.getAttribute("overflow")||"hidden"==this.getAttribute("overflow")){a.style.display="none"}document.body.appendChild(a)}};SBGrid.CT.Group.prototype.getOffsetLeft=function(){var a=this.elementName;var b=this;var c=0;while("xhtml:body"!=a){c+=b.m_heControl.offsetLeft;b=b.parent;a=b.elementName}return c};SBGrid.CT.Group.prototype.getOffsetTop=function(){var a=this.elementName;var c=this;var b=0;while("xhtml:body"!=a){b+=c.m_heControl.offsetTop;c=c.parent;a=c.elementName}return b};SBGrid.CT.Group.prototype.moveGroupExpansion=function(){if(SBGrid.DEF.is_smartphone){if(this.bIsExpansion){var d=document.getElementById("__GROUP_EXPANSION_"+this.id);if(null!=d){var g=this.getOffsetLeft()+this.m_heControl.offsetWidth;var e=this.getOffsetTop()+this.m_heControl.offsetHeight;var b=window.scrollX+window.innerWidth;var h=window.scrollY+window.innerHeight;var f=this.m_heControl.offsetLeft;var a=this.m_heControl.offsetTop;var c=(g>b)?b:g;var i=(e>h)?h:e;c=(f<c)?c:f;i=(a<i)?i:a;d.style.top=(i-20)+"px";d.style.left=(c-20)+"px"}}}};SBGrid.CT.Group.onClickExpansion=function(a,h){var g=document.SBHE_allElement.item(h);var m=document.getElementById("SBHE_"+h);var d=document.getElementById("__GROUP_EXPANSION_"+h);if(null!=m){if(!g.bIsExpansion){var f=(g.m_nOriginWidth>m.scrollWidth)?g.m_nOriginWidth:m.scrollWidth;var o=(g.m_nOriginHeight>m.scrollHeight)?g.m_nOriginHeight:m.scrollHeight;m.style.width=f+"px";m.style.height=o+"px";g.setAttribute("overflow","visible");g.bIsExpansion=true;d.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGlobalReturn;var b=window.scrollX+window.innerWidth;var l=window.scrollY+window.innerHeight;var i=g.m_heControl.offsetLeft+m.offsetWidth;var e=g.m_heControl.offsetTop+m.offsetHeight;var c=((i>b)?b:i);var n=((e>l)?l:e);d.style.left=((c-20)<0)?"0px":(c-20)+"px";d.style.top=((n-20)<0)?"0px":(n-20)+"px"}else{m.style.width=g.m_nOriginWidth+"px";m.style.height=g.m_nOriginHeight+"px";g.setAttribute("overflow","hidden");g.bIsExpansion=false;d.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGlobalExpansion;d.style.left=(g.m_heControl.offsetLeft+m.offsetWidth-20)+"px";d.style.top=(g.m_heControl.offsetTop+m.offsetHeight-20)+"px"}}};SBGrid.CT.ScrollBar=function(a,e,c,d,b){if(!a){return}SBGrid.CT.Control.call(this,a,"","","","","",false,e,10000,"",c,"","");this.attribute.min="0";this.attribute.max="0";this.attribute.pos="0";this.is_bGrid=b;this.m_strType=d;this.m_targetControl=null;this.nPrevScrollPositon=0;this.nPrevMax=0};SBGrid.CT.ScrollBar.prototype=new SBGrid.CT.Control;SBGrid.CT.ScrollBar.prototype.init=function(){if(null!=this.parent){if(null!=this.parent.m_heControl){if(!this.is_bGrid){this.m_targetControl=this.parent.m_heControl}else{this.m_targetControl=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.parent.id)}if(null!=this.m_targetControl){if("vscroll"==this.m_strType){this.attribute.max=parseInt(this.m_targetControl.scrollHeight-this.m_targetControl.clientHeight);this.attribute.pos=parseInt(this.m_targetControl.scrollTop)}else{this.attribute.max=parseInt(this.m_targetControl.scrollWidth-this.m_targetControl.clientWidth);this.attribute.pos=parseInt(this.m_targetControl.scrollLeft)}}}}};SBGrid.CT.ScrollBar.prototype.setAttribute=function(a,b){switch(a){case"pos":this.attribute.pos=b;if(null!=this.m_targetControl){if("vscroll"==this.m_strType){this.m_targetControl.scrollTop=parseInt(b)}else{this.m_targetControl.scrollLeft=parseInt(b)}}break}};SBGrid.CT.ScrollBar.prototype.refresh=function(){if(null==this.m_targetControl){this.init();return}if(null!=this.m_targetControl){if("vscroll"==this.m_strType){this.attribute.max=parseInt(this.m_targetControl.scrollHeight-this.m_targetControl.clientHeight);this.attribute.pos=parseInt(this.m_targetControl.scrollTop)}else{this.attribute.max=parseInt(this.m_targetControl.scrollWidth-this.m_targetControl.clientWidth);this.attribute.pos=parseInt(this.m_targetControl.scrollLeft)}}};SBGrid.CT.ScrollBar.prototype.getScrollPosition=function(){return this.attribute.pos};SBGrid.CT.ScrollBar.prototype.getScrollMax=function(){return this.attribute.max};SBGrid.CT.ScrollBar.prototype.setScrollPosition=function(a){this.attribute.pos=parseInt(a);if(a!=this.nPrevScrollPositon){if(a<this.nPrevScrollPositon){this.dispatch("onscrollup")}else{this.dispatch("onscrolldown")}this.nPrevScrollPositon=a}};SBGrid.CT.ScrollBar.prototype.setScrollMax=function(a){this.attribute.max=parseInt(a)};SBGrid.CT.ScrollBar.prototype.getPrevScrollPosition=function(){return this.nPrevScrollPositon};SBGrid.CT.DIV=function(d,h,e,u,q,n,p,s,b,t,a,f,o,c,g,m,l,i,w,v,r){if(!b){return}SBGrid.CT.Group.call(this,d,h,e,u,q,"",p,s,b,t,a,"","","",i,"",w,v,r);this.m_bShowPopupMenu=true;this.m_bSetPopupMenu=false};SBGrid.CT.DIV.prototype=new SBGrid.CT.Group;SBGrid.CT.DIV.init=function(){if(null==this.m_heControl){this.m_heControl=document.getElementById(this.id)}SBGrid.CT.Group.prototype.init.call(this)};SBGrid.CT.DIV.create=function(v,A,K){var x="";var t="";var o="";var n="";var y="";var U="";var l="";var P=false;var r=false;var e=false;var b=true;var E=true;var u="";var w=false;var f="";var h="";var O="";var N="";var q=false;var J="exclude";var s=-1;var S=-1;var L=9007199254740992;var m="";var G="default";var Q="";var a="";var B=false;var H="";var p=0;var F="none";var M="";var g=false;var D="";var T="softbowl:input";var I=false;var C="visible";var d="";for(var R=0;R<A.count();R++){var c=A.keys()[R];switch(c){case"alert":x=A.item(c);break;case"help":t=A.item(c);break;case"hint":o=A.item(c);break;case"accesskey":n=A.item(c);break;case"autonext":if("true"==A.item(c)){y=true}break;case"bind":U=A.item(c);break;case"class":l=A.item(c);break;case"disabled":if("true"==A.item(c)){P=true}break;case"dragmode":if("true"==A.item(c)){r=true}case"dropmode":if("true"==A.item(c)){e=true}break;case"editable":if("false"==A.item(c)){b=false}break;case"editmenu":if("false"==A.item(c)){E=false}break;case"format":u=A.item(c);break;case"decimalformatinsert":w=A.item(c);break;case"id":f=A.item(c);break;case"imemode":h=A.item(c);break;case"inputtype":O=A.item(c);break;case"invalidcharacters":N=A.item(c);break;case"isemptyformatted":if("true"==A.item(c)){q=true}break;case"mask":J=A.item(c);break;case"maxbyte":s=parseInt(A.item(c));break;case"maxlength":S=parseInt(A.item(c));break;case"navindex":L=parseInt(A.item(c));break;case"pastemode":G=A.item(c);break;case"ref":Q=A.item(c);break;case"jsonref":a=A.item(c);break;case"required":if("true"==A.item(c)){B=true}break;case"roundmode":H=A.item(c);break;case"roundposition":p=parseInt(A.item(c));break;case"showmask":if("true"==A.item(c)){g=true}break;case"tag":T=A.item(c);break;case"validateformat":if("true"==A.item(c)){I=true}break;case"visibility":C=A.item(c);break;default:if(!SBGrid.DEF.SB_STYLELIST[c]){d+=c+":"+A.item(c)+"; "}break}}var z=new SBGrid.CT.DIV(v,x,t,o,n,true,l,P,f,L,"","","","","","","",F,K,"softbowl:DIV",C);return z};SBGrid.CT.DataGridCell=function(a,e,d,b,c){this.elementName=c;this.id=d;this.tag=c;this.col=e;this.row=b;this.parent=a;this.attribute=new SBGrid.DS.Hashtable();this.rowstatus=SBGrid.DEF.SBGS_NEW;this.colstatus=true;this.mergeType=SBGrid.DEF.SBSM_NORMAL;this.mergeParentId=null;this.m_bMerge=true;this.m_nRowSpan=1;this.m_nColSpan=1;this.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;this.m_fixedCheckStatus=false;this.m_fixedNoCheckAll=false;this.m_xnNodeElement;this.m_jsonObject;this.m_bIsSubTotal=false;this.m_heControl=null;this.m_heDataControl=null;this.m_objElement=null;this.attribute.id=d;this.attribute.tag=c;this.editing=false;this.selected=false;this.isReadOnly=false;this.disabled=false;this.setParent();a=null;e=null;d=null;b=null;c=null};SBGrid.CT.DataGridCell.prototype.setParent=function(){this.parent.children.add(this.id,this);document.SBHE_allElement.add(this.id,this)};SBGrid.CT.DataGridCell.prototype.getHtmlElement=function(){return this.m_heControl};SBGrid.CT.DataGridCell.prototype.setHtmlElement=function(a){this.m_heControl=a};SBGrid.CT.DataGridCell.prototype.getNodeElement=function(){return this.m_xnNodeElement};SBGrid.CT.DataGridCell.prototype.setIndex=function(a){this.index=a};SBGrid.CT.DataGridCell.prototype.getElement=function(){if(this.m_objElement){this.m_objElement.setRefElement(this)}return this.m_objElement};SBGrid.CT.DataGridCell.prototype.setElement=function(a){this.m_objElement=a};SBGrid.CT.DataGridCell.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.DataGridCell.prototype.setAttribute=function(a,b){this.attribute[a]=b};SBGrid.CT.DataGridCell.prototype.getId=function(){return this.attribute.id};SBGrid.CT.DataGridCell.prototype.getClientLeft=function(a){var b=0;var c=this.m_heControl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heControl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.DataGridCell.prototype.getClientTop=function(a){var c=0;var b=this.m_heControl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heControl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.DataGridCell.prototype.getDisabled=function(){return this.disabled};SBGrid.CT.DataGridCell.prototype.setDisabled=function(a){this.disabled=a};SBGrid.CT.DataGridCell.prototype.getNodeElement=function(){return this.m_xnNodeElement};SBGrid.CT.DataGridCell.prototype.setNodeElement=function(a){this.m_xnNodeElement=a};SBGrid.CT.DataGridCell.prototype.setImage=function(g,e,d,c,b,a){var f=this.getElement();if(this.m_heDataControl){if(null==g){g=""}else{this.m_heDataControl.innerHTML="<img src='"+g+"' align='center' height='"+c+"' width='"+d+"' onclick='"+e+"();' style='"+b+"' alt='"+a+"' title='"+a+"'/>"}}};SBGrid.CT.DataGridCell.prototype.setWindowText=function(m,c,l){var b=this.getElement();var g=b.attribute.defaultValue;if(this.m_heDataControl){if(null==m){m=""}if(c){if(null==m){m=""}m=m.formatting(l)}else{if(null==m){m=""}l=b.getAttribute("format");var o=this.parent.m_htCellFormat[this.id];l=null!=o?o:l;o=null;if(""==m&&-1!=l.indexOf("0.0")){if(null==g){m="0".formatting(l)}}else{if(null==g){m=m.formatting(l)}else{var h=m.formatting(l);if(""!=h){m=h}}}}if(4==SBGrid.DEF.formatStatus(l)){if(""!=b.attribute.roundmode&&""!=b.attribute.roundposition){m=SBGrid.DEF.getRoundMode(m,b.attribute.roundmode,b.attribute.roundposition)}}if(SBGrid.DEF.is_ie){if(m==this.m_heDataControl.outerText){return}}else{if(m==this.m_heDataControl.textContent){return}}if(SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().preserveWhitespace){m=m.replace(/\s/g,"&nbsp;")}if(""!=m&&(-1!=b.attribute.secretendposition||-1!=b.attribute.secretstartposition)){var d=-1==b.attribute.secretstartposition?0:b.attribute.secretstartposition;var a=-1==b.attribute.secretendposition?m.length:b.attribute.secretendposition;if(a>d){var n=b.attribute.secretmark;var h=m.substr(0,d);var e=m.substr(a,m.length);for(var f=d;f<a;f++){h+=n}m=h+e}}if(this.parent.autoResize){this.m_heDataControl.innerHTML=m.newlineCharConvert()}else{this.m_heDataControl.innerHTML='<span style="white-space:nowrap;">'+m+"</span>"}}};SBGrid.CT.DataGridCell.prototype.setBoolState=function(f,c,a,e){this.boolstate=f;if(c){SBGrid.CF.GridSetText(this,strValue)}if(null!=this.m_heControl){var b=this.m_heControl.firstChild;if(b){var d=this.m_objElement;if(SBGrid.DEF.SBIT_CHECK==d.getInputType()){b.src=this.boolstate?d.getAttribute("checkimage"):d.getAttribute("uncheckimage")}else{if(SBGrid.DEF.SBIT_RADIO==d.getInputType()){b.src=this.boolstate?d.getAttribute("selectimage"):d.getAttribute("unselectimage")}}d=null}b=null}};SBGrid.CT.DataGridCell.prototype.getStatus=function(){return this.rowstatus};SBGrid.CT.DataGridCell.prototype.setStatus=function(a){this.rowstatus=a};SBGrid.CT.DataGridCell.prototype.getColStatus=function(){return this.colstatus};SBGrid.CT.DataGridCell.prototype.setColStatus=function(a){this.colstatus=a};SBGrid.CT.DataGridCell.prototype.setEditingMode=function(a){this.editing=a};SBGrid.CT.DataGridCell.prototype.getJsonObject=function(){return this.m_jsonObject};SBGrid.CT.DataGridCell.prototype.setJsonObject=function(a){this.m_jsonObject=a};SBGrid.CT.DataGridCell.prototype.getIsReadOnly=function(){return this.isReadOnly||this.disabled};SBGrid.CT.SelectCell=function(a,e,d,b,c){this.elementName=c;this.id=d;this.tag=c;this.col=e;this.row=b;this.parent=a;this.attribute=new SBGrid.DS.Hashtable();this.m_heControl=null;this.m_objElement=null;this.attribute.id=d;this.attribute.tag=c;this.selected=false;a=null;e=null;d=null;b=null;c=null};SBGrid.CT.SelectCell.prototype.setIndex=function(a){this.index=a};SBGrid.CT.SelectCell.prototype.getElement=function(){if(this.m_objElement){this.m_objElement.setRefElement(this)}return this.m_objElement};SBGrid.CT.SelectCell.prototype.setElement=function(a){this.m_objElement=a};SBGrid.CT.SelectCell.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.SelectCell.prototype.getId=function(){return this.id};SBGrid.CT.SelectCell.prototype.getClientLeft=function(a){var b=0;var c=this.m_heControl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heControl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.SelectCell.prototype.getClientTop=function(a){var c=0;var b=this.m_heControl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heControl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.SelectCell.prototype.getDisabled=function(){return this.disable};SBGrid.CT.SelectCell.prototype.setDisabled=function(a){this.disable=a};SBGrid.CT.SelectCell.prototype.getAttribute=function(a){return this.attribute[a]};SBGrid.CT.SelectCell.prototype.setAttribute=function(b,c){if(SBGrid.DEF.SB_STYLELIST[b]){this.attribute[b]=c;var a=SBGrid.DEF.findToMakeStyleSheet(this.id+"_Attr");SBGrid.UT.HtmlLib.setStyle(a,b,c)}};SBGrid.CT.SelectCell.prototype.initStyle=function(a){if(SBGrid.DEF.SB_STYLELIST[a]){this.attribute[a]="";var b=SBGrid.DEF.findToMakeStyleSheet(this.id+"_Attr");SBGrid.UT.HtmlLib.setStyle(b,a,"")}};SBGrid.CT.Cell=function(a,e,d,b,c){if(!a){return}SBGrid.CT.Attribute.call(this,a,d,c);this.col=e;this.row=b;this.rowstatus=SBGrid.DEF.SBGS_NEW;this.colstatus=true;this.mergeType=SBGrid.DEF.SBSM_NORMAL;this.mergeParentId=null;this.m_nRowSpan=1;this.m_nColSpan=1;this.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;this.m_fixedCheckStatus=false;this.m_fixedNoCheckAll=false;this.m_xnNodeElement;this.m_jsonObject;this.m_heControl;this.m_heDataControl=null;this.m_objOldCellStyle=new SBGrid.DS.Hashtable();this.m_objCellStyle=new SBGrid.DS.Hashtable();this.m_bIsSubTotal=false;this.editing=false;this.down=false;this.disable=false;this.hover=false;this.selected=false;this.isReadOnly=false;this.expanded=0;this.checked=0;this.m_nChildNumber=-1;this.m_strRecursion="";this.index=-1;this.text=""};SBGrid.CT.Cell.prototype=new SBGrid.CT.Attribute;SBGrid.CT.Cell.prototype.init=function(){this.m_heControl=document.getElementById("SBHE_"+this.id);var b=document.getElementById(this.id+"_data");if(b){this.m_heDataControl=b;b=null}var c=this.getElement();if("softbowl:col"!=c.elementName&&"softbowl:gridfixedcell"!=c.elementName){for(var a in c.attribute){if(SBGrid.DEF.SB_STYLELIST[a]){this.setAttribute(a,c.attribute[a])}}}};SBGrid.CT.Cell.prototype.unInit=function(){this.m_heControl=null;this.m_heDataControl=null};SBGrid.CT.Cell.prototype.applyDefaultStyle=function(){};SBGrid.CT.Cell.prototype.getInputType=function(){if(null!=this.m_objElement){return this.m_objElement.getInputType()}return SBGrid.DEF.SBIT_OUTPUT};SBGrid.CT.Cell.prototype.getMergeType=function(){return this.mergeType};SBGrid.CT.Cell.prototype.getHtmlElement=function(){return this.m_heControl};SBGrid.CT.Cell.prototype.setHtmlElement=function(a){this.m_heControl=a};SBGrid.CT.Cell.prototype.getNodeElement=function(){return this.m_xnNodeElement};SBGrid.CT.Cell.prototype.setNodeElement=function(a){this.m_xnNodeElement=a};SBGrid.CT.Cell.prototype.getJsonObject=function(){return this.m_jsonObject};SBGrid.CT.Cell.prototype.setJsonObject=function(a){this.m_jsonObject=a};SBGrid.CT.Cell.prototype.getText=function(){if(this.m_jsonObject){return this.m_jsonObject[this.m_objElement.attribute.ref]+""}else{if(this.m_xnNodeElement){return SBGrid.UT.XmlLib.getTextValue(this.m_xnNodeElement)}else{var a=SBGrid.CT.Caption.prototype.getText.call(this);if(a){return a}}}return""};SBGrid.CT.Cell.prototype.getIsReadOnly=function(){return this.isReadOnly||this.disable};SBGrid.CT.Cell.prototype.setText=function(a){if(this.m_jsonObject){this.m_jsonObject[this.m_objElement.attribute.ref]=a+""}else{if(this.m_xnNodeElement){SBGrid.UT.XmlLib.setTextValue(this.m_xnNodeElement,a)}else{SBGrid.CT.ElementBase.prototype.setText.call(this,a)}}};SBGrid.CT.Cell.prototype.setFixedWindowText=function(b){if(null==this.m_heControl){return}var a=this.m_heControl.lastChild;if(a){if(this.parent.autoResize){a.innerHTML=b}else{if("NOBR"==a.tagName){a.innerHTML=b}else{a.innerHTML='<span style="white-space:nowrap;">'+b+"</span>"}}}a=null};SBGrid.CT.Cell.prototype.getWindowText=function(){if(SBGrid.DEF.is_ie){return this.m_heControl.innerText}else{return this.m_heControl.textContent}};SBGrid.CT.Cell.prototype.setWindowText=function(l,c,h){var b=this.getElement();if(this.m_heDataControl){if(null==l){l=""}if(c){if(null==l){l=""}l=l.formatting(h)}else{if(null==l){l=""}h=this.m_objElement.getAttribute("format");l=l.formatting(h)}if(SBGrid.DEF.is_ie){if(l==this.m_heDataControl.outerText){return}}else{if(l==this.m_heDataControl.textContent){return}}if(SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().preserveWhitespace){l=l.replace(/\s/g,"&nbsp;")}if(""!=l&&(-1!=b.attribute.secretendposition||-1!=b.attribute.secretstartposition)){var d=-1==b.attribute.secretstartposition?0:b.attribute.secretstartposition;var a=-1==b.attribute.secretendposition?l.length:b.attribute.secretendposition;if(a>d){var m=b.attribute.secretmark;var g=l.substr(0,d);var e=l.substr(a,l.length);for(var f=d;f<a;f++){g+=m}l=g+e}}if(this.parent.autoResize){this.m_heDataControl.innerHTML=l}else{this.m_heDataControl.innerHTML='<span style="white-space:nowrap;">'+l+"</span>"}}};SBGrid.CT.Cell.prototype.setImage=function(b){var a=this.getElement();if(this.m_heDataControl){if(null==b){b=""}else{this.m_heDataControl.innerHTML="<img src='"+b+"'/>"}}};SBGrid.CT.Cell.prototype.setTextRefresh=function(a){var d=a;if(null!=a){var c=this.getElement();if(SBGrid.DEF.SBIT_CHECK==this.getInputType()||SBGrid.DEF.SBIT_RADIO==this.getInputType()){if(c){var f=(a==c.getTrueValue())?true:false;var e=f?c.getTrueValue():c.getFalseValue();if(f){c.m_nBeforeSelectRow=this.row}this.setBoolState(f);this.setWindowText(a)}}else{if(SBGrid.DEF.SBIT_COMBO==this.getInputType()){if(c){if(c.m_bIsCellCombo&&c.m_objCombo.isnodeset){var b=this.getAttribute("nodeset");if(null!=b){c.m_objCombo.nodeset=b;c.m_objCombo.reBuild()}else{if(null!=c.m_strComboNodeSet&c.m_strComboNodeSet!=c.m_objCombo.nodeset){c.m_objCombo.nodeset=c.m_strComboNodeSet;c.m_objCombo.reBuild()}}}d=c.m_objCombo.getLableByValue(a);this.setWindowText(d)}}else{if(SBGrid.DEF.SBIT_IMAGE==this.getInputType()){this.setImage(a)}else{this.setWindowText(a)}}}}if("label"==this.parent.m_strTooltip){if(null!=this.m_heControl){this.m_heControl.title=d}}else{if("true"==this.parent.m_strTooltip){if(null!=this.m_heControl){this.m_heControl.title=a}}}};SBGrid.CT.Cell.prototype.getSelect=function(){return this.selected};SBGrid.CT.Cell.prototype.setSelect=function(a){this.selected=a;if(this.parent instanceof SBGrid.CT.DataGrid){}else{var b=this.getElement();if(null!=b){b.setSelect(a)}}};SBGrid.CT.Cell.prototype.getDisabled=function(){return this.disable};SBGrid.CT.Cell.prototype.setDisabled=function(a){if(null!=this.m_heControl){this.m_heControl.setAttribute("disabled",String(a))}this.disable=a};SBGrid.CT.Cell.prototype.getBoolState=function(){var c=this.getText();var b=this.m_objElement.getTrueValue();var a=this.m_objElement.getFalseValue();if(c==b){this.boolstate=true}else{if(c==a){this.boolstate=false}}return this.boolstate};SBGrid.CT.Cell.prototype.setBoolState=function(e,c,a,d){this.boolstate=e;if(c){this.setText(strValue)}var b=this.m_heControl.firstChild;if(b){if(SBGrid.DEF.SBIT_CHECK==this.getInputType()){b.src=this.boolstate?this.m_objElement.getAttribute("checkimage"):this.m_objElement.getAttribute("uncheckimage")}else{if(SBGrid.DEF.SBIT_RADIO==this.getInputType()){b.src=this.boolstate?this.m_objElement.getAttribute("selectimage"):this.m_objElement.getAttribute("unselectimage")}}}};SBGrid.CT.Cell.prototype.getStatus=function(){return this.rowstatus};SBGrid.CT.Cell.prototype.setStatus=function(a){this.rowstatus=a};SBGrid.CT.Cell.prototype.getColStatus=function(){return this.colstatus};SBGrid.CT.Cell.prototype.setColStatus=function(a){this.colstatus=a};SBGrid.CT.Cell.prototype.setEditingMode=function(a){this.editing=a};SBGrid.CT.Cell.prototype.changeRowHeadUpdate=function(b){var a=this.m_heControl.firstChild;if(null!=a){switch(b){case SBGrid.DEF.SBGS_INSERT:case SBGrid.DEF.SBGS_INSERTANDNEW:a.src=this.parent.m_strInsertFlagImage;break;case SBGrid.DEF.SBGS_UPDATE:a.src=this.parent.m_strUpdateFlagImage;break;case SBGrid.DEF.SBGS_DELETE:case SBGrid.DEF.SBGS_DELETEANDUPDATE:a.src=this.parent.m_strDeleteFlagImage;break;default:a.src=this.parent.m_strNormalFlagImage;break}}};SBGrid.CT.Cell.prototype.getClientLeft=function(a){var b=0;var c=this.m_heControl;while(null!=c){b+=c.offsetLeft;if(c!=this.m_heControl){b+=c.clientLeft}if(a&&c!=document.body){b-=(SBGrid.DEF.is_android?0:c.scrollLeft)}c=c.offsetParent}return b};SBGrid.CT.Cell.prototype.getClientTop=function(a){var c=0;var b=this.m_heControl;while(null!=b){c+=b.offsetTop;if(b!=this.m_heControl){c+=b.clientTop}if(a&&b!=document.body){c-=(SBGrid.DEF.is_android?0:b.scrollTop)}b=b.offsetParent}return c};SBGrid.CT.Cell.prototype.setFixedCheck=function(b){if(SBGrid.DEF.SBIT_CHECK==this.m_objElement.getInputType()){var a=b?this.m_objElement.getTrueValue():this.m_objElement.getFalseValue();this.setBoolState(b);this.setText(a)}};SBGrid.CT.Cell.prototype.setFixedInputType=function(a){this.m_fixedInputType=a};SBGrid.CT.Cell.prototype.getFixedInputType=function(){return this.m_fixedInputType};SBGrid.CT.Cell.prototype.getLabel=function(){return this.m_heControl.getAttribute("label")};SBGrid.CT.Cell.prototype.setLabel=function(a){return this.m_heControl.setAttribute("label",a)};SBGrid.CT.Cell.prototype.setLabelChange=function(a){return this.m_heControl.innerHTML=a};SBGrid.CT.Cell.prototype.getValue=function(){if(null!=this.m_heControl){return this.m_heControl.getAttribute("value")}else{return""}};SBGrid.CT.Cell.prototype.setAttribute=function(b,a){SBGrid.CT.Attribute.prototype.setAttribute.call(this,b,a);switch(b){case"color":if(this.m_heDataControl){SBGrid.UT.HtmlLib.setStyle(this.m_heDataControl,b,a)}}};SBGrid.CT.Cell.prototype.setValue=function(a){return this.m_heControl.setAttribute("value",a)};SBGrid.CT.Cell.prototype.setMergeType=function(a){if(a){this.mergeType=SBGrid.DEF.SBSM_NORMAL}else{this.mergeType=SBGrid.DEF.SBSM_LOCK}};SBGrid.CT.Cell.prototype.setIndex=function(a){this.index=a};SBGrid.CT.Cell.prototype.getState=function(){var a=SBGrid.DEF.SB_CS_NORMAL;if(this.disable){a|=SBGrid.DEF.SB_CS_DISABLE}if(this.m_bHover){a|=SBGrid.DEF.SB_CS_HOVER}if(this.selected){a|=SBGrid.DEF.SB_CS_SELECT}if(this.m_bFocus){a|=SBGrid.DEF.SB_CS_FOCUS}if(this.down){a|=SBGrid.DEF.SB_CS_DOWN}return a};SBGrid.CT.Cell.prototype.setExpand=function(a){this.expanded=a};SBGrid.CT.Cell.prototype.getExpand=function(){return this.expanded};SBGrid.CT.Cell.prototype.haschilditem=function(){return this.m_nChildNumber};SBGrid.CT.Cell.prototype.setChecked=function(e){if(this.checked!=e){this.checked=e;var b=document.getElementById("SBHE_"+this.id+"_check");if(null==b){return}var f=null;for(var a=0;a<b.childNodes.length;a++){var f=b.childNodes.item(a);if("IMG"==f.nodeName){break}}if(null==f){return}if(1==this.checked){var d=this.parent.getAttribute("checkimage");if(""==d||null==d){d=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgTreeCheck}f.src=d}else{var c=this.parent.getAttribute("uncheckimage");if(""==c||null==c){c=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgTreeUnCheck}f.src=c}}};SBGrid.CT.Cell.prototype.getChecked=function(){return this.checked};SBGrid.CT.Cell.prototype.getParentIndex=function(){return this.getElement().getParentIndex(this)};SBGrid.CT.HtmlHtml=function(b,d,c,a){if(!d){return}this.convertMode=a;SBGrid.CT.Element.call(this,b,d,c)};SBGrid.CT.HtmlHtml.prototype=new SBGrid.CT.Element;SBGrid.CT.HtmlHead=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.HtmlHead.prototype=new SBGrid.CT.Element;SBGrid.CT.HtmlBody=function(d,h,e,u,q,n,p,s,b,t,a,f,o,c,g,m,l,i,w,v,r){if(!b){return}SBGrid.CT.Group.call(this,d,h,e,u,q,"",p,s,b,t,a,"","","",i,"",w,v,r);this.m_bShowPopupMenu=true;this.m_bSetPopupMenu=false;this.attribute.autorefresh=n;this.attribute["print-bottommargin"]=f;this.attribute["print-leftmargin"]=o;this.attribute["print-rightmargin"]=c;this.attribute["print-topmargin"]=g;this.attribute.pagewidth=""==m?null:m;this.attribute.pageheight=""==l?null:l};SBGrid.CT.HtmlBody.prototype=new SBGrid.CT.Group;SBGrid.CT.HtmlBody.prototype.refresh=function(){var arKeyset=this.children.keys();for(var i=0;i<arKeyset.length;i++){var strId=arKeyset[i];if(SBGrid.DEF.is_chrome){eval("try{"+strId+".refresh()}catch(e){}")}else{var objChild=this.children.item(strId);if(null!=objChild&&objChild instanceof SBGrid.CT.Element&&objChild.refresh){objChild.refresh()}}}};SBGrid.CT.HtmlBody.prototype.init=function(){this.m_heControl=document.body;SBGrid.CT.Group.prototype.init.call(this)};SBGrid.CT.HtmlBody.prototype.onMouseDown=function(a){SBGrid.CT.Group.prototype.onMouseDown.call(this,a);var i=window;var m=0;var l=0;while(window.top!=i&&null!=i){var g=i.frameElement;while(null!=g){m+=g.offsetLeft;l+=g.offsetTop;if(g!=i.frameElement&&g!=i.document.body){m+=g.clientLeft;l+=g.clientTop}m-=(SBGrid.DEF.is_android?0:g.scrollLeft);l-=(SBGrid.DEF.is_android?0:g.scrollTop);g=g.offsetParent}i=i.parent}m=m+a.x+window.top.document.body.scrollLeft;l=l+a.y+window.top.document.body.scrollTop;var h=false;if(window.top.document.getElementById("SBHE___SB_ContextMenu")){var c=window.top.document.getElementById("SBHE___SB_ContextMenu");var d=c.offsetLeft-window.top.document.body.scrollLeft;var b=c.offsetTop-window.top.document.body.scrollTop;var f=d+c.offsetWidth;var e=b+c.offsetHeight;if(m<d||m>f||l<b||l>e){window.top.document.body.removeChild(c)}else{h=true}}if(a.button==3){if(this.m_bShowPopupMenu&&!this.m_bSetPopupMenu&&!h){window.top.document.oncontextmenu=null;if(window!=window.top){document.oncontextmenu=null}}else{window.top.document.oncontextmenu=new Function("return false");if(window!=window.top){document.oncontextmenu=new Function("return false")}}if(this.m_bShowPopupMenu&&this.m_bSetPopupMenu&&!h){document.SBHE_allElement.item("__SB_ContextMenu").createContextMenu(m,l)}}};SBGrid.CT.CalendarItem=function(c,g,d,t,s,n,u,i,m,q,l,b,a,r,e,f,p,w,v,o,h){if(!a){return}SBGrid.CT.Caption.call(this,c,g,d,t,s,n,u,i,m,q,l,b,a,r,e,"",f,p,w,v,o,h);this.label};SBGrid.CT.CalendarItem.prototype=new SBGrid.CT.Caption;SBGrid.CT.CalendarItem.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this);this.label=this.m_heControl.innerHTML};SBGrid.CT.Calendar=function(e,h,f,s,n,l,m,q,c,r,a,g,d,i,p,b,u,t,o){if(!c){return}SBGrid.CT.Group.call(this,e,h,f,s,n,l,m,q,c,r,a,"",g,d,i,p,u,t,o);this.m_strChoosedPosition;this.attribute.showtoday=String(b);this.day;this.month;this.year;this.dayItem=new Array();this.header;this.prevyear;this.prevmonth;this.nextmonth;this.nextyear};SBGrid.CT.Calendar.prototype=new SBGrid.CT.Group;SBGrid.CT.Calendar.prototype.refresh=function(){this.makeCalendar(parseInt(this.year),parseInt(this.month),parseInt(this.day))};SBGrid.CT.Calendar.prototype.item=function(c,d){if(d==null){for(var b=0;b<7;b++){for(var a=0;a<7;a++){if(document.getElementById("SBHE_"+this.id+".item"+b+a).innerHTML==c){c=b;d=a;break}}if(d!=null){break}}}return this.dayItem[c][d]};SBGrid.CT.Calendar.prototype.init=function(f){SBGrid.CT.Group.prototype.init.call(this);this.header=new SBGrid.CT.CalendarHeader(this.id,"","",this.hint,SBGrid.DEF.Lan_Year+SBGrid.DEF.Lan_Month,"","","","",false,"","",this.id+".header",-1,"","","","","softbowl:caption","visible","");this.header.m_bDependentCtl=true;this.header.init();this.prevyear=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".prevyear",-1,"","","",-1,false,"","softbowl:button","visible","");this.prevyear.m_bDependentCtl=true;this.prevyear.init();this.prevmonth=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".prevmonth",-1,"","","",-1,false,"","softbowl:button","visible","");this.prevmonth.m_bDependentCtl=true;this.prevmonth.init();this.nextmonth=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".nextmonth",-1,"","","",-1,false,"","softbowl:button","visible","");this.nextmonth.m_bDependentCtl=true;this.nextmonth.init();this.nextyear=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",false,false,"","","",this.id+".nextyear",-1,"","","",-1,false,"","softbowl:button","visible","");this.nextyear.m_bDependentCtl=true;this.nextyear.init();this.calendaritem=new SBGrid.CT.CalendarItem(this.id,"","",this.hint,"","","","","",false,"","",this.id+".item",-1,"","","","","softbowl:calendaritem","visible","");this.calendaritem.m_bDependentCtl=true;this.calendaritem.init();this.calendarToday=new SBGrid.CT.CalendarToday(this.id,"","",this.hint,"","","","","",false,"","",this.id+".today",-1,"","","","","softbowl:calendartoday","visible");this.calendarToday.m_bDependentCtl=true;this.calendarToday.init();if(!this.calendaritem.getSelectAttribute("background-color")){this.calendaritem.setSelectAttribute("background-color","#81B5D8")}if(!this.calendaritem.getSelectAttribute("color")||this.calendaritem.getSelectAttribute("color")==""){this.calendaritem.setSelectAttribute("color","#FFFFFF")}for(var c=0;c<7;c++){var d=new Array();for(var b=0;b<7;b++){d[b]=new SBGrid.CT.Cell(this.id,b,this.id+".item"+c+b,c,"softbowl:calendaritem");d[b].setElement(this.calendaritem);d[b].init()}this.dayItem[c]=d}if(!f){var e=new Date();this.year=e.getFullYear().toString();this.month=(e.getMonth()+1).toString();this.day=e.getDate()}this.makeCalendar(parseInt(this.year),parseInt(this.month),parseInt(this.day));if(!f){var a=this.getAttribute("showtoday");this.setShowToday()}if("true"==this.getAttribute("disabled")){this.setDisabled(true)}if(this.m_heControl.attachEvent){this.m_heControl.attachEvent("onmousedown",SBGrid.DEF._W_onProcessMouseEvent);this.m_heControl.attachEvent("onmousemove",SBGrid.DEF._W_onProcessMouseEvent);this.m_heControl.attachEvent("onmouseup",SBGrid.DEF._W_onProcessMouseEvent)}else{this.m_heControl.addEventListener("mousedown",SBGrid.DEF._W_onProcessMouseEvent,false);this.m_heControl.addEventListener("mousemove",SBGrid.DEF._W_onProcessMouseEvent,false);this.m_heControl.addEventListener("mouseup",SBGrid.DEF._W_onProcessMouseEvent,false)}};SBGrid.CT.Calendar.prototype.setShowToday=function(){var d=document.getElementById("SBHE_"+this.id+".today");if(null==d){return}if("true"==this.getAttribute("showtoday")){var g=(Number(this.month)<10)?"0"+this.month:String(this.month);var f=(Number(this.day)<10)?"0"+this.day:String(this.day);d.innerHTML=SBGrid.DEF.Lan_Today+" : "+this.year+"-"+g+"-"+f;for(var b=0;b<this.dayItem.length;b++){var e=this.dayItem[b];for(var a=0;a<e.length;a++){var c=e[a];c.m_heControl.style.height="12.5%"}}d.style.textAlign="center";d.style.height="12.5%"}else{d.parentNode.removeChild(d)}};SBGrid.CT.Calendar.prototype.applyDefaultStyle=function(){};SBGrid.CT.Calendar.prototype.makeCalendar=function(m,e,c){var p=this.children.item(this.id+".header");p.attribute.text=m+SBGrid.DEF.Lan_Year+e+SBGrid.DEF.Lan_Month;document.getElementById("SBHE_"+this.attribute.id+"Year").innerHTML=m;document.getElementById("SBHE_"+this.attribute.id+"Month").innerHTML=e;var f=new Date(m,e-1,1);var g=f.getDay();var d="312831303130313130313031";var a=d.substring(((e-1)*2),((e-1)*2+2));if((e==2)&&(((m%4==0)&&(m%100!=0))||(m%400==0))){a="29"}var q=parseInt(a);var b=0;var o=1;for(var l=1;l<7;l++){for(var h=0;h<7;h++){var n;if(b<g||o>q){document.getElementById("SBHE_"+this.attribute.id+".item"+l+h).innerHTML=""}else{document.getElementById("SBHE_"+this.attribute.id+".item"+l+h).innerHTML=o;if(c==o){this.chooseDate(l.toString()+h.toString())}o=o+1}this.dayItem[l][h].label=this.dayItem[l][h].m_heControl.innerHTML;b=b+1}}};SBGrid.CT.Calendar.prototype.chooseDate=function(b){var a=document.getElementById("SBHE_"+this.attribute.id+".item"+b);if(a.innerHTML==""||b.substring(0,1)=="0"){return}if(this.m_strChoosedPosition!=null){var c=document.getElementById("SBHE_"+this.attribute.id+".item"+this.m_strChoosedPosition);c.style.color="";c.style.backgroundColor=""}this.day=a.innerHTML;this.m_strChoosedPosition=b;a.style.backgroundColor=this.calendaritem.getSelectAttribute("background-color");a.style.color=this.calendaritem.getSelectAttribute("color")};SBGrid.CT.Calendar.prototype.moveCalendar=function(a){if(this.m_strChoosedPosition!=null){var e=document.getElementById("SBHE_"+this.attribute.id+".item"+this.m_strChoosedPosition);e.style.color="";e.style.backgroundColor=""}this.m_strChoosedPosition=null;var b=document.getElementById("SBHE_"+this.attribute.id+"Year").innerHTML;var d=document.getElementById("SBHE_"+this.attribute.id+"Month").innerHTML;if(a=="prevYear"){this.year=((b)-1).toString();this.month=d}else{if(a=="nextYear"){this.year=(parseInt(b)+1).toString();this.month=d}else{if(a=="prevMonth"){if(d=="1"){this.year=(parseInt(b)-1).toString();this.month="12"}else{this.year=b;this.month=(parseInt(d)-1).toString()}}else{if(a=="nextMonth"){if(d=="12"){this.year=(parseInt(b)+1).toString();this.month="1"}else{this.year=b;this.month=(parseInt(d)+1).toString()}}}}}var c=new Date();if(this.year==c.getFullYear().toString()&&this.month==(c.getMonth()+1).toString()){this.day=c.getDate().toString()}else{this.day=""}this.makeCalendar(parseInt(this.year),parseInt(this.month),parseInt(this.day))};SBGrid.CT.Calendar.prototype.setToday=function(){var a=new Date();this.day=a.getDate().toString();this.month=(a.getMonth()+1).toString();this.year=a.getFullYear().toString();this.refresh()};SBGrid.CT.Calendar.prototype.onMouseDown=function(a){SBGrid.CT.Group.prototype.onMouseDown.call(this,a);if(!this.disabled){if(a.target.substring(0,this.id.length+5)==this.id+".item"){this.chooseDate(a.target.substring(this.id.length+5,this.id.length+7));this.dispatch("ondayselect")}else{if(a.target==this.id+".today"){this.setToday();this.dispatch("ondayselect")}}a.propagate="stop"}};SBGrid.CT.Calendar.prototype.onClick=function(b){SBGrid.CT.Group.prototype.onClick.call(this,b);if(!this.disabled){var a=this.m_strChoosedPosition;var c=false;if(b.target==this.id+".prevyear"){this.dispatch("onprevyear");this.moveCalendar("prevYear");c=true}else{if(b.target==this.id+".prevmonth"){this.dispatch("onprevmonth");this.moveCalendar("prevMonth");c=true}else{if(b.target==this.id+".nextmonth"){this.dispatch("onnextmonth");this.moveCalendar("nextMonth");c=true}else{if(b.target==this.id+".nextyear"){this.dispatch("onnextyear");this.moveCalendar("nextYear");c=true}}}}if(c){this.setDeselect(a)}}};SBGrid.CT.Calendar.prototype.setDeselect=function(b){var a=document.getElementById("SBHE_"+this.id+".item"+b);if(null!=a){a.style.backgroundColor="";a.style.color=""}};SBGrid.CT.Calendar.create=function(b,d,f){d=SBGrid.CT.Element.createClassName(d,"calendar");var a=SBGrid.CT.Calendar.createMainNode(d);var g=document.getElementById("SBHE_"+b);var c=document.SBHE_allElement.item(b);if(c instanceof SBGrid.CT.Input||c instanceof SBGrid.CT.GridCol){a.style.zIndex=100;var e=document.body;e.appendChild(a)}else{g.appendChild(a)}a=SBGrid.CT.Calendar.createSubNodes(a,d);return SBGrid.CT.Calendar.createObject(b,a,d,f)};SBGrid.CT.Calendar.createMainNode=function(b){var a=document.createElement("div");a=SBGrid.CT.Calendar.createAttribute(a,b);jQuery(a).addClass("sbgrid_calendar");jQuery(a).addClass("sbgrid_boxsizing");return a};SBGrid.CT.Calendar.createSubNodes=function(c,E){var a=E.item("id");var d=document.createElement("table");var x="";if(E.exists("calendar_header")){x=E.item("calendar_header")}jQuery(d).addClass("sbgrid_calendar_header "+x);d.setAttribute("id","SBHE_"+a+".header");d.cellPadding=0;d.cellSpacing=0;d.style.cssText="width:100%; height:20%;";var h=document.createElement("tbody");var D=document.createElement("tr");var v=document.createElement("td");v.style.cssText="width:17%; height:100%; text-align:right;";var q=document.createElement("button");q.setAttribute("id","SBHE_"+a+".prevyear");var C="";if(E.exists("calendar_prevyear")){C=E.item("calendar_prevyear")}jQuery(q).addClass("sbgrid_calendar_prevyear "+C);q.style.cssText="width:25px; height:15px; background-position:center;";v.appendChild(q);var u=document.createElement("td");u.style.cssText="width:13%; height:100%; text-align:right;";var F=document.createElement("button");F.setAttribute("id","SBHE_"+a+".prevmonth");var y="";if(E.exists("calendar_prevmonth")){y=E.item("calendar_prevmonth")}jQuery(F).addClass("sbgrid_calendar_prevmonth "+y);F.style.cssText="width:25px; height:15px; background-position:center;";u.appendChild(F);var s=document.createElement("td");s.setAttribute("id","SBHE_"+a+".header_TEXT");s.style.cssText="width:40%; height:100%; text-align:center;";var z=document.createElement("span");z.setAttribute("id","SBHE_"+a+"Year");s.appendChild(z);s.innerHTML+=SBGrid.DEF.Lan_Year;var f=document.createElement("span");f.setAttribute("id","SBHE_"+a+"Month");s.appendChild(f);s.innerHTML+=SBGrid.DEF.Lan_Month;var p=document.createElement("td");p.style.cssText="width:13%; height:100%;";var b=document.createElement("button");b.setAttribute("id","SBHE_"+a+".nextmonth");var r="";if(E.exists("calendar_nextmonth")){r=E.item("calendar_nextmonth")}jQuery(b).addClass("sbgrid_calendar_nextmonth "+r);b.style.cssText="width:25px; height:15px; background-position:center;";p.appendChild(b);var o=document.createElement("td");o.style.cssText="width:17%; height:100%; ";var n=document.createElement("button");n.setAttribute("id","SBHE_"+a+".nextyear");var w="";if(E.exists("calendar_nextyear")){w=E.item("calendar_nextyear")}jQuery(n).addClass("sbgrid_calendar_nextyear "+w);n.style.cssText="width:25px; height:15px; background-position:center;";o.appendChild(n);D.appendChild(v);D.appendChild(u);D.appendChild(s);D.appendChild(p);D.appendChild(o);h.appendChild(D);d.appendChild(h);c.appendChild(d);var e=document.createElement("table");e.setAttribute("id","SBHE_"+a+".item");var m="";if(E.exists("calendar_item")){m=E.item("calendar_item")}jQuery(e).addClass("sbgrid_calendar_body "+m);e.cellPadding=0;e.cellSpacing=0;e.style.cssText="width:100%; height:80%;";e.onclick=function(){};e.ondbclick=function(){};e.onmousedown=function(){};e.onmousemove=function(){};e.onmouseup=function(){};var l=document.createElement("tbody");for(var B=0;B<7;B++){var g=document.createElement("tr");for(var A=0;A<7;A++){var t=document.createElement("td");t.setAttribute("id","SBHE_"+a+".item"+B+A);t.style.cssText="width:12.5%; height:12.5%; text-align:center;";if(A==0){jQuery(t).addClass("sbgrid_calendar_item_sun")}else{if(A==6){jQuery(t).addClass("sbgrid_calendar_item_sat")}else{jQuery(t).addClass("sbgrid_calendar_item_day")}}if(B==0){if(A==0){t.innerHTML=SBGrid.DEF.Lan_Sunday}else{if(A==1){t.innerHTML=SBGrid.DEF.Lan_Monday}else{if(A==2){t.innerHTML=SBGrid.DEF.Lan_Tuesday}else{if(A==3){t.innerHTML=SBGrid.DEF.Lan_Wednesday}else{if(A==4){t.innerHTML=SBGrid.DEF.Lan_Thursday}else{if(A==5){t.innerHTML=SBGrid.DEF.Lan_Friday}else{if(A==6){t.innerHTML=SBGrid.DEF.Lan_Saturday}}}}}}}}g.appendChild(t)}l.appendChild(g)}e.appendChild(l);c.appendChild(e);return c};SBGrid.CT.Calendar.createObject=function(f,d,x,A){var m="";var g="";var z="";var t="";var p="";var r="";var v=false;var c="";var w=9007199254740992;var b="";var l="";var e="";var o="";var q="";var a="";var u="visible";var n="";for(var s=0;s<x.count();s++){var h=x.keys()[s];switch(h){case"alert":m=x.item(h);break;case"help":g=x.item(h);break;case"hint":z=x.item(h);break;case"accesskey":t=x.item(h);break;case"bind":p=x.item(h);break;case"class":r=x.item(h);break;case"disabled":if("true"==x.item(h)){v=true}break;case"id":c=x.item(h);break;case"navindex":w=parseInt(x.item(h));break;case"overflow":b=x.item(h);break;case"ref":l=x.item(h);break;case"jsonref":e=x.item(h);case"scroll":o=x.item(h);break;case"showeffect":q=x.item(h);break;case"showtoday":if("true"==x.item(h)){a=true}break;case"visibility":u=x.item(h);break;default:if(!SBGrid.DEF.SB_STYLELIST[h]){n+=h+":"+x.item(h)+"; "}break}}var y=new SBGrid.CT.Calendar(f,m,g,z,t,p,r,v,c,w,b,l,e,o,q,a,A,"softbowl:calendar",u,n);return y};SBGrid.CT.Calendar.createAttribute=function(b,a){b=SBGrid.CT.Group.createAttribute(b,a);return b};SBGrid.CT.CalendarHeader=function(d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,b,o,w,v,p,h){if(!a){return}SBGrid.CT.Caption.call(this,d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,"",b,o,w,v,p,h)};SBGrid.CT.CalendarHeader.prototype=new SBGrid.CT.Caption;SBGrid.CT.CalendarHeader.prototype.isCSSValid=function(b){var a=false;if(null==this.attribute[b]||""==this.attribute[b]){a=true}return a};SBGrid.CT.CalendarToday=function(d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,b,o,w,v,p,h){if(!a){return}SBGrid.CT.Caption.call(this,d,g,e,t,s,n,u,i,m,q,l,c,a,r,f,"",b,o,w,v,p,h)};SBGrid.CT.CalendarToday.prototype=new SBGrid.CT.Caption;SBGrid.CT.CalendarToday.prototype.isCSSValid=function(b){var a=false;if(null==this.attribute[b]||""==this.attribute[b]){a=true}return a};SBGrid.CT.Button=function(e,i,f,x,w,s,y,m,p,u,o,d,n,h,a,v,g,b,c,r,q,A,z,t,l){if(!a){return}SBGrid.CT.Caption.call(this,e,i,f,x,w,s,y,m,p,u,o,d,a,v,g,b,c,r,A,z,t,l);this.attribute.group=n;this.attribute.groupalign=h;this.attribute.selected=String(q);this.selected=q;this.m_heControl=document.getElementById("SBHE_"+this.id);this.m_strTargetGrid="";this.m_heLodExcelForm=null};SBGrid.CT.Button.prototype=new SBGrid.CT.Caption;SBGrid.CT.Button.prototype.refresh=function(){SBGrid.CT.BindableControl.prototype.refresh.call(this);with(this){if(null!=m_heControl){var strRef=attribute.jsonref;var strValue="";if(strRef==""||strRef==null){strRef=attribute.ref;strValue=(null!=strRef&&""!=strRef)?SBGrid.DS.XMLStorage.getUniqueStorage().getValue(strRef):getAttribute("text")}else{strValue=(null!=strRef&&""!=strRef)?SBGrid.DS.JsonStorage.getUniqueStorage().getValue(strRef):getAttribute("text")}if(null!=m_heControlText){m_heControlText.innerHTML=strValue.newlineCharConvert()}this.value=strValue}}};SBGrid.CT.Button.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Button.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this);if(null!=this.m_heControlText){var f=this.getAttribute("text");this.m_heControlText.innerHTML=f.newlineCharConvert()}if("softbowl:inputbutton"==this.attribute.tag){if(null!=this.parent){var i=0;var a=this.parent;var e=this.m_heControl;var g=a.m_heControl;var d=Number(a.attribute.left.split("px")[0]);var b=g.clientWidth;if(SBGrid.DEF.is_ie7){i+=parseInt(g.currentStyle.paddingLeft);i+=parseInt(g.currentStyle.paddingRight);i+=parseInt(g.currentStyle.borderLeftWidth);i+=parseInt(g.currentStyle.borderRightWidth)}var h=16>e.clientWidth?16:e.clientWidth;e.style.left=(d+b-h-i)+"px";e.style.height=a.m_heControl.clientHeight+"px";e=null;objParant=null;d=null;b=null;i=null;g=null;h=null}}this.m_strTargetGrid=this.getAttribute("loadexcelgrid");if(null!=this.m_strTargetGrid&&""!=this.m_strTargetGrid){this.createExcelButton()}if(""!=this.attribute.group){var c=this.attribute.group;if(null==document.m_htGroupButton){document.m_htGroupButton=new SBGrid.DS.Hashtable();document.m_htGroupButton[c]={arTab:new Array(),selected:null};document.m_htGroupButton[c].arTab.push(this);this.m_nGroupNum=0}else{if(null!=document.m_htGroupButton[c]){this.m_nGroupNum=document.m_htGroupButton[c].arTab.length;document.m_htGroupButton[c].arTab.push(this)}else{document.m_htGroupButton[c]={arTab:new Array(),selected:null};document.m_htGroupButton[c].arTab.push(this);this.m_nGroupNum=0}}this.designButton(true);if(this.selected){this.setSelected(true)}}};SBGrid.CT.Button.prototype.createExcelButton=function(){if(null==this.m_heLodExcelForm){if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8){this.m_heLodExcelForm=document.createElement("<form encType='multipart/form-data'>")}else{this.m_heLodExcelForm=document.createElement("form");this.m_heLodExcelForm.setAttribute("enctype","multipart/form-data")}this.m_heLodExcelForm.action=SBGrid.DEF.__getAppName()+"LoadExcel.tfs";this.m_heLodExcelForm.method="post";this.m_heLodExcelForm.target="SBHE___SB_LoadExcel";this.m_heLodExcelForm.style.filter="alpha(opacity=0)";this.m_heLodExcelForm.style.opacity=0;this.m_heLodExcelForm.style.position="absolute";this.m_heLodExcelForm.style.top=this.getAttribute("top");this.m_heLodExcelForm.style.left=this.getAttribute("left");this.m_heLodExcelForm.style.width=this.getAttribute("width");this.m_heLodExcelForm.style.height=this.getAttribute("height");if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){var b="<input type='hidden' name='nodeset'/>";b+="<input type='file' name='excel' onchange='"+this.id+".loadExcelGrid();' style='top:0px;left:0px;width:100%;height:100%;cursor:hand;' />";this.m_heLodExcelForm.innerHTML=b}else{var c=document.createElement("input");c.type="hidden";c.name="nodeset";var a=document.createElement("input");a.type="file";a.name="excel";a.style.top="0px";a.style.left="0px";a.style.width="100%";a.style.height="100%";a.style.cursor="hand";a.setAttribute("onchange",this.id+".loadExcelGrid();");this.m_heLodExcelForm.appendChild(c);this.m_heLodExcelForm.appendChild(a)}if(null!=this.parent.m_heControl){this.parent.m_heControl.appendChild(this.m_heLodExcelForm)}}};SBGrid.CT.Button.prototype.loadExcelGrid=function(){var e=this.m_heLodExcelForm.lastChild.value;e=e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase();if("xlsx"!=e&&"xls"!=e&&"cell"!=e){SBGrid.DEF.errorMsg("올바른 Excel File 형식이 아닙니다.");return}var g=document.SBHE_allElement.item(this.m_strTargetGrid);if(null!=g){var b=g.nodeset+"@";var f=true;for(var c=0;c<g.m_arColumn.length;c++){var a=g.m_arColumn[c].getAttribute("ref");if(""!=a.trim()){if(f){b+=a;f=false}else{b+=","+a}}}this.m_heLodExcelForm.firstChild.value=encodeURI(b+"@"+e)}else{SBGrid.DEF.errorMsg("Load Excel을 적용할 Target Grid가 존재하지 않습니다.");return}SBGrid.DEF.SBLE_GRID=this.m_strTargetGrid;SBGrid.DEF.SBLE_BUTTON=this;var d=document.getElementById("SBHE___SB_LoadExcel");if(d){d.setAttribute("targetGrid",this.m_strTargetGrid);if(d.attachEvent){d.attachEvent("onload",SBGrid.CT.Button.uploadComplete)}else{d.addEventListener("load",SBGrid.CT.Button.uploadComplete,false)}}this.m_heLodExcelForm.submit();this.m_heLodExcelForm.reset()};SBGrid.CT.Button.prototype.isCSSValid=function(b){var a=SBGrid.CT.Caption.prototype.isCSSValid.call(this);if("background-image"==b&&!a){if("softbowl:inputbutton"==this.getTag()){if("url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgButton+")"==SBGrid.UT.HtmlLib.getStyle(this.m_heControl,b)){return true}}else{if("softbowl:combobutton"==this.getTag()){if("url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCombo+")"==SBGrid.UT.HtmlLib.getStyle(this.m_heControl,b)){return true}}}}return a};SBGrid.CT.Button.prototype.applyDefaultStyle=function(){if(null!=this.m_heControl){var a=this.m_heControl.style;a.backgroundColor=null!=this.attribute["background-color"]?this.attribute["background-color"]:"";a.backgroundImage=null!=this.attribute["background-image"]?this.attribute["background-image"]:"";a.borderStyle=null!=this.attribute["border-style"]?this.attribute["border-style"]:"";a.borderColor=null!=this.attribute["border-color"]?this.attribute["border-color"]:"";a.borderWidth=null!=this.attribute["border-width"]?this.attribute["border-width"]:"";a.color=null!=this.attribute.color?this.attribute.color:""}};SBGrid.CT.Button.prototype.setAttribute=function(a,b){if(""!=this.attribute.group&&"border-style"==a){return}SBGrid.CT.Caption.prototype.setAttribute.call(this,a,b);switch(a){case"text":this.attribute.text=b;this.refresh();break;case"group":this.attribute.group=b;""!=b?this.designButton(true):this.designButton(false);break;case"groupalign":this.attribute.groupalign=b;this.designButton(true);break;case"selected":break}};SBGrid.CT.Button.prototype.onClick=function(a){SBGrid.CT.Caption.prototype.onClick.call(this,a);if(a.target==this.getId()){var b=this.getAttribute("group");if(!b.isEmpty()){this.setSelected(true,a)}}};SBGrid.CT.Button.prototype.onKeyPress=function(a){SBGrid.CT.Caption.prototype.onKeyPress.call(this,a);if(a.target==this.getId()&&(SBGrid.EVT.ENTER==a.keyCode||SBGrid.EVT.SPACE==a.keyCode)){var b=this.getAttribute("group");if(!b.isEmpty()){this.setSelected(true,a)}}};SBGrid.CT.Button.prototype.defaultAction=function(b,a){SBGrid.CT.Group.prototype.defaultAction.call(this,b,a)};SBGrid.CT.Button.prototype.setSelected=function(b,a){var e=this.getAttribute("group");var d=document.m_htGroupButton[e];if(null!=d&&null!=d.selected){var c=d.arTab[d.selected];c.attribute.selected="false";c.selected=false;SBGrid.UT.HtmlLib.setStyle(c.m_heControl,"background-color",null!=c.attribute["background-color"]?c.attribute["background-color"]:"");SBGrid.UT.HtmlLib.setStyle(c.m_heControl,"background-image",null!=c.attribute["background-image"]?c.attribute["background-image"]:"");SBGrid.UT.HtmlLib.setStyle(c.m_heControl,"border-color",null!=c.attribute["border-color"]?c.attribute["border-color"]:"#000000");SBGrid.UT.HtmlLib.setStyle(c.m_heControl,"border-width",null!=c.attribute["border-width"]?c.attribute["border-width"]:"");SBGrid.UT.HtmlLib.setStyle(c.m_heControl,"color",null!=c.attribute.color?c.attribute.color:"");objXnButtons=null}this.attribute.selected=b.toString();this.selected=b;if(b){d.selected=this.m_nGroupNum;SBGrid.UT.HtmlLib.setStyle(this.m_heControl,"background-color",null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"#FFE9D4");SBGrid.UT.HtmlLib.setStyle(this.m_heControl,"background-image",null!=this.attribute["select.background-image"]?this.attribute["select.background-image"]:"");SBGrid.UT.HtmlLib.setStyle(this.m_heControl,"border-color",null!=this.attribute["select.border-color"]?this.attribute["select.border-color"]:"#000000");SBGrid.UT.HtmlLib.setStyle(this.m_heControl,"border-width",null!=this.attribute["select.border-width"]?this.attribute["select.border-width"]:"");SBGrid.UT.HtmlLib.setStyle(this.m_heControl,"color",null!=this.attribute["select.color"]?this.attribute["select.color"]:"")}};SBGrid.CT.Button.prototype.onafterloadexcel=function(){};SBGrid.CT.Button.prototype.onafterloadexcelerror=function(){};SBGrid.CT.Button.prototype.designButton=function(b){var a=this.m_heControl;a.style.borderStyle="";a.style.borderColor="";if(b){a.hideFocus=true;if("user"==this.attribute.groupalign){SBGrid.UT.HtmlLib.setStyle(a,"border-style",null!=this.attribute["border-style"]?this.attribute["border-style"]:"none")}else{a.style.borderLeftStyle="solid";a.style.borderLeftColor="#000000";a.style.borderRightStyle="solid";a.style.borderRightColor="#000000";if("bottom"==this.attribute.groupalign){a.style.borderBottomStyle="solid";a.style.borderBottomColor="#000000";a.style.borderTopStyle="none";a.style.borderTopColor=""}else{if("top"==this.attribute.groupalign||""==this.attribute.groupalign){a.style.borderTopStyle="solid";a.style.borderTopColor="#000000";a.style.borderBottomStyle="none";a.style.borderBottomColor=""}}}}else{this.selected=false;this.attribute.selected="false";a.hideFocus=false;this.applyDefaultStyle()}};SBGrid.CT.Button.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"button");var a=SBGrid.CT.Button.createMainNode(d);var c=document.getElementById("SBHE_"+b);c.appendChild(a);a=SBGrid.CT.Button.createSubNodes(a,d);return SBGrid.CT.Button.createObject(b,a,d,e)};SBGrid.CT.Button.createMainNode=function(b){var a=document.createElement("button");a=SBGrid.CT.Button.createAttribute(a,b);a.removeAttribute("text");jQuery(a).addClass("sbgrid_button");return a};SBGrid.CT.Button.createSubNodes=function(a,c){var b=document.createElement("div");b.setAttribute("id","SBHE_"+c.item("id")+"_TEXT");b.setAttribute("class","sbgrid_button_div");if(a.getAttribute("text")){a.innerHTML=a.getAttribute("text").newlineCharConvert()}a.appendChild(b);return a};SBGrid.CT.Button.createObject=function(d,y,D,G){var l="";var e="";var F="";var E="";var w="";var t="";var A=false;var s=false;var p="";var r="";var a="";var C=9007199254740992;var h="";var b="";var v=false;var x="visible";var m="";for(var u=0;u<D.count();u++){var g=D.keys()[u];switch(g){case"alert":l=D.item(g);break;case"help":e=D.item(g);break;case"hint":F=D.item(g);break;case"text":E=D.item(g);break;case"accesskey":w=D.item(g);break;case"class":t=D.item(g);break;case"disabled":if("true"==D.item(g)){A=true}break;case"ellipsis":if("true"==D.item(g)){s=true}break;case"group":p=D.item(g);break;case"groupalign":r=D.item(g);break;case"id":a=D.item(g);break;case"navindex":C=parseInt(D.item(g));break;case"selected":if("true"==D.item(g)){v=true}break;case"visibility":x=D.item(g);break;case"background-image":var f=D.item(g).trim();if(-1==f.indexOf("url(")){f="url("+f+")";SBGrid.UT.HtmlLib.setStyle(y,"background-image",f)}default:if(!SBGrid.DEF.SB_STYLELIST[g]){m+=g+":"+D.item(g)+"; "}break}}var o=new SBGrid.CT.Button(d,l,e,F,E,w,false,"",t,A,s,"",p,r,a,C,h,b,"",-1,v,G,"softbowl:button",x,m);if(""!=m){var q=new SBGrid.DS.Hashtable();var z=new SBGrid.DS.Hashtable();var c=m.split(";");for(var u=0;u<c.length;u++){var n=c[u].split(":");if(-1!=n[0].trim().indexOf("select.")){var g=n[0].trim().substring(7);var B=n[1].trim();if(null!=B&&""!=B){q[g]=B}}else{if(-1!=n[0].trim().indexOf("hover.")){var g=n[0].trim().substring(6);var B=n[1].trim();if(null!=B&&""!=B){z[g]=B}}}}o.setSelectStyle(q);o.setHoverStyle(z)}return o};SBGrid.CT.Button.createAttribute=function(b,a){b=SBGrid.CT.Caption.createAttribute(b,a);return b};SBGrid.CT.Button.uploadComplete=function(){var p=document.getElementById("SBHE___SB_LoadExcel").contentWindow.strLoadXml;if(p){var b=SBGrid.UT.XmlLib.loadXMLFromString(p);if(!b.selectSingleNode("/root/SB_EXCEL_ERR")){var d=SBGrid.DEF.SBLE_BUTTON.getAttribute("exportfalserows");var o=d.isEmpty()?0:parseInt(d);var m=document.SBHE_allElement.item(SBGrid.DEF.SBLE_GRID);var h=m.nodeset.substring(0,m.nodeset.lastIndexOf("/"));var c=m.nodeset;if(null!=m){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage()){var q=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=q){var a=SBGrid.UT.XmlLib.getRootElementNode(b);var f=q.selectSingleNode(h);var r=SBGrid.UT.XmlLib.selectNodes(q,c);var g=r.length;for(var n=0;n<g;n++){f.removeChild(r.item(n))}var e=a.selectSingleNode(h);var l=e.childNodes.item(o);while(l){f.appendChild(l.cloneNode(true));l=l.nextSibling}}}m.refresh();SBGrid.DEF.SBLE_BUTTON.dispatch("onafterloadexcel")}}else{SBGrid.DEF.errorMsg("loadExcel 오류 : 잘못된 타입의 Excel 파일 입니다.");SBGrid.DEF.SBLE_BUTTON.dispatch("onafterloadexcelerror")}}};SBGrid.CT.TextArea=function(d,i,e,z,t,n,s,x,q,B,v,p,b,r,g,o,y,a,f,h,c,m,w,C,A,u,l){if(!b){return}SBGrid.CT.Group.call(this,d,i,e,z,t,n,s,x,b,y,a,"",h,c,m,w,C,A,u,l);this.m_strInputValue="";this.attribute.dragmode=String(q);this.attribute.dropmode=String(B);this.attribute.editable=String(v);this.attribute.editmenu=String(p);this.attribute.imemode=r;this.attribute.maxbyte=String(g);this.attribute.maxlength=String(o);this.attribute.pastemode=f;this.caretPosition=-1;this.label="";this.oldValue="";this.m_nCaretStart=0;this.m_strSelectionText="";this.m_nCaretEnd=0;this.m_nCaretStart;this.m_nCaretEnd;this.m_strUndo};SBGrid.CT.TextArea.prototype=new SBGrid.CT.Group;SBGrid.CT.TextArea.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);if("softbowl:input"!=this.tag&&"softbowl:comboinput"!=this.tag){this.m_heControl.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', this.id.replace('SBHE_', ''))")}if(null!=this.m_heControl){if(-1!=parseInt(this.attribute.maxlength)){this.m_heControl.maxLength=parseInt(this.attribute.maxlength)}if(""!=this.attribute.imemode){if("hangul"==this.attribute.imemode){this.m_heControl.style.imeMode="active"}else{if("alpha"==this.attribute.imemode){this.m_heControl.style.imeMode="inactive"}else{this.m_heControl.style.imeMode="disabled"}}}if("false"==this.attribute.editable){this.m_heControl.readOnly=true}if(SBGrid.DEF.is_iphone&&null==this.m_isGridInput){this.m_heControl.setAttribute("onFocus",'SBGrid.DS.XMLStorage.getUniqueStorage().setFocus("'+this.id+")")}}};SBGrid.CT.TextArea.prototype.applyDefaultStyle=function(){};SBGrid.CT.TextArea.prototype.getAbility=function(){return SBGrid.CT.Group.prototype.getAbility.call(this)|SBGrid.DEF.SBEA_HSB_AS_TEXT};SBGrid.CT.TextArea.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.TextArea.prototype.setEditText=function(a){this.m_strUndo=this.getWindowText();this.setWindowText(a)};SBGrid.CT.TextArea.prototype.getWindowText=function(){return this.m_heControl.value};SBGrid.CT.TextArea.prototype.setWindowText=function(a){this.m_heControl.value=a};SBGrid.CT.TextArea.prototype.refresh=function(){if(null!=this.m_heControl){var a="";a=this.attribute.jsonref;if(null==a||""==a){a=this.attribute.ref}if(null!=a&&""!=a){var b=this.getValue(a);if(this.value!=b){this.oldValue=this.value;this.m_heControl.value=b;this.value=b;this.label=this.m_heControl.value}}this.vscroll.init();this.hscroll.init()}};SBGrid.CT.TextArea.prototype.getSelBegin=function(){return this.m_nCaretStart};SBGrid.CT.TextArea.prototype.setSelBegin=function(c){var b=null!=this.m_heControlInput?this.m_heControlInput:this.m_heControl;var a=SBGrid.DEF.getCaretPosition(b);c=parseInt(c);if(c<this.m_nCaretStart){this.m_nCaretStart=c;this.m_nCaretEnd=this.m_nCaretEnd}else{if(c>this.m_nCaretEnd){this.m_nCaretStart=this.m_nCaretStart;this.m_nCaretEnd=c}else{this.m_nCaretStart=c;this.m_nCaretEnd=this.m_nCaretEnd}}a.start=this.m_nCaretStart;a.end=this.m_nCaretEnd;SBGrid.DEF.setCaretPosition(b,this.m_nCaretStart,this.m_nCaretEnd)};SBGrid.CT.TextArea.prototype.getSelEnd=function(){return this.m_nCaretEnd};SBGrid.CT.TextArea.prototype.setSelEnd=function(c){var b=null!=this.m_heControlInput?this.m_heControlInput:this.m_heControl;var a=SBGrid.DEF.getCaretPosition(b);c=parseInt(c);if(c<this.m_nCaretStart){this.m_nCaretStart=c;this.m_nCaretEnd=this.m_nCaretEnd}else{if(c>this.m_nCaretEnd){this.m_nCaretStart=this.m_nCaretStart;this.m_nCaretEnd=c}else{this.m_nCaretStart=c;this.m_nCaretEnd=this.m_nCaretEnd}}a.start=this.m_nCaretStart;a.end=this.m_nCaretEnd;SBGrid.DEF.setCaretPosition(b,this.m_nCaretStart,this.m_nCaretEnd)};SBGrid.CT.TextArea.prototype.getSelectionText=function(){var a=null!=this.m_heControlInput?this.m_heControlInput:this.m_heControl;return SBGrid.DEF.getSelectionText(a)};SBGrid.CT.TextArea.prototype.setSelectionText=function(a){var d=null!=this.m_heControlInput?this.m_heControlInput:this.m_heControl;var c=d.value;var e=c.substring(0,this.m_nCaretEnd);var b=c.substring(this.m_nCaretEnd);this.m_strSelectionText=a;c=e+a+b;d.value=c;SBGrid.DEF.setCaretPosition(this.m_heControl,this.m_nCaretStart,this.m_nCaretEnd)};SBGrid.CT.TextArea.prototype.setAttribute=function(a,b){SBGrid.CT.Group.prototype.setAttribute.call(this,a,b);switch(a){case"dragmode":this.attribute.dragmode=b;break;case"dropmode":this.attribute.dropmode=b;break;case"editable":this.attribute.editable=b;if("false"==b){this.m_heControl.readOnly=true}else{this.m_heControl.readOnly=false}break;case"editmenu":this.attribute.editmenu=b;break;case"imemode":this.attribute.imemode=b;break;case"maxbyte":this.attribute.maxbyte=b;break;case"maxlength":this.attribute.maxlength=b;if("-1"!=b){this.m_heControl.maxLength=parseInt(b);if(null!=this.objFormat){this.objFormat.m_nMaxLength=parseInt(b)}}else{this.m_heControl.maxLength=2147483647;if(null!=this.objFormat){this.objFormat.m_nMaxLength=2147483647}}break;case"pastemode":this.attribute.pastemode=b;break}};SBGrid.CT.TextArea.prototype.existBlock=function(a){return(""!=this.getSelectionText(this.m_heControl))};SBGrid.CT.TextArea.prototype.onDragStart=function(a){this.m_bDragStart=true;if("softbowl:input"==this.tag||"softbowl:textarea"==this.tag){a.dropData=this.getSelectionText(this.m_heControl)}};SBGrid.CT.TextArea.prototype.onDrop=function(a){if("file"==a.dropDataType){return}if(a.dropData.isEmpty()){return}var c=this.getWindowText();if(null!=c&&!c.isEmpty()){var b=SBGrid.DEF.getCaretPosition(this.m_heControl);c=c.substring(0,b.start)+a.dropData+c.substring(b.end+1,c.length)}else{c=a.dropData}this.setWindowText(c)};SBGrid.CT.TextArea.prototype.onBlur=function(b,d){SBGrid.CT.Group.prototype.onBlur.call(this,b);var g=null!=this.m_heControlInput?this.m_heControlInput:this.m_heControl;var f=SBGrid.DEF.getCaretPosition(g);this.m_nCaretStart=f.start;this.m_nCaretEnd=f.end;var a=this.attribute.jsonref;if(a!=""&&a!=null){if("true"==this.attribute.editable){var c=this.getValue();var h=this.m_heControl.value;if(c!=h){this.setValue(h);this.setText(h);if(this.m_bBinded){this.refreshCurrentModel(a)}this.dispatch("onvaluechanged")}}}else{var e=this.getRefNode();if(null!=e){if("true"==this.attribute.editable){var c=this.getValue();var h=this.m_heControl.value;if(c!=h){this.setValue(h);this.setText(h);if(this.m_bBinded){a=this.attribute.ref;this.refreshCurrentModel(a)}this.dispatch("onvaluechanged")}}}}};SBGrid.CT.TextArea.prototype.onMouseDown=function(a){SBGrid.CT.Control.prototype.onMouseDown.call(this,a);if("false"==this.getAttribute("editable")){return}if(this.existBlock()){this.m_bLButtonDown=true}};SBGrid.CT.TextArea.prototype.onMouseMove=function(a){if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){SBGrid.DEF.bDragDrop=true;this.m_bDragStart=true;a.capture="";a.drag=this.id;this.dispatch("ondragstart");if(this.m_bLButtonDown&&""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){this.dispatch("ondragenter");this.dispatch("ondragover")}}else{SBGrid.CT.Control.prototype.onMouseMove.call(this,a)}};SBGrid.CT.TextArea.prototype.onMouseUp=function(a){SBGrid.CT.Control.prototype.onMouseUp.call(this,a);this.m_bLButtonDown=false};SBGrid.CT.TextArea.prototype.onKeyDown=function(b){SBGrid.CT.Group.prototype.onKeyDown.call(this,b);if(-1!=parseInt(this.attribute.maxlength)&&"softbowl:textarea"==this.attribute.tag){if(this.m_heControl.value.length==parseInt(this.attribute.maxlength)){if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE||b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN){return}else{this.dispatch("onmaxlength");if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1].id)}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id)}}}}if(-1!=parseInt(this.attribute.maxbyte)&&"softbowl:textarea"==this.attribute.tag){var a=0;a=b.keyCode>227?2:1;if(this.m_heControl.value.getByte()+a>parseInt(this.attribute.maxbyte)){if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE||b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN){return}else{if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1].id)}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id)}}}}};SBGrid.CT.TextArea.prototype.onKeyUp=function(b){SBGrid.CT.Group.prototype.onKeyUp.call(this,b);if(!SBGrid.DEF.is_ie&&"softbowl:textarea"==this.attribute.tag){if(-1!=parseInt(this.attribute.maxlength)){if(this.m_heControl.value.length>parseInt(this.attribute.maxlength)){var a=this.m_heControl.value.substring(0,parseInt(this.attribute.maxlength));this.m_heControl.value=a}}if(-1!=parseInt(this.attribute.maxbyte)){if(this.m_heControl.value.getByte()+1>=parseInt(this.attribute.maxbyte)){var a=this.m_heControl.value.setByteWithStrLength(parseInt(this.attribute.maxbyte));this.m_heControl.value=a}}}var c=this.m_heControl.value;this.label=c};SBGrid.CT.TextArea.prototype.onScroll=function(a){SBGrid.CT.Group.prototype.onScroll.call(this,a);if("visible"==this.attribute.overflow&&"softbowl:textarea"==this.attribute.tag){if(null!=this.m_heControl){this.setAttribute("height",(this.m_heControl.scrollHeight+2)+"px")}}};SBGrid.CT.TextArea.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"textarea");var e=SBGrid.CT.TextArea.createMainNode(c);var b=document.getElementById("SBHE_"+a);b.appendChild(e);e=SBGrid.CT.TextArea.createSubNodes(e,c);return SBGrid.CT.TextArea.createObject(a,e,c,d)};SBGrid.CT.TextArea.createMainNode=function(a){var b=document.createElement("textarea");b.setAttribute("rows","1");b.setAttribute("cols","1");b=SBGrid.CT.TextArea.createAttribute(b,a);jQuery(b).addClass("sbgrid_textarea");return b};SBGrid.CT.TextArea.createSubNodes=function(b,a){return b};SBGrid.CT.TextArea.createObject=function(c,z,D,G){var n="";var d="";var E="";var v="";var q="";var t="";var B=false;var A=false;var g=false;var x=true;var y=true;var a="";var F="";var s=-1;var m=-1;var C=9007199254740992;var l="";var r="default";var h="";var b="";var p="";var w="visible";var o="";for(var u=0;u<D.count();u++){var e=D.keys()[u];switch(e){case"alert":n=D.item(e);break;case"help":d=D.item(e);break;case"hint":E=D.item(e);break;case"accesskey":v=D.item(e);break;case"bind":q=D.item(e);break;case"class":t=D.item(e);break;case"disabled":if("true"==D.item(e)){B=true}break;case"dragmode":if("true"==D.item(e)){A=true}case"dropmode":if("true"==D.item(e)){g=true}break;case"editable":if("false"==D.item(e)){x=false}break;case"editmenu":if("false"==D.item(e)){y=false}break;case"id":a=D.item(e);break;case"imemode":F=D.item(e);break;case"maxbyte":nMaxbyte=parseInt(D.item(e));break;case"maxlength":nMaxlength=parseInt(D.item(e));break;case"navindex":C=parseInt(D.item(e));break;case"overflow":l=D.item(e);case"pastemode":strPastemode=D.item(e);break;case"ref":h=D.item(e);break;case"jsonref":h=D.item(e);break;case"scroll":p=D.item(e);case"validateformat":if("true"==D.item(e)){bValidateformat=true}break;case"visibility":w=D.item(e);break;default:if(!SBGrid.DEF.SB_STYLELIST[e]){o+=e+":"+D.item(e)+"; "}break}}var f=new SBGrid.CT.TextArea(c,n,d,E,v,q,t,B,A,g,x,y,a,F,s,m,C,l,r,h,b,p,"",G,"softbowl:textarea",w,o);return f};SBGrid.CT.TextArea.createAttribute=function(b,a){b=SBGrid.CT.Group.createAttribute(b,a);return b};SBGrid.CT.Input=function(s,u,q,o,l,E,P,g,K,t,i,b,H,r,f,d,m,N,A,n,C,p,M,F,h,z,L,a,v,J,I,y,G,e,x,D,O,B,w,c){if(!d){return}SBGrid.CT.TextArea.call(this,s,u,q,o,l,P,g,K,t,i,b,H,d,m,p,M,F,h,z,L,a,y,G,D,O,w,c);this.attribute.autonext=String(E);this.attribute.format=r;this.attribute.decimalformatinsert=String(f);this.attribute.inputtype=N;this.attribute.invalidcharaters=A;this.attribute.isemptyformatted=String(n);this.attribute.mask=C;this.attribute.required=String(v);this.attribute.roundmode=J;this.attribute.roundposition=String(I);this.attribute.showmask=String(e);this.attribute.showtoday=String(x);this.attribute.validateformat=String(B);this.inputType=N;this.m_bIsDotZero=false;this.m_heControlInput;this.m_nInputButtomPointX=0;this.m_nInputButtomPointY=0;this.m_strRoundModeMask="";this.m_strShowMask="";this.objFormat;this.m_objInputButton=null;this.m_objColorButton=null;this.m_objCalendar=null;this.m_objSpin=null};SBGrid.CT.Input.prototype=new SBGrid.CT.TextArea;SBGrid.CT.Input.prototype.init=function(){SBGrid.CT.TextArea.prototype.init.call(this);if(null!=this.m_heControl){this.m_heControlInput=this.m_heControl;if("button"==this.inputType){this.m_objInputButton=this.createChild("softbowl:inputbutton","id:"+this.id+".button;")}else{if("date"==this.inputType){this.m_objInputButton=this.createChild("softbowl:inputbutton","id:"+this.id+".button;");this.m_objCalendar=this.createChild("softbowl:calendar","id:input.calendar;visibility:hidden;");var b="";if(this.m_clCSSName.exists("input_calendar")){jQuery(this.m_objCalendar.m_heControl).addClass(this.m_clCSSName.item("input_calendar"))}if(""==this.attribute.format){this.attribute.format="yyyy-mm-dd"}}else{if("spin"==this.inputType){}}}this.objFormat=new SBGrid.UT.Format(this.m_heControlInput,this.attribute.format,this.attribute.decimalformatinsert,this.attribute.maxlength);if("true"==this.attribute.showmask){this.m_strShowMask=this.attribute.format.replace(/(\w)|(\#)/g,"_")}if(-1!=this.attribute.format.indexOf(".0")){this.m_bIsDotZero=true}if("button"==this.inputType||"date"==this.inputType){if(!this.visible){this.m_objInputButton.setAttribute("visibility","hidden")}if(this.disabled){this.m_objInputButton.setAttribute("disabled","true")}}if(SBGrid.DEF.is_iphone||SBGrid.DEF.is_ipad){var a=this.m_heControlInput.style.background;a=""==a?"transparent":a;this.m_heControlInput.style.background="-webkit-gradient(linear, 0% 0%, 0% 100%, from("+a+"), to("+a+"))";this.m_heControlInput.style.webkitBorderRadius="0px";if(null==this.getAttribute("padding-left")||""==this.getAttribute("padding-left")){this.m_heControlInput.style.paddingLeft="0px"}}}};SBGrid.CT.Input.prototype.getAbility=function(){return SBGrid.CT.TextArea.prototype.getAbility.call(this)|SBGrid.DEF.SBEA_HSB_AS_FORMAT};SBGrid.CT.Input.prototype.refresh=function(){SBGrid.CT.BindableControl.prototype.refresh.call(this);if(null!=this.m_heControlInput){var a=this.attribute.jsonref;if(null==a||""==a){a=this.attribute.ref}if(null!=a&&""!=a){var e=this.getValue();if(this.value!=e){this.oldValue=this.value;this.value=e;this.setWindowText(e)}else{if(""==e&&""!=this.m_strShowMask){this.m_heControlInput.value=this.m_strShowMask}else{if(""==e&&null!=this.attribute.format){if(-1!=this.attribute.format.indexOf("0.0")){this.m_heControlInput.value="0".formatting(this.attribute.format)}}}}if("secret"!=this.inputType){this.label=this.m_heControlInput.value}else{var d="";var b=this.m_heControlInput.value.length;for(var c=0;c<b;c++){d+="*"}this.label=d}}}};SBGrid.CT.Input.prototype.getValue=function(){if(this.m_bBinded){return SBGrid.CT.TextArea.prototype.getValue.call(this)}return this.value};SBGrid.CT.Input.prototype.setValue=function(a){if(this.m_bBinded){SBGrid.CT.TextArea.prototype.setValue.call(this,a)}else{this.value=a}};SBGrid.CT.Input.prototype.setAttribute=function(b,d){SBGrid.CT.TextArea.prototype.setAttribute.call(this,b,d);switch(b){case"left":if(null!=this.m_objInputButton){var c=parseInt(d);var e=parseInt(this.attribute.width);this.m_objInputButton.setAttribute("left",(c+e-18)+"px")}if("date"==this.inputType){if(null!=this.m_objCalendar){var a=isFinite(d)?d+"px":d;this.m_objCalendar.setAttribute("left",a)}}break;case"width":if(null!=this.m_objInputButton){var c=parseInt(this.attribute.left);var e=parseInt(d);this.m_objInputButton.setAttribute("left",(c+e-18)+"px")}break;case"top":if(null!=this.m_objInputButton){this.m_objInputButton.setAttribute("top",d)}break;case"height":if(null!=this.m_objInputButton){this.m_objInputButton.setAttribute("height",d)}break;case"autonext":this.attribute.autonext=d;break;case"format":this.attribute.format=d;if("true"==this.attribute.showmask){this.m_strShowMask=this.attribute.format.replace(/(\w)|(\#)/g,"_")}if(-1!=this.attribute.format.indexOf(".0")){this.m_bIsDotZero=true}else{this.m_bIsDotZero=false}this.objFormat.init(d);break;case"inputtype":this.attribute.inputtype=d;break;case"isemptyformatted":this.attribute.isemptyformatted=d;break;case"mask":this.attribute.mask=d;break;case"required":this.attribute.required=d;break;case"roundmode":this.attribute.roundmode=d;break;case"roundposition":this.attribute.roundposition=d;break;case"showmask":this.attribute.showmask=d;if("true"==this.attribute.showmask){this.m_strShowMask=this.attribute.format.replace(/(\w)|(\#)/g,"_")}break;case"validateformat":this.attribute.validateformat=d;break;case"visibility":if("button"==this.inputType||"date"==this.inputType){this.m_objInputButton.setAttribute("visibility",value)}else{if("spin"==this.inputType){}}case"datatype":if(null!=this.m_heControl){this.m_heControl.setAttribute("datatype",d)}}};SBGrid.CT.Input.prototype.setInputType=function(a){if(this.inputType==a||a=="secret"){return}if("button"==a||"date"==a){if(null==this.m_objInputButton){this.m_objInputButton=this.createChild("softbowl:inputbutton","id:"+this.id+".button;")}else{this.m_objInputButton.m_heControl.style.display="block"}}else{if(null!=this.m_objInputButton){this.m_objInputButton.m_heControl.style.display="none"}}if("date"==a){this.attribute.format="yyyy-mm-dd";if(null==this.m_objCalendar){this.m_objCalendar=this.createChild("softbowl:calendar","id:input.calendar;visibility:hidden;");if(this.m_clCSSName.exists("input_calendar")){jQuery(this.m_objCalendar.m_heControl).addClass(this.m_clCSSName.item("input_calendar"))}}else{this.m_objCalendar.m_heControl.style.display="block"}}else{this.attribute.format="";if(null!=this.m_objCalendar){this.m_objCalendar.m_heControl.style.display="none"}}if(!this.visible){this.m_objCalendar.m_heControl.style.display="none";this.m_objInputButton.m_heControl.style.display="none"}if(this.disabled){this.m_objCalendar.setAttribute("disabled","true");this.m_objInputButton.setAttribute("disabled","true")}this.attribute.inputtype=a;this.inputType=a};SBGrid.CT.Input.prototype.setVisible=function(a,b){SBGrid.CT.TextArea.prototype.setVisible.call(this,a,b);if("button"==this.inputType||"date"==this.inputType){this.m_objInputButton.setVisible(a,b)}else{if("spin"==this.inputType){}}};SBGrid.CT.Input.prototype.setWindowText=function(a){this.m_heControlInput.value=a;if(this.objFormat.getFormatExist()){this.objFormat.init(this.attribute.format,true);if("exclude"==this.attribute.mask){this.value=this.objFormat.getFormatInputData();if(""!=this.attribute.roundmode&&""!=this.attribute.roundposition){this.value=SBGrid.DEF.getRoundMode(this.m_heControlInput.value,this.attribute.roundmode,this.attribute.roundposition);this.m_heControlInput.value=this.value}}else{this.value=this.m_heControlInput.value;if(""!=this.attribute.roundmode&&""!=this.attribute.roundposition){this.value=SBGrid.DEF.getRoundMode(this.m_heControlInput.value,this.attribute.roundmode,this.attribute.roundposition);this.m_heControlInput.value=this.value}this.setValue(this.value)}}};SBGrid.CT.Input.prototype.setButtomPosition=function(){this.m_nInputButtomPointX=this.m_heControl.offsetLeft+this.m_heControl.clientWidth-18;this.m_nInputButtomPointY=this.m_heControl.offsetTop;var a=this.m_heControl;while(null!=a){if(SBGrid.DEF.is_firefox){a=a.parentNode}else{a=a.parentElement}this.m_nInputButtomPointX-=a.scrollLeft;this.m_nInputButtomPointY-=a.scrollTop;if("BODY"==a.tagName){break}}};SBGrid.CT.Input.prototype.setCaretPosition=function(a){this.m_nCaretStart=a;this.m_nCaretEnd=a;SBGrid.DEF.setCaretPosition(this.m_heControl,this.m_nCaretStart,this.m_nCaretStart)};SBGrid.CT.Input.prototype.getInputDateAttribute=function(){var a=new SBGrid.DS.Hashtable();a.add("id","input_date");a.add("left",this.attribute.left);a.add("top",(Number(this.attribute.top.split("px")[0])+Number(this.attribute.height.split("px")[0]))+"px");a.add("width","190px");a.add("height","140px");a.add("navindex","-1");return a};SBGrid.CT.Input.prototype.showCalendar=function(h){if(h){this.m_objCalendar.parent=this;var l=nViewportHeight;var o=nViewportWidth;var c=0;var a=0;var e=this.m_heControl;if(null!=e){if(this.getClientLeft(true)+this.m_objCalendar.m_heControl.offsetWidth>o){a=(this.getClientLeft(true)-(this.m_objCalendar.m_heControl.offsetWidth-e.offsetWidth))}else{a=this.getClientLeft(true)}if(this.getClientTop(true)+e.offsetHeight+this.m_objCalendar.m_heControl.offsetHeight>l){c=(this.getClientTop(true)-this.m_objCalendar.m_heControl.offsetHeight)}else{c=(this.getClientTop(true)+e.offsetHeight)}}this.m_objCalendar.setAttribute("top",c+"px");this.m_objCalendar.setAttribute("left",a+"px");var n=this.getValue();if(""!=n){var i=this.getAttribute("format");i=i.replace(/\W/g,"");n=n.replace(/\W/g,"");var g=null;var d=null;var b=null;var m=i.indexOf("y");if(-1!=m&&"y"==i.charAt(m+3)){g=Number(n.substr(m,4))}var p=i.indexOf("m");if(-1!=p&&"m"==i.charAt(p+1)){d=Number(n.substr(p,2))}var f=i.indexOf("d");if(-1!=f&&"d"==i.charAt(f+1)){b=Number(n.substr(f,2))}if(null!=g&&g>99){this.m_objCalendar.year=g.toString()}if(null!=d&&d>0){this.m_objCalendar.month=d.toString()}if(null!=b&&b>0){this.m_objCalendar.day=b.toString()}this.m_objCalendar.refresh()}else{this.m_objCalendar.setToday()}}this.m_objCalendar.setVisible(h)};SBGrid.CT.Input.prototype.onBlur=function(a){var e=false;var l=this.attribute.format;var h=this.attribute.ref;if("true"==this.attribute.editable){var g=this.getValue();var m="";if(null!=l&&!l.isEmpty()){if("true"==this.attribute.showmask){this.m_heControlInput.value=this.m_heControlInput.value==this.m_strShowMask?"":this.m_heControlInput.value;this.m_heControlInput.value=this.m_heControlInput.value==""?this.m_strShowMask:this.m_heControlInput.value}if(this.m_bIsDotZero&&!this.objFormat.m_bIsEmptyFormatted&&"true"==this.attribute.isemptyformatted){this.m_heControlInput.value=this.m_heControlInput.value.replace(/\.(0+)/g,"")}if("exclude"==this.attribute.mask){this.objFormat.init(l);m=this.objFormat.getFormatInputData()}else{m=this.m_heControlInput.value;if(2==this.objFormat.m_nMoneyUnitFormatPattern&&!this.attribute.roundmode.isEmpty()&&!this.attribute.roundposition.isEmpty()){m=SBGrid.DEF.getRoundMode(m,this.attribute.roundmode,this.attribute.roundposition)}}if("true"==this.attribute.validateformat){this.dispatch("onbeforevalidation");if(this.objFormat.m_nLength==this.m_heControlInput.value.length){this.dispatch("onvalidformat")}else{if((!this.objFormat.m_bExistMoneyUnitFormat)||(this.objFormat.m_bExistMoneyUnitFormat&&0==this.m_heControlInput.value.length)){this.dispatch("oninvalidformat")}else{this.dispatch("onvalidformat")}}}}else{m=this.m_heControlInput.value}if(g!=m){if(m==this.m_strShowMask){m=""}if("softbowl:comboinput"==this.tag&&"search"==this.parent.getAttribute("editmode")){var b=false;if(null!=m&&!m.isEmpty()){for(var f=0;f<this.parent.m_nRows;f++){for(var d=0;d<this.parent.m_nCols;d++){var c=this.parent.getCell(f,d);if(null!=c&&c.label==m){b=true;break}}if(b){break}}}if(!b){m=""}}if("softbowl:comboinput"!=this.tag){this.setText(m)}this.setValue(m);if(this.m_bBinded){this.refreshCurrentModel(this.attribute.ref)}else{if(h.isEmpty()){this.setText(g);this.setValue(g);this.setWindowText(g)}}if(this.m_bIsDotZero&&!this.objFormat.m_bIsEmptyFormatted&&"true"==this.attribute.isemptyformatted){this.m_heControlInput.value=this.m_heControlInput.value.replace(/\.(0+)/g,"")}if(!this.getAttribute("skipvaluechanged")){e=true}}else{if(this.m_bIsDotZero&&"true"==this.attribute.isemptyformatted){this.m_heControlInput.value=this.m_heControlInput.value.replace(/\.(0+)/g,"")}}if(2==this.objFormat.m_nMoneyUnitFormatPattern&&!this.attribute.roundmode.isEmpty()&&!this.attribute.roundposition.isEmpty()){this.m_strRoundModeMask=this.m_heControlInput.value;this.m_heControlInput.value=SBGrid.DEF.getRoundMode(this.m_strRoundModeMask,this.attribute.roundmode,this.attribute.roundposition)}if(this.m_objCalendar&&!this.m_objCalendar.isDescendants(a.relatedTarget,true)){this.showCalendar(false)}SBGrid.CT.Group.prototype.onBlur.call(this,a);if(!this.getAttribute("skipvaluechanged")&&e){this.dispatch("onvaluechanged")}}};SBGrid.CT.Input.prototype.onFocus=function(a){SBGrid.CT.TextArea.prototype.onFocus.call(this,a);if(a.target==this.id){var b=this.getAttribute("format");if(!b.isEmpty()){if(0==this.m_heControlInput.value.length&&"true"==this.attribute.showmask){this.m_heControlInput.value=this.m_strShowMask}else{if(this.m_bIsDotZero&&"true"==this.attribute.isemptyformatted){if(-1==this.m_heControlInput.value.indexOf(".")){this.objFormat.m_bIsEmptyFormatted=false;this.m_heControlInput.value+=".0"}}}if(2==this.objFormat.m_nMoneyUnitFormatPattern&&!this.attribute.roundmode.isEmpty()&&!this.attribute.roundposition.isEmpty()&&"exclude"==this.attribute.mask){if(""!=this.m_strRoundModeMask){this.m_heControlInput.value=this.m_strRoundModeMask}}}window.setTimeout("try{if (null != "+this.id+"){"+this.id+'.m_heControlInput.select();}else{document.SBHE_allElement.item("'+this.id+'").m_heControlInput.select();}}catch(e){}',0)}};SBGrid.CT.Input.prototype.onKeyDown=function(a){SBGrid.CT.TextArea.prototype.onKeyDown.call(this,a);var f=false;if(-1!=parseInt(this.attribute.maxlength)){var e=parseInt(this.attribute.maxlength);if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()){if(-1!=this.attribute.format.indexOf(".")&&-1!=this.attribute.maxlength.indexOf(".")){var m=parseInt(this.attribute.maxlength.split(".")[0]);var n=this.objFormat.m_strInputRealityData;var g=-1!=n.indexOf(".")?n.indexOf("."):n.length;var c=SBGrid.DEF.getCaretPosition(this.m_heControl).start;var b=SBGrid.DEF.getCaretPosition(this.m_heControl).end;if(""!=this.objFormat.m_strDotZero){if(n.substring(g,n.length).length-1==this.objFormat.m_strDotZero.length&&c==b&&b==this.m_heControl.value.length){f=true}}if(m==g){if(((48<=a.keyCode&&a.keyCode<=57)||(96<=a.keyCode&&a.keyCode<=105))&&b==c&&(b<=this.m_heControl.value.indexOf(".")||(b>this.m_heControl.value.indexOf(".")&&-1==n.indexOf(".")&&110!=a.keyCode))){a.browserPreventDefault();a.browserStopPropagation();return}}}else{if(this.m_heControlInput.value.replaceAll(",","").replace(".","").length==e){f=true}}}else{if(this.m_heControlInput.value.length==e){f=true}}}else{if(this.m_heControlInput.value.length==e){f=true}}}else{if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()&&""!=this.objFormat.m_strDotZero){var n=this.objFormat.m_strInputRealityData;var g=-1!=n.indexOf(".")?n.indexOf("."):n.length;var c=SBGrid.DEF.getCaretPosition(this.m_heControl).start;var b=SBGrid.DEF.getCaretPosition(this.m_heControl).end;if(n.substring(g,n.length).length-1==this.objFormat.m_strDotZero.length&&c==b&&b==this.m_heControl.value.length){f=true}}else{if(!this.objFormat.getMoneyUnitFormatExist()){if(this.m_heControlInput.value.length==this.attribute.format.length){f=true}}}}}if(a.keyCode==SBGrid.EVT.BACKSPACE||a.keyCode==SBGrid.EVT.DELETE){f=false}if(f){if(a.keyCode==SBGrid.EVT.LEFT||a.keyCode==SBGrid.EVT.UP||a.keyCode==SBGrid.EVT.RIGHT||a.keyCode==SBGrid.EVT.DOWN){return}else{this.dispatch("onmaxlength");if("true"==this.attribute.autonext){var l=SBGrid.DEF.getCaretPosition(this.m_heControl);if(l.start==l.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var i=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].id);a.browserPreventDefault();a.browserStopPropagation();break}i++}i=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);a.browserPreventDefault();a.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}if(-1!=parseInt(this.attribute.maxbyte)){var h=0;var o=this.m_heControlInput.value;var d=SBGrid.DEF.SB_KOREAN.exec(o.substr(o.length-1,1));h=null!=d?2:1;if(this.m_heControlInput.value.getByte()+h>parseInt(this.attribute.maxbyte)){if(a.keyCode==SBGrid.EVT.BACKSPACE||a.keyCode==SBGrid.EVT.DELETE||a.keyCode==SBGrid.EVT.LEFT||a.keyCode==SBGrid.EVT.UP||a.keyCode==SBGrid.EVT.RIGHT||a.keyCode==SBGrid.EVT.DOWN){return}else{if("true"==this.attribute.autonext){var l=SBGrid.DEF.getCaretPosition(this.m_heControl);if(l.start==l.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var i=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+i].id);a.browserPreventDefault();a.browserStopPropagation();break}i++}i=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);a.browserPreventDefault();a.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}}if(this.objFormat.getFormatExist()){if(a.keyCode==229){this.objFormat.stopKeyEvent(a)}if(8==a.keyCode||46==a.keyCode){if(!SBGrid.DEF.is_smartphone&&!this.objFormat.getMoneyUnitFormatExist()){this.objFormat.keypressFormatting(a)}else{if(!SBGrid.DEF.is_smartphone&&this.objFormat.getMoneyUnitFormatExist()){this.objFormat.moneyKeyCheck(a)}}}}};SBGrid.CT.Input.prototype.onKeyPress=function(a){SBGrid.CT.TextArea.prototype.onKeyPress.call(this,a);if(this.objFormat.getFormatExist()){if(a.keyCode!=229){if(!SBGrid.DEF.is_smartphone&&!this.objFormat.getMoneyUnitFormatExist()){this.objFormat.keypressFormatting(a)}else{if(!SBGrid.DEF.is_smartphone&&this.objFormat.getMoneyUnitFormatExist()){this.objFormat.keypressMoneyUnitFormatting(a)}else{if(SBGrid.DEF.is_smartphone){this.objFormat.keypressMoneyUnitFormatting(a)}}}}}};SBGrid.CT.Input.prototype.onKeyUp=function(b){SBGrid.CT.TextArea.prototype.onKeyUp.call(this,b);if(!SBGrid.DEF.is_ie){if(-1!=parseInt(this.attribute.maxbyte)){if(this.m_heControlInput.value.getByte()+1>=parseInt(this.attribute.maxbyte)){var n=this.m_heControlInput.value.setByteWithStrLength(parseInt(this.attribute.maxbyte));this.m_heControlInput.value=n}}}var e=false;if(-1!=parseInt(this.attribute.maxlength)){var d=parseInt(this.attribute.maxlength);if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()){if(-1!=this.attribute.format.indexOf(".")&&-1!=this.attribute.maxlength.indexOf(".")){var i=parseInt(this.attribute.maxlength.split(".")[0]);var m=this.objFormat.m_strInputRealityData;var f=-1!=m.indexOf(".")?m.indexOf("."):m.length;var c=SBGrid.DEF.getCaretPosition(this.m_heControl).start;var a=SBGrid.DEF.getCaretPosition(this.m_heControl).end;if(""!=this.objFormat.m_strDotZero){if(m.substring(f,m.length).length-1==this.objFormat.m_strDotZero.length&&c==a&&a==this.m_heControl.value.length){e=true}}if(i==f){if(((48<=b.keyCode&&b.keyCode<=57)||(96<=b.keyCode&&b.keyCode<=105))&&a==c&&(a<=this.m_heControl.value.indexOf(".")||(a>this.m_heControl.value.indexOf(".")&&-1==m.indexOf(".")&&110!=b.keyCode))){b.browserPreventDefault();b.browserStopPropagation();return}}}else{if(this.m_heControlInput.value.replaceAll(",","").replace(".","").length==d){e=true}}}else{if(this.m_heControlInput.value.length==d){e=true}}}else{if(this.m_heControlInput.value.length==d){e=true}}}else{if(""!=this.attribute.format){if(this.objFormat.getMoneyUnitFormatExist()&&""!=this.objFormat.m_strDotZero){var m=this.objFormat.m_strInputRealityData;var f=-1!=m.indexOf(".")?m.indexOf("."):m.length;var c=SBGrid.DEF.getCaretPosition(this.m_heControl).start;var a=SBGrid.DEF.getCaretPosition(this.m_heControl).end;if(m.substring(f,m.length).length-1==this.objFormat.m_strDotZero.length&&c==a&&a==this.m_heControl.value.length){e=true}}else{if(!this.objFormat.getMoneyUnitFormatExist()){if(this.m_heControlInput.value.length==this.attribute.format.length){e=true}}}}}if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE){e=false}if(e){if((b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN)||b.keyCode==SBGrid.EVT.TAB||b.keyCode==SBGrid.EVT.SHIFT){return}else{this.dispatch("onmaxlength");if("true"==this.attribute.autonext){var h=SBGrid.DEF.getCaretPosition(this.m_heControl);if(h.start==h.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var g=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].id);b.browserPreventDefault();b.browserStopPropagation();break}g++}g=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);b.browserPreventDefault();b.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}if(-1!=parseInt(this.attribute.maxbyte)){if(this.m_heControlInput.value.getByte()>=parseInt(this.attribute.maxbyte)){if(b.keyCode==SBGrid.EVT.BACKSPACE||b.keyCode==SBGrid.EVT.DELETE||b.keyCode==SBGrid.EVT.LEFT||b.keyCode==SBGrid.EVT.UP||b.keyCode==SBGrid.EVT.RIGHT||b.keyCode==SBGrid.EVT.DOWN){return}else{if("true"==this.attribute.autonext){var h=SBGrid.DEF.getCaretPosition(this.m_heControl);if(h.start==h.end){if(null==this.m_isGridInput){if(null!=SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+1]){var g=1;while(true){if(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].isEnable()){SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[this.m_TabIndex+g].id);b.browserPreventDefault();b.browserStopPropagation();break}g++}g=null}else{SBGrid.DEF.setFocus(SBGrid.DS.XMLStorage.getUniqueStorage().m_objTabIndex[0].id);b.browserPreventDefault();b.browserStopPropagation()}}else{this.m_bEndEdit=true}}}}}}var l=this.m_heControl.value;this.label=l};SBGrid.CT.Input.prototype.onMouseDown=function(a){SBGrid.CT.TextArea.prototype.onMouseDown.call(this,a)};SBGrid.CT.Input.prototype.onMouseMove=function(a){SBGrid.CT.TextArea.prototype.onMouseMove.call(this,a)};SBGrid.CT.Input.prototype.onMouseUp=function(a){SBGrid.CT.TextArea.prototype.onMouseUp.call(this,a)};SBGrid.CT.Input.prototype.onDrop=function(a){SBGrid.CT.TextArea.prototype.onDrop.call(this,a)};SBGrid.CT.Input.prototype.onClick=function(a){SBGrid.CT.TextArea.prototype.onClick.call(this,a);if(("date"==this.inputType||"button"==this.inputType)&&null!=this.m_objInputButton&&this.m_objInputButton.getId()==a.target){this.dispatch("onbuttonclick");if("date"==this.inputType){this.showCalendar(!this.m_objCalendar.visible)}}else{if("colorpopup"==this.inputType&&null!=this.m_objColorButton&&this.m_objColorButton.getId()==a.target){this.dispatch("oncolorbuttonclick")}else{if("spin"==this.inputType&&null!=this.m_objSpin&&this.m_objSpin.getId()==a.target){}}}};SBGrid.CT.Input.prototype.onDblClick=function(a){SBGrid.CT.TextArea.prototype.onDblClick.call(this,a);if(!this.disabled&&""!=this.inputType){if("spin"==this.inputType){if(this.m_nInputButtomPointX<a.clientX){if(this.m_nInputButtomPointY+(this.m_heControl.clientHeight/2)>a.clientY){this.dispatch("onspindbup")}else{this.dispatch("onspindbdown")}}}}};SBGrid.CT.Input.prototype.onDaySelect=function(b){var c=this.getValue();var d=this.getAttribute("format");var e="";var f=d.match(/(y+)|(m+)|(d+)/g);if(""==this.m_objCalendar.day){return}for(var a=0;a<f.length;a++){if(-1!=f[a].indexOf("y")){e+=String(this.m_objCalendar.year)}else{if(-1!=f[a].indexOf("m")){e+=String(parseInt(this.m_objCalendar.month)>9?this.m_objCalendar.month:"0"+this.m_objCalendar.month)}else{e+=String(parseInt(this.m_objCalendar.day)>9?this.m_objCalendar.day:"0"+this.m_objCalendar.day)}}}if("include"==this.getAttribute("mask")){if(null==e){e=""}e=e.formatting(d)}if(c!=e){this.setWindowText(e);this.setValue(e);if(this.isBinded()){this.refreshCurrentModel(this.attribute.ref)}if("true"!=this.getAttribute("skipvaluechanged")){this.dispatch("onvaluechanged")}}this.showCalendar(false)};SBGrid.CT.Input.prototype.defaultAction=function(b,a){SBGrid.CT.TextArea.prototype.defaultAction.call(this,b,a);switch(b){case"ondayselect":this.onDaySelect(a);break;case"oncolorselect":this.onColorSelect(a);break;case"onautomaticcolor":break;case"oncustomcolor":break;case"onhidepopup":break;case"onbeforevalidation":break;case"oninvalidformat":break;case"onspinupbuttonclick":break;case"onspindownbuttonclick":break}};SBGrid.CT.Input.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"input");var e=SBGrid.CT.Input.createMainNode(c);var b=document.getElementById("SBHE_"+a);b.appendChild(e);e=SBGrid.CT.Input.createSubNodes(e,c);return SBGrid.CT.Input.createObject(a,e,c,d)};SBGrid.CT.Input.createMainNode=function(a){var b=document.createElement("input");b=SBGrid.CT.Input.createAttribute(b,a);jQuery(b).addClass("sbgrid_input");jQuery(b).addClass("sbgrid_boxsizing");return b};SBGrid.CT.Input.createSubNodes=function(b,a){return b};SBGrid.CT.Input.createObject=function(u,P,z,G){var x="";var s="";var o="";var n="";var y=true;var R="";var l="";var M=false;var q=false;var e=false;var b=true;var D=true;var t="";var h=false;var f="";var g="";var K="";var I="";var p=false;var F="";var m=-1;var r=-1;var H=9007199254740992;var w="default";var N="";var a="";var A=false;var L="";var J=0;var Q=false;var C=false;var E=false;var B="visible";var d="";for(var O=0;O<z.count();O++){var c=z.keys()[O];switch(c){case"alert":x=z.item(c);break;case"help":s=z.item(c);break;case"hint":o=z.item(c);break;case"accesskey":n=z.item(c);break;case"autonext":if("true"==z.item(c)){y=true}break;case"bind":R=z.item(c);break;case"class":l=z.item(c);break;case"disabled":if("true"==z.item(c)){M=true}break;case"dragmode":if("true"==z.item(c)){q=true}case"dropmode":if("true"==z.item(c)){e=true}break;case"editable":if("false"==z.item(c)){b=false}break;case"editmenu":if("false"==z.item(c)){D=false}break;case"format":t=z.item(c);break;case"decimalformatinsert":h=z.item(c);break;case"id":f=z.item(c);break;case"imemode":g=z.item(c);break;case"inputtype":K=z.item(c);break;case"invalidcharacters":I=z.item(c);break;case"isemptyformatted":if("true"==z.item(c)){p=true}break;case"mask":F=z.item(c);break;case"maxbyte":nMaxbyte=parseInt(z.item(c));break;case"maxlength":nMaxlength=parseInt(z.item(c));break;case"navindex":H=parseInt(z.item(c));break;case"pastemode":strPastemode=z.item(c);break;case"ref":N=z.item(c);break;case"jsonref":a=z.item(c);break;case"required":if("true"==z.item(c)){A=true}break;case"roundmode":strRoundMode=z.item(c);break;case"roundposition":nRoundPosition=parseInt(z.item(c));break;case"showmask":if("true"==z.item(c)){bShowmask=true}break;case"showtoday":if("true"==z.item(c)){C=true}case"validateformat":if("true"==z.item(c)){E=true}break;case"visibility":B=z.item(c);break;default:if(!SBGrid.DEF.SB_STYLELIST[c]){d+=c+":"+z.item(c)+"; "}break}}var v=new SBGrid.CT.Input(u,x,s,o,n,y,R,l,M,q,e,b,D,t,h,f,g,K,I,p,F,m,r,H,"",w,N,a,A,L,J,"none","",Q,C,G,"softbowl:input",E,B,d);return v};SBGrid.CT.Input.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.Input.prototype.applyDefaultStyle=function(){};SBGrid.CT.InputButton=function(b,g,c,f,e,d,a){if(!f){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",g,c,false,"","","",f,"","","",-1,false,e,d,a)};SBGrid.CT.InputButton.prototype=new SBGrid.CT.Button;SBGrid.CT.InputButton.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"inputbutton");var e=SBGrid.CT.InputButton.createMainNode(a,c);if(null!=e){var b=document.getElementById("SBHE_"+a);b.parentNode.appendChild(e);b.style.paddingRight="18px";return SBGrid.CT.InputButton.createObject(a,e,c,d)}return null};SBGrid.CT.InputButton.createMainNode=function(b,i){var a=document.SBHE_allElement.item(b);if(null!=a){var e=Number(a.attribute.left.split("px")[0]);var m=Number(a.attribute.top.split("px")[0]);var d=a.m_heControl.offsetWidth;var c=a.m_heControl.offsetHeight;var f=document.createElement("button");SBGrid.CT.InputButton.createAttribute(f,i);var l="";if(i.exists("input_inputbutton")){l=i.item("input_inputbutton")}jQuery(f).addClass("sbgrid_inputbutton "+l);var h=SBGrid.UT.HtmlLib.getStyle(a.m_heControl,"border-width");var g=(""==h)?0:parseInt(h.replaceAll("px",""));e=e+d-18-g;d=d-g;c=c-(g*2);SBGrid.UT.HtmlLib.setStyle(f,"left",e+"px");SBGrid.UT.HtmlLib.setStyle(f,"top",(m+g)+"px");SBGrid.UT.HtmlLib.setStyle(f,"width",18+"px");SBGrid.UT.HtmlLib.setStyle(f,"height",c+"px");return f}return null};SBGrid.CT.InputButton.createObject=function(b,g,l,a){var c="";var e=false;var n="";var m="visible";var h="";for(var f=0;f<l.count();f++){var o=l.keys()[f];switch(o){case"class":c=l.item(o);break;case"disabled":if("true"==l.item(o)){e=true}break;case"id":n=l.item(o);break;case"visibility":m=l.item(o);break;default:if(!SBGrid.DEF.SB_STYLELIST[o]){h+=o+":"+l.item(o)+"; "}break}}var d=new SBGrid.CT.InputButton(b,c,e,n,a,"softbowl:inputbutton",m,h);return d};SBGrid.CT.InputButton.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.InputSpin=function(b,g,c,f,e,d,a){if(!f){return}SBGrid.CT.Group.call(this,b,"","","","","",g,c,f,-1,"","","",false,"","","",e,"softbowl:spinupbutton",a)};SBGrid.CT.InputSpin.prototype=new SBGrid.CT.Group;SBGrid.CT.InputSpin.prototype.getBindingType=function(){return SBGrid.DEF.SB_NONE};SBGrid.CT.InputSpin.create=function(a,c,d){c=SBGrid.CT.Element.createClassName(c,"inputspin");var e=SBGrid.CT.InputSpin.createMainNode(a,c);if(null!=e){var b=document.getElementById("SBHE_"+a);b.parentNode.appendChild(e);b.style.paddingRight="18px";return SBGrid.CT.InputSpin.createObject(a,e,c,d)}return null};SBGrid.CT.InputSpin.createMainNode=function(b,e){var d=document.SBHE_allElement.item(b);if(null!=d){var f=Number(d.attribute.left.split("px")[0]);var g=Number(d.attribute.top.split("px")[0]);var h=Number(d.attribute.width.split("px")[0]);var c=Number(d.attribute.height.split("px")[0]);var a=document.createElement("div");SBGrid.CT.InputSpin.createAttribute(heInputSpin,e);heInputSpin.style.position="absolute";heInputSpin.style.left=(f+h-18)+"px";heInputSpin.style.top=g+"px";heInputSpin.style.width="18px";heInputSpin.style.height=c+"px";heInputSpin.style.borderWidth="1px";heInputSpin.style.backgroundRepeat="no-repeat";heInputSpin.style.backgroundPosition="center center";if(SBGrid.DEF.is_ie){heInputSpin.style.width="17px";heInputSpin.style.height=(c-1)+"px";heInputSpin.style.top=(g+1)+"px"}return heInputSpin}return null};SBGrid.CT.InputSpin.createObject=function(b,c,l,a){var d="";var f=false;var n="";var m="visible";var h="";for(var g=0;g<l.count();g++){var o=l.keys()[g];switch(o){case"class":d=l.item(o);break;case"disabled":if("true"==l.item(o)){f=true}break;case"id":n=l.item(o);break;case"visibility":m=l.item(o);break;default:if(!SBGrid.DEF.SB_STYLELIST[o]){h+=o+":"+l.item(o)+"; "}break}}var e=new SBGrid.CT.InputSpin(b,d,f,n,a,"softbowl:inputbutton",m,h);return e};SBGrid.CT.InputSpin.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.SpinUpButton=function(b,f,c,e,d,a){if(!e){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",f,c,false,"","","",e,"","","",-1,false,d,a)};SBGrid.CT.SpinUpButton.prototype=new SBGrid.CT.Button;SBGrid.CT.SpinDownButton=function(b,f,c,e,d,a){if(!e){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",f,c,false,"","","",e,"","","",-1,false,d,a)};SBGrid.CT.SpinDownButton.prototype=new SBGrid.CT.Button;SBGrid.CT.Secret=function(t,v,r,o,i,F,Q,g,L,p,d,b,I,s,e,l,O,B,n,D,q,N,G,h,A,M,a,w,K,J,z,H,f,u,y,m,E,P,C,x,c){if(!e){return}SBGrid.CT.Input.call(this,t,v,r,o,i,F,Q,g,L,p,d,b,I,s,false,e,l,O,B,n,D,q,N,G,h,A,M,a,w,K,J,z,H,f,false,E,P,C,x,c);this.attribute.secretendposition=String(u);this.attribute.secretmark=y;this.attribute.secretstartposition=String(m)};SBGrid.CT.Secret.prototype=new SBGrid.CT.Input;SBGrid.CT.Secret.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"secret");var a=SBGrid.CT.Secret.createMainNode(d);var c=document.getElementById("SBHE_"+b);c.appendChild(a);a=SBGrid.CT.Secret.createSubNodes(a,d);return SBGrid.CT.Secret.createObject(b,a,d,e)};SBGrid.CT.Secret.createMainNode=function(b){var a=SBGrid.CT.Input.createMainNode(b);jQuery(a).removeClass("sbgrid_input");jQuery(a).addClass("sbgrid_secret");a.type="password";return a};SBGrid.CT.Secret.createSubNodes=function(a,b){return a};SBGrid.CT.Secret.createObject=function(e,E,C,G){var o="";var f="";var D="";var v="";var q="";var t="";var A=false;var z=false;var h=false;var x=true;var y=true;var a="";var F="";var n=-1;var B=9007199254740992;var l="";var c="";var r=-1;var m="";var s=-1;var d="";var w="visible";var p="";for(var u=0;u<C.count();u++){var g=C.keys()[u];switch(g){case"alert":o=C.item(g);break;case"help":f=C.item(g);break;case"hint":D=C.item(g);break;case"accesskey":v=C.item(g);break;case"bind":q=C.item(g);break;case"class":t=C.item(g);break;case"disabled":if("true"==C.item(g)){A=true}break;case"dragmode":if("true"==C.item(g)){z=true}break;case"dropmode":if("true"==C.item(g)){h=true}break;case"editable":if("false"==C.item(g)){x=false}break;case"editmenu":if("false"==C.item(g)){y=false}break;case"id":a=C.item(g);break;case"imemode":F=C.item(g);break;case"maxlength":n=parseInt(C.item(g));break;case"navindex":B=parseInt(C.item(g));break;case"ref":l=C.item(g);break;case"jsonref":c=C.item(g);break;case"secretendposition":r=parseInt(C.item(g));break;case"secretmark":m=C.item(g);break;case"secretstartposition":s=parseInt(C.item(g));break;case"visibility":w=C.item(g);break;default:if(!SBGrid.DEF.SB_STYLELIST[g]){p+=g+":"+C.item(g)+"; "}break}}var b=new SBGrid.CT.Secret(e,o,f,D,v,false,q,t,A,z,h,x,y,"",a,F,"secret","",false,"",-1,n,B,"","",l,c,false,d,0,"none","",false,"","","",G,"softbowl:secret",false,w,p);return b};SBGrid.CT.Secret.createAttribute=function(b,a){b=SBGrid.CT.Input.createAttribute(b,a);return b};SBGrid.CT.Output=function(e,h,f,u,t,p,v,l,n,r,m,d,a,s,g,b,c,o,x,w,q,i){if(!a){return}SBGrid.CT.Caption.call(this,e,h,f,u,t,p,v,l,n,r,m,d,a,s,g,b,c,o,x,w,q,i)};SBGrid.CT.Output.prototype=new SBGrid.CT.Caption;SBGrid.CT.Output.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"output");var a=SBGrid.CT.Output.createMainNode(d);var c=document.getElementById("SBHE_"+b);c.appendChild(a);a=SBGrid.CT.Output.createSubNodes(a,d);return SBGrid.CT.Output.createObject(b,a,d,e)};SBGrid.CT.Output.createMainNode=function(c){var a=document.createElement("span");a=SBGrid.CT.Output.createAttribute(a,c);var b=c.item("autoresize");jQuery(a).addClass("sbgrid_caption_div sbgrid_boxsizing");return a};SBGrid.CT.Output.createSubNodes=function(b,d){var f=d.item("id");var h=document.createElement("table");h.cellspacing="0";h.cellpadding="0";h.onclick=function(){};h.ondbclick=function(){};h.onmousedown=function(){};h.onmousemove=function(){};h.onmouseup=function(){};var e=document.createElement("tbody");var g=document.createElement("tr");var a=document.createElement("td");jQuery(e).addClass("sbgrid_caption_tbody");var c=d.item("autoresize");if(null!=c){if("true"==c){jQuery(h).addClass("sbgrid_caption_table")}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}}else{jQuery(h).addClass("sbgrid_caption_table sbgrid_table_fixed")}jQuery(a).addClass("sbgrid_caption_td");a.setAttribute("id","SBHE_"+f+"_TEXT");if(b.getAttribute("text")){jQuery(a).text(b.getAttribute("text").newlineCharConvert())}g.appendChild(a);e.appendChild(g);h.appendChild(e);b.appendChild(h);return b};SBGrid.CT.Output.createObject=function(e,h,z,C){var n="";var f="";var B="";var A="";var v="";var q=false;var p="";var s="";var x=false;var r=false;var d="";var a="";var y=9007199254740992;var l="";var b="";var c="";var u=0;var w="visible";var o="";for(var t=0;t<z.count();t++){var g=z.keys()[t];switch(g){case"alert":n=z.item(g);break;case"help":f=z.item(g);break;case"hint":B=z.item(g);break;case"accesskey":v=z.item(g);break;case"autoreisze":if("true"==z.item(g)){q=true}break;case"bind":p=z.item(g);break;case"class":s=z.item(g);break;case"ellipsis":if("true"==z.item(g)){r=true}break;case"format":d=z.item(g);break;case"id":a=z.item(g);break;case"navindex":y=parseInt(z.item(g));break;case"ref":l=z.item(g);break;case"jsonref":l=z.item(g);break;case"roundmode":strRoundMode=z.item(g);break;case"roundposition":nRoundPosition=parseInt(z.item(g));break;case"visibility":w=z.item(g);break;default:if(!SBGrid.DEF.SB_STYLELIST[g]){o+=g+":"+z.item(g)+"; "}break}}var m=new SBGrid.CT.Output(e,n,f,B,A,v,q,p,s,x,r,d,a,y,l,b,c,u,C,"softbowl:output",w,o);return m};SBGrid.CT.Output.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);b.cellSpacing=0;b.cellPadding=0;return b};SBGrid.CT.Select=function(r,v,q,o,n,L,p,h,i,H,G,s,m,f,B,M,C,l,I,a,D,y,x,E,A,K,J,w,g,c,b,t,F,u,z,d,e){if(!f){return}SBGrid.CT.Group.call(this,r,v,q,o,n,L,h,G,f,C,l,"",I,a,y,E,A,K,w,d);this.attribute.appearance=z;this.attribute.cellspacing=p;this.attribute.cols=i;this.attribute.direction=H;this.attribute.dragmode=String(s);this.attribute.dropmode=String(m);this.attribute.itemheight=B;this.attribute.itemwidth=M;this.attribute.rows=D;this.attribute.sep=x;this.attribute.vcellspacing=J;this.label;this.value;this.children;this.selected=false;this.mouseCol=0;this.mouseRow=0;this.focusIndex=-1;this.isnodeset=c;this.nodeset=b;this.jsonnodeset=t;this.labelref=F;this.valueref=u;this.checkImage="";this.unCheckImage="";this.disCheckImage="";this.disUnCheckImage="";this.itemLength=g>0?g:0;this.length=this.itemLength;this.choices;this.itemset;this.m_strUserStaticValue=e;this.htStaticValue;this.m_objItem;this.m_nCols;this.m_nRows;this.arItemList;this.m_arItemList;this.m_heItemList;this.m_arCloneNode;this.m_arCloneJson;this.m_nAppearance="full"==z?1:3;this.m_bIsReBuild=false};SBGrid.CT.Select.prototype=new SBGrid.CT.Group;SBGrid.CT.Select.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);this.m_heControl.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', this.id.replace('SBHE_', ''))");this.checkImage=null!=this.attribute["select.background-image"]?this.attribute["select.background-image"]:this.checkImage;this.unCheckImage=null!=this.attribute["background-image"]?this.attribute["background-image"]:this.unCheckImage;this.disCheckImage=null!=this.attribute["disable.select.background-image"]?this.attribute["disable.select.background-image"]:this.disCheckImage;this.disUnCheckImage=null!=this.attribute["disable.background-image"]?this.attribute["disable.background-image"]:this.disUnCheckImage;var t=null;var m=null;this.itemCheckImage=null!=this.attribute["item.select.background-image"]?this.attribute["item.select.background-image"]:"";this.itemUnCheckImage=null!=this.attribute["item.disable.select.background-image"]?this.attribute["item.disable.select.background-image"]:"";this.itemDisCheckImage=null!=this.attribute["item.disable.select.background-image"]?this.attribute["item.disable.select.background-image"]:"";this.itemDisUnSelectImage=null!=this.attribute["item.disable.background-image"]?this.attribute["item.disable.background-image"]:"";var d=null;var c=null;var h="";var b=this.getAttribute("appearance");if("full"==b){t=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"";m=null!=this.attribute["select.color"]?this.attribute["select.color"]:"";d=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"";c=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"";h="id:"+this.id+".item; background-image:"+this.unCheckImage+"; select.background-image:"+this.checkImage+"; disable.background-image:"+this.disUnCheckImage+"; disable.select.background-image:"+this.disCheckImage+"; ";h+=" select.background-color:"+t+"; select.color:"+m+"; ";h+="item.select.background-image:"+this.itemCheckImage+"; item.disable.select.background-image:"+this.itemDisCheckImage+"; item.select.background-color:"+d+"; item.select.color:"+c+"; "}else{if("minimal"==b){h="id:"+this.id+".item; select.background-image:#select-menu; "}else{t=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"darkblue";m=null!=this.attribute["select.color"]?this.attribute["select.color"]:"#FFFFFF";d=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"darkblue";c=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"#FFFFFF";h="id:"+this.id+".item; select.background-color:"+t+"; select.color:"+m+"; ";h+="item.select.background-color:"+d+"; item.select.color:"+c+"; "}}t=null;m=null;this.m_objItem=this.createChild("softbowl:selectitem",h);this.choices=new SBGrid.DS.Choices(this.id,this.id+".choices","softbowl:choices");if(this.isnodeset){var s=new SBGrid.DS.Itemset(this.id+".choices",this.id+".itemset","softbowl:itemset");s.setAttribute("nodeset",this.nodeset);var f=new SBGrid.DS.Label(this.id+".itemset",this.id+".label","softbowl:label");f.setAttribute("ref",this.labelref);var g=new SBGrid.DS.Value(this.id+".itemset",this.id+".value","softbowl:value");g.setAttribute("ref",this.valueref);s.setLabel(f);s.setValue(g);this.choices.setItemset(s);this.initItemset()}else{if(null!=this.m_strUserStaticValue&&""!=this.m_strUserStaticValue){this.htStaticValue=new SBGrid.DS.Hashtable();var l=this.m_strUserStaticValue.split("|");for(var e=0;e<l.length;e++){if(-1!=l[e].indexOf("^")){var o=l[e].split("^");var n=o[0];o.shift();this.htStaticValue[n]=o}}}}var q=this.getAttribute("cellspacing");this.makeCell();this.setAttribute("cellspacing",q);var p=this.children.keys();for(var e=0;e<p.length;e++){var a=p[e];var r=this.children.item(a);if(null!=r){if(!this.isnodeset&&"softbowl:cell"==r.attribute.tag){SBGrid.CF.Init(r);r.label=this.htStaticValue[r.id][0];r.value=this.htStaticValue[r.id][1];r.m_heControl.setAttribute("name",this.id+"_item");r.m_heControl.setAttribute("label",this.htStaticValue[r.id][0]);r.m_heControl.setAttribute("value",this.htStaticValue[r.id][1]);r.m_heControl.noWrap=true}else{if("softbowl:cell"==r.attribute.tag){SBGrid.CF.Init(r)}else{r.init()}}}}this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true};SBGrid.CT.Select.prototype.reBuild=function(){if(this.isnodeset){this.m_bIsReBuild=true;if(this.m_heItemList){this.m_heItemList.parentNode.removeChild(this.m_heItemList)}for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){SBGrid.CF.UnInit(b)}}}this.initItemset();this.makeCell();for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){SBGrid.CF.Init(b)}}}this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true}else{this.m_bIsReBuild=true;if(this.m_heItemList){this.m_heItemList.parentNode.removeChild(this.m_heItemList)}var d=0;for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){var e=b.id;this.children.remove(e);document.SBHE_allElement.remove(e,b);d++}}}this.initItemset();this.makeCell();for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b){SBGrid.CF.Init(b)}}}this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true}};SBGrid.CT.Select.prototype.refresh=function(){if(null!=this.m_heControl){var a=this.getValue();if(null!=a){if(this.isnodeset){if(this.equlsChangeNode()){this.reBuild()}this.applySelectCell()}else{if(!this.isnodeset&&("softbowl:select"==this.attribute.tag||"full"==this.attribute.appearance)){this.reBuild();this.applySelectCell()}}this.applySelection(a)}}SBGrid.CT.Group.prototype.refresh.call(this)};SBGrid.CT.Select.prototype.applySelectCell=function(){var c=0;for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var a=this.getCell(d,b);if(null==a){continue}var f=null;if("downacross"==this.attribute.direction&this.isnodeset){f=this.arItemList[((this.m_nRows*b)+d)]}else{f=this.arItemList[c]}if(null==f){this.m_nCols=this.m_nCols-1;break}var e=f.label;var g=f.value;var h="";var l="";if((this.jsonnodeset!=""&&this.jsonnodeset!=null)||!this.isnodeset){h=e;l=g}else{h=SBGrid.UT.XmlLib.getTextValue(e);l=SBGrid.UT.XmlLib.getTextValue(g)}if(null!=a.m_heControl){if(h!=SBGrid.CF.GetLabel(a)||l!=SBGrid.CF.GetValue(a)){SBGrid.CF.SetLabel(a,h);SBGrid.CF.SetValue(a,l);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=l+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+h}else{this.m_ShowValueStrLabel=h}SBGrid.CF.SetLabelChange(a,this.m_ShowValueStrLabel)}}a.label=h;a.value=l;c++}}};SBGrid.CT.Select.prototype.equlsChangeNode=function(){if(this.jsonnodeset!=""&&this.jsonnodeset!=null){var strNodeSet=this.jsonnodeset;var oItemSetList=eval(strNodeSet);if(null==this.m_arCloneJson){this.m_arCloneJson=new Array();if(null!=oItemSetList){this.resetCloneJson(oItemSetList);return true}}if(null!=oItemSetList){if(oItemSetList.length!=this.m_arCloneJson.length){this.resetCloneJson(oItemSetList);return true}for(var i=0;i<oItemSetList.length;i++){if(oItemSetList[i]!=this.m_arCloneJson[i]){this.resetCloneJson(oItemSetList);return true}}}return false}else{var strNodeSet=this.nodeset;if((strNodeSet.length-1)==strNodeSet.lastIndexOf("/")){strNodeSet=strNodeSet.substring(0,strNodeSet.length-1)}var xnItemSetList=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet);if(null==this.m_arCloneNode){this.m_arCloneNode=new Array();if(null!=xnItemSetList){this.resetCloneNode(xnItemSetList);return true}}if(null!=xnItemSetList){if(xnItemSetList.length!=this.m_arCloneNode.length){this.resetCloneNode(xnItemSetList);return true}else{if(1==xnItemSetList.length&&1==this.m_arCloneNode.length){if(null!=this.m_arCloneNode.m_nCloneLength){if(xnItemSetList.item(0).childNodes.length!=this.m_arCloneNode.m_nCloneLength){this.resetCloneNode(xnItemSetList);return true}}}}for(var i=0;i<xnItemSetList.length;i++){if(xnItemSetList.item(i)!=this.m_arCloneNode[i]){this.resetCloneNode(xnItemSetList);return true}}}return false}};SBGrid.CT.Select.prototype.resetCloneNode=function(a){this.m_arCloneNode=new Array();for(var b=0;b<a.length;b++){this.m_arCloneNode.push(a.item(b))}if(1==a.length){this.m_arCloneNode.m_nCloneLength=a.item(0).childNodes.length}};SBGrid.CT.Select.prototype.resetCloneJson=function(a){this.m_arCloneJson=new Array();for(var b=0;b<a.length;b++){this.m_arCloneJson.push(a[b])}};SBGrid.CT.Select.prototype.listBoxReSize=function(){var a=this.getAttribute("appearance");if("compact"==a){if(this.m_heControl.clientWidth>this.m_heItemList.clientWidth){this.m_heItemList.style.width="100%"}else{this.m_heItemList.style.width=""}}};SBGrid.CT.Select.prototype.item=function(b){var a=-1;var c=-1;a=parseInt(b/this.m_nCols);c=parseInt(b%this.m_nCols);return this.getCell(a,c)};SBGrid.CT.Select.prototype.setAttribute=function(a,b){SBGrid.CT.Group.prototype.setAttribute.call(this,a,b);switch(a){case"cellspacing":this.attribute.cellspacing=b;break;case"col":this.attribute.col=b;this.m_nSelectedCol=parseInt(this.attribute.col);this.mouseCol=this.m_nSelectedCol;break;case"cols":this.attribute.cols=b;this.m_nCols=parseInt(this.attribute.cols);this.reBuild();break;case"direction":this.attribute.direction=b;break;case"dragmode":this.attribute.dragmode=b;break;case"dropmode":this.attribute.dropmode=b;break;case"itemheight":this.attribute.itemheight=b;if(""!=b){this.setItemheight(b)}break;case"height":if("full"==this.attribute.appearance&&"visible"==this.attribute.overflow){if(this.m_nOverflowHeight>parseInt(b.replace("px",""))){this.m_heControl.style.height=this.m_nOverflowHeight+"px";this.attribute.height=this.m_nOverflowHeight+"px";this.m_nOverflowHeight=this.m_nOverflowHeight}}break;case"itemwidth":this.attribute.itemwidth=b;if(""!=b){this.setItemwidth(b)}break;case"overflow":this.attribute.overflow=b;this.setOverflow(b);break;case"row":this.attribute.row=b;this.m_nSelectedRow=parseInt(this.attribute.row);this.mouseRow=this.m_nSelectedRow;break;case"rows":this.attribute.rows=b;break;case"scroll":this.attribute.scroll=b;this.setScroll(b);break;case"sep":this.attribute.sep=b;break;case"vcellspacing":this.attribute.vcellspacing=b;if(""!=b){this.setVcellspacing(b)}break}};SBGrid.CT.Select.prototype.setCheckImage=function(d){this.checkImage=d;this.m_objItem.setAttribute("select.background-image",d);this.m_objItem.m_jsonCssEvent.select="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setUnCheckImage=function(d){this.unCheckImage=d;this.m_objItem.setAttribute("background-image",d);this.m_objItem.m_jsonCssEvent.deselect="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setDisCheckImage=function(d){this.disCheckImage=d;this.m_objItem.setAttribute("disable.select.background-image",d);this.m_objItem.m_jsonCssEvent.disable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setDisUnCheckImage=function(d){this.disUnCheckImage=d;this.m_objItem.setAttribute("disable.background-image",d);this.m_objItem.m_jsonCssEvent.dedisable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select.prototype.setCellspacing=function(f){var a=parseInt(f.split("px")[0])/2;for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var c=this.getCell(d,b);if(null!=c){var e=c.m_heControl;if(null!=e){e.style.paddingLeft=a+"px";e.style.paddingRight=a+"px"}}}}};SBGrid.CT.Select.prototype.setVcellspacing=function(a){var f=parseInt(a.split("px")[0])/2;for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var c=this.getCell(d,b);if(null!=c){var e=c.m_heControl;if(null!=e){e.style.paddingTop=f+"px";e.style.paddingBottom=f+"px"}}}}};SBGrid.CT.Select.prototype.setItemwidth=function(d){var l=document.getElementById("SBHE_"+this.id+"_allitem");if(null!=l){var d=String(d);d=-1!=d.indexOf("px")?d:d+"px";if(SBGrid.DEF.is_ie7){if("COLGROUP"==l.firstChild.tagName){var g=l.firstChild.children;for(var e=0;e<this.m_nCols;e++){g.item(e).style.width=d}}else{var h=document.createElement("colgroup");var m=document.createElement("col");m.style.width=d;for(var e=0;e<this.m_nCols;e++){h.appendChild(m.cloneNode(true))}h.appendChild(document.createElement("col"));l.insertBefore(h,l.firstChild);for(var e=0;e<this.m_nRows;e++){for(var c=0;c<this.m_nCols;c++){var b=this.getCell(e,c);if(null!=b){var a=b.m_heControl;if(null!=a){a.style.paddingRight=""}}}}}}else{if("fixed"==l.style.tableLayout){var f=l.querySelectorAll("col[style]");for(var e=0;e<f.length;e++){f.item(e).style.width=d}}else{l.style.tableLayout="fixed";var h=document.createElement("colgroup");var m=document.createElement("col");m.style.width=d;for(var e=0;e<this.m_nCols;e++){h.appendChild(m.cloneNode(true))}h.appendChild(document.createElement("col"));l.insertBefore(h,l.firstChild);var f=l.querySelectorAll("td");for(var e=0;e<f.length;e++){f.item(e).style.paddingRight=""}}}}};SBGrid.CT.Select.prototype.setItemheight=function(a){for(var d=0;d<this.m_nRows;d++){for(var b=0;b<this.m_nCols;b++){var c=this.getCell(d,b);if(null!=c){var e=c.m_heControl;if(null!=e){e.style.height=a.split("px")[0]+"px"}}}}};SBGrid.CT.Select.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Select.prototype.makeCell=function(){var g=this.attribute.cols;var f=this.attribute.rows;this.m_nCols=(""==g)||("*"==g)?1:parseInt(g);this.m_nRows=""==f?1:parseInt(f);if("*"==g&&(1<=this.m_nRows)){this.m_nCols=Math.ceil(this.itemLength/this.m_nRows)}else{this.m_nRows=Math.ceil(this.itemLength/this.m_nCols)}var e=0;var d=null;var c=null;for(var b=0;b<this.m_nRows;b++){for(var a=0;a<this.m_nCols&&e<this.itemLength;a++){d=this.id+"_"+b+"_"+a;c=this.children.item(d);c=null==c?new SBGrid.CT.SelectCell(this,a,d,b,"softbowl:cell"):c;this.children.add(d,c);document.SBHE_allElement.add(d,c);c.setElement(this.m_objItem);c.setIndex(e);c.selected=false;e++}}e=null;d=null;c=null};SBGrid.CT.Select.prototype.initItemset=function(){this.arItemList=new Array();if(this.isnodeset){if(this.m_heControl){if(null!=this.m_heItemList&&null!=this.m_heControl.firstChild){this.m_heControl.removeChild(this.m_heItemList)}}this.m_heControl=document.getElementById("SBHE_"+this.id);var strNodeSet=this.nodeset;if((strNodeSet.length-1)==strNodeSet.lastIndexOf("/")){strNodeSet=strNodeSet.substring(0,strNodeSet.length-1)}var strLabelRef=this.labelref;if(0==strLabelRef.indexOf("/")){strLabelRef=strLabelRef.substring(1)}var arLabelRefPath=strLabelRef.split("/");if(1!=arLabelRefPath.length){for(var i=0;i<arLabelRefPath.length-1;i++){strNodeSet=strNodeSet+"/"+arLabelRefPath[i]}strLabelRef=arLabelRefPath[arLabelRefPath.length-1]}var strValueRef=this.valueref;if(0==strValueRef.indexOf("/")){strValueRef=strValueRef.substring(1)}var arValueRefPath=strValueRef.split("/");if(1!=arValueRefPath.length){strValueRef=arValueRefPath[arValueRefPath.length-1]}this.itemLength=0;if(this.jsonnodeset!=""&&this.jsonnodeset!=null){try{this.itemLength=eval(this.jsonnodeset).length;for(var i=0;i<this.itemLength;i++){var data={label:eval(this.jsonnodeset+"["+i+"]."+strLabelRef),value:eval(this.jsonnodeset+"["+i+"]."+strValueRef)};this.arItemList.push(data)}}catch(e){SBGrid.DEF.errorMsg("jsonref를 이용한 itemset 구성 오류")}}else{var xlItemSetLabel=null;var xlItemSetValue=null;var nLabelLength=-1;var nValueLength=-1;if(""!=strLabelRef){xlItemSetLabel=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strLabelRef);nLabelLength=xlItemSetLabel.length}if(""!=strValueRef){xlItemSetValue=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strValueRef);nValueLength=xlItemSetValue.length}var nItemSetLength=nLabelLength>=nValueLength?nValueLength:nLabelLength;for(var i=0;i<nItemSetLength;i++){var data={label:xlItemSetLabel.item(i),value:xlItemSetValue.item(i)};this.arItemList.push(data)}this.itemLength=nItemSetLength}var strCols=this.attribute.cols;var strRows=this.attribute.rows;this.m_nCols=(""==strCols)||("*"==strCols)?1:parseInt(strCols);this.m_nRows=""==strRows?1:parseInt(strRows);if("*"==strCols&&(1<this.m_nRows)){this.m_nCols=Math.ceil(this.itemLength/this.m_nRows)}else{this.m_nRows=Math.ceil(this.itemLength/this.m_nCols)}}else{var strCols=this.attribute.cols;var strRows=this.attribute.rows;this.m_nCols=""==strCols?1:0==this.m_nCols?1:parseInt(strCols);this.m_nRows=""==strRows?1:"*"==strRows?1:0==this.m_nRows?1:parseInt(strRows);if("*"==strCols&&1<=this.m_nRows){this.m_nCols=Math.ceil(this.itemLength/this.m_nRows)}else{this.m_nRows=Math.ceil(this.itemLength/this.m_nCols)}}this.htStaticValue=new SBGrid.DS.Hashtable();if(null!=this.m_strUserStaticValue&&""!=this.m_strUserStaticValue){var arCellList=this.m_strUserStaticValue.split("|");var cellListIndex=0;for(var i=0;i<this.m_nRows;i++){for(var j=0;j<this.m_nCols;j++){var strCellName=this.id+"_"+i+"_"+j;if(-1!=arCellList[cellListIndex].indexOf("^")){var arCellLabelAndValue=arCellList[cellListIndex].split("^");arCellLabelAndValue.shift();this.htStaticValue[strCellName]=arCellLabelAndValue;var data={label:this.htStaticValue[strCellName][0],value:this.htStaticValue[strCellName][1]};this.arItemList.push(data);cellListIndex++}}}}this.m_arItemList=new Array();this.m_arItemList.push("<table id='SBHE_"+this.id+"_allitem' cellPadding=0 cellSpacing=0 width='100%' ");var nTotalHeight="";var strItemHeight=this.getAttribute("itemheight");var strItemWidth=this.getAttribute("itemwidth");var strVcellSpacing=this.getAttribute("vcellspacing");var strCellSpacing=this.getAttribute("cellspacing");strItemHeight=(null!=strItemHeight)?strItemHeight.split("px")[0]:"";strItemWidth=(null!=strItemWidth)?strItemWidth.split("px")[0]:"";strVcellSpacing=(null!=strVcellSpacing)?strVcellSpacing.split("px")[0]:"";strCellSpacing=(null!=strCellSpacing)?strCellSpacing.split("px")[0]:"";if(""!=strItemWidth){if(!SBGrid.DEF.is_ie7){this.m_arItemList.push(" style='table-layout:fixed;'>")}else{this.m_arItemList.push(">")}this.m_arItemList.push("<colgroup>");for(var j=0;j<this.m_nCols;j++){this.m_arItemList.push("<col style='width:"+strItemWidth+"px'/>")}this.m_arItemList.push("<col/>");this.m_arItemList.push("</colgroup><tbody>")}else{this.m_arItemList.push("><tbody>")}var strPaddingTop="";var nPaddingTop=0;var strPaddingBottom="";var strPaddingRight="4px";if(""!=strItemHeight){if(18>parseInt(strItemHeight)){strItemHeight="18px"}else{strItemHeight=strItemHeight+"px"}}else{if(""==strVcellSpacing||"0"==strVcellSpacing){strItemHeight="18px"}else{strPaddingTop="padding-top:"+String(parseInt(strVcellSpacing)/2+1)+"px; ";nPaddingTop=parseInt(strVcellSpacing)/2+1;strPaddingBottom="padding-bottom:"+String(parseInt(strVcellSpacing)/2+1)+"px; "}}nTotalHeight=parseInt(strItemHeight.split("px")[0])+nPaddingTop;if(""!=strItemWidth){strItemWidth=strItemWidth+"px"}else{if(""!=strCellSpacing&&null!=strCellSpacing){var nCellSpacing=parseInt(strPaddingRight.replace("px",""))+parseInt(strCellSpacing);strPaddingRight=String(nCellSpacing)+"px"}}var strCSSName="class='sbgrid_selectitem"+this.m_nAppearance+" ";if(this.m_clCSSName.exists(SBGrid.DEF.SB_APPEARANCE[this.m_nAppearance]+"_selectitem")){strCSSName+=this.m_clCSSName.item(SBGrid.DEF.SB_APPEARANCE[this.m_nAppearance]+"_selectitem ")}if(this.m_clCSSName.exists(this.m_strLocalTag+"_selectitem")){strCSSName+=this.m_clCSSName.item(this.m_strLocalTag+"_selectitem")}var bIsTooltip="true"==this.attribute.selectitemtooltip;var nItemIndex=0;for(var i=0;i<this.m_nRows;i++){this.m_arItemList.push("<tr>");for(var j=0;j<this.m_nCols&&nItemIndex<this.arItemList.length;j++){var xnItem=null;if("downacross"==this.attribute.direction&&this.isnodeset){xnItem=this.arItemList[((this.m_nRows*j)+i)]}else{xnItem=this.arItemList[nItemIndex]}var xnLabel=xnItem.label;var xnValue=xnItem.value;var strLabel="";var strValue="";if((this.jsonnodeset!=""&&this.jsonnodeset!=null)||!this.isnodeset){strLabel=xnItem.label;strValue=xnItem.value}else{strLabel=SBGrid.UT.XmlLib.getTextValue(xnLabel);strValue=SBGrid.UT.XmlLib.getTextValue(xnValue)}var strTDId=this.id+"_"+i+"_"+j;var heTableTd;if(SBGrid.DEF.is_smartphone){this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strCSSName+" "+strTDId+'_Attr\' onmousedown=" " onmousemove=" " onmouseup=" " ondblclick=" " onkeydown=" " onkeypress=" " onkeyup=" " name=\''+this.id+"_item' noWrap=true value='"+strValue+"' style='width:"+strItemWidth+";height:"+strItemHeight+";"+strPaddingTop+strPaddingBottom)}else{var strTooltip="";if(bIsTooltip){strTooltip=" title='"+strLabel+"' "}this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strCSSName+" "+strTDId+"_Attr' "+strTooltip+'onmousedown=" " onmousemove=" " onmouseup=" " ondblclick=" " onkeydown=" " onkeypress=" " onkeyup=" " name=\''+this.id+"_item' noWrap=true value='"+strValue+"' label='"+strLabel+"' style='height:"+strItemHeight+";"+strPaddingTop+strPaddingBottom)}var bIsAddTd=false;if(j<this.m_nCols){this.m_arItemList.push("padding-right:"+strPaddingRight+";'>")}if(j!=0&&j==this.m_nCols-1){bIsAddTd=true}nItemIndex++;this.m_arItemList.push(""+strLabel+"</td>");if(bIsAddTd){this.m_arItemList.push("<td style='width:100%;'></td>")}}this.m_arItemList.push("</tr>")}this.m_arItemList.push("</tbody></table>");this.m_heControl.innerHTML=this.m_arItemList.join("");this.length=this.itemLength;nTotalHeight=nTotalHeight*this.m_nRows;if("visible"==this.getAttribute("overflow")){if(""==this.getAttribute("height")||(""!=this.getAttribute("height")&&nTotalHeight>(parseInt(this.getAttribute("height").replace("px",""))))){this.m_heControl.style.height=nTotalHeight+"px";this.attribute.height=nTotalHeight+"px";this.m_nOverflowHeight=nTotalHeight}}};SBGrid.CT.Select.prototype.defaultAction=function(b,a){SBGrid.CT.Group.prototype.defaultAction.call(this,b,a);if("onselect"==b){this.onSelect(a)}else{if("ondeselect"==b){this.onDeselect(a)}}};SBGrid.CT.Select.prototype.select=function(f){var h=this.getRefNode();if(null==h){return}if(this.isnodeset){var b=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);if(0==b.length||f>=b.length){return}}this.m_nSelectedRow=parseInt(f/this.m_nCols);this.m_nSelectedCol=parseInt(f%this.m_nCols);var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d){return}var a=false;var c=h.item(0);if(null!=c){var l=SBGrid.UT.XmlLib.getTextValue(c);var p=SBGrid.CF.GetValue(d);var n="";var g=this.getAttribute("sep");if(!g.isEmpty()){var o=l.split(g);for(var e=0;e<o.length;e++){if(!o[e].isEmpty()){n+=o[e]+g;if(o[e]==p){return}}}}n+=p;SBGrid.UT.XmlLib.setTextValue(c,n);if(l!=n){a=true}}var m="";m=this.attribute.jsonref;if(m==""||m==null){m=this.attribute.ref}this.refreshCurrentModel(m);this.dispatch("onselect");if(a){this.dispatch("onvaluechanged")}};SBGrid.CT.Select.prototype.deselect=function(f){var c=false;if(null==f){f=0;c=true}var h=this.getRefNode();if(null==h){return}this.m_nSelectedRow=parseInt(f/this.m_nCols);this.m_nSelectedCol=parseInt(f%this.m_nCols);var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d){return}var a=false;var b=h.item(0);if(null!=b){var m="";if(!c){var l=SBGrid.UT.XmlLib.getTextValue(b);var o=SBGrid.CF.GetValue(d);var g=this.getAttribute("sep");if(!g.isEmpty()){var n=l.split(g);for(var e=0;e<n.length;e++){if(!n[e].isEmpty()){if(n[e]!=o){m+=n[e]+g}}}}else{if(l!=o){m=l}}if(l!=m){a=true}}else{a=true}SBGrid.UT.XmlLib.setTextValue(b,m)}this.refreshCurrentModel(this.attribute.ref);this.dispatch("ondeselect");if(a){this.dispatch("onvaluechanged")}};SBGrid.CT.Select.prototype.clearSelect=function(){for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl&&b.m_bSelect){SBGrid.CF.SetSelect(b,false)}}}};SBGrid.CT.Select.prototype.applySelection=function(o){if(!this.m_bIsReBuild){this.clearSelect()}this.label="";this.value=o;if(null!=o){o=o.trim();var h=this.getAttribute("sep");var a;if(null==h||h.isEmpty()){a=[o]}else{a=o.split(h)}for(var e=0;e<a.length;e++){var l=a[e];if(""==l){continue}for(var g=0;g<this.m_nRows;g++){for(var f=0;f<this.m_nCols;f++){var d=this.getCell(g,f);if(null==d||null==d.m_heControl){continue}var o=SBGrid.CF.GetValue(d);if(o==l){SBGrid.CF.SetSelect(d,true);d.m_bSelectChange=true;if(""==this.label){this.label+=SBGrid.CF.GetLabel(d)}else{this.label+=(h+SBGrid.CF.GetLabel(d))}}}}}for(var c=0;c<this.m_nRows;c++){for(var b=0;b<this.m_nCols;b++){var d=this.getCell(c,b);if(null==d||null==d.m_heControl){continue}if(!d.m_bSelectChange){SBGrid.CF.SetSelect(d,false)}d.m_bSelectChange=false}}}this.m_bIsReBuild=false};SBGrid.CT.Select.prototype.setNodeset=function(a){if(this.isnodeset){this.nodeset=a}};SBGrid.CT.Select.prototype.onSelect=function(b){var g=this.getRefNode();if(null==g){return}var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d||null==b){this.setSelect();return}var a=false;var m=this.attribute.jsonref;var c;if(typeof g!="string"){c=g.item(0)}if(null!=c||(m!=""&&m!=null)){var h=this.value;if(m!=""&&m!=null){h=SBGrid.DS.JsonStorage.getUniqueStorage().getValue(this.attribute.jsonref)}else{h=SBGrid.UT.XmlLib.getTextValue(c)}var o=SBGrid.CF.GetValue(d);var l="";var f=this.getAttribute("sep");if(!f.isEmpty()){var n=h.split(f);for(var e=0;e<n.length;e++){if(!n[e].isEmpty()){l+=n[e]+f;if(n[e]==o){return}}}}l+=o;if(m!=""&&m!=null){SBGrid.DS.JsonStorage.getUniqueStorage().setValue(this.attribute.jsonref,l)}else{SBGrid.UT.XmlLib.setTextValue(c,l)}if(h!=l){a=true}}m=this.attribute.jsonref;if(m==""||m==null){m=this.attribute.ref}this.refreshCurrentModel(m);this.dispatch("onselect");if(a){this.dispatch("onvaluechanged")}};SBGrid.CT.Select.prototype.setSelect=function(){this.attribute.appearance="true";this.selected=true;if(null!=this.m_htSelectStyle){for(var strKey in this.m_htSelectStyle){var strValue=this.m_htSelectStyle[strKey];if(-1!=strKey.indexOf("background-image")){if(-1==strValue.indexOf("url(")){strValue="url("+strValue+")"}}var strStyle="";if(-1!=strKey.indexOf("-")){var arStyle=strKey.split("-");strStyle+=arStyle[0].toLowerCase();for(var i=1;i<arStyle.length;i++){var strUpper=arStyle[i].charAt(0).toUpperCase();var strLower=arStyle[i].substring(1);strStyle+=strUpper.concat(strLower)}}else{strStyle=strKey.toLowerCase()}eval("this.m_heControl.style."+strStyle+" = '"+strValue+"'")}}};SBGrid.CT.Select.prototype.onDeselect=function(b){var a=false;var g=this.getRefNode();if(null==g){return}var d=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==d||null==b){this.setDeselect();return}var a=false;var m=this.attribute.jsonref;var c;if(typeof g!="string"){c=g.item(0)}if(null!=c||(m!=""&&m!=null)){var h=this.value;if(m!=""&&m!=null){h=SBGrid.DS.JsonStorage.getUniqueStorage().getValue(this.attribute.jsonref)}else{h=SBGrid.UT.XmlLib.getTextValue(c)}var o=SBGrid.CF.GetValue(d);var l="";var f=this.getAttribute("sep");if(!f.isEmpty()){var n=h.split(f);for(var e=0;e<n.length;e++){if(!n[e].isEmpty()){if(n[e]!=o){l+=n[e]+f}}}l=l.substring(0,l.lastIndexOf(f))}else{if(h!=o){l=h}}if(m!=""&&m!=null){SBGrid.DS.JsonStorage.getUniqueStorage().setValue(this.attribute.jsonref,l)}else{SBGrid.UT.XmlLib.setTextValue(c,l)}if(h!=l){a=true}}m=this.attribute.jsonref;if(m==""||m==null){m=this.attribute.ref}this.refreshCurrentModel(m);this.dispatch("ondeselect");if(a){this.dispatch("onvaluechanged")}};SBGrid.CT.Select.prototype.setDeselect=function(){this.attribute.appearance="false";this.selected=false;if(null!=this.m_strStyle){this.m_heControl.style.cssText=this.m_strStyle}};SBGrid.CT.Select.prototype.onMouseUp=function(a){SBGrid.CT.Group.prototype.onMouseUp.call(this,a);this.m_bLButtonDown=false};SBGrid.CT.Select.prototype.onMouseMove=function(a){if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){SBGrid.DEF.bDragDrop=true;this.m_bDragStart=true;a.capture="";a.drag=this.id;this.dispatch("ondragstart");if(this.m_bLButtonDown&&""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){this.dispatch("ondragenter");this.dispatch("ondragover")}}else{SBGrid.CT.Group.prototype.onMouseMove.call(this,a)}};SBGrid.CT.Select.prototype.onMouseDown=function(b){SBGrid.CT.Group.prototype.onMouseDown.call(this,b);if(!this.isCell(b.target)){return}if(SBGrid.EVT.BUTTON_LEFT!=b.button){return}if("false"==this.getAttribute("editable")){return}this.m_bLButtonDown=false;this.m_bDragStart=false;var a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=a){if(a.getDisabled()){return}var c=a.getElement();if(a.selected){this.dispatch("ondeselect")}else{this.dispatch("onselect")}SBGrid.DEF.setFocus(a.getId());this.m_bLButtonDown=true}};SBGrid.CT.Select.prototype.onKeyDown=function(b){SBGrid.CT.Group.prototype.onKeyDown.call(this,b);var c=false;var a;switch(b.keyCode){case SBGrid.EVT.UP:if(this.m_nSelectedRow>0){this.m_nSelectedRow--;c=true}else{this.m_nSelectedRow=0;c=true}break;case SBGrid.EVT.DOWN:if(this.m_nSelectedRow<this.m_nRows-1){this.m_nSelectedRow++;c=true}else{this.m_nSelectedRow=(this.m_nRows-1);c=true}break;case SBGrid.EVT.LEFT:if(this.m_nSelectedCol>0){this.m_nSelectedCol--;c=true}else{this.m_nSelectedCol=0;c=true}break;case SBGrid.EVT.RIGHT:if(this.m_nSelectedCol<this.m_nCols-1){this.m_nSelectedCol++;c=true}else{this.m_nSelectedCol=this.m_nCols-1;c=true}break;case SBGrid.EVT.SPACE:case SBGrid.EVT.ENTER:a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(a){if(a.disabled){return}if(a.selected){if(!(this instanceof SBGrid.CT.Select1)){this.dispatch("ondeselect")}}else{this.dispatch("onselect")}}break}if(c){a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(a){SBGrid.DEF.setFocus(a.getId())}}};SBGrid.CT.Select.prototype.onFocus=function(c){SBGrid.CT.Group.prototype.onFocus.call(this,c);var b=false;if("minimal"==this.getAttribute("appearance")){b=true}var d=this.focusIndex;if(-1==this.m_nSelectedRow&&!b){this.m_nSelectedRow=0}if(-1==this.m_nSelectedCol&&!b){this.m_nSelectedCol=0}var a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=a){if(!b){SBGrid.DEF.setFocus(a.getId())}if("full"==this.getAttribute("appearance")&&-1!=d&&d!=a.index&&"softbowl:select"!=this.tag){this.dispatch("ondeselect")}this.focusIndex=a.index}};SBGrid.CT.Select.create=function(a,c,d){var e=SBGrid.CT.Select.createMainNode(c);var b=document.getElementById("SBHE_"+a);b.appendChild(e);e=SBGrid.CT.Select.createSubNodes(e,c);return SBGrid.CT.Select.createObject(a,e,c,d)};SBGrid.CT.Select.createMainNode=function(a){var b=document.createElement("div");b=SBGrid.CT.Select.createAttribute(b,a);a=SBGrid.CT.Element.createClassName(a,"select");jQuery(b).addClass("sbgrid_select sbgrid_boxsizing");if(a.exists("class")){jQuery(b).addClass(a.item("class"))}return b};SBGrid.CT.Select.createSubNodes=function(b,a){return b};SBGrid.CT.Select.createObject=function(c,r,G,J){var n="";var d="";var H="";var z="";var q="";var u="";var x="";var C="1";var v="acrossdown";var E=false;var D=false;var g=false;var a="";var w="";var m="";var F=9007199254740992;var l="hidden";var h="";var b="";var B="*";var p="";var t=" ";var e="";var A="visible";var I=r.getAttribute("appearance");var o="";for(var y=0;y<G.count();y++){var f=G.keys()[y];switch(f){case"alert":n=G.item(f);break;case"help":d=G.item(f);break;case"hint":H=G.item(f);break;case"accesskey":z=G.item(f);break;case"bind":q=G.item(f);break;case"cellspacing":u=G.item(f);break;case"class":x=G.item(f);break;case"cols":C=G.item(f);break;case"direction":v=G.item(f);break;case"disabled":if("true"==G.item(f)){E=true}break;case"dragmode":if("true"==G.item(f)){D=true}break;case"dropmode":if("true"==G.item(f)){g=true}break;case"id":a=G.item(f);break;case"itemheight":w=G.item(f);break;case"itemwidth":m=G.item(f);break;case"navindex":F=parseInt(G.item(f));break;case"overflow":l=G.item(f);break;case"ref":h=G.item(f);break;case"jsonref":h=G.item(f);break;case"rows":B=G.item(f);break;case"scroll":p=G.item(f);break;case"sep":t=G.item(f);break;case"vcellspacing":e=G.item(f);break;case"visibility":A=G.item(f);break;case"appearance":break;default:if(!SBGrid.DEF.SB_STYLELIST[f]){o+=f+":"+G.item(f)+"; "}break}}var s=new SBGrid.CT.Select(c,n,d,H,z,q,u,x,C,v,E,D,g,a,w,m,F,l,h,b,B,p,t,null,J,"softbowl:select",e,A,0,false,"","","","",I,o,"");return s};SBGrid.CT.Select.createAttribute=function(b,a){b=SBGrid.CT.Group.createAttribute(b,a);return b};SBGrid.CT.Select.prototype.setLableRef=function(a){this.labelref=a};SBGrid.CT.Select.prototype.setValueRef=function(a){this.valueref=a};SBGrid.CT.Select1=function(t,x,s,o,n,S,r,f,h,N,M,u,m,J,g,e,p,E,T,F,l,B,O,a,G,A,z,I,q,D,R,Q,y,P,K,b,w,L,v,C,c,d,i,H){if(!e){return}if("minimal"==C){this.m_heComboboxInput=document.getElementById("SBHE_"+e+".input")}SBGrid.CT.Select.call(this,t,x,s,o,n,S,r,f,h,N,M,u,m,e,E,T,F,l,O,a,G,A,z,I,D,R,Q,y,P,K,b,w,L,v,C,c,d);this.m_bShowItemList=false;this.m_nComboButtomPoint=0;this.attribute.editmenu=String(J);this.attribute.editmode=g;this.attribute.itemcount=String(p);this.attribute.pastemode=B;this.attribute.showvalue=String(q);this.selectImage="";this.unSelectImage="";this.disSelectImage="";this.disUnSelectImage="";this.m_objInput;this.m_objButtion;this.m_bButtonClick=false;this.m_bSelect;this.m_bIsSelectedCell=false;this.m_bGridCombo=false;this.m_bItemCount="data";this.m_nItemSetHeight;this.m_bShowValue;this.m_ShowValueStrLabel;this.m_nItemHeight=null!=i?parseInt(i):null;this.m_nItemWidth=null!=H?parseInt(H):null;this.m_objScroll={bScrollEvent:false,bUpProcess:true,bDownProcess:true,nMaxLength:0,nBottom:0,nStartRow:0,nEndRow:0,nTopRow:0,nBottomRow:0,nPosition:0,nTargetTop:0,nTargetHeight:0,heTargetTable:null,heTargetTbody:null,nScrollDivHeight:0,arScrollLength:new Array()};this.m_heScrollDiv=null;this.m_bScrollRock=true;this.m_objWidthCtl={bScrollEvent:false,nStaticWidth:0};this.m_nAppearance="full"==C?2:4};SBGrid.CT.Select1.prototype=new SBGrid.CT.Select;SBGrid.CT.Select1.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);this.selectImage=null!=this.attribute["select.background-image"]?this.attribute["select.background-image"]:this.selectImage;this.unSelectImage=null!=this.attribute["background-image"]?this.attribute["background-image"]:this.unSelectImage;this.disSelectImage=null!=this.attribute["disable.select.background-image"]?this.attribute["disable.select.background-image"]:this.disSelectImage;this.disUnSelectImage=null!=this.attribute["disable.background-image"]?this.attribute["disable.background-image"]:this.disUnSelectImage;var b=null;var n=null;this.itemSelectImage=null!=this.attribute["item.select.background-image"]?this.attribute["item.select.background-image"]:"";this.itemUnSelectImage=null!=this.attribute["item.background-image"]?this.attribute["item.background-image"]:"";this.itemDisSelectImage=null!=this.attribute["item.disable.select.background-image"]?this.attribute["item.disable.select.background-image"]:"";this.itemDisUnSelectImage=null!=this.attribute["item.disable.background-image"]?this.attribute["item.disable.background-image"]:"";var m=null;var p=null;var f="";var r=this.getAttribute("appearance");if("full"==r){b=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"";n=null!=this.attribute["select.color"]?this.attribute["select.color"]:"";m=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"";p=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"";f="id:"+this.id+".item; background-image:"+this.unSelectImage+";select.background-image:"+this.selectImage+"; disable.background-image:"+this.disUnSelectImage+"; disable.select.background-image:"+this.disSelectImage+"; ";f+=" select.background-color:"+b+"; select.color:"+n+"; ";f+="item.select.background-image:"+this.itemSelectImage+"; item.disable.select.background-image:"+this.itemDisSelectImage+"; item.select.background-color:"+m+"; item.select.color:"+p+"; "}else{if("minimal"==r){b=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"darkblue";n=null!=this.attribute["select.color"]?this.attribute["select.color"]:"#FFFFFF";m=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"darkblue";p=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"#FFFFFF";f="id:"+this.id+".item; select.background-color:"+b+"; select.color:"+n+"; ";f+="item.select.background-color:"+m+"; item.select.color:"+p+"; ";var l="";var c="";if(null!=this.getAttribute("ref")){l=this.getAttribute("ref")}else{if(null!=this.getAttribute("jsonref")){c=this.getAttribute("jsonref")}}this.m_objInput=new SBGrid.CT.Input(this.id,"","",this.hint,"",false,"","",this.disabled,this.getAttribute("dragmode"),this.getAttribute("dropmode"),this.isEditable(),false,"",false,this.id+".input","","","","","",-1,-1,-1,"","",l,c,false,"",-1,"","",false,false,"","softbowl:comboinput",false,"visible");this.m_objInput.m_bDependentCtl=true;this.m_objButton=new SBGrid.CT.Button(this.id,"","",this.hint,"","",false,"","",this.disabled,false,"","","",this.id+".button",-1,"","","",-1,false,"","softbowl:combobutton","visible");this.m_objButton.m_bDependentCtl=true}else{b=null!=this.attribute["select.background-color"]?this.attribute["select.background-color"]:"darkblue";n=null!=this.attribute["select.color"]?this.attribute["select.color"]:"#FFFFFF";m=null!=this.attribute["item.select.background-color"]?this.attribute["item.select.background-color"]:"darkblue";p=null!=this.attribute["item.select.color"]?this.attribute["item.select.color"]:"#FFFFFF";f="id:"+this.id+".item; select.background-color:"+b+"; select.color:"+n+"; ";f+="item.select.background-color:"+m+"; item.select.color:"+p+"; "}}b=null;n=null;this.m_objItem=this.createChild("softbowl:selectitem",f);this.choices=new SBGrid.DS.Choices(this.id,this.id+".choices","softbowl:choices");if(this.isnodeset){var d=new SBGrid.DS.Itemset(this.id+".choices",this.id+".itemset","softbowl:itemset");if(this.jsonnodeset!=""&&this.jsonnodeset!=null){d.setAttribute("jsonref",this.jsonnodeset)}else{d.setAttribute("nodeset",this.nodeset)}var u=new SBGrid.DS.Label(this.id+".itemset",this.id+".label","softbowl:label");u.setAttribute("ref",this.labelref);var x=new SBGrid.DS.Value(this.id+".itemset",this.id+".value","softbowl:value");x.setAttribute("ref",this.valueref);d.setLabel(u);d.setValue(x);this.choices.setItemset(d);this.initItemset()}else{if("minimal"==r){var h=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;if(null!=h){document.body.appendChild(h);if(null==this.m_nItemSetHeight){this.m_nItemSetHeight=h.offsetHeight}if(!SBGrid.DEF.is_smartphone){h.setAttribute("U_D_C_S","combo");h.setAttribute("onscroll","SBGrid.DEF._W_onProcessEvent(window.event, 'onscroll', "+this.id+".id)")}h.style.height="0px";if(SBGrid.DEF.is_smartphone){h.style.overflow="hidden"}}}else{if("full"==r){this.initItemset()}}if(null!=this.m_strUserStaticValue&&""!=this.m_strUserStaticValue){this.htStaticValue=new SBGrid.DS.Hashtable();var o=this.m_strUserStaticValue.split("|");for(var v=0;v<o.length;v++){if(-1!=o[v].indexOf("^")){var s=o[v].split("^");var w=s[0];s.shift();this.htStaticValue[w]=s;var d=new SBGrid.DS.Itemset(this.id+".choices",this.id+".item."+v,"softbowl:item");var u=new SBGrid.DS.Label(this.id+".itemset",this.id+".label."+v,"softbowl:label");u.setAttribute("text",s[0]);var x=new SBGrid.DS.Value(this.id+".itemset",this.id+".value."+v,"softbowl:value");x.setAttribute("text",s[1]);d.setLabel(u);d.setValue(x)}}}this.m_objWidthCtl.nStaticWidth=this.m_nItemWidth}this.makeCell();var a=this.children.keys();for(var v=0;v<a.length;v++){var q=a[v];var t=this.children.item(q);if(null!=t){if(!this.isnodeset&&"softbowl:cell"==t.getAttribute("tag")){SBGrid.CF.Init(t);if(null!=t.m_heControl){t.m_heControl.setAttribute("label",this.htStaticValue[t.id][0]);t.m_heControl.setAttribute("value",this.htStaticValue[t.id][1]);t.m_heControl.noWrap=true;t.label=this.htStaticValue[t.id][0];t.value=this.htStaticValue[t.id][1]}}else{if("softbowl:cell"==t.attribute.tag){SBGrid.CF.Init(t)}else{t.init()}}}}this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;if(null!=this.m_heItemList){this.m_heItemList.setAttribute("parentId","true");this.scrollAttributeSetting();var g=this.attribute.windowcombo;if(null!=g&&"true"==g){this.parentWindowAppend(this.m_heItemList)}g=null}this.m_bIsTooltip="true"==this.attribute.selectitemtooltip;this.m_blockObject="true"==this.attribute["block-object"];var e=document.getElementById("SBHE_"+this.id+".input");if(null!=e){SBGrid.UT.HtmlLib.setStyle(e,"padding","0px")}};SBGrid.CT.Select1.prototype.parentWindowAppend=function(d){var c=window;var b=window;var e=window;while(true){b=c.parent;if(null!=b&&c!=b&&null!=c.SBGrid.DEF.__getAppName){e=c;c=b}else{if(null==c.SBGrid.DEF.__getAppName){var a=e.document.documentElement.lastChild;a.appendChild(d);d.parentWindow=window;this.m_objItemWindow=e}else{var a=c.document.documentElement.lastChild;a.appendChild(d);d.parentWindow=window;this.m_objItemWindow=c}break}}};SBGrid.CT.Select1.prototype.reBuild=function(){if(this.isnodeset||"full"==this.attribute.appearance){this.m_bIsReBuild=true;if(this.m_heItemList){this.m_heItemList.parentNode.removeChild(this.m_heItemList)}var e=this.m_objScroll.nTopRow;var b=this.m_objScroll.nBottomRow;for(var d=e;d<=b;d++){for(var a=0;a<this.m_nCols;a++){var c=this.getCell(d,a);if(null!=c){SBGrid.CF.UnInit(c)}}}this.initItemset();this.m_heItemList=document.getElementById("SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;this.scrollAttributeSetting();this.makeCell();e=this.m_objScroll.nTopRow;b=this.m_objScroll.nBottomRow;for(var d=e;d<=b;d++){for(var a=0;a<this.m_nCols;a++){var c=this.getCell(d,a);if(null!=c){SBGrid.CF.Init(c)}}}e=null;b=null;var f=this.attribute.windowcombo;if(null!=f&&"true"==f){this.parentWindowAppend(this.m_heItemList)}f=null}};SBGrid.CT.Select1.prototype.refresh=function(){SBGrid.CT.Select.prototype.refresh.call(this);if("minimal"==this.attribute.appearance){if(null==this.label){this.label=this.value}var a=this.label;if(null==a){a="";this.label=""}else{if("value"==this.getAttribute("showtype")){a=this.value}else{if("label"==this.getAttribute("showtype")){a=a}else{if("true"==this.getAttribute("showvalue")||"all"==this.getAttribute("showtype")){a=" ["+this.value+"]     "+a}}}}this.m_objInput.setWindowText(a)}};SBGrid.CT.Select1.prototype.setSelectImage=function(d){this.selectImage=d;this.m_objItem.setAttribute("select.background-image",d);this.m_objItem.m_jsonCssEvent.select="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.setUnSelectImage=function(d){this.unSelectImage=d;this.m_objItem.setAttribute("disable.select.background-image",d);this.m_objItem.m_jsonCssEvent.deselect="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.setDisSelectImage=function(d){this.disSelectImage=d;this.m_objItem.setAttribute("disable.background-image",d);this.m_objItem.m_jsonCssEvent.disable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.setDisUnSelectImage=function(d){this.disUnSelectImage=d;this.m_objItem.setAttribute("disable.select.background-image",d);this.m_objItem.m_jsonCssEvent.dedisable="background-image:url("+d+")";for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){var b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl){SBGrid.CF.SetSelect(b)}}}this.refresh()};SBGrid.CT.Select1.prototype.getEditMode=function(){var a=this.getAttribute("editmode");switch(a){case"search":return SBGrid.DEF.SB_POPUP_SEARCH;case"nopopupsearch":return SBGrid.DEF.SB_NO_POPUP_SEARCH;case"input":return SBGrid.DEF.SB_INPUT;case"inputsearch":return SBGrid.DEF.SB_POPUP_INPUT;default:return SBGrid.DEF.SB_NONE_EDIT}};SBGrid.CT.Select1.prototype.setAttribute=function(b,c){SBGrid.CT.Select.prototype.setAttribute.call(this,b,c);switch(b){case"left":if("minimal"==this.attribute.appearance){var a=isFinite(c)?c+"px":c;this.m_heItemList.style.left=a}break;case"editmenu":this.attribute.editmenu=c;break;case"editmode":this.attribute.editmode=c;if(""!=c){this.attribute.editable=true;this.m_heComboboxInput.readOnly=false}else{this.attribute.editable=false;this.m_heComboboxInput.readOnly=true}break;case"itemcount":this.attribute.itemcount=c;break;case"pastemode":this.attribute.pastemode=c;break;case"showvalue":this.attribute.showvalue=c;break}};SBGrid.CT.Select1.prototype.setDisabled=function(b,a){SBGrid.CT.Select.prototype.setDisabled.call(this,b,a);if("minimal"==this.attribute.appearance){this.showItemList(false)}};SBGrid.CT.Select1.prototype.applyDefaultStyle=function(){};SBGrid.CT.Select1.prototype.defaultAction=function(b,a){SBGrid.CT.Select.prototype.defaultAction.call(this,b,a);if("onglobalmousedown"==b){this.showItemList(false);this.showItemListBar(false)}};SBGrid.CT.Select1.prototype.prepareStyle=function(){SBGrid.CT.Select.prototype.prepareStyle.call(this)};SBGrid.CT.Select1.prototype.getClientLeft=function(a){var c=0;var e=window;var d=this.m_heControl;var b="true"==this.attribute.windowcombo;while(null!=d){c+=d.offsetLeft;if(d!=this.m_heControl){c+=d.clientLeft}if(a&&d!=document.body){c-=(SBGrid.DEF.is_android?0:d.scrollLeft)}d=d.offsetParent;if(null==d&&b){if(null!=this.m_objItemWindow&&this.m_objItemWindow!=e){if(null!=e.frameElement){d=e.frameElement}e=e.parent}}}e=null;return c};SBGrid.CT.Select1.prototype.getClientTop=function(a){var e=0;var d=window;var c=this.m_heControl;var b="true"==this.attribute.windowcombo;while(null!=c){e+=c.offsetTop;if(c!=this.m_heControl){e+=c.clientTop}if(a&&c!=document.body){e-=(SBGrid.DEF.is_android?0:c.scrollTop)}c=c.offsetParent;if(null==c&&b){if(null!=this.m_objItemWindow&&this.m_objItemWindow!=d){if(null!=d.frameElement){c=d.frameElement}d=d.parent}}}d=null;return e};SBGrid.CT.Select1.prototype.showItemList=function(i){var o=false;var q=nViewportWidth;var p=nViewportHeight;var h=0;var b=0;this.m_bShowItemList=i;var s=SBGrid.DS.SBBody;var g=document;var f="true"==this.attribute.windowcombo;if(f){var r=this.m_objItemWindow;if(null!=r.body){s=r.body;g=r.document;q=r.nViewportWidth;p=r.nViewportHeight;b=s.m_heControl.scrollTop}r=null}if(typeof g.documentElement.scrollTop!="undefined"){h=g.documentElement.scrollTop}else{if(typeof s.m_heControl.scrollTop!="undefined"){h=s.m_heControl.scrollTop}}var n=this.m_heItemList;if(n){if(i&&!this.disabled){SBGrid.DEF.setPermitResize(false);n.style.visibility="";if(SBGrid.DEF.is_smartphone){n.style.height=null;n.style.overflow="visible"}else{if("data"==this.m_bItemCount){if(typeof this.m_nItemSetHeight!="undefined"){n.style.height=this.m_nItemSetHeight+"px"}else{n.style.height=null}}else{if(this.m_bItemCount){n.style.height=this.m_nItemSetHeight+"px";n.style.overflowY="scroll"}else{n.style.height=null;n.style.overflowY="visible"}}}if(this.getClientLeft(true)+n.offsetWidth>q){n.style.left=(this.getClientLeft(true)+(this.m_heControl.offsetWidth-n.offsetWidth))+"px"}else{n.style.left=this.getClientLeft(true)+"px"}if(this.getClientTop(true)+this.m_heControl.offsetHeight+n.offsetHeight>p-this.getClientTop(true)){if(this.getClientTop(true)-h>p-this.getClientTop(true)){o=true;if(p-this.getClientTop(true)-this.m_heControl.offsetHeight<n.offsetHeight){if((this.getClientTop(true)-n.offsetHeight)>0){n.style.top=(this.getClientTop(true)-n.offsetHeight-b)+"px"}else{n.style.top=(h-b)+"px"}if(typeof this.m_nItemSetHeight!="undefined"){if(this.m_nItemSetHeight>this.getClientTop(true)-h){n.style.height=(this.getClientTop(true)-h)+"px"}}else{n.style.height=null}n.style.overflowY="scroll"}else{n.style.top=(this.getClientTop(true)+this.m_heControl.offsetHeight+b)+"px";if(typeof this.m_nItemSetHeight!="undefined"){n.style.height=this.m_nItemSetHeight+"px"}else{n.style.height=null}}}else{n.style.top=(this.getClientTop(true)+this.m_heControl.offsetHeight+b)+"px";if(n.offsetHeight>p-this.m_heControl.offsetHeight-this.getClientTop(true)){n.style.overflowY="scroll";n.style.height=(p-this.m_heControl.offsetHeight-this.getClientTop(true)+h-5)+"px"}else{if(typeof this.m_nItemSetHeight!="undefined"){n.style.height=this.m_nItemSetHeight+"px"}else{n.style.height=null}}}}else{n.style.top=(this.getClientTop(true)+this.m_heControl.offsetHeight+b)+"px";if(typeof this.m_nItemSetHeight!="undefined"){n.style.height=this.m_nItemSetHeight+"px"}else{n.style.height=null}}var d=0;this.m_objScroll.nScrollDivHeight=n.offsetHeight;var e=""==this.attribute.cellspacing?0:parseInt(this.attribute.cellspacing);if(this.m_bGridCombo){n.style.width=this.m_heControl.offsetWidth+"px"}else{n.style.width=(this.m_nItemWidth+e)+"px"}if(SBGrid.DEF.is_ie&&this.m_blockObject){var l="left:"+(parseInt(n.style.left)-1)+"px;";var m="height:"+(parseInt(n.style.height)+1)+"px;";var a="width:"+(parseInt(n.style.width)+2)+"px;";var c="top:"+n.style.top+";";document.getElementById("SBHE___SB_LoadExcel").style.cssText="position: absolute;"+l+c+m+a+";z-index:3"}}else{SBGrid.DEF.setPermitResize(true);n.style.visibility="hidden";if(SBGrid.DEF.is_smartphone){n.style.height="0px";n.style.overflow="hidden"}else{n.style.height="0px";if(!this.m_bItemCount){n.style.top="0px";n.style.overflow="hidden"}}n.style.width="0px";if(SBGrid.DEF.is_ie&&this.m_blockObject){document.getElementById("SBHE___SB_LoadExcel").style.cssText="display: none; position: absolute;"}}}n=null};SBGrid.CT.Select1.prototype.showItemListBar=function(a){var b=window;var c=this.attribute.windowcombo;if(null!=c&&"true"==c){return}b=null};SBGrid.CT.Select1.prototype.setValueToInput=function(b,a){};SBGrid.CT.Select1.prototype.setReverseColor=function(){};SBGrid.CT.Select1.prototype.isEditable=function(){return(this.getEditMode()!=SBGrid.DEF.SB_NONE_EDIT)};SBGrid.CT.Select1.prototype.applySelection=function(e){if(!this.m_bIsReBuild){this.clearSelect()}var d=this.value;this.label=null;this.value=e;if(null!=d&&"minimal"!=this.getAttribute("appearance")){if("full"==this.getAttribute("appearance")||"full"!=this.getAttribute("appearance")&&""!=d&&e!=d){for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){b=this.getCell(c,a);if(null!=b&&null!=b.m_heControl&&d==SBGrid.CF.GetValue(b)){SBGrid.CF.SetSelect(b,false)}}}}}if(null!=e){e=e.trim();var b=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=b&&null!=b.m_heControl&&e==SBGrid.CF.GetValue(b)){SBGrid.CF.SetSelect(b,true);this.label=SBGrid.CF.GetLabel(b);this.m_bIsSelectedCell=true;return}else{for(var c=0;c<this.m_nRows;c++){for(var a=0;a<this.m_nCols;a++){b=this.getCell(c,a);if(null!=b&&(e==SBGrid.CF.GetValue(b))){SBGrid.CF.SetSelect(b,true);this.label=SBGrid.CF.GetLabel(b);this.m_bIsSelectedCell=true;this.m_bIsReBuild=false;return}}}}}this.m_bIsReBuild=false};SBGrid.CT.Select1.prototype.initItemset=function(){if(this.m_heItemList){if(null!=this.m_heItemList.firstChild){this.m_heItemList.removeChild(this.m_heItemList.firstChild)}}var strAppearance=this.getAttribute("appearance");if("minimal"==strAppearance){var strNodeSet=this.nodeset;if((strNodeSet.length-1)==strNodeSet.lastIndexOf("/")){strNodeSet=strNodeSet.substring(0,strNodeSet.length-1)}var strLabelRef=this.labelref;if(0==strLabelRef.indexOf("/")){strLabelRef=strLabelRef.substring(1)}var arLabelRefPath=strLabelRef.split("/");if(1!=arLabelRefPath.length){for(var i=0;i<arLabelRefPath.length-1;i++){strNodeSet=strNodeSet+"/"+arLabelRefPath[i]}strLabelRef=arLabelRefPath[arLabelRefPath.length-1]}var strValueRef=this.valueref;if(0==strValueRef.indexOf("/")){strValueRef=strValueRef.substring(1)}var arValueRefPath=strValueRef.split("/");if(1!=arValueRefPath.length){strValueRef=arValueRefPath[arValueRefPath.length-1]}this.itemLength=0;this.arItemList=new Array();this.m_arItemList=new Array();var tdIDs=null;if(SBGrid.DEF.is_firefox){tdIDs=new Array()}if(this.jsonnodeset!=""&&this.jsonnodeset!=null){try{this.itemLength=eval(this.jsonnodeset).length;for(var i=0;i<this.itemLength;i++){var data={label:eval(this.jsonnodeset+"["+i+"]."+strLabelRef),value:eval(this.jsonnodeset+"["+i+"]."+strValueRef)};this.arItemList.push(data)}}catch(e){SBGrid.DEF.errorMsg("jsonref를 이용한 itemset 구성 오류")}}else{var xlItemSetLabel=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strLabelRef);var xlItemSetValue=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,strNodeSet+"/"+strValueRef);var nLabelLength=xlItemSetLabel.length;var nValueLength=xlItemSetValue.length;var nItemSetLength=nLabelLength>=nValueLength?nValueLength:nLabelLength;for(var i=0;i<nItemSetLength;i++){var data={label:xlItemSetLabel.item(i),value:xlItemSetValue.item(i)};this.arItemList.push(data)}this.itemLength=nItemSetLength;this.length=this.itemLength}this.m_heComboboxImg=document.getElementById(this.id+"_img");this.m_heControl=document.getElementById("SBHE_"+this.id);var strStyleWidth=this.m_heControl.style.width;var strStyleheight=this.m_heControl.style.height;var heComboListDiv=null;if(null!=this.m_heItemList){heComboListDiv=this.m_heItemList}else{var heTempDiv=document.createElement("div");heTempDiv.innerHTML='<div onscroll=\'SBGrid.DEF._W_onProcessEvent(event, "onscroll", "'+this.id+"\")'></div>";heComboListDiv=heTempDiv.firstChild}heComboListDiv.setAttribute("id","SBHE_"+this.id+"_allitem");SBGrid.DEF.SB_ITEMLIST["SBHE_"+this.id+"_allitem"]=true;jQuery(heComboListDiv).addClass("sbgrid_combo_itemlist");if(!SBGrid.DEF.is_smartphone){heComboListDiv.setAttribute("U_D_C_S","combo")}heComboListDiv.style.visibility="hidden";heComboListDiv.style.height="0px";var strItemHeight=this.getAttribute("itemheight");var strItemWidth=this.getAttribute("itemwidth");var strVcellSpacing=this.getAttribute("vcellspacing");var strCellSpacing=this.getAttribute("cellspacing");strItemHeight=(null!=strItemHeight)?strItemHeight.split("px")[0]:"";strItemWidth=(null!=strItemWidth)?strItemWidth.split("px")[0]:"";strVcellSpacing=(null!=strVcellSpacing)?strVcellSpacing.split("px")[0]:"";strCellSpacing=(null!=strCellSpacing)?strCellSpacing.split("px")[0]:"";if(""==strItemWidth){var strComboWidth=this.getAttribute("sbgrid_grid_combo_width");if(""!=strComboWidth){strItemWidth=parseInt(strComboWidth)-2}}var nItemHeight=parseInt(strItemHeight);var nItemWidth=parseInt(strItemWidth);var nVcellSpacing=parseInt(strVcellSpacing);var nCellSpacing=parseInt(strCellSpacing);var nPaddingRight=null;var strCols=this.attribute.cols;var strRows=this.attribute.rows;var nCols=(""==strCols)||("*"==strCols)?1:parseInt(strCols);var nRows=(""==strRows)||("*"==strRows)?1:parseInt(strRows);var strComboWidth=this.getAttribute("width").replaceAll("px","");if(""==strComboWidth||null==strComboWidth){strComboWidth=this.m_heControl.style.width}var nComboWidth=parseInt(strComboWidth);if((""==strItemWidth||null==strItemWidth)||nComboWidth>nItemWidth){nItemWidth=isNaN(nComboWidth)?100:nComboWidth}if("*"==strCols&&(1<nRows)){nCols=Math.ceil(this.itemLength/nRows)}else{nRows=Math.ceil(this.itemLength/nCols)}var strDirection=this.attribute.direction;if("true"==this.attribute.showvalue){nCols=1;nRows=this.itemLength;strDirection=""}nPaddingRight=(""==strCellSpacing||null==strCellSpacing)?(nCols>1?18:0):nCellSpacing;if(""==strItemHeight||null==strItemHeight){nItemHeight=(""==strVcellSpacing||null==strVcellSpacing)?18:nVcellSpacing}this.m_nItemHeight=nItemHeight;var nItemCutLine=parseInt(this.attribute.itemcount);if(nItemCutLine<nRows&&!SBGrid.DEF.is_smartphone){this.m_bItemCount=true;this.m_nItemSetHeight=(nItemHeight*nItemCutLine)}else{this.m_bItemCount=false;this.m_nItemSetHeight=(nItemHeight*nRows)}if(SBGrid.DEF.is_smartphone){heComboListDiv.style.height="0px"}this.m_nItemWidth=(nItemWidth*nCols);this.m_objWidthCtl.nStaticWidth=(nItemWidth*nCols);this.m_arItemList.push("<table class='sbgrid_combo_itemlist_table' cellSpacing=0 cellPadding=0 style='width:100%;height:100%'>");var bIsTooltip="true"==this.attribute.selectitemtooltip;var nItemIndex=0;this.m_nRows=nRows;var comboText;var strItemClassName="class='sbgrid_selectitem"+this.m_nAppearance+" ";if(this.m_clCSSName.exists(this.m_strLocalTag+"_selectitem")){strItemClassName+=this.m_clCSSName.item(this.m_strLocalTag+"_selectitem")}if(this.m_clCSSName.exists("select1_selectitem")){strItemClassName+=" "+this.m_clCSSName.item("select1_selectitem")}var appendEvent="";var bAttach=false;if(window.attachEvent){bAttach=true}for(var i=0;i<nRows;i++){if(i<(nItemCutLine+10)){this.m_arItemList.push("<tr>");for(var j=0;j<nCols&&nItemIndex<this.arItemList.length;j++){var xnItem=null;if("downacross"==strDirection){xnItem=this.arItemList[((nRows*j)+i)]}else{xnItem=this.arItemList[nItemIndex]}var xnLabel=xnItem.label;var xnValue=xnItem.value;var strLabel="";var strValue="";if(this.jsonnodeset!=""&&this.jsonnodeset!=null){strLabel=xnItem.label;strValue=xnItem.value}else{strLabel=SBGrid.UT.XmlLib.getTextValue(xnLabel);strValue=SBGrid.UT.XmlLib.getTextValue(xnValue)}var strTDId=this.id+"_"+i+"_"+j;this.m_bShowValue=this.attribute.showvalue;if("true"==this.attribute.showvalue){comboText=strValue+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+strLabel}else{comboText=strLabel}if(SBGrid.DEF.is_smartphone||SBGrid.DEF.is_ipad){this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strItemClassName+" "+strTDId+"_Attr' onmousedown='' i='' onmouseup='' ondblclick='' onkeydown='' onkeypress='' onkeyup='' text='"+strLabel+"' value='"+strValue+"' label='"+strLabel+"' noWrap='nowrap' style='height:"+nItemHeight+"px;padding-right:"+nPaddingRight+"px;'>"+comboText+"</td>")}else{var strTooltip="";if(bIsTooltip){strTooltip=" title='"+comboText+"' "}this.m_arItemList.push("<td id='SBHE_"+strTDId+"' "+strItemClassName+" "+strTDId+"_Attr' "+strTooltip+"text='"+strLabel+"' value='"+strValue+"' label='"+strLabel+"' noWrap=true style='height:"+nItemHeight+"px;padding-right:"+nPaddingRight+"px;'>"+comboText+"</td>");nItemIndex++}if(bAttach){appendEvent+="SBHE_"+strTDId+".attachEvent('onmousedown', SBGrid.DEF._W_onProcessMouseEvent);";appendEvent+="SBHE_"+strTDId+".attachEvent('onmousemove', SBGrid.DEF._W_onProcessMouseEvent);";appendEvent+="SBHE_"+strTDId+".attachEvent('onmouseup', SBGrid.DEF._W_onProcessMouseEvent);"}else{appendEvent+="SBHE_"+strTDId+".addEventListener('mousedown', SBGrid.DEF._W_onProcessMouseEvent, false);";appendEvent+="SBHE_"+strTDId+".addEventListener('mousemove', SBGrid.DEF._W_onProcessMouseEvent, false);";appendEvent+="SBHE_"+strTDId+".addEventListener('mouseup', SBGrid.DEF._W_onProcessMouseEvent, false);"}if(tdIDs){tdIDs.push("SBHE_"+strTDId)}}this.m_arItemList.push("</tr>")}else{break}}this.m_arItemList.push("</table>");this.m_arItemList.push("<div class='sbgrid_ScrollDiv' style='height:"+(nRows*nItemHeight)+"px'></div>");heComboListDiv.innerHTML=this.m_arItemList.join("");document.body.appendChild(heComboListDiv);if(SBGrid.DEF.is_firefox&&tdIDs){for(var t=0;t<tdIDs.length;t++){var strTDID=tdIDs[t];var htTD=document.getElementById(strTDID);if(htTD){htTD.addEventListener("mousedown",SBGrid.DEF._W_onProcessMouseEvent,false);htTD.addEventListener("mousemove",SBGrid.DEF._W_onProcessMouseEvent,false);htTD.addEventListener("mouseup",SBGrid.DEF._W_onProcessMouseEvent,false)}}delete tdIDs;tdIDs=null}else{eval(appendEvent)}}else{SBGrid.CT.Select.prototype.initItemset.call(this)}};SBGrid.CT.Select1.prototype.getLabelValue=function(c,f){var d=null;var a={label:"",value:""};if("downacross"==this.attribute.direction){d=this.arItemList[((this.m_nRows*f)+c)]}else{d=this.arItemList[((this.m_nCols*c)+f)]}var e=d.label;var b=d.value;if(this.jsonnodeset!=""&&this.jsonnodeset!=null){a.label=e;a.value=b}else{a.label=SBGrid.UT.XmlLib.getTextValue(e);a.value=SBGrid.UT.XmlLib.getTextValue(b)}return a};SBGrid.CT.Select1.prototype.onSelect=function(b){var d=this.getRefNode();if(null==d){return}var a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null==a||null==b){this.setSelect();return}var c=this.value;this.setValue(SBGrid.CF.GetValue(a));this.dispatch("onselect");if(c!=this.getValue()){this.dispatch("onvaluechanged")}};SBGrid.CT.Select1.prototype.setSelect=function(){this.attribute.appearance="true";this.selected=true;if(null!=this.m_htSelectStyle){for(var strKey in this.m_htSelectStyle){var strValue=this.m_htSelectStyle[strKey];if(-1!=strKey.indexOf("background-image")){if(-1==strValue.indexOf("url(")){strValue="url("+strValue+")"}}var strStyle="";if(-1!=strKey.indexOf("-")){var arStyle=strKey.split("-");strStyle+=arStyle[0].toLowerCase();for(var i=1;i<arStyle.length;i++){var strUpper=arStyle[i].charAt(0).toUpperCase();var strLower=arStyle[i].substring(1);strStyle+=strUpper.concat(strLower)}}else{strStyle=strKey.toLowerCase()}eval("this.m_heControl.style."+strStyle+" = '"+strValue+"'")}}};SBGrid.CT.Select1.prototype.onFocus=function(a){SBGrid.CT.Select.prototype.onFocus.call(this,a);if(""==this.attribute.editmode){this.setReverseColor()}};SBGrid.CT.Select1.prototype.onBlur=function(a){if("minimal"==this.getAttribute("appearance")&&(a.relatedTarget.isEmpty()||!this.isDescendants(a.relatedTarget,true))){this.showItemList(false);this.showItemListBar(false)}if(this.m_objInput&&a.target==this.m_objInput.getId()){if(SBGrid.DEF.SB_NONE_EDIT!=this.getEditMode()){}}this.m_bSelect=false;SBGrid.CT.Select.prototype.onBlur.call(this,a)};SBGrid.CT.Select1.prototype.isCell=function(a){if("minimal"==this.getAttribute("appearance")){if(a==this.id+".input"||a==this.id+".button"){return false}}return SBGrid.CT.Select.prototype.isCell.call(this,a)};SBGrid.CT.Select1.prototype.onMouseDown=function(d){SBGrid.CT.Group.prototype.onMouseDown.call(this,d);this.m_bButtonClick=false;if(SBGrid.EVT.BUTTON_LEFT!=d.button){return}if(this.m_heItemList&&"minimal"==this.getAttribute("appearance")){if(!this.isCell(d.target)){if(this.m_bShowItemList){this.showItemList(false);this.showItemListBar(false)}else{var a=(null==this.m_objInput)||!this.isEditable()||(d.target!=this.m_objInput.getId());if(a){if(SBGrid.DEF.SB_INPUT==this.getEditMode()||SBGrid.DEF.SB_POPUP_INPUT==this.getEditMode()){var e=this.m_objInput.getWindowText();if(null!=e&&!e.isEmpty()){var c=-1;var f=-1;if(false){this.clearSelect();var b=this.getCell(c,f);if(b){SBGrid.CF.SetSelect(b,true)}}}}if("minimal"==this.getAttribute("appearance")){this.showItemList(true)}}}if(""!=this.label){this.m_bLButtonDown=true}}else{this.m_bButtonClick=true;this.showItemList(false);this.showItemListBar(false)}}var b=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=b&&!("minimal"==this.getAttribute("appearance")&&!this.isCell(d.target))){this.dispatch("onselect");this.m_bLButtonDown=true}this.m_bButtonClick=false};SBGrid.CT.Select1.prototype.onMouseOver=function(c){SBGrid.CT.Control.prototype.onMouseOver.call(this,c);if("minimal"==this.attribute.appearance&&this.isCell(c.target)){var b=this.getAttribute("row");var d=this.getAttribute("col");this.clearSelect();var a=this.getCell(b,d);if(a){this.m_nSelectedRow=b;this.m_nSelectedCol=d;SBGrid.CF.SetSelect(a,true)}this.showItemListBar(true);b=null;d=null;a=null}};SBGrid.CT.Select1.prototype.onKeyDown=function(b){if("minimal"==this.attribute.appearance){SBGrid.CT.Group.prototype.onKeyDown.call(this,b);if(SBGrid.EVT.UP!=b.keyCode&&SBGrid.EVT.DOWN!=b.keyCode&&SBGrid.EVT.ESC!=b.keyCode){if(this.m_objInput&&this.m_objInput.getId()==b.target){return}}}else{SBGrid.CT.Select.prototype.onKeyDown.call(this,b);return}var c=false;switch(b.keyCode){case SBGrid.EVT.UP:if(this.m_nSelectedRow>0){this.m_nSelectedRow--;c=true}break;case SBGrid.EVT.DOWN:if(this.m_nSelectedRow<this.m_nRows-1){this.m_nSelectedRow++;c=true}break;case SBGrid.EVT.LEFT:if(this.m_nSelectedCol>0){this.m_nSelectedCol--;c=true}break;case SBGrid.EVT.RIGHT:if(this.m_nSelectedCol<this.m_nCols-1){this.m_nSelectedCol++;c=true}break;case SBGrid.EVT.SPACE:case SBGrid.EVT.ENTER:if(!this.m_bShowItemList){this.showItemList(true);this.showItemListBar(true)}else{this.showItemList(false);this.showItemListBar(false);if(this.m_objInput.getId()!=b.target){this.dispatch("onselect")}if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){if(this.m_nSelectedCol==-1&&this.m_nSelectedRow==-1){this.setText("");this.setValue("")}c=true;break}}return;case SBGrid.EVT.ESC:this.showItemList(false);this.showItemListBar(false);return;default:return}if(c){if(this.m_nSelectedCol==-1){this.m_nSelectedCol=0}if(this.m_nSelectedRow==-1){this.m_nSelectedRow=0}var a=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=a){if(this.m_bShowItemList){this.clearSelect();SBGrid.CF.SetSelect(a,true)}else{this.dispatch("onselect");if(""!=this.attribute.editmode){window.setTimeout("try{if (null != "+this.m_objInput.id+"){"+this.m_objInput.id+'.m_heControlInput.select();}else{document.SBHE_allElement.item("'+this.m_objInput.id+'").m_heControlInput.select();}}catch(e){}',0)}}}this.itemValidCheck(b,c)}};SBGrid.CT.Select1.prototype.itemValidCheck=function(a,h){if(!this.isCell(a.target)){if(a.target==this.m_objInput.getId()||(""==this.attribute.editmode&&!this.m_bShowItemList)){var m=this.m_objInput.getWindowText();if(null!=m&&!m.isEmpty()){var d=-1;var g=-1;this.clearSelect();var b=false;for(var f=0;f<this.m_nRows;f++){for(var e=0;e<this.m_nCols;e++){var c=this.getCell(f,e);for(var l=0;l<m.length;l++){if(c.label.charAt(l)==m.charAt(l)){if(l==m.length-1){b=true}continue}else{break}}if(b){d=f;g=e;break}}if(b){break}}var c=this.getCell(d,g);if(null!=c){SBGrid.CF.SetSelect(c,true);if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){this.m_nSelectedRow=d;this.m_nSelectedCol=g}}else{if(SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()){this.m_nSelectedRow=-1;this.m_nSelectedCol=-1}return}if((SBGrid.DEF.SB_POPUP_SEARCH==this.getEditMode()||SBGrid.DEF.SB_POPUP_INPUT==this.getEditMode())&&!h){this.showItemList(true)}}else{var d=-1;var g=-1;this.clearSelect();this.showItemList(false)}}}};SBGrid.CT.Select1.prototype.onScroll=function(a){if(!SBGrid.DEF.is_smartphone){if(this.m_objScroll.bScrollEvent&&this.m_objScroll.nPosition!=this.m_heItemList.scrollTop){var b=this.m_objScroll.nPosition-this.m_heItemList.scrollTop;if(Math.abs(b)<80){this.scrolButtonClick(b,this.m_heItemList.scrollTop)}else{jQuery(this.m_heScrollDiv).addClass("sbgrid_comboDiv_alpha");this.m_objScroll.arScrollLength.push(1);window.setTimeout("SBGrid.DEF."+this.id+".scrollingCombo(true);",100)}}}};SBGrid.CT.Select1.prototype.scrollAttributeSetting=function(){var d=this.m_objScroll;var b=this.m_nRows-1;var a=parseInt(this.attribute.itemcount)+10;var c=a<this.m_nRows;d.nMaxLength=a;d.nBottomRow=c?d.nTopRow+a-1:this.m_nRows-1;d.nEndRow=this.m_nRows-a;d.bScrollEvent=c;d.nPosition=this.m_heItemList.scrollTop;d.nScrollDivHeight=this.m_heItemList.offsetHeight;d.heTargetTable=this.m_heItemList.firstChild;if(null!=d.heTargetTable){d.heTargetTbody=d.heTargetTable.firstChild;d.nTargetHeight=d.heTargetTable.offsetHeight}this.m_heScrollDiv=this.m_heItemList.lastChild;d=null};SBGrid.CT.Select1.prototype.scrolButtonClick=function(f,d){if(this.mbScrollRock){return}this.m_bScrollRock=true;var e=this.m_objScroll;e.nPosition=d;var c=d+e.nScrollDivHeight/2;var b=e.nTargetTop+e.nTargetHeight/2;var a=Math.ceil((Math.abs(f)/this.m_nItemHeight));if(0>f&&e.bDownProcess){if(b-c<0){this.scrollUpDownTable(true,a)}}else{if(e.bUpProcess){if(b-c>0){this.scrollUpDownTable(false,a)}}}e=null;this.m_bScrollRock=false};SBGrid.CT.Select1.prototype.scrollUpDownTable=function(p,f){var e=null;var l=null;var b=this.m_objScroll;if(p){var o=b.nTopRow+f;if(o>b.nEndRow){f=f-(o-b.nEndRow)}b.nTargetTop=b.nTargetTop+(this.m_nItemHeight*f);e=b.nTopRow+f;l=b.nBottomRow+f;for(var n=0;n<f;n++){var c=b.heTargetTbody.firstChild;var h=b.nTopRow+n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){if(g.selected){SBGrid.CF.SetSelect(g,false);g.selected=true}if(null!=g.m_heControl){jQuery(g.m_heControl).removeClass(g.id+"_Attr");var d=this.id+"_"+(b.nBottomRow+1+n)+"_"+m;g.m_heControl.id="SBHE_"+d;jQuery(g.m_heControl).addClass(d+"_Attr")}SBGrid.CF.UnInit(g)}}h=b.nBottomRow+1+n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){SBGrid.CF.Init(g);if(this.isnodeset){var q=this.getLabelValue(h,m);g.label=q.label;g.value=q.value}SBGrid.CF.SetLabel(g,g.label,this.m_bIsTooltip);SBGrid.CF.SetValue(g,g.value);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=g.value+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+g.label}else{this.m_ShowValueStrLabel=g.label}SBGrid.CF.SetLabelChange(g,this.m_ShowValueStrLabel);if(g.selected){SBGrid.CF.SetSelect(g,true)}}}b.heTargetTbody.appendChild(c)}}else{f=f>b.nTopRow?b.nTopRow:f;b.nTargetTop=b.nTargetTop-(this.m_nItemHeight*f);e=b.nTopRow-f;l=b.nBottomRow-f;var c=b.heTargetTbody.firstChild;for(var n=0;n<f;n++){var h=b.nBottomRow-n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){if(g.selected){SBGrid.CF.SetSelect(g,false);g.selected=true}if(null!=g.m_heControl){jQuery(g.m_heControl).removeClass(g.id+"_Attr");var d=this.id+"_"+(b.nTopRow-1-n)+"_"+m;g.m_heControl.id="SBHE_"+d;jQuery(g.m_heControl).addClass(d+"_Attr")}SBGrid.CF.UnInit(g)}}h=b.nTopRow-1-n;for(var m=0;m<this.m_nCols;m++){var g=this.getCell(h,m);if(null!=g){SBGrid.CF.Init(g);if(this.isnodeset){var q=this.getLabelValue(h,m);g.label=q.label;g.value=q.value}SBGrid.CF.SetLabel(g,g.label,this.m_bIsTooltip);SBGrid.CF.SetValue(g,g.value);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=g.value+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+g.label}else{this.m_ShowValueStrLabel=g.label}SBGrid.CF.SetLabelChange(g,this.m_ShowValueStrLabel);if(g.selected){SBGrid.CF.SetSelect(g,true)}}}var a=b.heTargetTbody.lastChild;b.heTargetTbody.insertBefore(a,c);c=a}}b.heTargetTable.style.top=b.nTargetTop+"px";b.nTopRow=e;b.nBottomRow=l;b.bUpProcess=0!=e;b.bDownProcess=(this.m_nRows-1)!=l;b=null};SBGrid.CT.Select1.prototype.scrollingCombo=function(d){var o=this.m_objScroll;if(o.arScrollLength.length>1){o.arScrollLength.shift();return}if(this.mbScrollRock){return}this.m_bScrollRock=true;jQuery(this.m_heScrollDiv).removeClass("sbgrid_comboDiv_alpha");var e=null;var g=null;o.nPosition=this.m_heItemList.scrollTop;var l=o.nPosition+(o.nScrollDivHeight/2)-(o.nTargetHeight/2);var a=parseInt(l/this.m_nItemHeight);if(a==o.nTopRow){o.heTargetTable.style.top=o.nTargetTop+"px";o.arScrollLength=new Array();return}else{if(a<o.nStartRow){a=o.nStartRow}else{if(a>o.nEndRow){a=o.nEndRow}}}e=a;g=o.nBottomRow-o.nTopRow+a;o.nTargetTop=this.m_nItemHeight*(a);var c=0;for(var m=o.nTopRow;m<=o.nBottomRow;m++){for(var h=0;h<this.m_nCols;h++){var f=this.getCell(m,h);if(null!=f){if(f.selected){SBGrid.CF.SetSelect(f,false);f.selected=true}if(null!=f.m_heControl){jQuery(f.m_heControl).removeClass(f.id+"_Attr");var b=this.id+"_"+(a+c)+"_"+h;f.m_heControl.id="SBHE_"+b;jQuery(f.m_heControl).addClass(b+"_Attr")}SBGrid.CF.UnInit(f)}}c++}c=0;for(var m=e;m<=g;m++){for(var h=0;h<this.m_nCols;h++){var f=this.getCell(m,h);if(null!=f){SBGrid.CF.Init(f);if(this.isnodeset){var n=this.getLabelValue(m,h);f.label=n.label;f.value=n.value}SBGrid.CF.SetLabel(f,f.label,this.m_bIsTooltip);SBGrid.CF.SetValue(f,f.value);if("true"==this.m_bShowValue){this.m_ShowValueStrLabel=f.value+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+f.label}else{this.m_ShowValueStrLabel=f.label}SBGrid.CF.SetLabelChange(f,this.m_ShowValueStrLabel);if(f.selected){SBGrid.CF.SetSelect(f,true)}}}c++}o.heTargetTable.style.top=o.nTargetTop+"px";o.nTopRow=e;o.nBottomRow=g;o.arScrollLength=new Array();o.bUpProcess=0!=e;o.bDownProcess=(this.m_nRows-1)!=g;o=null;this.m_bScrollRock=false};SBGrid.CT.Select1.create=function(a,c,d){var e=SBGrid.CT.Select1.createMainNode(c);var b=document.getElementById("SBHE_"+a);b.appendChild(e);e=SBGrid.CT.Select1.createSubNodes(e,c);return SBGrid.CT.Select1.createObject(a,e,c,d)};SBGrid.CT.Select1.createMainNode=function(i){var d=document.createElement("div");d=SBGrid.CT.Select1.createAttribute(d,i);i=SBGrid.CT.Element.createClassName(i,"select1");jQuery(d).addClass("sbgrid_select sbgrid_boxsizing");if(d.getAttribute("appearance")=="full"){if(i.exists("class")){jQuery(d).addClass(i.item("class"))}}if(d.getAttribute("appearance")=="minimal"){jQuery(d).addClass("sbgrid_select4");var l=d.id;var f=document.createElement("table");f.cellPadding=0;f.cellSpacing=0;SBGrid.UT.HtmlLib.setStyle(f,"width","100%");SBGrid.UT.HtmlLib.setStyle(f,"height","100%");var c=document.createElement("tbody");var e=document.createElement("tr");SBGrid.UT.HtmlLib.setStyle(e,"width","100%");SBGrid.UT.HtmlLib.setStyle(e,"height","100%");var g=document.createElement("td");g.valign="middle";var h=document.createElement("input");if(!d.editmode){h.readOnly=true}h.id=l+".input";var a="sbgrid_combo_input ";if(i.exists("select1_comboinput")){a+=i.item("select1_comboinput")+" "}if(i.exists("combo_comboinput")){a+=i.item("combo_comboinput")}h.setAttribute("class",h.getAttribute("class")+" "+a);a="";var b=document.createElement("td");b.id=l+"_img";b.valign="middle";b.align="center";b.setAttribute("class","sbgrid_combo_button_td");var m=document.createElement("button");m.id=l+".button";a="sbgrid_combo_button ";if(i.exists("select1_combobutton")){a+=i.item("select1_combobutton")+" "}if(i.exists("combo_combobutton")){a+=i.item("combo_combobutton")}m.setAttribute("class",m.getAttribute("class")+" "+a);b.appendChild(m);g.appendChild(h);e.appendChild(g);e.appendChild(b);c.appendChild(e);f.appendChild(c);d.appendChild(f)}return d};SBGrid.CT.Select1.createSubNodes=function(b,a){return b};SBGrid.CT.Select1.createObject=function(w,m,A,F){var z="";var v="";var s="";var q="";var P="";var t="";var n="";var o="1";var M="acrossdown";var L=false;var u=false;var f=false;var g="";var p="";var I="";var G=9007199254740992;var c="hidden";var N="";var a="";var H="*";var E="";var D=" ";var J="";var B="visible";var K=m.getAttribute("appearance");var C=false;var b="";var h=0;if(m.getAttribute("appearance")=="full"){h=0}else{if(m.getAttribute("appearance")=="minimal"){h=A.exists("itemcount")?parseInt(A.item("itemcount")):30}else{if(m.getAttribute("appearance")=="compact"){h=0}}}var y="default";var r="";var l=false;var e="";for(var O=0;O<A.count();O++){var d=A.keys()[O];switch(d){case"alert":z=A.item(d);break;case"help":v=A.item(d);break;case"hint":s=A.item(d);break;case"accesskey":q=A.item(d);break;case"bind":P=A.item(d);break;case"cellspacing":t=A.item(d);break;case"class":n=A.item(d);break;case"cols":o=A.item(d);break;case"direction":M=A.item(d);break;case"disabled":if("true"==A.item(d)){L=true}break;case"dragmode":if("true"==A.item(d)){u=true}break;case"dropmode":if("true"==A.item(d)){f=true}break;case"editmenu":if("true"==A.item(d)){C=true}break;case"editMode":b=A.item(d);break;case"id":g=A.item(d);break;case"itemcount":break;case"itemheight":p=A.item(d);break;case"itemwidth":I=A.item(d);break;case"navindex":G=parseInt(A.item(d));break;case"overflow":c=A.item(d);break;case"pastemode":y=A.item(d);break;case"ref":N=A.item(d);break;case"jsonref":a=A.item(d);break;case"rows":H=A.item(d);break;case"scroll":E=A.item(d);break;case"sep":D=A.item(d);break;case"showtype":r=A.item(d);break;case"showvalue":if("true"==A.item(d)){l=true}break;case"vcellspacing":J=A.item(d);break;case"visibility":B=A.item(d);break;case"appearance":break;default:if(!SBGrid.DEF.SB_STYLELIST[d]){e+=d+":"+A.item(d)+"; "}break}}var x=new SBGrid.CT.Select1(w,z,v,s,q,P,t,n,o,M,L,u,f,C,b,g,h,p,I,G,c,y,N,a,H,E,D,null,l,F,"softbowl:select1",J,B,0,false,"","","","",K,e);return x};SBGrid.CT.Select1.createAttribute=function(b,a){b=SBGrid.CT.Select.createAttribute(b,a);return b};SBGrid.CT.SelectItem=function(a,c,b){this.m_parentWindow=window;if(!c){return}SBGrid.CT.Caption.call(this,a,"","","","","",true,"","",false,false,"",c,-1,"","","",0,b,"softbowl:selectitem","visible")};SBGrid.CT.SelectItem.prototype=new SBGrid.CT.Caption;SBGrid.CT.SelectItem.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this)};SBGrid.CT.SelectItem.prototype.setSelect=function(a){if(null==a){a=false}var f=this.getRefElement();if(null!=f){var e=f.m_heControl;if(null!=e){var m=SBGrid.DEF.is_ie?e.currentStyle.height:window.getComputedStyle(e,null).height;var c=SBGrid.DEF.is_ie?e.currentStyle.paddingRight:window.getComputedStyle(e,null).paddingRight;var g=SBGrid.DEF.is_ie?e.currentStyle.paddingTop:window.getComputedStyle(e,null).paddingTop;var d=SBGrid.DEF.is_ie?e.currentStyle.paddingBottom:window.getComputedStyle(e,null).paddingBottom;m=""!=m?"height:"+m+";":"";c=1<parseInt(c)?"padding-right:"+c+";":"";g=1<parseInt(g)?"padding-top:"+g+";":"";d=1<parseInt(d)?"padding-bottom:"+d+";":"";f.m_bSelect=a;var l=this.parent.getState(SBGrid.DEF.SB_CS_DISABLE);var h="";var i=this.parent.m_nAppearance;if(a){if(1==i){jQuery(e).removeClass("sbgrid_selectitem1").addClass("sbgrid_selectitem1_check")}else{if(2==i){jQuery(e).removeClass("sbgrid_selectitem2").addClass("sbgrid_selectitem2_check")}}if(l||f.disable){e.style.cssText=(m+c+g+d)+this.m_jsonCssEvent.disable}else{e.style.cssText=(m+c+g+d)+this.m_jsonCssEvent.itemselect}var b=e.style.backgroundImage;if(b){if(b.trim().substring(0,4)!="url("){b="url("+b+")"}window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '"+b+"';}",0)}else{window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '';}",0)}}else{if(1==i){jQuery(e).removeClass("sbgrid_selectitem1_check").addClass("sbgrid_selectitem1")}else{if(2==i){jQuery(e).removeClass("sbgrid_selectitem2_check").addClass("sbgrid_selectitem2")}}if(l||f.disable){e.style.cssText=(m+c+g+d)+this.m_jsonCssEvent.dedisable}else{e.style.cssText=(m+c+g+d)+this.m_jsonCssEvent.deselect}var b=e.style.backgroundImage;if(b){if(b.trim().substring(0,4)!="url("){b="url("+b+")"}window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '"+b+"';}",0)}else{window.setTimeout("var SBHE_Control_obj = document.getElementById('"+e.id+"');if(null != SBHE_Control_obj){SBHE_Control_obj.style.backgroundImage = '';}",0)}}}}};SBGrid.CT.SelectItem.create=function(b,g,a){var h=g.item("id")?g.item("id"):"";var l=new SBGrid.CT.SelectItem(b,h,a);var c=g.keys();l.m_jsonCssEvent.itemselect="";for(var e=0;e<c.length;e++){var f=c[e];if(-1!=f.indexOf("disable.select.")){var d=g.item(f);f=f.substring(15);if(-1!=f.indexOf("background-image")){d="url("+d+")"}l.m_jsonCssEvent.disable+=f+":"+d+";"}else{if(-1!=f.indexOf("disable.")){var d=g.item(f);f=f.substring(8);if(-1!=f.indexOf("background-image")){d="url("+d+")"}l.m_jsonCssEvent.dedisable+=f+":"+d+";"}else{if(-1!=f.indexOf("item.select.")){var d=g.item(f);f=f.substring(12);if(-1!=f.indexOf("background-image")){d="url("+d+")"}l.m_jsonCssEvent.itemselect+=f+":"+d+";"}else{if(-1!=f.indexOf("background-image")){var d=g.item(f);d="url("+d+")";l.m_jsonCssEvent.deselect=f+":"+d+";"}else{l.setAttribute(f,g.item(c[e]))}}}}}return l};SBGrid.DS.Choices=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.itemset};SBGrid.DS.Choices.prototype=new SBGrid.CT.Element;SBGrid.DS.Choices.prototype.init=function(){};SBGrid.DS.Choices.prototype.setItemset=function(a){this.itemset=a};SBGrid.DS.Choices.create=function(b,c){var a=new SBGrid.DS.Choices(b,c.item("id"),"softbowl:choices");a.parent.isnodeset=true;return a};SBGrid.DS.Itemset=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b);this.label;this.value};SBGrid.DS.Itemset.prototype=new SBGrid.CT.Element;SBGrid.DS.Itemset.prototype.init=function(){};SBGrid.DS.Itemset.prototype.setLabel=function(a){this.label=a};SBGrid.DS.Itemset.prototype.setValue=function(a){this.value=a};SBGrid.DS.Itemset.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"nodeset":if(null!=this.parent.parent){this.parent.parent.nodeset=b}break}};SBGrid.DS.Itemset.create=function(e,g){var d=new SBGrid.DS.Itemset(e,g.item("id"),"softbowl:itemset");var f=d.parent;var b=f.elementName;if("softbowl:treeview"==b){if(g.exists("nodeset")){f.m_bIsItemSet=true;var c=g.item("nodeset");var a=c.lastIndexOf("/");var h=c.substring(a+1);f.nodeset=c;f.m_strNodeSetName=h}}else{if("softbowl:choices"==b){if(g.exists("nodeset")){d.parent.parent.nodeset=g.item("nodeset")}}}return d};SBGrid.DS.Label=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.DS.Label.prototype=new SBGrid.CT.Element;SBGrid.DS.Label.prototype.init=function(){};SBGrid.DS.Label.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"ref":if(null!=this.parent.parent.parent){this.parent.parent.parent.labelref=b}break}};SBGrid.DS.Label.create=function(b,d){var e=new SBGrid.DS.Label(b,d.item("id"),"softbowl:label");var c=e.parent.parent;var a=c.elementName;if("softbowl:treeview"==a){if(d.exists("ref")){c.m_strLabelRef=d.item("ref")}}else{if("softbowl:choices"==a){if(d.exists("ref")){e.parent.parent.parent.labelref=d.item("ref")}e.parent.parent.parent.reBuild("init");e.parent.parent.parent.setDisabled(this.disabled)}}return e};SBGrid.DS.Value=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.DS.Value.prototype=new SBGrid.CT.Element;SBGrid.DS.Value.prototype.init=function(){};SBGrid.DS.Value.prototype.setAttribute=function(a,b){SBGrid.CT.Element.prototype.setAttribute.call(this,a,b);switch(a){case"ref":if(null!=this.parent.parent.parent){this.parent.parent.parent.valueref=b}break}};SBGrid.DS.Value.create=function(c,e){var b=new SBGrid.DS.Value(c,e.item("id"),"softbowl:value");var d=b.parent.parent;var a=d.elementName;if("softbowl:treeview"==a){if(e.exists("ref")){d.m_strValueRef=e.item("ref")}}else{if("softbowl:choices"==a){if(e.exists("ref")){b.parent.parent.parent.valueref=e.item("ref")}b.parent.parent.parent.reBuild("init");b.parent.parent.parent.setDisabled(this.disabled)}}return b};SBGrid.DS.Depth=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.DS.Depth.prototype=new SBGrid.CT.Element;SBGrid.DS.Depth.prototype.init=function(){};SBGrid.DS.Depth.create=function(a,c){var b=new SBGrid.DS.Depth(a,c.item("id"),"softbowl:depth");if(c.exists("ref")){b.parent.parent.m_strDepthRef=c.item("ref")}return b};SBGrid.CT.Image=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.Image.prototype=new SBGrid.CT.Element;SBGrid.CT.Image.prototype.init=function(){};SBGrid.CT.Image.create=function(b,c){var a=new SBGrid.CT.Image(b,c.item("id"),"softbowl:image");if(c.exists("ref")){a.parent.parent.m_strImageRef=c.item("ref")}return a};SBGrid.CT.SelectedImage=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.SelectedImage.prototype=new SBGrid.CT.Element;SBGrid.CT.SelectedImage.prototype.init=function(){};SBGrid.CT.SelectedImage.create=function(a,c){var b=new SBGrid.CT.SelectedImage(a,c.item("id"),"softbowl:selectedimage");if(c.exists("ref")){b.parent.parent.m_strSelectedImageRef=c.item("ref")}return b};SBGrid.CT.ExpandedImage=function(a,c,b){if(!c){return}SBGrid.CT.Element.call(this,a,c,b)};SBGrid.CT.ExpandedImage.prototype=new SBGrid.CT.Element;SBGrid.CT.ExpandedImage.prototype.init=function(){};SBGrid.CT.ExpandedImage.create=function(a,b){var c=new SBGrid.CT.ExpandedImage(a,b.item("id"),"softbowl:expandedimage");if(b.exists("ref")){c.parent.parent.m_strExpandedImageRef=b.item("ref")}return c};SBGrid.CT.Img=function(c,h,d,u,p,l,o,n,s,r,e,a,t,f,b,g,w,v,m,q,i){if(!a){return}SBGrid.CT.BindableControl.call(this,c,h,d,u,p,l,n,s,a,t,f,b,w,v,q,i);this.attribute.dragmode=String(r);this.attribute.dropmode=String(e);this.attribute.cache=String(o);this.attribute.src=g;this.attribute.upload=String(m);this.attribute.jsonref=String(b);this.src=g;this.upload=m;this.m_heUploadUI=null;this.m_bUploadUIVisible=false};SBGrid.CT.Img.prototype=new SBGrid.CT.BindableControl;SBGrid.CT.Img.prototype.getBindingType=function(){return SBGrid.DEF.SB_SINGLE};SBGrid.CT.Img.prototype.refresh=function(){if(null!=this.m_heControl){var strRef="";strRef=this.attribute.jsonref;if(null!=strRef&&""!=strRef){var strValue=eval(this.attribute.jsonref);this.setSrc(strValue)}strRef=this.attribute.ref;if(null!=strRef&&""!=strRef){var strValue=this.getValue(strRef);this.setSrc(strValue)}}};SBGrid.CT.Img.prototype.init=function(){SBGrid.CT.BindableControl.prototype.init.call(this);var c=document.getElementById("SBHE___SB_ImageUploadFrame");if(c){if(c.attachEvent){c.attachEvent("onload",SBGrid.CT.Img.uploadTempComplete)}else{c.addEventListener("load",SBGrid.CT.Img.uploadTempComplete,false)}}if(this.upload){this.createUploadUI()}var e=parseInt((this.m_heControl.style.border).replaceAll("px",""));var f=parseInt((this.m_heControl.style.borderLeft).replaceAll("px",""));var b=parseInt((this.m_heControl.style.borderTop).replaceAll("px",""));var d=parseInt((this.m_heControl.style.borderRight).replaceAll("px",""));var a=parseInt((this.m_heControl.style.borderBottom).replaceAll("px",""));if(""!=e&&null!=e){if(""!=f&&null){this.m_heControl.style.borderLeft=f}}};SBGrid.CT.Img.prototype.createUploadUI=function(){this.m_heUploadShadowUI=document.createElement("div");this.m_heUploadShadowUI.className="sbgrid_image_upload_shadow";this.m_heUploadShadowUI.style.visibility="hidden";this.m_heUploadShadowUI.style.top=this.getAttribute("top");this.m_heUploadShadowUI.style.left=this.getAttribute("left");this.m_heUploadShadowUI.style.width=this.getAttribute("width");this.m_heUploadShadowUI.style.height=this.getAttribute("height");this.m_heControl.parentNode.appendChild(this.m_heUploadShadowUI);this.m_heUploadUI=document.createElement("div");this.m_heUploadUI.setAttribute("id","SBHE_"+this.id);var e=this.m_heControl.className;if(""!=e){jQuery(this.m_heUploadUI).addClass(e)}this.m_heUploadUI.style.top=this.getAttribute("top");this.m_heUploadUI.style.left=this.getAttribute("left");this.m_heUploadUI.style.width=this.getAttribute("width");this.m_heUploadUI.style.overflow="hidden";this.m_heControl.parentNode.appendChild(this.m_heUploadUI);var d=document.createElement("button");d.id="SBHE_"+this.id+".detach";var h="";if(this.m_clCSSName.exists("img_detach")){h=this.m_clCSSName.item("img_detach")}jQuery(d).addClass("sbgrid_image_detach "+h);d.parent=this;d.style.right="4px";d.style.top="4px";d.style.width="16px";d.style.height="16px";d.style.backgroundColor="transparent";d.onclick=function(){SBGrid.CT.Img.deleteFile(this.parent.id)};this.m_heUploadUI.appendChild(d);var c=new SBGrid.CT.Button(this.id,"","","","","",false,"","",false,false,"","","",this.id+".detach",-1,"","",-1,false,"","softbowl:button","visible");c.init();var b=document.createElement("div");b.id="SBHE_"+this.id+".attach";b.style.left="50%";b.style.top="50%";b.style.width="32px";b.style.height="32px";b.style.fontSize="0pt";b.style.overflow="hidden";var f="";if(this.m_clCSSName.exists("img_attach")){f=this.m_clCSSName.item("img_attach")}jQuery(b).addClass("sbgrid_image_attach "+f);this.m_heUploadUI.appendChild(b);var g=new SBGrid.CT.Button(this.id,"","","","","",false,"","",false,false,"","","",this.id+".attach",-1,"","",-1,false,"","softbowl:button","visible");g.init();b.style.marginLeft=(b.offsetWidth/-2)+"px";b.style.marginTop=(b.offsetHeight/-2)+"px";var a=document.createElement("form");a.id="SBHE___SB_ImageUploadForm_"+this.id;a.name="SBHE___SB_ImageUploadForm_"+this.id;a.action=SBGrid.DEF.__getAppName()+"/FileUpload.tfs";a.method="post";a.encoding="multipart/form-data";a.enctype="multipart/form-data";a.target="SBHE___SB_ImageUploadFrame";a.style.backgroundColor="transparent";b.appendChild(a);this.createUploadFileInput()};SBGrid.CT.Img.prototype.createUploadFileInput=function(d){var d=document.getElementById("SBHE___SB_ImageUploadForm_"+this.id);d.style.left="0px";d.style.top="0px";d.style.width="100%";d.style.height="100%";var c=document.getElementById("SBHE_ImageInput_"+this.id);if(c){d.removeChild(c)}var a=document.createElement("input");a.id="SBHE_ImageInput_"+this.id;a.name="SBHE_ImageInput_"+this.id;a.type="file";a.onchange=function(){var g=this.parentNode.id.replace("SBHE___SB_ImageUploadForm_","");SBGrid.CT.Img.submitFile(g);document.SBHE_controls.item(g).createUploadFileInput()};d.appendChild(a);var e=document.getElementById("SBHE_"+this.id+".attach");var b=e.offsetHeight;var f=e.offsetWidth;a=document.getElementById("SBHE_ImageInput_"+this.id);a.style.filter="alpha(opacity = 0)";a.style.opacity=0;a.style.left="0px";a.style.top="0px";a.style.width="100%";a.style.height="100%"};SBGrid.CT.Img.prototype.showUploadUI=function(){if(this.upload){this.m_bUploadUIVisible=true;this.m_heUploadUI.style.visibility="";this.m_heUploadShadowUI.style.visibility="";var c=this.getAttribute("top");var d=this.getAttribute("left");var b=this.getAttribute("width");var a=this.getAttribute("height");this.m_heUploadUI.style.top=parseInt(c)+"px";this.m_heUploadUI.style.left=parseInt(d)+"px";this.m_heUploadUI.style.width=parseInt(b)+"px";this.m_heUploadUI.style.height=parseInt(a)+"px"}};SBGrid.CT.Img.prototype.hideUploadUI=function(){if(this.upload){this.m_bUploadUIVisible=false;this.m_heUploadUI.style.visibility="hidden";this.m_heUploadShadowUI.style.visibility="hidden"}};SBGrid.CT.Img.prototype.deleteFile=function(){if(""!=this.src){this.setSrc("");if(this.attribute.jsonref!=""){eval(this.attribute.jsonref+"='';")}else{SBGrid.DS.XMLStorage.getUniqueStorage().setValue(this.attribute.ref,"")}this.refresh()}};SBGrid.CT.Img.prototype.submitFile=function(){var b=document.getElementById("SBHE_ImageInput_"+this.id);var a=document.getElementById("SBHE___SB_ImageUploadForm_"+this.id);a.submit()};SBGrid.CT.Img.prototype.setAttachedFile=function(a,b){this.setSrc(b);this.setValue(a+"|"+b)};SBGrid.CT.Img.prototype.setAttribute=function(a,b){SBGrid.CT.BindableControl.prototype.setAttribute.call(this,a,b);switch(a){case"cache":this.attribute.cache=b;break;case"src":this.attribute.src=b;this.src=b;this.m_heControl.src=b;break}};SBGrid.CT.Img.prototype.setSrc=function(b){if(this.upload&&-1<b.indexOf("|")){var a=b.split("|");if(2==a.length){b=a[1]}}if(this.src!=b){this.attribute.src=b;this.src=b;if(b==""){this.m_heControl.src="data:image/png;base64,"}else{this.m_heControl.src=b}}};SBGrid.CT.Img.prototype.onClick=function(a){SBGrid.CT.BindableControl.prototype.onClick.call(this,a);if(SBGrid.DEF.is_smartphone&&this.upload){(this.m_bUploadUIVisible)?this.hideUploadUI():this.showUploadUI()}};SBGrid.CT.Img.prototype.onMouseMove=function(a){if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){SBGrid.DEF.bDragDrop=true;this.m_bDragStart=true;a.capture="";a.drag=this.id;this.dispatch("ondragstart");if(this.m_bLButtonDown&&""!=this.getAttribute("dropmode")&&"false"!=this.getAttribute("dropmode")){this.dispatch("ondragenter");this.dispatch("ondragover")}}else{SBGrid.CT.Control.prototype.onMouseMove.call(this,a)}};SBGrid.CT.Img.prototype.onMouseDown=function(a){SBGrid.CT.Control.prototype.onMouseDown.call(this,a);this.m_bLButtonDown=true};SBGrid.CT.Img.prototype.onMouseUp=function(a){SBGrid.CT.Control.prototype.onMouseUp.call(this,a);this.m_bLButtonDown=false};SBGrid.CT.Img.prototype.onMouseEnter=function(a){SBGrid.CT.BindableControl.prototype.onMouseEnter.call(this,a);if(this.upload){this.showUploadUI()}};SBGrid.CT.Img.prototype.onMouseOut=function(a){SBGrid.CT.BindableControl.prototype.onMouseOut.call(this,a);if(this.upload&&a.pTarget.parent!=this&&a.pTarget!=this){this.hideUploadUI()}};SBGrid.CT.Img.deleteFile=function(b){var a=document.SBHE_controls.item(b);if(null!=a&&a instanceof SBGrid.CT.Img){a.deleteFile()}};SBGrid.CT.Img.submitFile=function(b){var a=document.SBHE_controls.item(b);if(null!=a&&a instanceof SBGrid.CT.Img){a.submitFile()}};SBGrid.CT.Img.uploadTempComplete=function(){var i=document.getElementById("SBHE___SB_ImageUploadFrame").contentWindow.document;var f;if(SBGrid.DEF.is_ie){if(i.XMLDocument){f=i.XMLDocument.xml}else{var h=new XMLSerializer();f=h.serializeToString(i)}}else{var h=new XMLSerializer();f=h.serializeToString(i)}if(f){var a=SBGrid.UT.XmlLib.loadXMLFromString(f);if(a.selectSingleNode("/root")){var m=a.selectSingleNode("/root/tagName");var b=a.selectSingleNode("/root/fileName");var d=a.selectSingleNode("/root/tempName");var g=SBGrid.UT.XmlLib.getTextValue(m);var l=SBGrid.UT.XmlLib.getTextValue(b);var e=SBGrid.UT.XmlLib.getTextValue(d);var c=document.SBHE_controls.item(g.substr("SBHE_ImageInput_".length));if(null!=c){c.setAttachedFile(l,e)}}}};SBGrid.CT.Img.create=function(b,d,e){d=SBGrid.CT.Element.createClassName(d,"img");var a=SBGrid.CT.Img.createMainNode(d);var c=document.getElementById("SBHE_"+b);c.appendChild(a);a=SBGrid.CT.Img.createSubNodes(a,d);return SBGrid.CT.Img.createObject(b,a,d,e)};SBGrid.CT.Img.createMainNode=function(b){var a=document.createElement("img");a.setAttribute("alt",this.id);a=SBGrid.CT.Img.createAttribute(a,b);jQuery(a).addClass("sbgrid_image");jQuery(a).addClass("sbgrid_boxsizing");return a};SBGrid.CT.Img.createSubNodes=function(a,b){return a};SBGrid.CT.Img.createObject=function(c,q,z,B){var m="";var d="";var A="";var u="";var o="";var t=true;var r="";var x=false;var w=false;var g=false;var a="";var y=9007199254740992;var h="";var b="";var l="";var p=false;var v="visible";var n="";for(var s=0;s<z.count();s++){var f=z.keys()[s];switch(f){case"alert":m=z.item(f);break;case"help":d=z.item(f);break;case"hint":A=z.item(f);break;case"accesskey":u=z.item(f);break;case"bind":o=z.item(f);break;case"cache":if("false"==z.item(f)){t=false}break;case"class":r=z.item(f);break;case"disabled":if("true"==z.item(f)){x=true}break;case"dragmode":if("true"==z.item(f)){w=true}break;case"dropmode":if("true"==z.item(f)){g=true}break;case"id":a=z.item(f);break;case"navindex":y=parseInt(z.item(f));break;case"ref":h=z.item(f);break;case"jsonref":b=z.item(f);break;case"src":l=z.item(f);break;case"visibility":v=z.item(f);break;default:if(!SBGrid.DEF.SB_STYLELIST[f]){n+=f+":"+z.item(f)+"; "}break}}var e=new SBGrid.CT.Img(c,m,d,A,u,o,t,r,x,w,g,a,y,h,b,l,B,"softbowl:img",p,v,n);return e};SBGrid.CT.Img.createAttribute=function(b,a){b=SBGrid.CT.BindableControl.createAttribute(b,a);return b};SBGrid.UT.GridStatusManager=function(){this.m_nRow=-1;this.m_nCol=-1;this.m_strText="";this.m_dwUpdataFlag=0;this.m_arDeleteData=new Array();this.m_arDeleteDataXml=new Array()};SBGrid.UT.GridStatusManager.prototype.getModifyRow=function(){return this.m_nRow};SBGrid.UT.GridStatusManager.prototype.setModifyRow=function(a){this.m_nRow=a};SBGrid.UT.GridStatusManager.prototype.getModifyCol=function(){return this.m_nCol};SBGrid.UT.GridStatusManager.prototype.setModifyCol=function(a){this.m_nCol=a};SBGrid.UT.GridStatusManager.prototype.getModifyText=function(){return this.m_strText};SBGrid.UT.GridStatusManager.prototype.setModifyText=function(a){this.m_strText=a};SBGrid.UT.GridStatusManager.prototype.getUpdateFlag=function(){return this.m_dwUpdataFlag};SBGrid.UT.GridStatusManager.prototype.setUpdateFlag=function(a){this.m_dwUpdataFlag=a};SBGrid.UT.GridStatusManager.prototype.getArrayDelete=function(){return this.m_arDeleteData};SBGrid.UT.GridStatusManager.prototype.getArrayDeleteXml=function(){return this.m_arDeleteDataXml};SBGrid.CT.DataGrid=function(strParentId,strAlert,strHelp,strHint,bAllowBigSelection,bAllowSelection,bAllowUserResize,bAutoResize,bAutoSizeMouse,strBackColorAlternate,strBackColorFrozen,strCaption,strCaptionLayout,strClass,strColSep,strColWidth,strDataHeight,strDataType,nDefaultRows,strDeleteFlagImage,bDisabled,bDragmode,bDropmode,bEllipsis,strExplorerbar,strExplorerUI,strExtendLastCol,nFixedCols,strFocusColor,strForeColorFrozen,nFrozenBottomRows,nFrozenCols,nFrozenRows,strId,strInsertFlagImage,strMergeCells,strMergeCellsFixedCols,strMergeCellFixedRows,bMultiTotal,strNodeSet,strJsonRef,strNormalFlagImage,strOverflow,bRemoveHScroll,bRemoveVScroll,strRowHeader,strRowHeight,nRows,strRowSep,strScroll,strSelectFontColorStyle,strSelectImageStyle,strSelectMode,strSubTotalPosition,strStyle,strTag,strToolTip,strUpdateFlagImage,strVisibility,strWallPaper,bIsDecimalFormatInsert,strUserDefineAttrib,strSummary,bAutoResizeCaption,strDataReplace){if(!strId){return}this.m_heLodExcelForm=null;this.m_strTargetGrid=strId;this.m_strGridJsonReg=strJsonRef!=null?strJsonRef:"";this.createDefaultHtmlTag(strParentId,strId,strStyle);SBGrid.CT.Group.call(this,strParentId,strAlert,strHelp,strHint,"","",strClass,bDisabled,strId,0,strOverflow,"","","",strScroll,"",strStyle,strTag,strVisibility,strUserDefineAttrib);strCaption=strCaption.split("__SB_STR_N").join("\\n");strCaption=strCaption.split("__SB_STR_T").join("\\t");strCaption=strCaption.split("__SB_STR_R").join("\\r");strCaption=strCaption.split("__SB_N").join("\n");strCaption=strCaption.split("__SB_T").join("\t");strCaption=strCaption.split("__SB_R").join("\r");if(strJsonRef==""&&strDataType=="delimeter"){strJsonRef=strId+"_delimeterData"}this.attribute.allowbigselection=String(bAllowBigSelection);this.attribute.allowselection=String(bAllowSelection);this.attribute.allowuserresize=String(bAllowUserResize);this.attribute.autoresize=String(bAutoResize);this.attribute.autosizemouse=String(bAutoSizeMouse);this.attribute.backcoloralternate=strBackColorAlternate;this.attribute.backcolorfrozen=strBackColorFrozen;this.attribute.caption=strCaption;this.attribute["caption-layout"]=strCaptionLayout;this.attribute.colsep=strColSep;this.attribute.colwidth=strColWidth;this.attribute.dataheight=strDataHeight;this.attribute.datatype=strDataType;this.attribute.defaultrows=String(nDefaultRows);this.attribute.deleteflagimage=strDeleteFlagImage;this.attribute.dragmode=String(bDragmode);this.attribute.dropmode=String(bDropmode);this.attribute.ellipsis=String(bEllipsis);this.attribute.explorerbar=strExplorerbar;this.attribute.explorerui=strExplorerUI;this.attribute.extendlastcol=strExtendLastCol;this.attribute.fixedcols=String(nFixedCols);this.attribute.focuscolor=strFocusColor;this.attribute.forecolorfrozen=strForeColorFrozen;this.attribute.frozenbottomrows=String(nFrozenBottomRows);this.attribute.frozencols=String(nFrozenCols);this.attribute.frozenrows=String(nFrozenRows);this.attribute.insertflagimage=strInsertFlagImage;this.attribute.mergecells=strMergeCells;this.attribute.mergecellsfixedcols=strMergeCellsFixedCols;this.attribute.mergecellsfixedrows=strMergeCellFixedRows;this.attribute.multitotal=String(bMultiTotal);this.attribute.nodeset=strNodeSet;this.attribute.jsonref=strJsonRef;this.attribute.normalflagimage=strNormalFlagImage;this.attribute.removehscroll=String(bRemoveHScroll);this.attribute.removevscroll=String(bRemoveVScroll);this.attribute.rowheader=strRowHeader;this.attribute.rowheight=strRowHeight;this.attribute.rows=String(nRows);this.attribute.rowsep=strRowSep;this.attribute.selectfontcolorstyle=strSelectFontColorStyle;this.attribute.selectimagestyle=strSelectImageStyle;this.attribute.selectionmode=strSelectMode;this.attribute.subtotalposition=strSubTotalPosition;this.attribute.tooltip=strToolTip;this.attribute.updateflagimage=strUpdateFlagImage;this.attribute.wallpaper=strWallPaper;this.attribute.decimalformatinsert=String(bIsDecimalFormatInsert);this.attribute.scrollmakecell="false";this.attribute.summary=strSummary;this.attribute.datareplace=strDataReplace;this.allowBigSelection=bAllowBigSelection;this.allowSelection=bAllowSelection;this.allowUserResize=bAllowUserResize;this.allStyle;this.autoMerge=true;this.autoResize=bAutoResize;this.autoSizeMouse=bAutoSizeMouse;this.backColorAlternate=strBackColorAlternate;this.backColorFrozen=strBackColorFrozen;this.caption=strCaption;this.cellAttribute;this.cellComboNodeset;this.cellComboJson;this.cellStyle;this.checkImage;this.col=-1;this.colDisabled;this.cols;this.colSort;this.colStatus;this.colStyle;this.colType;this.m_arColWidth=new Array();this.colWidthMax=9999;this.colWidthMin=3;this.dataHeight=""==strDataHeight?20:parseInt(strDataHeight);this.disabledCheckImage;this.disabledSelectImage;this.disabledUncheckImage;this.disabledUnselectImage;this.explorerbar=strExplorerbar;this.explorerui=strExplorerUI;this.extendLastCol=strExtendLastCol;this.ellipsis=bEllipsis;this.fixedcellcheckbox;this.fixedcellischeck;this.fixedCols=nFixedCols;this.fixedRows;this.focusColor=strFocusColor;this.foreColorFrozen=strForeColorFrozen;this.frozenBottomRows=nFrozenBottomRows;this.frozenCols=nFrozenCols;this.frozenRows=nFrozenRows;this.getGroupCollapsed;this.isSelected;this.leftCol;this.mergeCells=strMergeCells;this.mergeCellsFixedCols=strMergeCellsFixedCols;this.mergeCellsFixedRows=strMergeCellFixedRows;this.mergeCol;this.mergeRow;this.mouseCol;this.mouseRow;this.multiselect;this.multiTotals=bMultiTotal;this.nodeset=strNodeSet;this.jsonref=strJsonRef;this.group=0;this.groupCol=0;this.groupLevelCol=null;this.rightCol;this.row=-1;this.rowheader=strRowHeader;this.m_nRowHeight=""==strRowHeight?20:parseInt(strRowHeight);this.rowHeightMax=9999;this.rowHeightMin=19;this.rows;this.rowStatus;this.rowStyle;this.select;this.selectedRow;this.selectedRows;this.selectFontColorStyle=strSelectFontColorStyle;this.selectImage;this.selectImageStyle=strSelectImageStyle;this.selectionMode;this.seqRowHeader=1;this.sort;this.subtotalPosition=strSubTotalPosition;this.topRow=0;this.bottomRow=0;this.unCheckImage;this.unSelectImage;this.updateImage;this.valueMatrix;this.wallPaper=strWallPaper;this.m_strTooltip=strToolTip;this.m_objUpdate=new SBGrid.UT.GridStatusManager();this.m_htRowHeight=new SBGrid.DS.Hashtable();this.m_bRowHeader=!strRowHeader.isEmpty();this.m_bIsChangeItem=false;this.m_arColumn=new Array();this.m_arCaption=new Array();this.m_arCombo=new Array();this.m_heGridWhole;this.m_heGridFFScrollRow;this.m_heGridFFNoScrollRow;this.m_heGridFFCol;this.m_heGridFFBScrollRow;this.m_heGridFFBNoScrollRow;this.m_heGridMergeCell;this.m_heHGuideLine;this.m_heVGuideLine;this.m_heMoveColumnBar;this.m_objInput;this.m_objCombo;this.m_objTextArea;this.m_nPrevX;this.m_nPrevY;this.m_nEditRow=-1;this.m_nEditCol=-1;this.m_nPrevDownRow=-1;this.m_nPrevDownCol=-1;this.m_nDownRow=-1;this.m_nDownCol=-1;this.m_strPrevCursor="";this.m_resizeInfo={m_nCurX:0,m_nCurY:0};this.m_arSelectRows;this.m_arSelectCols;this.m_htSelectCells;this.m_bModify=false;this.m_bEditing=false;this.m_bChangedItem=false;this.m_bColChangeStatus=false;this.m_bClearCaption=false;this.m_bAfterResize;this.m_nDefaultRows=nDefaultRows;this.m_nRealRows=0;this.m_strDeleteFlagImage=(""==strDeleteFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHDelete:strDeleteFlagImage);this.m_strInsertFlagImage=(""==strInsertFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHInsert:strInsertFlagImage);this.m_strNormalFlagImage=(""==strNormalFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHNew:strNormalFlagImage);this.m_strUpdateFlagImage=(""==strUpdateFlagImage?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHUpdate:strUpdateFlagImage);this.m_arHiddenCol=new Array();this.m_arHiddenRow;this.m_arHiddenRowState=new Array();this.m_arUpdateDeleteList=new Array();this.m_nHideColumnsCount;this.m_clIndexes=new SBGrid.DS.Collection();this.m_clFilteringHistoryStack=new SBGrid.DS.Collection();if(SBGrid.DEF.is_smartphone){this.m_nOriginWidth=0;this.m_nOriginHeight=0}this.m_htDataStyle=null;this.m_htFixedStyle=null;this.m_bIsExplorerBar=false;this.m_nExplorerBarType=-1;this.m_bIsExplorerUI=false;this.m_nExplorerUIType=-1;this.m_bIsFirstMoveColumn=false;this.m_bHasItem;this.m_heWait=null;this.m_htColSort=new SBGrid.DS.Hashtable();this.m_nSortType=SBGrid.DEF.SBST_ASC;this.m_htRowSubTotal=new SBGrid.DS.Hashtable();this.m_nMakeIndex=0;this.m_nBottomRowCount=0;this.m_arMergeList=new Array();this.m_arMergeByFreeList=new Array();this.m_arMergeFixedRowList=new Array();this.m_arMergeFixedColList=new Array();this.m_htMergeFRColList=new SBGrid.DS.Hashtable();this.m_htMergeFCColList=new SBGrid.DS.Hashtable();this.m_htMergeColList=new SBGrid.DS.Hashtable();this.m_bChangeFixedRows=false;this.m_arFixedRowHiddenStatus=new Array();this.m_bIsShowItem=false;this.m_bIsSort=false;this.m_arSortNodeList=null;this.m_arSortJson=null;this.m_bIsMakeCellStatus=false;this.m_objGridData=null;this.m_nlightGridTime=null;this.m_nlightGridLine=0;this.m_bIsMaxLength=false;this.m_bIsRowHeight=""!=strRowHeight;this.m_objScroll={bScrollEvent:false,bUpProcess:true,bDownProcess:true,nMaxLength:0,nBottom:0,nStartRow:0,nEndRow:0,nTopRow:0,nBottomRow:0,nPosition:0,nTargetTop:0,nTargetHeight:0,heTargetTable:null,nScrollDivHeight:0,arScrollLength:new Array(),arTargetRow:new Array()};this.m_objHeArea={bTotalHiddenCheck:false,bCheckWidth:null,bChangeWidth:null,bCheckHeight:null};this.m_bScrollRock=false;this.m_objGroup=new Array();this.m_scrollSetTime=null;this.m_arCellStyleTable=new Array();this.m_htCellFormat=new SBGrid.DS.Hashtable();if(strDataType=="delimeter"){arLightgrid.push({id:strId,nodeset:strNodeSet,jsonref:strJsonRef});this.jsonref=strId+"_delimeterData"}this.m_bIsShowCombo=false;this.m_nReScrollPosition=null;this.autoResizeCaption=bAutoResizeCaption;this.m_replaceString=strDataReplace;if(typeof this.backColorFrozen=="undefined"){this.backColorFrozen=""}eval("window."+strId+"_delimeterData = new Array();")};SBGrid.CT.DataGrid.prototype=new SBGrid.CT.Group;SBGrid.CT.DataGrid.prototype.AddColSelect=function(d){if(this.getAllowSelection()&&SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectCols,d);if(-1==a){this.m_arSelectCols.push(d);for(var c=this.fixedRows;c<this.rows;c++){var b=this.getCell(c,d);if(null!=b){this.setCellSelect(b,true)}}}}};SBGrid.CT.DataGrid.prototype.AddFreeSelect=function(b,c){if(this.getAllowSelection()&&SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){var a=this.getCell(b,c);if(null!=a){this.setCellSelect(a,true)}}};SBGrid.CT.DataGrid.prototype.AddListSelect=function(d){if(this.getAllowSelection()&&SBGrid.DEF.SBSM_LIST==this.getSelectionMode()){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,d);if(-1==a){this.m_arSelectRows.push(d);for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCell(d,c);if(null!=b){this.setCellSelect(b,true)}}}this.selectedRows=this.m_arSelectRows.length}};SBGrid.CT.DataGrid.prototype.addColumn=function(a,b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".addColumn","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".addColumn","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(null==b){b=true}else{if(typeof b!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".addColumn","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(this.hasInstance()||this.isJsonRef()){this.addColumnHasInstance(a,b)}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.m_heGridFFScrollRow.style.width=this.m_heGridWhole.clientWidth+"px";this.m_heGridFFBScrollRow.style.width=this.m_heGridWhole.clientWidth+"px";this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.addRow=function(c,b,a){if(null==c){c=true}if(null==b){b=false}if(null==a){a=false}if(this.hasInstance()||this.isJsonRef()){this.addRowHasInstance(c,b,a);if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.insertRow=function(c,d,e,b,a){if(null==c||0>c||c>=this.rows){if(this.fixedRows==this.rows){c=0}else{return}}if(null==e){e=true}if(null==b){b=false}if(null==d){d="above"}if(null==c||c>=this.m_nRealRows){return}if("above"==d&&c<(this.fixedRows)){return}if(null==a){a=false}if(c==(this.m_nRealRows-1)&&"below"==d){this.addRow(e,b,a);return}if(this.hasInstance()||this.isJsonRef()){this.insertRowHasInstance(c,d,e,b,a);if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.deleteRow=function(b,c,a){if(null==b||b<this.fixedRows||b>=this.m_nRealRows){return}if(b==(this.m_nRealRows-1)){this.removeRow(c,a);return}if(null==c){c=true}if(null==a){a=false}if(this.hasInstance()||this.isJsonRef()){this.deleteRowHasInstance(b,c,a);if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.insertColumn=function(d,a,b,c){if(null==d||0>d||d>=this.cols){return}if(d==(this.cols-1)&&"after"==b){this.addColumn(a,c);return}if(null==c){c=true}if(null==b){b="before"}if(this.hasInstance()||this.isJsonRef()){this.insertColumnHasInstance(d,a,b,c)}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.deleteColumn=function(b,a){if(null==b||0>b||b>=this.cols){return}if(b==(this.cols-1)){this.removeColumn(a);return}if(b>=this.cols){return}if(null==a){a=true}if(this.hasInstance()||this.isJsonRef()){this.deleteColumnHasInstance(b,a)}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.removeRow=function(b,a){if(null==b){b=true}if(null==a){a=false}if(this.hasInstance()||this.isJsonRef()){this.RemoveRowHasInstance(b,a);if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.removeColumn=function(a){if(null==a){a=true}else{if(typeof a!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".removeColumn","Please check if parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(this.hasInstance()||this.isJsonRef()){this.RemoveColumnHasInstance(a)}else{}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}};SBGrid.CT.DataGrid.prototype.init=function(){SBGrid.CT.Group.prototype.init.call(this);this.userGridCss();if(null==this.attribute.pageselection){this.attribute.pageselection="true"}this.m_objFixedCell=this.createChild("softbowl:gridfixedcell","id:"+this.id+".fixed-cell");this.m_objInput=this.createChild("softbowl:gridinput","id:"+this.id+"_input;decimalformatinsert:"+this.getAttribute("decimalformatinsert"));this.m_objInput.m_bDependentCtl=true;if(this.m_htFixedStyle){for(var e in this.m_htFixedStyle){this.m_objFixedCell.attribute[e]=this.m_htFixedStyle[e]}}if(SBGrid.DEF.is_smartphone){this.m_nOriginWidth=this.m_heControl.offsetWidth;this.m_nOriginHeight=this.m_heControl.offsetHeight}this.initGridProperties();var b=this.children.keys();for(var c=0;c<b.length;c++){var a=b[c];var d=this.getCellById(a);if(null!=d&&"softbowl:cell"!=d.elementName){d.init()}}this.applyColStyleInheritanceCellCSS();this.applyBaseCellCSS("fixed");this.applyBaseCellCSS("data");this.applyFocusColorCss();this.makeGrid();this.setOverflowGrid(this.attribute.overflow);if(SBGrid.DEF.is_smartphone){var b=this.children.keys();for(var c=0;c<b.length;c++){var a=b[c];var d=this.getCellById(a);if(null!=d&&"softbowl:col"!=d.elementName){d.init()}}}this.colGroupNameSpace();this.setSeqForRowHeader();if(0<this.cols){this.m_bHasItem=true}window.setTimeout("SBGrid.getGrid('"+this.id+"').resize()",0);if(this.m_objScroll.bScrollEvent){this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow)}this.defaultAttributeSetting(!SBGrid.DEF.is_smartphone);if(this.autoMerge){this.merge()}if(SBGrid.DEF.is_ie){window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heGridFFScrollRow.style.height = SBGrid.getGrid('"+this.id+"').m_heGridFFScrollRow.firstChild.offsetHeight + 'px'}catch(e){}",0);window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heGridFFNoScrollRow.style.height = SBGrid.getGrid('"+this.id+"').m_heGridFFNoScrollRow.firstChild.offsetHeight + 'px'}catch(e){}",0)}if(this.isPossibleFiltering()){if(this.jsonref!=""){this.createIndexesForFiltering();this.initFilteringHistoryStack()}}if(this.autoResizeCaption){this.autoResizeCaptionWidth()}this.dispatch("ongridrebuild")};SBGrid.CT.DataGrid.prototype.executeCalculate=function(){if(this.fixedRows<this.rows){for(var i=this.fixedCols;i<this.cols;i++){var objColumn=this.getColumnControl(i);var strCalc=objColumn.getAttribute("calc");if(""!=strCalc){for(var j=this.fixedRows;j<this.rows;j++){var objCell=this.getCell(j,i);var objCol=objCell.getElement();var strCalc=objCol.getAttribute("calc");if(""!=strCalc){var strCalcName=strCalc.substring(0,strCalc.indexOf("("));var strCalcParam="(this.id, "+j.toString()+", "+i.toString()+")";strCalc=strCalcName+strCalcParam;var strResult=eval(strCalc);if(null!=strResult){SBGrid.CF.GridSetText(objCell,strResult)}}}}}}};SBGrid.CT.DataGrid.prototype.createIndexesForFiltering=function(){this.m_clIndexes=new SBGrid.DS.Collection();var b=this.m_bRowHeader?1:0;for(var a=0+b;a<this.getCols();a++){this.m_clIndexes.add(this.valueMatrix(0,a),this.getIndexDataOfSelectedColumn(a))}};SBGrid.CT.DataGrid.prototype.initFilteringHistoryStack=function(){this.m_clFilteringHistoryStack=new SBGrid.DS.Collection();var b=new Array();for(var a=1;a<this.getRows();a++){b.push(a)}this.m_clFilteringHistoryStack.add("TOTAL_ROW_LIST",b.splice(0))};SBGrid.CT.DataGrid.prototype.refresh=function(a){SBGrid.CT.Group.prototype.refresh.call(this);if(this.hasInstance()||this.isJsonRef()){this.refreshForHasInstance(a)}else{this.refreshForHasNotInstance()}if(SBGrid.DEF.is_ie){window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heGridFFScrollRow.style.height = SBGrid.getGrid('"+this.id+"').m_heGridFFScrollRow.firstChild.offsetHeight + 'px'}catch(e){}",0);window.setTimeout("try{SBGrid.getGrid('"+this.id+"').m_heGridFFNoScrollRow.style.height = SBGrid.getGrid('"+this.id+"').m_heGridFFNoScrollRow.firstChild.offsetHeight + 'px'}catch(e){}",0)}this.executeCalculate()};SBGrid.CT.DataGrid.prototype.rebuild=function(){this.m_arUpdateDeleteList=new Array();if(this.hasInstance()||(this.isJsonRef()&&-1==this.jsonref.indexOf("_delimeterData"))){this.rebuildForHasInstance()}else{this.rebuildForHasNotInstance()}};SBGrid.CT.DataGrid.prototype.rebuildForHasNotInstance=function(){var strJsonRef=this.getAttribute("jsonref");eval(strJsonRef+"= new Array();");this.refresh()};SBGrid.CT.DataGrid.prototype.colRef=function(a){for(var b=this.fixedCols;b<this.cols;b++){if(null!=this.m_arColumn[b]){if(a.localeCompare(this.m_arColumn[b].getAttribute("ref"))==0){return b}}}return -1};SBGrid.CT.DataGrid.prototype.getColRef=function(a){return this.colRef(a)};SBGrid.CT.DataGrid.prototype.findRow=function(l,b,g,a,h){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof l)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(b==null){b=this.fixedRows}else{if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(g==null){g=this.fixedCols}else{if(typeof g!="number"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if 3rd parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}}if(a==null){a=false}else{if(typeof a!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if 4th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(h==null){h=false}else{if(typeof h!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".findRow","Please check if 5th parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}for(var e=b;e<this.m_nRealRows;e++){for(var d=g;d<this.cols;d++){var c=this.getCell(e,d);if(null!=c){var f=SBGrid.CF.GridGetText(c);if(a&&h){if(f.localeCompare(l)==0){return e}}else{if(a&&!h){if(f.indexOf(l)!=-1){return e}}else{if(!a&&h){l=l.toUpperCase();f=f.toUpperCase();if(f.localeCompare(l)==0){return e}}else{if(!a&&!h){l=l.toUpperCase();f=f.toUpperCase();if(f.indexOf(l)!=-1){return e}}}}}}}}return -1};SBGrid.CT.DataGrid.prototype.setTopRow=function(c){var a=0;c=c>this.m_nRealRows?this.m_nRealRows:c;for(var b=this.fixedRows;b<c;b++){if(this.isRowHidden(b)){continue}a+=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}this.m_heGridWhole.scrollTop=a;this.topRow=c};SBGrid.CT.DataGrid.prototype.setTopBottomRowPosition=function(){var a=this.m_heGridWhole.scrollTop;var c=0;var b=0;for(var e=0;e<this.fixedRows;e++){b+=this.m_htRowHeight[e]?this.m_htRowHeight[e]:this.rowHeight}var f=a+(this.m_heGridWhole.clientHeight-b);for(var e=this.fixedRows;e<this.m_nRealRows;e++){c+=this.m_htRowHeight[e]?this.m_htRowHeight[e]:this.dataHeight;if(0>(a-c)){this.topRow=e;for(var d=e+1;d<this.m_nRealRows;d++){c+=this.m_htRowHeight[d]?this.m_htRowHeight[d]:this.dataHeight;if(0>(f-c)){this.bottomRow=d;return}}}}};SBGrid.CT.DataGrid.prototype.setBottomRow=function(c){var a=0;c=c>this.m_nRealRows-1?this.m_nRealRows-1:c;for(var b=0;b<=c;b++){if(this.isRowHidden(b)){continue}a+=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.rowHeight}a=(a-this.m_heGridWhole.clientHeight)-1;if(a<0){a=0}this.m_heGridWhole.scrollTop=a;this.bottomRow=c};SBGrid.CT.DataGrid.prototype.textMatrix=function(a,b){if(this.isFixedCell(a,b)){return this.labelMatrix(a,b)}else{return this.valueMatrix(a,b)}};SBGrid.CT.DataGrid.prototype.setTextMatrix=function(a,c,b){if(arguments.length!=3){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setTextMatrix","Please check if third parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}this.setValueMatrix(a,c,b)};SBGrid.CT.DataGrid.prototype.getTextMatrix=function(a,b){if(arguments.length!=2){SBGrid.DEF.APIerrorMsg(this.id+".getTextMatrix","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getTextMatrix","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getTextMatrix","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}return this.valueMatrix(a,b)};SBGrid.CT.DataGrid.prototype.labelMatrix=function(c,f){var d=this.getCell(c,f);if(null!=d){if(this.isFixedCell(c,f)){var i=d.m_heControl;if(SBGrid.DEF.is_ie){return i.innerText}else{return i.textContent}}else{var a=d.getElement();if(a){if(SBGrid.DEF.SBIT_CHECK==a.getInputType()||SBGrid.DEF.SBIT_RADIO==a.getInputType()||SBGrid.DEF.SBIT_IMAGE==a.getInputType()){return this.valueMatrix(c,f)}else{if(null!=d.m_heDataControl){if(SBGrid.DEF.is_ie){return d.m_heDataControl.innerText}else{return d.m_heDataControl.textContent}}else{if(SBGrid.DEF.SBIT_COMBO==a.getInputType()){var e=a.m_objCombo;if(a.m_bIsCellCombo&&e.isnodeset){var b=d.getAttribute("nodeset");if(null!=b){e.nodeset=b;e.reBuild()}else{if(null!=a.m_strComboNodeSet&a.m_strComboNodeSet!=e.nodeset){e.nodeset=a.m_strComboNodeSet;e.refresh()}}b=null}strToolTipText=e.getLableByValue(SBGrid.CF.GridGetText(d));var g=a.getAttribute("format");g=null!=d.attribute.format?d.attribute.format:g;e=null;if(null==g||""==g){return strToolTipText}else{return strToolTipText.formatting(g)}}else{var h=SBGrid.CF.GridGetText(d);if(null!=h){var g=a.getAttribute("format");g=null!=d.attribute.format?d.attribute.format:g;e=null;if(null==g||""==g){return h}else{return h.formatting(g)}}}}}}}}return""};SBGrid.CT.DataGrid.prototype.setFilterOfColumn=function(a){var c=SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().selectNodes("/root/grid/grid_data/name");for(var b=0;b<c.length;b++){}};SBGrid.CT.DataGrid.prototype.getUpdateDataXml=function(a,t){var b;var m="";var o=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();var c=new Array();var s=this.attribute.colsep;var l=this.attribute.rowsep;var r=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);for(var q=this.fixedCols;q<this.cols;q++){c.push(this.m_arColumn[q].getAttribute("ref"))}switch(a){case"insert":b=1;break;case"delete":b=4;break;case"update":b=2;break;default:b=0;break}if(null==t){t="status"}if(0==b||4==b){for(var q=0;q<this.m_arUpdateDeleteList.length;q++){var f=this.m_arUpdateDeleteList[q].substring(0,this.m_arUpdateDeleteList[q].lastIndexOf(l));var e=f.split(s);var h=o.createElement(r);for(var p=2;p<e.length;p++){var n=o.createElement(c[p-2]);var u=n.ownerDocument.createTextNode(e[p]);n.appendChild(u);h.appendChild(n)}var n=o.createElement(t);var u=n.ownerDocument.createTextNode(e[0]);n.appendChild(u);h.appendChild(n);m+=SBGrid.UT.XmlLib.serializeToString(h)}}for(var q=this.fixedRows;q<this.m_nRealRows;q++){var g=this.getRowStatus(q);if(3==g){g=1}else{if(4<g&&7>g){g=4}}if(0<g&&(g==b||0==b)){var d="";switch(g){case 1:d="i";break;case 2:d="u";break;case 4:d="d";break}var h=o.createElement(r);for(var p=this.fixedCols;p<this.cols;p++){var n=o.createElement(c[p-this.fixedCols]);var u=n.ownerDocument.createTextNode(SBGrid.CF.GridGetText(this.getCell(q,p)));n.appendChild(u);h.appendChild(n)}var n=o.createElement(t);var u=n.ownerDocument.createTextNode(d);n.appendChild(u);h.appendChild(n);m+=SBGrid.UT.XmlLib.serializeToString(h)}}return m};SBGrid.CT.DataGrid.prototype.getUpdateDataJson=function(e,o,m){var d;var p="";var n="";var s=new Array();var l=this.attribute.colsep;var c=this.attribute.rowsep;if(null==o){o="status"}if(null==m){n="rownum"}else{n=String(m)}var r=this.m_bRowHeader?1:0;for(var h=this.fixedCols-r;h<this.cols;h++){s.push(this.m_arColumn[h].getAttribute("ref"))}switch(e){case"insert":d=1;break;case"delete":d=4;break;case"update":d=2;break;default:d=0;break}if(0==d||4==d){for(var h=0;h<this.m_arUpdateDeleteList.length;h++){var g=this.m_arUpdateDeleteList[h].substring(0,this.m_arUpdateDeleteList[h].lastIndexOf(c));var b=g.split(l);for(var h=0;h<b.length;h++){if(p!=""&&h==0){p+=", "}if(h==0){p+='{"'+o+'":"'+b[h]+'", "'}else{if(h==1){p+=n+'":"'+b[h]+'", "'}else{if(h>1&&h<b.length-1){p+=s[h-2]+'":"'+b[h]+'", "'}else{if(h==b.length-1){p+=s[h-2]+'":"'+b[h]+'"}'}}}}}}}for(var h=this.fixedRows;h<this.m_nRealRows;h++){var q=this.getRowStatus(h);if(3==q){q=1}else{if(4<q&&7>q){q=4}}if(0<q&&(q==d||0==d)){var a="";switch(q){case 1:a="i";break;case 2:a="u";break;case 4:a="d";break}if(p!=""){p+=","}p+='{"'+o+'":"'+a+'", "';p+=n+'":"'+h+'", "';for(var f=this.fixedCols;f<this.cols;f++){p+=s[f]+'":"'+SBGrid.CF.GridGetText(this.getCell(h,f));if(f<this.cols-1){p+='", "'}else{p+='"}'}}}}if(p!=""){p="["+p+"]"}return p};SBGrid.CT.DataGrid.prototype.moveSubtotal=function(f,b){if(null==f||null==b||(0>f||this.m_nRealRows<=f)){return}if("insert"==b){var d=new SBGrid.DS.Hashtable();for(var e in this.m_htRowSubTotal){var a=Number(e);if(f<=a){var c=this.m_htRowSubTotal[a];d[a+1]=c}else{d[a]=this.m_htRowSubTotal[a]}}this.m_htRowSubTotal=d;d=null}else{if("delete"==b){var d=new SBGrid.DS.Hashtable();for(var e in this.m_htRowSubTotal){var a=Number(e);if(f==a){continue}if(f<a){var c=this.m_htRowSubTotal[a];d[a-1]=c}else{d[a]=this.m_htRowSubTotal[a]}}this.m_htRowSubTotal=d;d=null}else{if("above"==b||"below"==b){var d=new SBGrid.DS.Hashtable();for(var e in this.m_htRowSubTotal){var a=Number(e);if(f<=a){var c=this.m_htRowSubTotal[a];d[a+1]=c}else{d[a]=this.m_htRowSubTotal[a]}}this.m_htRowSubTotal=d;d=null}}}};SBGrid.CT.DataGrid.prototype.isSubtotalAll=function(){for(var a in this.m_htRowSubTotal){return true}return false};SBGrid.CT.DataGrid.prototype.isSubtotal=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".isSubtotal","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".isSubtotal","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=this.m_htRowSubTotal[a]){return true}else{return false}};SBGrid.CT.DataGrid.prototype.subtotal=function(f,p,c,s,b,r,o,t){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof f)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof p!="number"){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".subtotal","Please check if 3rd parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var u=typeof(p);if("number"!=u&&"string"!=u){for(var n=0;n<p.length;n++){if(-1==p[n]){p.splice(n,1)}}switch(p.length){case 0:p=-1;u="number";break;case 1:p=p[0];u="number";break;default:break}}if("number"!=typeof(c)&&"string"!=typeof(c)){var g=this.multiTotals;this.multiTotals=true;for(var n=0;n<c.length;n++){this.subtotal(f,p,c[n],s,b,r,o,t)}this.multiTotals=g;return}switch(f){case"clear":this.clearAllSubTotalRow();break;case"sum":case"percent":case"count":case"average":case"max":case"min":break;default:return}if("clear"!=f){if(null!=s){try{var m=null;m=s.split(";");if(null!=m){for(var n=0;n<m.length;n++){if(-1!=m[n].indexOf("format")){s=m[n].split(":")[1]}}}}catch(q){}}else{s=""}if(null==b){b=""}var a=p;if("number"!=u&&"string"!=u){a=p[p.length-1]}if(null==r||"string"==typeof(r)){r=(-1==a)?0:a}if(this.fixedRows==this.m_nRealRows){return}this.clearSelection();if(this.m_nRealRows!=this.m_nMakeIndex){SBGrid.CT.DataGrid.PartiallyCount=this.m_nRealRows;if(!SBGrid.DEF.is_smartphone){}else{for(var n=0;n<this.m_nRealRows;n++){for(var l=0;l<this.cols;l++){var h=this.getCell(n,l);if(null!=h){this.children.remove(h.id);SBGrid.DEF.__removeAll(h.id)}}}this.makeSmartPhoneGrid()}SBGrid.CT.DataGrid.PartiallyCount=100}var d=new Array();if("number"==u){this.colCellGroup(p,this.fixedRows,this.m_nRealRows-1,d)}else{if(null!=p&&0<p.length){this.colCellGroup(p[0],this.fixedRows,this.m_nRealRows-1,d);if(1!=p.length){d=this.colCellGroupArray(p,this.fixedRows,this.m_nRealRows-1,d);p=p[p.length-1]}}}if(-1==p){p=this.fixedCols;o=null==o?"":o}this.setSubTotalResult(d,f,p,c,s,b,r,o,t);this.setSeqForRowHeader()}};SBGrid.CT.DataGrid.prototype.clearAllSubTotalRow=function(h){var c=0;var g=new Array();for(var f in this.m_htRowSubTotal){g.push(Number(f))}g.sort(SBGrid.DEF.numberASC);for(var e=0;e<g.length;e++){for(var b=this.fixedCols;b<this.cols;b++){var d=this.getCell(g[e],b);if(null!=d){d.m_bIsSubTotal=false;d.text=""}if(!h){this.rebuildStyle(g[e],b)}}}if(!h){for(var a=0;a<g.length;a++){this.deleteRow(g[a]+c,false,true);c--}}this.m_htRowSubTotal=new SBGrid.DS.Hashtable()};SBGrid.CT.DataGrid.prototype.setSubTotalResult=function(e,t,s,n,c,F,B,f,D){var r=0;var w=false;if(null==f){w=true}if(this.fixedCols<=s&&s<this.cols){for(var y=0;y<e.length;y++){var C=f;var l=e[y][0]+r;var v=e[y][1]+r;var E=false;for(var d in this.m_htRowSubTotal){if(s!=parseInt(this.m_htRowSubTotal[d][0])){if((v+1)==parseInt(d)){E=true;break}}}if(E){var A=new SBGrid.DS.Hashtable();for(var d in this.m_htRowSubTotal){var h=this.m_htRowSubTotal[d];var u=parseInt(d);if((v+1)<=u){A[String(u+1)]=h}else{A[d]=h}}this.m_htRowSubTotal=A}var b=this.getCalcurateRow(t,n,l,v);var p=this.getCell(l,s);if(w){if(null!=p){C=SBGrid.CF.GridGetText(p)}}else{if(-1!=f.indexOf("%s")){if(null!=p){C=f.replace("%s",SBGrid.CF.GridGetText(p))}}}if("above"==this.subtotalPosition){var a=l;var p=this.getCell(a-1,s);while(null!=p&&p.m_bIsSubTotal){a=p.row;p=this.getCell(a-1,s)}var z=true;var g=false;if(this.multiTotals){var q=this.m_htRowSubTotal[a];if(null!=q){g=true;if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){if(g){this.moveSubtotal(a,"above")}var m=new Array();this.m_htRowSubTotal[a]=m;m.push(s);m.push(n);this.insertRow(a,"before",false,true,true);this.setSubTotalValue(a,n,c,F,B,C,b);r++}else{var q=this.m_htRowSubTotal[a];q.push(n);this.setSubTotalValue(a,n,c,F,B,C,b)}}else{var g=false;var o=v;var p=this.getCell(o+1,s);while(null!=p&&p.m_bIsSubTotal){o=p.row;p=this.getCell(o+1,s)}var z=true;if(this.multiTotals){var q=this.m_htRowSubTotal[o];if(null!=q){g=true;if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){this.moveSubtotal(o+1,"below");var m=new Array();this.m_htRowSubTotal[o+1]=m;m.push(s);m.push(n);if(this.m_nRealRows-1!=o){this.insertRow(o+1,"before",false,true,true)}else{this.addRow(false,true,true)}this.setSubTotalValue(o+1,n,c,F,B,C,b);r++}else{var q=this.m_htRowSubTotal[o];q.push(n);this.setSubTotalValue(o,n,c,F,B,C,b)}}}}else{var b=this.getCalcurateRow(t,n,this.fixedRows,this.m_nRealRows-1);if(w){f=""}else{if(-1!=f.indexOf("%s")){if(null!=p){f=f.replace("%s","")}}}if("above"==this.subtotalPosition){var z=true;if(this.multiTotals){var q=this.m_htRowSubTotal[this.fixedRows];if(null!=q){if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){var m=new Array();this.m_htRowSubTotal[this.fixedRows]=m;m.push(s);m.push(n);this.insertRow(this.fixedRows,"before",false,true,true);this.setSubTotalValue(this.fixedRows,n,c,F,B,f,b)}else{var q=this.m_htRowSubTotal[this.fixedRows];q.push(n);this.setSubTotalValue(this.fixedRows,n,c,F,B,f,b)}}else{var z=true;if(this.multiTotals){var q=this.m_htRowSubTotal[v+1];if(null!=q){if(q[0]==s){for(var x=1;x<q.length;x++){if(q[x]!=n){z=false}else{z=true;break}}}}}if(z){var m=new Array();this.m_htRowSubTotal[v+1]=m;m.push(s);m.push(n);if(this.m_nRealRows-1!=v){this.insertRow(v+1,"before",false,true,true)}else{this.addRow(false,true,true)}this.setSubTotalValue(v+1,n,c,F,B,f,b);r++}else{var q=this.m_htRowSubTotal[v+1];q.push(n);this.setSubTotalValue(v+1,n,c,F,B,f,b)}}}};SBGrid.CT.DataGrid.prototype.setSubTotalValue=function(e,c,o,a,n,l,q){var b=false;for(var h=0;h<this.cols;h++){var d=this.getCell(e,h);if(null!=d){b=d.m_bIsSubTotal;d.m_bIsSubTotal=true;if(c==h){d.text=q;this.setLinkedData(d,null,null);SBGrid.CF.GridSetWindowText(d,q,true,o)}else{if(n==h){if(b&&""==l){b=false;continue}d.text=l;this.setLinkedData(d,null,null);SBGrid.CF.GridSetWindowText(d,l,true,"")}else{if(null==d.text){d.text=""}this.setLinkedData(d,null,null);SBGrid.CF.GridSetWindowText(d,d.text,true,o)}}b=false}}var m=new SBGrid.DS.Hashtable();var g=a.split(/\;/g);for(var h=0;h<g.length;h++){if(g[h].trim().isEmpty()){break}var f=g[h].split(/\:/g);m[f[0].trim()]=f[1].trim()}for(var p in m){this.setRowStyle(e,"data",p,m[p])}};SBGrid.CT.DataGrid.prototype.getCalcurateRow=function(d,b,f,e){switch(d){case"sum":var n=0;for(var l=f;l<=e;l++){var g=this.getCell(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");n+=isFinite(o)?Number(o):0}}return String(n);case"percent":var n=0;var m=0;for(var l=this.fixedRows;l<this.m_nRealRows;l++){var g=this.getCell(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");m+=isFinite(o)?Number(o):0;if(f<=l&&l<=e){n+=isFinite(o)?Number(o):0}}}return String((n/m)*100);case"count":var a=0;for(var l=f;l<=e;l++){var g=this.getCell(l,b);if(null!=g&&!g.m_bIsSubTotal){a++}}return String(a);case"average":var n=0;var a=0;for(var l=f;l<=e;l++){var g=this.getCell(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");n+=isFinite(o)?Number(o):0;a++}}return String(n/a);case"max":var c=null;for(var l=f;l<=e;l++){var g=this.getCell(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);o=o.replace(/\,/g,"");if(isFinite(o)){if(null==c){c=Number(o);continue}c=c<Number(o)?Number(o):c}}}if(null==c){c=""}return String(c);case"min":var h=null;for(var l=f;l<=e;l++){var g=this.getCell(l,b);if(null!=g&&!g.m_bIsSubTotal){var o=SBGrid.CF.GridGetText(g);if(isFinite(o)){if(null==h){h=Number(o);continue}h=h>Number(o)?Number(o):h}}}if(null==h){h=""}return String(h)}};SBGrid.CT.DataGrid.prototype.getSubTotalSize=function(){var a=0;for(var b in this.m_htRowSubTotal){a++}return a};SBGrid.CT.DataGrid.prototype.getRowCountFromInstance=function(){this.m_xlRefNode=this.getControlNodeList();if(this.m_xlRefNode){return this.m_xlRefNode.length}return 0};SBGrid.CT.DataGrid.prototype.eventCaptionClear=function(){this.m_bClearCaption=true};SBGrid.CT.DataGrid.prototype.isCellNodeChanged=function(){this.m_xlRefNode=this.getControlNodeList();for(var c=this.fixedCols;c<this.cols;c++){for(var a=this.fixedRows;a<this.m_nRealRows;a++){var b=this.getCell(a,c);if(null!=b&&!b.m_bIsSubTotal){if(null==b.m_xnNodeElement){return true}}}}return false};SBGrid.CT.DataGrid.prototype.refreshForHasInstance=function(g){var f=true;var a;var h=this.m_replaceString;if(h!=""&&h!="undefined"&&h!=null){a=h.split("?")}if(f&&!this.isChangedItem()){if(!g){if(!this.m_bHasItem){this.rebuildForHasInstance();return}if(this.m_bColChangeStatus){this.rebuildForHasInstance();this.m_bColChangeStatus=false;return}}var e=this.getRowCountFromInstance();if(e+this.fixedRows!=this.m_nRealRows-this.getSubTotalSize()){this.rebuildForHasInstance();return}else{for(var d=this.fixedRows;d<this.fixedRows+this.frozenRows;d++){for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCell(d,c);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),a)}}}for(var d=this.m_objScroll.nTopRow;d<=this.m_objScroll.nBottomRow;d++){for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCell(d,c);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),a)}}}for(var d=this.m_nRealRows-this.m_nBottomRowCount;d<this.m_nRealRows;d++){for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCell(d,c);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),a)}}}for(var d=0;d<this.m_arCombo.length;d++){var l=this.m_arCombo[d];if(true==l.visible){l.showComboRefresh()}}}}this.setChangedItem(false)};SBGrid.CT.DataGrid.prototype.gridToJson=function(){if(this.m_arSortJson!=null){var movecol=this.m_moveColInfo;var joSort=new Array();var j=parseInt(movecol.substring(movecol.length-1));for(var i=0;i<this.m_arSortJson.length;i++){joSort[i]=this.m_arSortJson[i][j]}var joToJson=eval(this.jsonref);for(var i=0;i<joSort.length;i++){joToJson[i]=joSort[i]}}};SBGrid.CT.DataGrid.prototype.mappingCellHasInstance=function(f,p,c,l){var d;if(null==f){f=this.fixedRows}if(null==p){p=this.fixedCols}if(null==c){c=this.m_nRealRows}if(null==l){l=this.cols}var r=this.m_replaceString;if(r!=""&&r!="undefined"&&r!=null){d=r.split("?")}var n=null;if(SBGrid.DEF.is_chrome&&!this.isJsonRef()){n=new Array();for(var m=0;m<this.m_xlRefNode.length;m++){var q=new SBGrid.DS.Hashtable();var o=this.m_xlRefNode.item(m).firstChild;while(o){if("#text"!=o.nodeName){q[o.nodeName]=o}o=o.nextSibling}n.push(q)}}for(var m=p;m<l;m++){var t=this.m_arColumn[m].getAttribute("ref");for(var g=f;g<c;g++){var a=null;var s=null;var h;var b;if(this.isJsonRef()){s=this.m_xlRefNode[g-this.fixedRows];b=s}else{if(!SBGrid.DEF.is_chrome){a=this.m_xlRefNode.item(g-this.fixedRows);h=SBGrid.UT.XmlLib.selectSingleNode(a,t)}else{h=n[g-this.fixedRows][t]}}var e=this.getCell(g,m);if(null!=e&&(null!=h||null!=b)){this.setLinkedData(e,h,b);if(this.isPhysicalRow(g)){if(b!=null){SBGrid.CF.GridSetTextRefresh(e,b[t]+"",d)}else{SBGrid.CF.GridSetTextRefresh(e,SBGrid.UT.XmlLib.getTextValue(h),d)}}}}}};SBGrid.CT.DataGrid.prototype.refreshForHasNotInstance=function(){if(null!=this.m_nlightGridTime){this.stopCreateInterval()}if(null!=this.m_objGridData){if(SBGrid.DEF.is_ie){var h=this.id;this.m_heGridWhole.attachEvent("onscroll",function(){SBGrid.DEF._W_onProcessEvent(event,"onscroll",h)})}else{this.m_heGridWhole.setAttribute("onscroll",'SBGrid.DEF._W_onProcessEvent(event, "onscroll", "'+this.id+'")')}var l=this.m_heGridWhole.firstChild;var f=this.m_heGridFFScrollRow.firstChild;if(null!=this.m_heGridFFNoScrollRow.firstChild&&null!=this.m_heGridFFCol.firstChild&&null!=this.m_heGridFFBScrollRow.firstChild&&null!=this.m_heGridFFBNoScrollRow.firstChild){this.m_heGridFFNoScrollRow.removeChild(this.m_heGridFFNoScrollRow.firstChild);this.m_heGridFFCol.removeChild(this.m_heGridFFCol.firstChild);this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild)}l.removeChild(l.lastChild);l.removeChild(l.lastChild);f.removeChild(f.lastChild);f.removeChild(f.lastChild);var a=new Array();var g=new Array();var c="border-top-width:0px;border-left-width:0px;border-right-width:1px;border-bottom-width:1px;border-top-style:none;border-left-style:none;border-right-style:solid;border-bottom-style:solid;border-right-color:#D4D0C8;border-bottom-color:#D4D0C8;";var e="background-color:#D4D0C8;text-align:center;border-right-color:#6F6F5F;border-bottom-color:#6F6F5F;";var b="<div style='width:100%;border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent;overflow:hidden; border-left-color:transparent;word-wrap:normal'>";a.push("<colgroup>");g.push("<colgroup>");for(var d=0;d<this.m_objGridData.status.col;d++){a.push("<col style='width:"+this.m_objGridData.column[d].width+"px;'/>");g.push("<col style='width:"+this.m_objGridData.column[d].width+"px;'/>")}a.push("</colgroup>");g.push("</colgroup>");a.push("<tbody>");g.push("<tbody id='"+this.id+".datagridwhole.tbody'>");a.push("<tr>");g.push("<tr>");for(var d=0;d<this.m_objGridData.status.col;d++){a.push("<td style='height:"+this.m_nRowHeight+"px;"+c+e+"'>"+b+'<span style="white-space:nowrap;">'+this.m_objGridData.column[d].caption+"</span></div></td>");g.push("<td style='height:"+this.m_nRowHeight+"px;"+c+e+"'>"+b+"</div></td>")}a.push("</tr>");g.push("</tr>");a.push("</tbody>");g.push("</tbody>");jQuery(f).append(a.join(""));jQuery(l).append(g.join(""));this.m_nlightGridTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').createIntervalTag();",50)}};SBGrid.CT.DataGrid.prototype.createIntervalTag=function(){if(this.m_nlightGridLine>=this.m_objGridData.status.row){return}var f="border-top-width:0px;border-left-width:0px;border-right-width:1px;border-bottom-width:1px;border-top-style:none;border-left-style:none;border-right-style:solid;border-bottom-style:solid;border-right-color:#D4D0C8;border-bottom-color:#D4D0C8;";var a="<div style='width:100%;border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent;overflow:hidden; border-left-color:transparent;word-wrap:normal'>";var g=new Array();var e=""!=this.backColorAlternate;if(SBGrid.DEF.is_ie){var d=1==this.m_nlightGridLine&1&&e?"background-color:"+this.backColorAlternate+";":"";g.push("<tr>");for(var b=0;b<this.m_objGridData.status.col;b++){g.push("<td style='height:"+this.dataHeight+"px;"+f+this.m_objGridData.column[b].style+d+"'>"+a+'<span style="white-space:nowrap;">'+this.m_objGridData.data[this.m_nlightGridLine][b].D+"</span></div></td>")}g.push("</tr>");this.m_nlightGridLine++}else{for(var c=0;c<100;c++){var d=1==c&1&&e?"background-color:"+this.backColorAlternate+";":"";g.push("<tr>");for(var b=0;b<this.m_objGridData.status.col;b++){g.push("<td style='height:"+this.dataHeight+"px;"+f+this.m_objGridData.column[b].style+d+"'>"+a+'<span style="white-space:nowrap;">'+this.m_objGridData.data[this.m_nlightGridLine][b].D+"</span></div></td>")}g.push("</tr>");this.m_nlightGridLine++}}jQuery(document.getElementById(this.id+".datagridwhole.tbody")).append(g.join(""));if(!SBGrid.DEF.is_smartphone){this.__FFRowMove()}this.stopCreateInterval()};SBGrid.CT.DataGrid.prototype.stopCreateInterval=function(){window.clearTimeout(this.m_nlightGridTime);this.m_nlightGridTime=null;if(this.m_nlightGridLine>=this.m_objGridData.status.row){this.m_nlightGridLine=0}else{this.m_nlightGridTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').createIntervalTag();",50)}};SBGrid.CT.DataGrid.prototype.rebuildForHasInstance=function(){this.m_bChangeFixedRows=false;this.setDisabled(false);this.deleteSortShowIcon();this.deleteShowExplorerUI();this.stopEditing();this.clearSelection();this.clearAllSubTotalRow(true);this.clearMerge();this.initGridProperties();this.m_bHasItem=true;this.m_bIsSort=false;this.m_objGroup=new Array();this.m_arCellStyleTable=new Array();this.m_htCellFormat=new SBGrid.DS.Hashtable();this.group=0;if(0==this.cols){this.m_bHasItem=false;return}this.resetScroll();this.remakeGrid();for(var c=0;c<this.m_arColumn.length;c++){this.setChild(this.m_arColumn[c].id,this.m_arColumn[c]);if(SBGrid.DEF.SBIT_COMBO==this.m_arColumn[c].m_nInputType){this.setChild(this.m_arColumn[c].m_objCombo.id,this.m_arColumn[c].m_objCombo)}}this.setChild(this.m_objInput.id,this.m_objInput);var b=this.children.keys();for(var c=0;c<b.length;c++){var a=b[c];var d=this.getCellById(a);if(null!=d&&"softbowl:cell"!=d.elementName){SBGrid.CF.GridInit(d)}}if(SBGrid.DEF.is_smartphone){var b=this.children.keys();for(var c=0;c<b.length;c++){var a=b[c];var d=this.getCellById(a);if(null!=d&&"softbowl:col"!=d.elementName){SBGrid.CF.GridInit(d)}}}this.mappingCellHasInstance(null,null,this.m_nMakeIndex,null);for(var c=this.fixedRows;c<this.m_nMakeIndex;c++){this.setRowStatus(c,SBGrid.DEF.SBGS_NEW)}this.colGroupNameSpace();if(!SBGrid.DEF.is_smartphone){if(this.m_objScroll.bScrollEvent){this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow)}}this.defaultAttributeSetting(!SBGrid.DEF.is_smartphone);if(this.autoMerge){this.merge()}this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heGridFFCol){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.autoResize){this.reSizeScrollDiv()}if(!SBGrid.DEF.is_smartphone){this.scrollAttributeSetting();this.__FFRowMove()}this.dispatch("ongridrebuild")};SBGrid.CT.DataGrid.prototype.deleteColumnHasInstance=function(nCol,bRefresh){this.stopEditing();if(0==this.m_arColumn.length){return}this.clearSelection();this.clearMerge();if(!(this.rowheader&&0==this.m_arColumn.length)){var strRef=this.m_arColumn[nCol].getAttribute("ref");if(this.isJsonRef()){try{var objGridItemJson=eval(this.jsonref)}catch(e){return}if(null!=objGridItemJson&&0<objGridItemJson.length){for(var i=(objGridItemJson.length-1);i>-1;i--){try{eval("delete "+this.jsonref+"["+i+"]."+strRef)}catch(e){SBGrid.DEF.errorMsg("Deletecolumn 함수 수행에 실패하였습니다::DeleteColumnHasInstance");return}}}}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=strRef&&!strRef.isEmpty()&&null!=xnDoc){for(var i=0;i<this.m_xlRefNode.length;i++){var xnRef=this.m_xlRefNode.item(i);if(null!=xnRef.selectSingleNode(strRef)){xnRef.removeChild(xnRef.selectSingleNode(strRef))}}}}this.m_arColumn.splice(nCol,1);this.m_arColWidth.splice(nCol,1);this.m_arHiddenCol.splice(nCol,1);for(var i=0;i<this.fixedRows;i++){this.m_arCaption[i].splice(nCol,1)}}for(var i=0;i<this.m_nRealRows;i++){this.physicalRemoveCell(i,nCol)}this.cols--;this.colWidthReset();this.captionReset();this.setColGroupDeleteCol(nCol);for(var i=(nCol+1);i<(this.cols+1);i++){for(var j=0;j<this.m_nRealRows;j++){var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+j+"_"+(i-1);objCell.col=i-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;if(objCell.m_heControl){objCell.m_heControl.id="SBHE_"+strCellNewId}if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}var strRemoveChildColID=this.id+"_col_"+this.cols;this.children.remove(strRemoveChildColID);SBGrid.DEF.__removeAll(strRemoveChildColID);for(var i=0;i<this.cols;i++){this.setColWidth(i,this.m_arColWidth[i])}this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.insertColumnHasInstance=function(nCol,strColAttribute,strType,bRefresh){this.stopEditing();if(strColAttribute.isEmpty()){return}this.clearSelection();this.clearMerge();if(!(this.rowheader&&0==this.m_arColumn.length)){if("after"==strType){nCol++}for(var i=(this.m_arColumn.length-1);i>=nCol;i--){var objCol=this.m_arColumn[i];var strNewId=this.id+"_col_"+(i+1);objCol.id=strNewId;objCol.attribute.id=strNewId;this.children.add(strNewId,objCol);SBGrid.DEF.__appendControl(strNewId,objCol);SBGrid.DEF.__appendAll(strNewId,objCol)}var strCreateChildColID=this.id+"_col_"+nCol;this.children.remove(strCreateChildColID);SBGrid.DEF.__removeAll(strCreateChildColID);strColAttribute+="id:"+strCreateChildColID;var objChild=this.createChild("softbowl:col",strColAttribute);var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strRef=objChild.getAttribute("ref");if(this.isJsonRef()){var strGridItemJson=JSON.stringify(eval(this.jsonref));var strRegExp="/(\\{";for(var i=0;i<nCol;i++){strRegExp+="[^,}]*"}strRegExp+="\\,)([^}]*\\})/g";var strInsertedGridItemJson=strGridItemJson.replace(eval(strRegExp),function(match,strRegCap1,strRegCap2){return strRegCap1+' "'+strRef+'":"", '+strRegCap2});eval(this.jsonref+" = "+strInsertedGridItemJson)}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=strRef&&!strRef.isEmpty()&&null!=xnDoc){for(var i=0;i<this.m_xlRefNode.length;i++){var xnRef=this.m_xlRefNode.item(i);var xnNewColNode=xnDoc.createElement(strRef);xnRef.appendChild(xnNewColNode)}}}this.m_arColumn.splice(nCol,0,objChild);this.m_arColWidth.splice(nCol,0,100);this.m_arHiddenCol.splice(nCol,0,100);var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].splice(nCol,0," ")}else{this.m_arCaption[i].splice(nCol,0,strCaption)}}this.setColGroupInsertCol(nCol,100)}else{strColAttribute="type:"+this.getAttribute("rowheader")+";";strColAttribute+="id:"+this.id+"_col_"+this.cols;var objChild=this.createChild("softbowl:col",strColAttribute);if(null==objChild){return}var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].push(" ")}else{this.m_arCaption[i].push(strCaption)}}this.m_arColumn.push(objChild);this.m_arColWidth.push(20);this.setColGroupAddCol(this.cols,20)}this.cols++;this.colWidthReset();this.captionReset();for(var i=(this.m_arColumn.length-1);i>(nCol-1);i--){for(var j=0;j<this.m_nRealRows;j++){var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+j+"_"+(i+1);objCell.col=i+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;if(objCell.m_heControl){objCell.m_heControl.id="SBHE_"+strCellNewId}if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}this.m_xlRefNode=this.getControlNodeList();var objColumn=this.m_arColumn[nCol];var strColumnRef=objColumn.getAttribute("ref");for(var i=0;i<this.m_nRealRows;i++){var strCellId=this.id+"_"+i+"_"+nCol;if(i<this.fixedCols){var objCell=this.getCellById(strCellId);if(null!=objCell){if(strCellId!=objCell.id){objCell=null}}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,nCol,strCellId,i,"softbowl:cell"):objCell;objCell.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}else{var xnCell;var jsonCell;if(this.isJsonRef()){xnRowData=this.m_xlRefNode[i-this.fixedRows];jsonCell=xnRowData}else{xnRowData=this.m_xlRefNode.item(i-this.fixedRows);xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}var objCell=this.getCellById(strCellId);if(null!=objCell){if(strCellId!=objCell.id){objCell=null}}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,nCol,strCellId,i,"softbowl:cell"):objCell;objCell.setElement(objColumn);this.setLinkedData(objCell,xnCell,jsonCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}}var objScroll=this.m_objScroll;if(objScroll.bScrollEvent){objColumn.init();var nFFLength=this.fixedRows+this.frozenRows;var objCell;for(var i=0;i<nFFLength;i++){this.physicalCreateCell(i,nCol);objCell=this.getCell(i,nCol);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols;j++){objCell=this.getCell(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}var nAppendRowLength=objScroll.nTopRow-nFFLength;for(var i=nFFLength;i<this.m_nMakeIndex;i++){this.physicalCreateCell(i,nCol,false,false,true,false,nAppendRowLength,0)}for(var i=nFFLength;i<this.m_nRealRows;i++){objCell=this.getCell(i,nCol);if(null!=objCell){SBGrid.CF.GridInit(objCell)}if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols;j++){objCell=this.getCell(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}this.scrollingGrid();this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow();for(var i=nFFLength;i<this.m_nRealRows;i++){this.scrollingCellStyle(i,nCol)}this.defaultAttributeStyleSetting(true);this.setExtendLastCol(this.extendLastCol)}else{var nRealBottomRow=0;if(this.frozenBottomRows>0){nRealBottomRow=this.m_nBottomRowCount;this.m_nBottomRowCount=0}for(var i=0;i<this.m_nRealRows;i++){this.physicalCreateCell(i,nCol);if(i>=this.m_nRealRows-nRealBottomRow){this.m_nBottomRowCount++}}objColumn.init();for(var i=0;i<this.m_nRealRows;i++){var objCell=this.getCell(i,nCol);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}if(!SBGrid.DEF.is_ie){for(var j=nCol+1;j<this.cols;j++){objCell=this.getCell(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}}if("hidden"==objColumn.attribute.visibility){this.setColHidden(nCol,true)}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.addColumnHasInstance=function(strColAttribute,bRefresh){this.stopEditing();if(strColAttribute.isEmpty()){return}this.clearSelection();if(!(this.rowheader&&0==this.m_arColumn.length)){var strSemicolon="";strColAttribute=strColAttribute.trim();if(0<strColAttribute.length&&(-1==strColAttribute.lastIndexOf(";")||strColAttribute.length!=strColAttribute.lastIndexOf(";"))){strSemicolon=";"}if(-1==strColAttribute.indexOf("id:")){strColAttribute+=strSemicolon+"id:"+this.id+"_col_"+this.cols}var objChild=this.createChild("softbowl:col",strColAttribute);if(null==objChild){return}var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strRef=objChild.getAttribute("ref");if(this.isJsonRef()){var strGridItemJson=JSON.stringify(eval(this.jsonref));var strRegExp="/(\\{[^}]*)(\\})/g";var strInsertedGridItemJson=strGridItemJson.replace(eval(strRegExp),function(match,strRegCap1,strRegCap2){return strRegCap1+', "'+strRef+'":""'+strRegCap2});eval(this.jsonref+" = "+strInsertedGridItemJson)}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=strRef&&!strRef.isEmpty()&&null!=xnDoc){for(var i=0;i<this.m_xlRefNode.length;i++){var xnRef=this.m_xlRefNode.item(i);var xnNewColNode=xnDoc.createElement(strRef);xnRef.appendChild(xnNewColNode)}}}var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].push(" ")}else{this.m_arCaption[i].push(strCaption)}}this.m_arColumn.push(objChild);this.m_arColWidth.push(100);this.m_arHiddenCol.push(100);this.setColGroupAddCol(this.cols,100)}else{strColAttribute="type:"+this.getAttribute("rowheader")+";";strColAttribute+="id:"+this.id+"_col_"+this.cols;var objChild=this.createChild("softbowl:col",strColAttribute);if(null==objChild){return}var strCursor=objChild.getAttribute("cursor");if(null!=strCursor&&strCursor.isEmpty()){objChild.setAttribute("cursor",this.getAttribute("cursor"))}var strCaption=objChild.getAttribute("caption");for(var i=0;i<this.fixedRows;i++){if(null==strCaption||""==strCaption){this.m_arCaption[i].push(" ")}else{this.m_arCaption[i].push(strCaption)}}this.m_arColumn.push(objChild);this.m_arColWidth.push(20);this.m_arHiddenCol.push(20);this.setColGroupAddCol(this.cols,20)}this.cols++;this.colWidthReset();this.captionReset();this.m_xlRefNode=this.getControlNodeList();var objScroll=this.m_objScroll;if(objScroll.bScrollEvent){var objTargetCol=this.m_arColumn[this.cols-1];objTargetCol.init();var nFFLength=this.fixedRows+this.frozenRows;var objCell;for(var i=0;i<nFFLength;i++){this.physicalCreateCell(i,this.cols-1);objCell=this.getCell(i,this.cols-1);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols-1;j++){objCell=this.getCell(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}var nAppendRowLength=objScroll.nTopRow-nFFLength;for(var i=nFFLength;i<this.m_nMakeIndex;i++){this.physicalCreateCell(i,this.cols-1,false,false,true,false,nAppendRowLength,0)}var strColumnRef=objTargetCol.getAttribute("ref");for(var i=nFFLength;i<this.m_nRealRows;i++){var xnRowData;var jsonRowData;if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[i-this.fixedRows]}else{xnRowData=this.m_xlRefNode.item(i-this.fixedRows)}var strCellId=this.id+"_"+i+"_"+(this.cols-1);var objCell=this.getCellById(strCellId);if(null!=objCell){if(strCellId!=objCell.id){objCell=null}}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,this.cols-1,strCellId,i,"softbowl:cell"):objCell;objCell.setElement(objTargetCol);if(null!=strColumnRef){var xnCell;var jsonCell;if(this.isJsonRef()){jsonCell=jsonRowData}else{xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}this.setLinkedData(objCell,xnCell,jsonCell)}SBGrid.CF.GridSetMergeType(objCell,objTargetCol.m_bMerge);SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true;if(!SBGrid.DEF.is_ie){for(var j=0;j<this.cols-1;j++){objCell=this.getCell(i,j);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}}this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.scrollingGrid();this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeStyleSetting(true);this.setExtendLastCol(this.extendLastCol)}else{var nRealBottomRow=0;if(this.frozenBottomRows>0){nRealBottomRow=this.m_nBottomRowCount;this.m_nBottomRowCount=0}for(var i=0;i<this.m_nRealRows;i++){this.physicalCreateCell(i,this.cols-1);if(i>=this.m_nRealRows-nRealBottomRow){this.m_nBottomRowCount++}}this.m_arColumn[this.cols-1].init();for(var i=0;i<this.m_nRealRows;i++){var objCell=this.getCell(i,this.cols-1);if(null!=objCell){SBGrid.CF.GridInit(objCell);objCell.m_bUserAddCell=true}}this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}}var objCol=this.m_arColumn[this.cols-1];if("hidden"==objCol.attribute.visibility){this.setColHidden(this.cols-1,true)}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.deleteRowHasInstance=function(nRow,bRefresh,bNotDeleteNode){this.stopEditing();this.clearSelection();this.clearMerge();if(this.fixedRows==this.m_nRealRows){return}var nShiftRow,bIsFirstNode=true,bIsBottomRow=false,objStringArr,strRplcDt=this.m_replaceString;if(strRplcDt!=""&&strRplcDt!="undefined"&&strRplcDt!=null){objStringArr=strRplcDt.split("?")}if(!bNotDeleteNode){var objRemoveFcell=this.getCell(nRow,0);if(!objRemoveFcell.m_bUserAddCell){var strColSep=this.attribute.colsep;var strRowSep=this.attribute.rowsep;var strData="d"+strColSep+"-1";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){strData+=strColSep;strData+=SBGrid.CF.GridGetText(this.getCell(nRow,i))}strData+=strRowSep;this.m_arUpdateDeleteList.push(strData)}var xnNodeset;var xnParentNode;var objRemoveTargetCell=this.getCell(nRow,this.fixedCols);if(this.isJsonRef()){if(null!=objRemoveTargetCell){eval("SBGrid.DEF.arrRemoveAt("+this.jsonref+","+(nRow-this.fixedRows)+");")}}else{xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);xnParentNode=xnNodeset.item(0).parentNode;if(null!=objRemoveTargetCell){try{xnParentNode.removeChild(xnNodeset.item(nRow-this.fixedRows))}catch(e){if(null!=window.console){console.log(" datagrid deleteRow : "+e)}}}}}this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heGridFFCol){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}var nScrollMaxLen=this.m_objScroll.nMaxLength;if(nScrollMaxLen<=this.m_nMakeIndex&&nScrollMaxLen<this.m_nRealRows-this.m_nBottomRowCount){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow--;var objCell=null;var nScrollTopRow=this.m_objScroll.nTopRow;var nScrollBottomRow=this.m_objScroll.nBottomRow;for(var i=(nRow+1);i<this.m_nRealRows;i++){for(var j=0;j<this.cols;j++){objCell=this.getCell(i,j);if(null!=objCell){var strCellNewId=this.id+"_"+(i-1)+"_"+j;objCell.row=i-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);if(i>=nScrollTopRow&&i<=nScrollBottomRow){SBGrid.CF.GridInit(objCell);if(bRefresh){if(j>=this.fixedCols){SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr)}}}}}}this.m_nRealRows--;this.m_htRowHeight[nRow]=null;this.m_arCellStyleTable.splice(nRow,0);this.scrollingGrid();this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeStyleSetting()}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow--;this.m_objScroll.nTargetHeight-=this.dataHeight;this.physicalRemovePartRow(nRow,nRow);if(nRow<(this.fixedRows+this.frozenRows)){var nCountRow=nRow;while((nCountRow+1)!=(this.fixedRows+this.frozenRows)){nCountRow++;for(var i=0;i<this.cols;i++){var objCell=this.getCell(nCountRow,i);if(null!=objCell){var strCellNewId=this.id+"_"+(nCountRow-1)+"_"+i;objCell.row=nCountRow-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heControl.id="SBHE_"+strCellNewId;if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}for(var i=0;i<this.cols;i++){var objCell=this.getCell(nCountRow+1,i);if(null!=objCell){this.physicalCreateCell(nCountRow,i,bIsFirstNode,objCell.m_bIsSubTotal,true,true);bIsFirstNode=false}}for(var i=0;i<this.cols;i++){var objCell=this.getCell(nCountRow+1,i);if(null!=objCell){var strCellNewId=this.id+"_"+(nCountRow)+"_"+i;objCell.row=nCountRow;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr);this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell)}}if(nCountRow+1<this.m_nRealRows){this.physicalRemovePartRow(nCountRow+1,nCountRow+1)}for(var i=0;i<this.cols;i++){for(var j=nCountRow+2;j<this.m_nRealRows;j++){var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j-1)+"_"+i;objCell.row=j-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heControl.id="SBHE_"+strCellNewId;if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}SBGrid.CF.GridInit(objCell);this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell)}}}for(var i=this.fixedRows;i<this.m_nRealRows;i++){var objCell=this.getCell(i,0);if(null!=objCell){this.setRowStatus(i,objCell.getStatus())}}}else{for(var i=0;i<this.cols;i++){for(var j=(nRow+1);j<this.m_nRealRows;j++){var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j-1)+"_"+i;objCell.row=j-1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heControl.id="SBHE_"+strCellNewId;if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}if(nRow>=(this.m_nRealRows-this.frozenBottomRows)&&this.frozenBottomRows>0){if(this.m_nRealRows>this.fixedRows+this.frozenBottomRows+this.frozenRows){bIsBottomRow=true;nShiftRow=this.m_nRealRows-this.frozenBottomRows-1;this.physicalRemovePartRow(nShiftRow,nShiftRow)}}}if(this.rows==this.m_nRealRows){this.rows--}this.m_nRealRows--;this.m_nMakeIndex--;if(bIsBottomRow){var nTempBottomRowCount=this.m_nBottomRowCount;this.m_nBottomRowCount=0;for(var i=0;i<this.cols;i++){var objCell=this.getCell(nShiftRow,i);if(null!=objCell){this.physicalCreateCell(nShiftRow,i,bIsFirstNode,objCell.m_bIsSubTotal,true);bIsFirstNode=false}}for(var i=0;i<this.cols;i++){var objCell=this.getCell(nShiftRow,i);if(null!=objCell){SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr);this.setRowStatus(nShiftRow,objCell.getStatus())}}this.m_nBottomRowCount=nTempBottomRowCount+1}this.m_htRowHeight[nRow]=null;for(var i=0;i<this.cols;i++){var strRemoveChildCellId=this.id+"_"+this.m_nRealRows+"_"+i;this.children.remove(strRemoveChildCellId);SBGrid.DEF.__removeAll(strRemoveChildCellId)}this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}}if(!bNotDeleteNode){this.moveSubtotal(nRow,"delete");this.setSeqForRowHeader()}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.insertRowHasInstance=function(nRow,strType,bRefresh,bPreserveStatus,bNotAddNode){this.stopEditing();this.clearSelection();this.clearMerge();if("below"==strType){nRow++}var objStringArr;var strRplcDt=this.m_replaceString;var bIsFirstNode=true;var bIsBottomRow=false;var nTempBottomRowCount=this.m_nBottomRowCount;var nExpectationRows=this.m_nRealRows;if(strRplcDt!=""&&strRplcDt!="undefined"&&strRplcDt!=null){objStringArr=strRplcDt.split("?")}if(!bNotAddNode){if(this.isJsonRef()){var arNewRow=new Array();var strJson="";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(strRef==null||strRef==""){continue}arNewRow.push('"'+strRef+'":""')}var arJsonObject=this.jsonref.split(".");if(this.fixedRows==this.m_nRealRows){if(arJsonObject.length==1){strJson=arJsonObject[0]+"=[{"+arNewRow.join(",")+"}]"}else{if(arJsonObject.length>1){strJson='"'+arJsonObject[arJsonObject.length-1]+'":[{'+arNewRow.join(",")+"}]";for(var i=arJsonObject.length-2;i>0;i--){strJson='"'+arJsonObject[i]+'" : {'+strJson+"}"}strJson=arJsonObject[0]+"={"+strJson+"};"}}eval(strJson)}else{strJson="{"+arNewRow.join(",")+"}";eval(this.jsonref+".splice("+(nRow-1)+", 0,"+strJson+");")}}else{if(this.fixedRows==this.m_nRealRows){var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset.substring(0,this.nodeset.lastIndexOf("/")));var strNodeName=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);strNodeName=strNodeName.replace(/\[(.*)\]/g,"");var xnNewRow=SBGrid.UT.XmlLib.createChild(xnNodeset.item(0),strNodeName)}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);var strNodeName=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);strNodeName=strNodeName.replace(/\[(.*)\]/g,"");var xnNewRow=xnDoc.createElement(strNodeName);var xnParentNode=xnNodeset.item(0).parentNode;xnParentNode.insertBefore(xnNewRow,xnNodeset.item((nRow-this.fixedRows)))}var strSplitNodeset=this.nodeset;var htStartsWith=null;if(-1!=strSplitNodeset.indexOf("starts-with")){htStartsWith=new SBGrid.DS.Hashtable();strSplitNodeset=strSplitNodeset.replace(/\).*starts\-with\s*\(/g,"|");var arStartsWith=strSplitNodeset.replace(/(.*starts\-with(\s*)\((\s*))|(\)\s*\])/g,"").split("|");for(var i=0;i<arStartsWith.length;i++){var arNodeToVale=arStartsWith[i].split(",");htStartsWith[arNodeToVale[0]]=arNodeToVale[1].replace(/(\s*\')|(\'\s*)/g,"")}}var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(null!=strRef&&""!=strRef){if(null!=htStartsWith){if(null!=htStartsWith[strRef]){SBGrid.UT.XmlLib.createChildWithValue(xnNewRow,strRef,htStartsWith[strRef]);continue}}SBGrid.UT.XmlLib.createChild(xnNewRow,strRef)}}}}if(this.m_objScroll.nMaxLength<=this.m_nMakeIndex){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow++;if(null==this.m_objScroll.arTargetRow||this.m_nRealRows!=this.m_objScroll.arTargetRow.length){this.m_objScroll.arTargetRow=new Array();for(var i=0;i<this.m_nRealRows;i++){this.m_objScroll.arTargetRow.push(i)}this.m_objScroll.arTargetRow.push(this.m_nRealRows)}else{this.m_objScroll.arTargetRow.push(this.m_nRealRows)}}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow++;this.m_objScroll.nTargetHeight+=this.dataHeight;this.m_nMakeIndex++}if(this.rows==this.m_nRealRows){this.rows++}this.m_nRealRows++;if(!this.m_objScroll.bScrollEvent){if(nRow<(this.fixedRows+this.frozenRows)){var nCountRow=nRow;var nBottomRowCount;var bBottomRowStatus=false;while((nCountRow+1)!=(this.fixedRows+this.frozenRows)){nCountRow++}if(this.m_nBottomRowCount<this.frozenBottomRows){nBottomRowCount=this.m_nBottomRowCount;this.m_nBottomRowCount=0;bBottomRowStatus=true}for(var i=0;i<this.cols;i++){for(var j=(nExpectationRows-1);j>nCountRow;j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heControl.id="SBHE_"+strCellNewId;objCell.m_heControl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heControl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}var objCell=this.getCell(nCountRow,i);if(null!=objCell){this.physicalCreateCell(nCountRow+1,i,bIsFirstNode,objCell.m_bIsSubTotal,true);bIsFirstNode=false}}if(bBottomRowStatus){this.m_nBottomRowCount=nBottomRowCount+1}for(var i=0;i<this.cols;i++){var objCell=this.getCell(nCountRow,i);if(null!=objCell){var strCellNewId=this.id+"_"+(nCountRow+1)+"_"+i;var strCellOdlId=this.id+"_"+(nCountRow)+"_"+i;objCell.row=nCountRow+1;objCell.id=strCellNewId;this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);this.children.add(strCellOdlId,null);SBGrid.DEF.__appendAll(strCellOdlId,null);SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr);this.setRowStatus(nCountRow+1,objCell.getStatus())}}this.physicalRemovePartRow(nCountRow,nCountRow);for(var i=0;i<this.cols;i++){for(var j=nCountRow-1;j>(nRow-1);j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heControl.id="SBHE_"+strCellNewId;objCell.m_heControl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heControl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}}}else{if(nRow>(nExpectationRows-this.frozenBottomRows)&&this.frozenBottomRows>0){bIsBottomRow=true;for(var i=0;i<this.cols;i++){for(var j=(nExpectationRows-1);j>=nRow;j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heControl.id="SBHE_"+strCellNewId;objCell.m_heControl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heControl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}var strCellOldId=this.id+"_"+nRow+"_"+i;this.children.add(strCellOldId,null);SBGrid.DEF.__appendAll(strCellOldId,null)}if(nExpectationRows>=this.fixedRows+this.frozenBottomRows+this.frozenRows){var nShiftRow=nExpectationRows-this.frozenBottomRows;this.physicalRemovePartRow(nShiftRow,nShiftRow,nExpectationRows);nTempBottomRowCount=this.m_nBottomRowCount;for(var i=0;i<this.cols;i++){var objCell=this.getCell(nShiftRow,i);if(null!=objCell){this.physicalCreateCell(nShiftRow,i,bIsFirstNode,objCell.m_bIsSubTotal,true);bIsFirstNode=false}}for(var i=0;i<this.cols;i++){var objCell=this.getCell(nShiftRow,i);if(null!=objCell){SBGrid.CF.GridInit(objCell);SBGrid.CF.GridSetTextRefresh(objCell,SBGrid.CF.GridGetText(objCell),objStringArr);this.setRowStatus(nShiftRow,objCell.getStatus())}}}this.m_nBottomRowCount=nRow-(this.m_nRealRows-this.frozenBottomRows)}else{for(var i=0;i<this.cols;i++){for(var j=(nExpectationRows-1);j>(nRow-1);j--){if(0==i){jQuery('tr[rowNum="'+this.id+"_"+j+'"]').attr("rowNum",this.id+"_"+(j+1))}var objCell=this.getCell(j,i);if(null!=objCell){var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;objCell.m_heControl.id="SBHE_"+strCellNewId;objCell.m_heControl.setAttribute("rowNum",this.id+"_"+(j+1));objCell.m_heControl.setAttribute("cellId",this.id+"."+(j+1)+"."+i);if(objCell.m_heDataControl){objCell.m_heDataControl.id=strCellNewId+"_data"}this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);SBGrid.CF.GridInit(objCell)}}var strCellOldId=this.id+"_"+nRow+"_"+i;this.children.add(strCellOldId,null);SBGrid.DEF.__appendAll(strCellOldId,null)}}}}this.m_htRowHeight[nRow]=this.dataHeight;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heGridFFCol){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}bIsFirstNode=true;if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){this.physicalCreateCell(nRow,i,bIsFirstNode,bNotAddNode);bIsFirstNode=false}for(var i=0;i<this.cols;i++){SBGrid.CF.GridInit(this.getCell(nRow,i))}}else{for(var i=0;i<this.cols;i++){if(this.frozenBottomRows>0){var objCell=this.getCell(nExpectationRows-this.frozenBottomRows,i);objCell.attribute["background-color"]=null}for(var j=(nExpectationRows-1);j>=(nRow);j--){var objCell=this.getCell(j,i);var strCellNewId=this.id+"_"+(j+1)+"_"+i;objCell.row=j+1;objCell.id=strCellNewId;objCell.attribute.id=strCellNewId;this.children.add(strCellNewId,objCell);SBGrid.DEF.__appendAll(strCellNewId,objCell);objCell.attribute["background-color"]=null;SBGrid.CF.GridInit(objCell)}var objColumn=this.m_arColumn[i];var strColumnRef=objColumn.getAttribute("ref");var xnRowData;var jsonRowData;if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[nRow-this.fixedRows]}else{xnRowData=this.m_xlRefNode.item(nRow-this.fixedRows)}var strCellId=this.id+"_"+nRow+"_"+i;var objCell=null;if(i<this.fixedCols){objCell=new SBGrid.CT.DataGridCell(this,i,strCellId,nRow,"softbowl:cell");objCell.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}else{var xnCell;var jsonCell;if(this.isJsonRef()){jsonCell=jsonRowData}else{xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}objCell=new SBGrid.CT.DataGridCell(this,i,strCellId,nRow,"softbowl:cell");objCell.setElement(objColumn);this.setLinkedData(objCell,xnCell,jsonCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}this.children.add(strCellId,objCell);SBGrid.DEF.__appendAll(strCellId,objCell);SBGrid.CF.GridInit(objCell)}this.m_arCellStyleTable.splice(nRow,0,new Array());this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.scrollingGrid()}if(bIsBottomRow){this.m_nBottomRowCount=nTempBottomRowCount+1}this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow();this.defaultAttributeSetting();if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(!bNotAddNode){for(var i=0;i<this.cols;i++){var objCell=this.getCell(nRow,i);if(null!=objCell){objCell.m_bUserAddCell=true;if(!bPreserveStatus){objCell.setEditingMode(true)}}}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){this.selectRow(nRow)}this.setRowValue(nRow);this.setRowStatus(nRow,SBGrid.DEF.SBGS_NEW|SBGrid.DEF.SBGS_INSERT);this.setSeqForRowHeader();this.moveSubtotal(nRow,"insert")}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.addRowHasInstance=function(bRefresh,bPreserveStatus,bNotAddNode){this.stopEditing();this.clearSelection();var xnRowData;var jsonRowData;if(!bNotAddNode){if(this.isJsonRef()){var arNewRow=new Array();var strJson="";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(strRef==null||strRef==""){continue}arNewRow.push('"'+strRef+'":""')}var arJsonObject=this.jsonref.split(".");if(this.fixedRows==this.m_nRealRows){if(arJsonObject.length==1){strJson=arJsonObject[0]+"=[{"+arNewRow.join(",")+"}]"}else{if(arJsonObject.length>1){strJson='"'+arJsonObject[arJsonObject.length-1]+'":[{'+arNewRow.join(",")+"}]";for(var i=arJsonObject.length-2;i>0;i--){strJson='"'+arJsonObject[i]+'" : {'+strJson+"}"}strJson=arJsonObject[0]+"={"+strJson+"};"}}eval(strJson)}else{strJson="{"+arNewRow.join(",")+"}";eval(this.jsonref+".push("+strJson+");")}}else{if(this.fixedRows==this.m_nRealRows){var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);if(xnNodeset.length>0){xnNewRow=xnNodeset.item(0)}else{var strNodeset=this.nodeset.replace(/\[(.*)\]/g,"");SBGrid.DS.XMLStorage.getUniqueStorage().makeNode(strNodeset);xnNewRow=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceSinglePart(null,strNodeset)}}else{var xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);var strNodeName=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);strNodeName=strNodeName.replace(/\[(.*)\]/g,"");var xnNewRow=SBGrid.UT.XmlLib.createChild(xnNodeset.item(0).parentNode,strNodeName)}var strSplitNodeset=this.nodeset;var htStartsWith=null;if(-1!=strSplitNodeset.indexOf("starts-with")){htStartsWith=new SBGrid.DS.Hashtable();strSplitNodeset=strSplitNodeset.replace(/\).*starts\-with\s*\(/g,"|");var arStartsWith=strSplitNodeset.replace(/(.*starts\-with(\s*)\((\s*))|(\)\s*\])/g,"").split("|");for(var i=0;i<arStartsWith.length;i++){var arNodeToVale=arStartsWith[i].split(",");htStartsWith[arNodeToVale[0]]=arNodeToVale[1].replace(/(\s*\')|(\'\s*)/g,"")}}var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){var strRef=this.m_arColumn[i].getAttribute("ref");if(null!=strRef&&""!=strRef){if(null!=htStartsWith){if(null!=htStartsWith[strRef]){SBGrid.UT.XmlLib.createChildWithValue(xnNewRow,strRef,htStartsWith[strRef]);continue}}SBGrid.UT.XmlLib.createChild(xnNewRow,strRef)}}}}if(this.m_objScroll.nMaxLength<=this.m_nMakeIndex){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow++;if(null==this.m_objScroll.arTargetRow||this.m_nRealRows!=this.m_objScroll.arTargetRow.length){this.m_objScroll.arTargetRow=new Array();for(var i=0;i<this.m_nRealRows;i++){this.m_objScroll.arTargetRow.push(i)}this.m_objScroll.arTargetRow.push(this.m_nRealRows)}else{this.m_objScroll.arTargetRow.push(this.m_nRealRows)}}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow++;this.m_objScroll.nTargetHeight+=this.dataHeight;this.m_nMakeIndex++}var bFirstNode=true;var nFFBRowPosition=this.m_nRealRows-this.frozenBottomRows;if(this.m_nRealRows>=(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(nFFBRowPosition,nFFBRowPosition)}}if(this.rows==this.m_nRealRows){this.rows++}this.m_nRealRows++;this.m_htRowHeight[this.m_nRealRows-1]=this.dataHeight;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heGridFFCol){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.m_nRealRows>(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){var objCell;for(var i=0;i<this.cols;i++){objCell=this.getCell(nFFBRowPosition,i);if(null!=objCell){if(this.m_objScroll.bScrollEvent){objCell.attribute["background-color"]=null}else{this.physicalCreateCell(nFFBRowPosition,i,bFirstNode,objCell.m_bIsSubTotal,true)}bFirstNode=false}}if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){objCell=this.getCell(nFFBRowPosition,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}if(null!=objCell){this.setRowStatus(nFFBRowPosition,objCell.rowstatus)}}for(var i=0;i<this.cols;i++){if(this.m_objScroll.bScrollEvent){var objColumn=this.m_arColumn[i];var strColumnRef=objColumn.getAttribute("ref");if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[this.m_nRealRows-1-this.fixedRows]}else{xnRowData=this.m_xlRefNode.item(this.m_nRealRows-1-this.fixedRows)}var strCellId=this.id+"_"+(this.m_nRealRows-1)+"_"+i;if(i<this.fixedCols){var objCell=this.getCellById(strCellId);if(null!=objCell&&strCellId!=objCell.id){objCell=null}objCell=null==objCell?new SBGrid.CT.DataGridCell(this,i,strCellId,this.m_nRealRows-1,"softbowl:cell"):objCell;objCell.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}else{var xnCell;var jsonCell;if(this.isJsonRef()){jsonCell=jsonRowData}else{xnCell=SBGrid.UT.XmlLib.selectSingleNode(xnRowData,strColumnRef)}var objCell=this.getCellById(strCellId);if(null!=objCell&&strCellId!=objCell.id){objCell=null}objCell=null==objCell||strCellId!=objCell.id?new SBGrid.CT.DataGridCell(this,i,strCellId,this.m_nRealRows-1,"softbowl:cell"):objCell;objCell.setElement(objColumn);this.setLinkedData(objCell,xnCell,jsonCell);SBGrid.CF.GridSetMergeType(objCell,objColumn.m_bMerge)}}else{this.physicalCreateCell(this.m_nRealRows-1,i,false,bNotAddNode)}}if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){var objCell=this.getCell(this.m_nRealRows-1,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}this.m_objScroll.arTargetRow.push(this.m_nRealRows-1)}else{this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.scrollingGrid();this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow()}if(this.m_nRealRows>(this.fixedRows+this.frozenRows)&&this.frozenBottomRows>0&&!this.m_objScroll.bScrollEvent){this.m_nBottomRowCount++}if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(!bNotAddNode){this.defaultAttributeSetting();for(var i=0;i<this.cols;i++){var objCell=this.getCell(this.m_nRealRows-1,i);if(null!=objCell){objCell.m_bUserAddCell=true;if(!bPreserveStatus){objCell.setEditingMode(true)}}}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){this.selectRow(this.m_nRealRows-1)}this.setRowValue(this.m_nRealRows-1);this.setRowStatus(this.m_nRealRows-1,SBGrid.DEF.SBGS_NEW|SBGrid.DEF.SBGS_INSERT);this.setSeqForRowHeader()}};SBGrid.CT.DataGrid.prototype.RemoveRowHasInstance=function(bRefresh,bNotDeleteNode){this.stopEditing();this.clearSelection();this.clearMerge();if(this.fixedRows==this.m_nRealRows){return}if(!bNotDeleteNode){var objRemoveFcell=this.getCell(this.m_nRealRows-1,0);if(!objRemoveFcell.m_bUserAddCell){var strColSep=this.attribute.colsep;var strRowSep=this.attribute.rowsep;var strData="d"+strColSep+"-1";var nRowHeader=this.m_bRowHeader?1:0;for(var i=0+nRowHeader;i<this.cols;i++){strData+=strColSep;strData+=SBGrid.CF.GridGetText(this.getCell(this.m_nRealRows-1,i))}strData+=strRowSep;this.m_arUpdateDeleteList.push(strData)}var xnNodeset;var xnNodeItem;var objRemoveTargetCell=this.getCell(this.m_nRealRows-1,this.fixedCols);if(this.isJsonRef()){if(null!=objRemoveTargetCell){eval("SBGrid.DEF.arrRemoveAt("+this.jsonref+","+(this.m_nRealRows-1-this.fixedRows)+");")}}else{xnNodeset=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset);xnNodeItem=xnNodeset.item(0).parentNode;if(null!=objRemoveTargetCell){try{xnNodeItem.removeChild(xnNodeset.item(this.m_nRealRows-1-this.fixedRows))}catch(e){if(null!=window.console){console.log(" datagrid RemoveRow : "+e)}}}}}var nScrollMaxLen=this.m_objScroll.nMaxLength;if(nScrollMaxLen<=this.m_nMakeIndex&&nScrollMaxLen<this.m_nRealRows-this.m_nBottomRowCount){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow--}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow--;this.m_objScroll.nTargetHeight-=this.dataHeight;this.m_nMakeIndex--}this.m_htRowHeight[this.m_nRealRows-1]=null;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heGridFFCol){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(this.m_nRealRows-1,this.m_nRealRows-1)}var bFirstNode=true;var nShiftRow;if(this.m_nRealRows>(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){nShiftRow=this.m_nRealRows-this.frozenBottomRows-1;if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(nShiftRow,nShiftRow)}}if(this.rows==this.m_nRealRows){this.rows--}this.m_nRealRows--;if(this.m_nRealRows>=(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){var objCell;var nTempData=this.m_nBottomRowCount;this.m_nBottomRowCount=0;for(var i=0;i<this.cols;i++){objCell=this.getCell(nShiftRow,i);if(null!=objCell){if(this.m_objScroll.bScrollEvent){objCell.attribute["background-color"]=null}else{this.physicalCreateCell(nShiftRow,i,bFirstNode,objCell.m_bIsSubTotal,true)}bFirstNode=false}}this.m_nBottomRowCount=nTempData+1;if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){objCell=this.getCell(nShiftRow,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}if(null!=objCell){this.setRowStatus(nShiftRow,objCell.rowstatus)}}if(!this.m_objScroll.bScrollEvent){for(var i=0;i<this.cols;i++){var objCell=this.getCell(this.m_nRealRows-1,i);if(null!=objCell){SBGrid.CF.GridInit(objCell)}}}else{this.scrollingGrid();this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow()}if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(!bNotDeleteNode){this.setSeqForRowHeader()}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.RemoveColumnHasInstance=function(bRefresh){this.stopEditing();if(0==this.m_arColumn.length){return}this.clearSelection();this.clearMerge();var strRef=this.m_arColumn[this.cols-1].getAttribute("ref");if(this.isJsonRef()){try{var objGridItemJson=eval(this.jsonref)}catch(e){return}if(null!=objGridItemJson&&0<objGridItemJson.length){for(var i=(objGridItemJson.length-1);i>-1;i--){try{eval("delete "+this.jsonref+"["+i+"]."+strRef)}catch(e){SBGrid.DEF.errorMsg("RemoveColumn 함수 수행에 실패하였습니다::RemoveColumnHasInstance");return}}}}else{var xnDoc=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();if(null!=strRef&&!strRef.isEmpty()&&null!=xnDoc){for(var i=0;i<this.m_xlRefNode.length;i++){var xnRef=this.m_xlRefNode.item(i);if(null!=xnRef.lastChild){xnRef.removeChild(xnRef.lastChild)}}}}this.children.remove(this.m_arColumn[this.cols-1].id);SBGrid.DEF.__removeAll(this.m_arColumn[this.cols-1].id);this.setColGroupRemoveCol();this.m_arColumn[this.cols-1]=null;this.m_arColumn.pop();this.m_arColWidth.pop();this.m_arHiddenCol.pop();this.cols--;this.colWidthReset();if(null!=this.m_arCaption[0][this.cols-1]){for(var i=0;i<this.m_arCaption.length;i++){this.m_arCaption[i].pop()}}this.captionReset();for(var i=0;i<this.m_nRealRows;i++){this.physicalRemoveCell(i,this.cols)}if(bRefresh){this.refreshCurrentModel(this.attribute.ref)}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.captionReset=function(){var a=(this.m_bRowHeader)?1:0;this.attribute.caption="";for(var c=0;c<this.m_arCaption.length;c++){if(c>0){this.attribute.caption+="|"}for(var b=a;b<this.m_arCaption[c].length;b++){this.attribute.caption+=this.m_arCaption[c][b];if((b+1)<this.m_arCaption[c].length){this.attribute.caption+="^"}}}this.caption=this.attribute.caption};SBGrid.CT.DataGrid.prototype.colWidthReset=function(){var a=(this.m_bRowHeader)?1:0;var c=0;if(1==a){c+=this.m_arColWidth[0]}this.attribute.colwidth="";for(var b=a;b<this.m_arColWidth.length;b++){this.attribute.colwidth+=this.m_arColWidth[b];c+=this.m_arColWidth[b];if((b+1)<this.m_arColWidth.length){this.attribute.colwidth+=","}}this.setTableWidthChange(c)};SBGrid.CT.DataGrid.prototype.isChangedItem=function(){return this.m_bChangedItem};SBGrid.CT.DataGrid.prototype.setChangedItem=function(a){this.m_bChangedItem=a};SBGrid.CT.DataGrid.prototype.getNode=function(b){var g=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceDocument();var f=this.nodeset.substring(this.nodeset.lastIndexOf("/")+1,this.nodeset.length);if(f){var e=g.createElement(f);for(var c=0+nRowHeader;c<this.cols;c++){var h=this.m_arColumn[c].getAttribute("ref");if(h){var l=g.createElement(h);var d;var a=this.getCell(b,c);if(null!=a){d=l.ownerDocument.createTextNode(SBGrid.CF.GridGetText(a))}else{return null}l.appendChild(d);e.appendChild(l)}}return e}};SBGrid.CT.DataGrid.prototype.getJson=function(nRow){var joSelectJson=eval(this.attribute.jsonref+"["+(nRow-1)+"]");return joSelectJson};SBGrid.CT.DataGrid.prototype.getBindingType=function(){return SBGrid.DEF.SB_MULTIPLE};SBGrid.CT.DataGrid.prototype.defaultAction=function(b,a){SBGrid.CT.Group.prototype.defaultAction.call(this,b,a);switch(b){case"onbeforeedit":this.onBeforeEdit(a);break;case"onstartedit":this.onStartEdit(a);break;case"onentercell":this.onEnterCell(a);break;case"onleavecell":this.onLeaveCell(a);break;case"onafteredit":this.onAfterEdit(a);break;case"onbeforeuserresize":this.onBeforeUserResize(a);break;case"onafteruserresize":this.onAfterUserResize(a);break;case"onbeforemovecolumn":this.onBeforeMoveColumn(a);break;case"onaftermovecolumn":this.onAfterMoveColumn(a);break;case"onimestart":this.onImeStart(a);break;case"onspinupbuttonclick":this.onSpinUpButtonClick(a);break;case"onspindownbuttonclick":this.onSpinDownButtonClick(a);break}};SBGrid.CT.DataGrid.prototype.initGridProperties=function(){this.col=-1;this.row=-1;this.m_nEditRow=-1;this.m_nEditCol=-1;this.m_nPrevDownRow=-1;this.m_nPrevDownCol=-1;this.m_nDownRow=-1;this.m_nDownCol=-1;this.cols=this.m_arColumn.length;var e=this.attribute.caption;var c=e.split("|");this.m_arCaption=new Array();for(var h=0;h<c.length;h++){this.m_arCaption[h]=new Array();var n=c[h];var f=n.split("^");if(this.m_bRowHeader){this.m_arCaption[h][0]=" "}for(var g=0;g<f.length&&g<this.cols;g++){this.m_arCaption[h][(this.m_bRowHeader)?g+1:g]=f[g]}}var b=this.fixedRows;this.fixedRows=""!=e||this.m_bRowHeader?this.m_arCaption.length:0;if(b!=this.fixedRows){this.m_bChangeFixedRows=true}if(this.m_bRowHeader&&(0==this.fixedCols)){this.fixedCols=1}if(0==this.m_arColWidth.length){if(this.m_bRowHeader){if(null==this.m_arColWidth[0]){this.m_arColWidth[0]=20;this.m_arHiddenCol[0]=20}}var o=this.attribute.colwidth;if(null==o||o.isEmpty()){for(var h=0;h<this.cols;h++){var a=(this.m_bRowHeader)?h+1:h;if(null!=this.m_arColumn[a]){if(this.m_arColumn[a].visible){this.m_arColWidth[a]=100}else{this.m_arColWidth[a]=0;this.m_arColumn[a].m_bHiddenState=true}this.m_arHiddenCol[a]=100}}}else{var d=o.split(",");for(var h=0;h<this.cols;h++){var a=(this.m_bRowHeader)?h+1:h;if(null!=this.m_arColumn[a]){if(this.m_arColumn[a].visible){if(h<d.length&&!isNaN(Number(d[h].trim()))){this.m_arColWidth[a]=Number(d[h].trim())}else{this.m_arColWidth[a]=100}this.m_arHiddenCol[a]=this.m_arColWidth[a]}else{if(h<d.length&&!isNaN(Number(d[h].trim()))){this.m_arHiddenCol[a]=Number(d[h].trim())}else{this.m_arHiddenCol[a]=100}this.m_arColWidth[a]=0;this.m_arColumn[a].m_bHiddenState=true}}}}}this.m_arCombo=new Array();var l=0;while(true){var m=this.children.m_htCollection[this.id+"_combo_"+l];if(null!=m){this.m_arCombo.push(m)}else{break}l++}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){this.m_arSelectRows=new Array()}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){this.m_arSelectCols=new Array()}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){this.m_htSelectCells=new SBGrid.DS.Hashtable()}}}if(!this.m_bIsRowHeight&&this.m_htFixedStyle&&this.m_htFixedStyle.height){this.m_nRowHeight=parseInt(this.m_htFixedStyle.height)}else{if(this.m_htFixedStyle&&this.m_htFixedStyle.height){this.m_htFixedStyle.height=this.m_nRowHeight+"px"}}if(this.m_htDataStyle&&this.m_htDataStyle.height){this.dataHeight=parseInt(this.m_htDataStyle.height)}};SBGrid.CT.DataGrid.prototype.hasInstance=function(){return("xml"==this.getAttribute("datatype"))};SBGrid.CT.DataGrid.prototype.appendColumn=function(a){this.m_arColumn.push(a)};SBGrid.CT.DataGrid.prototype.createColumns=function(objJson){var strErrorMsg="";if(arguments.length!=1){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(!(objJson instanceof Array)){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if parameter type is 'Array'.",SBGrid.DEF.DEBUG_MODE);return}else{if(objJson.length<=0){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if parameter array's length is 0.",SBGrid.DEF.DEBUG_MODE);return}else{var nIdNumber=0;var strId,strType,strRef,strStyle,strFormat,strCalc;if(this.m_bRowHeader){strId=this.GenerateID("softbowl:"+this.id+"_col");var objGridCol=new SBGrid.CT.GridCol(this.id,true,true,"","","",1,false,true,true,"","","",strId,"",-1,true,"","",-1,-1,"default","","",0,1,"auto",-1,"",-1,"",false,"",false,"","xforms:col",this.attribute.rowheader,"","","","","","","","","",false,"visible","","","");this.appendColumn(objGridCol)}var bExistImage=false;for(var i=0;i<(objJson.length);i++){if(!(objJson[i].id)){objJson[i].id=this.GenerateID("softbowl:"+this.id+"_col")}else{if((typeof objJson[i].id)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'id' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].type)){objJson[i].type="output"}else{if((typeof objJson[i].type)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'type' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(objJson[i].type=="image"){bExistImage=true}}if(!(objJson[i].ref)){objJson[i].ref=""}else{if((typeof objJson[i].ref)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'ref' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].style)){objJson[i].style=""}else{if((typeof objJson[i].style)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'style' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].format)){objJson[i].format=""}else{if((typeof objJson[i].format)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'format' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].calc)){objJson[i].calc=""}else{if((typeof objJson[i].calc)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'calc' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].validate)){objJson[i].validate=""}else{if((typeof objJson[i].validate)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'validate' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].disabled)){objJson[i].disabled=false}else{if((typeof objJson[i].disabled)!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'disabled' property's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].type=="combo"){if(!(objJson[i].strNodeSet)){objJson[i].strNodeSet=""}else{if((typeof objJson[i].strNodeSet)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].strJsonNodeSet)){objJson[i].strJsonNodeSet=""}else{if((typeof objJson[i].strJsonNodeSet)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strJsonNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].strNodeSet==""&&objJson[i].strJsonNodeSet==""){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check 'strNodeSet' and 'strJsonNodeSet' property's value is null.",SBGrid.DEF.DEBUG_MODE)}else{if((typeof objJson[i].strNodeSet)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strNodeSet' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].strLabelRef)){objJson[i].strLabelRef=""}else{if((typeof objJson[i].strLabelRef)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strLabelRef' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(!(objJson[i].strValueRef)){objJson[i].strValueRef=""}else{if((typeof objJson[i].strValueRef)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'strValueRef' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}if(objJson[i].imageUri==null||objJson[i].imageUri=="undefined"){objJson[i].imageUri=""}if(objJson[i].imageWidth==null||objJson[i].imageWidth=="undefined"){objJson[i].imageWidth="100%"}if(objJson[i].imageHeight==null||objJson[i].imageHeight=="undefined"){objJson[i].imageHeight="100%"}if(objJson[i].imageStyle==null||objJson[i].imageStyle=="undefined"){objJson[i].imageStyle=""}if(objJson[i].imageClick==null||objJson[i].imageClick=="undefined"){objJson[i].imageClick=""}if(objJson[i].imageClick==null||objJson[i].imageClick=="undefined"){objJson[i].imageAlt=""}}if(!(objJson[i].title)||(objJson[i].type!="input"&&objJson[i].type!="combo")){objJson[i].title=""}else{if((objJson[i].title)&&((typeof objJson[i].title)!="string")){SBGrid.DEF.APIerrorMsg(this.id+".createColumns","Please check if 'title' property's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}}}var arComboIdList=new Array();for(var i=0;i<(objJson.length);i++){var objGridCol=new SBGrid.CT.GridCol(this.id,true,true,"","true,false","",1,objJson[i].disabled,true,true,"","",objJson[i].format,objJson[i].id,"",-1,true,"","",-1,-1,"default",objJson[i].ref,"",0,1,"auto",-1,"*",-1,"",false,"",false,objJson[i].style,"softbowl:col",objJson[i].type,objJson[i].imageUri,objJson[i].imageWidth,objJson[i].imageHeight,objJson[i].imageStyle,objJson[i].imageClick,objJson[i].imageAlt,objJson[i].title,"","",false,"visible",objJson[i].calc,objJson[i].validate,"");this.appendColumn(objGridCol);if(objJson[i].type=="combo"){var strComboId=this.GenerateID("softbowl:"+this.id+"_combo_");var objCombo=new SBGrid.CT.GridCombo(this.id,"","","","","","","","1","acrossdown",false,false,false,false,"",strComboId,20,"","",9007199254740992,"","","","","*","","",null,false,"","softbowl:select1","","visible",0,true,objJson[i].strNodeSet,objJson[i].strJsonNodeSet,objJson[i].strLabelRef,objJson[i].strValueRef,"minimal","","",null,null,objJson[i].id);eval("SBGrid.DEF."+objCombo.id+"=objCombo");arComboIdList.push(objCombo.id)}else{arComboIdList.push("")}}this.init();for(var i=0,j=arComboIdList.length;i<j;i++){if(arComboIdList[i]!=""){document.getElementById("SBHE_"+arComboIdList[i]+".input").setAttribute("title",objJson[i].title)}}if(bExistImage){this.setAutoResize(true,false)}this.refresh();if(bExistImage){window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",200)}}}};SBGrid.CT.DataGrid.prototype.getFixedFrozenColWidth=function(){var a=0;for(var b=0;b<(this.fixedCols+this.frozenCols);b++){a+=this.m_arColWidth[b]}return a};SBGrid.CT.DataGrid.prototype.getFixedFrozenRowHeight=function(){var a=0;for(var b=0;b<(this.fixedRows+this.frozenRows);b++){if(this.m_htRowHeight[b]){a+=this.m_htRowHeight[b]}}return a};SBGrid.CT.DataGrid.prototype.getFrozenBottomRowHeight=function(){var a=0;for(var b=this.m_nRealRows-this.frozenBottomRows;b<this.m_nRealRows;b++){if(this.m_htRowHeight[b]){a+=this.m_htRowHeight[b]}}return a};SBGrid.CT.DataGrid.prototype.getAllowSelection=function(){return this.allowSelection};SBGrid.CT.DataGrid.prototype.getAllowBigSelection=function(){return this.allowBigSelection};SBGrid.CT.DataGrid.prototype.getSelectionMode=function(){var a=this.getAttribute("selectionmode");switch(a){case"listbox":return SBGrid.DEF.SBSM_LIST;case"byrow":return SBGrid.DEF.SBSM_BYROW;case"bycol":return SBGrid.DEF.SBSM_BYCOL;case"free":return SBGrid.DEF.SBSM_FREE;default:return SBGrid.DEF.SBSM_LIST}};SBGrid.CT.DataGrid.prototype.setSelectionMode=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setSelectionMode","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setSelectionMode","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(a=="listbox"||a=="byrow"||a=="bycol"||a=="free"){if(this.getAttribute("selectionmode")!=a){this.setAttribute("selectionmode",a);this.rebuild()}}else{if(this.getAttribute("selectionmode")!="listbox"){this.setAttribute("selectionmode","listbox");this.rebuild()}}};SBGrid.CT.DataGrid.prototype.isEditing=function(){return this.m_bEditing};SBGrid.CT.DataGrid.prototype.getEditRow=function(){return this.m_nEditRow};SBGrid.CT.DataGrid.prototype.getEditCol=function(){return this.m_nEditCol};SBGrid.CT.DataGrid.prototype.getRow=function(){return this.row};SBGrid.CT.DataGrid.prototype.setRowValue=function(a){this.row=a};SBGrid.CT.DataGrid.prototype.setRow=function(c){if(c>=this.m_nRealRows||c<-1){return}this.row=c;this.clearSelection();var b=this.getSelectionMode();if(c>=this.fixedRows){if(SBGrid.DEF.SBSM_LIST==b||SBGrid.DEF.SBSM_BYROW==b){this.selectRow(c)}else{if(SBGrid.DEF.SBSM_FREE==b){var a=this.getCell(c,this.col);if(null!=a){this.addSelCells(c,this.col,a)}a=null}}}if(this.col>=this.fixedCols){if(SBGrid.DEF.SBSM_BYCOL==b){this.selectCol(this.col)}}};SBGrid.CT.DataGrid.prototype.getCol=function(){return this.col};SBGrid.CT.DataGrid.prototype.setColValue=function(a){this.col=a};SBGrid.CT.DataGrid.prototype.setCol=function(c){if(c>=this.cols||c<-1){return}this.col=c;this.clearSelection();var b=this.getSelectionMode();if(c>=this.fixedCols){if(SBGrid.DEF.SBSM_BYCOL==b){this.selectCol(c)}else{if(SBGrid.DEF.SBSM_FREE==b){var a=this.getCell(this.row,c);if(null!=a){this.addSelCells(this.row,c,a)}a=null}}}if(this.row>=this.fixedRows){if(SBGrid.DEF.SBSM_LIST==b||SBGrid.DEF.SBSM_BYROW==b){this.selectRow(this.row)}}};SBGrid.CT.DataGrid.prototype.getMouseRow=function(){return parseInt(this.getAttribute("row"))};SBGrid.CT.DataGrid.prototype.setMouseRow=function(a){this.setAttribute("row",String(a))};SBGrid.CT.DataGrid.prototype.getMouseCol=function(){return parseInt(this.getAttribute("col"))};SBGrid.CT.DataGrid.prototype.getClickedRow=function(){return this.m_nDownRow};SBGrid.CT.DataGrid.prototype.getClickedCol=function(){return this.m_nDownCol};SBGrid.CT.DataGrid.prototype.setColType=function(l,c){if((null==l||null==c)||(0>l||this.cols<=l)){return}var b=this.m_arColumn[l];var d;var m=this.m_replaceString;if(m!=""&&m!="undefined"&&m!=null){d=m.split("?")}if(null!=b){var g;switch(c){case"output":case"input":case"radio":case"checkbox":case"inputbutton":case"inputdate":case"combo":if(b.getAttribute("type")==c){return}else{g=b.getAttribute("type");b.setAttribute("type",c);b.init()}break;default:return}this.stopEditing();this.clearSelection();var n=this.m_arColWidth[l];var a=true;if(("output"==c&&"input"==g)||("input"==c&&"output"==g)||("radio"==c&&"checkbox"==g)||("checkbox"==c&&"radio"==g)||("inputbutton"==c&&"inputdate"==g)||("inputdate"==c&&"inputbutton"==g)){a=false}for(var h=this.fixedRows;h<this.m_nRealRows;h++){var e=this.getCell(h,l);if(null!=e){if(a){if(("inputdate"==c||"inputbutton"==c)){e.m_heControl.vAlign="top"}else{e.m_heControl.vAlign="middle"}var f=b.makeCellElement(SBGrid.CF.GridGetText(e),n,e.id,e.attribute);e.m_heControl.innerHTML=f;if("checkbox"==c||"radio"==c){e.setAttribute("text-align","center")}SBGrid.CF.GridInit(e)}SBGrid.CF.GridSetTextRefresh(e,SBGrid.CF.GridGetText(e),d)}}}};SBGrid.CT.DataGrid.prototype.colType=function(c){var a=this.getColumnControl(c);if(null==a){return""}var b=a.getColType();switch(b){case 0:return"output";case 1:return"input";case 2:return"combo";case 3:return"check";case 4:return"radio";case 5:return"inputbutton";case 6:return"inputdate";default:return""}};SBGrid.CT.DataGrid.prototype.valueMatrix=function(b,c){var a=this.getCell(b,c);if(null!=a){if(this.isFixedCell(b,c)){return this.labelMatrix(b,c)}if(a.getNodeElement()||a.getJsonObject()){return SBGrid.CF.GridGetText(a)}else{return a.text}}return""};SBGrid.CT.DataGrid.prototype.setValueMatrix=function(b,d,c){var a=this.getCell(b,d);if(null!=a){c=String(c);if(a.getNodeElement()||a.getJsonObject()){SBGrid.CF.GridSetText(a,c)}else{a.text=c}if(this.isFixedCell(b,d)){SBGrid.CF.GridSetFixedWindowText(a,c)}else{a.setWindowText(c)}}return""};SBGrid.CT.DataGrid.prototype.tooltipText=function(b,c){var a=this.getCell(b,c);if(null!=a){if(null!=a.m_heControl.title){return a.m_heControl.title}}return""};SBGrid.CT.DataGrid.prototype.setTooltipText=function(b,d,c){var a=this.getCell(b,d);if(null!=a){a.m_heControl.title=c}};SBGrid.CT.DataGrid.prototype.sortClear=function(){this.m_htColSort=new SBGrid.DS.Hashtable()};SBGrid.CT.DataGrid.prototype.colSort=function(a){switch(this.m_htColSort[a]){case SBGrid.DEF.SBST_ASC:return"asc";break;case SBGrid.DEF.SBST_DESC:return"desc";break;case SBGrid.DEF.SBST_NONE:return"none";break;default:return"none"}};SBGrid.CT.DataGrid.prototype.setColSort=function(d,c){if((null==d||null==c)||(0>d||this.cols<=d)){return}var a;switch(c){case"asc":a=SBGrid.DEF.SBST_ASC;break;case"desc":a=SBGrid.DEF.SBST_DESC;break;case"none":a=SBGrid.DEF.SBST_NONE;break;default:return}var b=this.m_arColumn[d];if(null!=b){this.m_htColSort[d]=a}};SBGrid.CT.DataGrid.prototype.setMouseCol=function(a){this.setAttribute("col",String(a))};SBGrid.CT.DataGrid.prototype.setCellComboNodeset=function(b,e,d){var a=this.getCell(b,e);var c=this.m_arColumn[e];if(null!=a&&null!=c){a.setAttribute("nodeset",d);c.m_bIsCellCombo=true}};SBGrid.CT.DataGrid.prototype.setCellComboJson=function(c,e,a){var b=this.getCell(c,e);var d=this.m_arColumn[e];if(null!=b&&null!=d){b.setAttribute("jsonnodeset",a);d.m_bIsCellCombo=true}};SBGrid.CT.DataGrid.prototype.isSortable=function(){var b=this.getRowHeader()!=0?1:0;var a=false;switch(this.m_nExplorerBarType){case SBGrid.DEF.SBEB_SORT:case SBGrid.DEF.SBEB_SORT_SHOW:case SBGrid.DEF.SBEB_SORT_MOVE:case SBGrid.DEF.SBEB_SORT_SHOW_MOVE:a=true}if(a){if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&this.m_nDownCol>=b){return a}else{return false}}return a};SBGrid.CT.DataGrid.prototype.isPossibleFiltering=function(){var a=false;switch(this.m_nExplorerUIType){case SBGrid.DEF.SBEB_UI_FILTERING:case SBGrid.DEF.SBEB_UI_FILTERING_HIDE:case SBGrid.DEF.SBEB_UI_FILTERING_SHOW:case SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW:a=true}return a};SBGrid.CT.DataGrid.prototype.isPossibleHideColumns=function(){var a=false;switch(this.m_nExplorerUIType){case SBGrid.DEF.SBEB_UI_HIDE:case SBGrid.DEF.SBEB_UI_FILTERING_HIDE:case SBGrid.DEF.SBEB_UI_HIDE_SHOW:case SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW:a=true}return a};SBGrid.CT.DataGrid.prototype.isFixedCell=function(a,b){return((0<=a&&this.fixedRows>a)||(0<=b&&this.fixedCols>b))};SBGrid.CT.DataGrid.prototype.isFixedRow=function(a){return(0<=a&&this.fixedRows>a)};SBGrid.CT.DataGrid.prototype.isFixedCol=function(a){return(0<=a&&this.fixedCols>a)};SBGrid.CT.DataGrid.prototype.isFrozenRow=function(a){return((this.fixedRows<=a&&a<(this.fixedRows+this.frozenRows))||(a>=this.m_nRealRows-this.m_nBottomRowCount))};SBGrid.CT.DataGrid.prototype.isFrozenCell=function(a,b){return((this.fixedRows<=a)&&(this.fixedCols<=b))&&((a<(this.fixedRows+this.frozenRows))||(a>=this.m_nRealRows-this.m_nBottomRowCount)||(b<(this.fixedCols+this.frozenCols)))};SBGrid.CT.DataGrid.prototype.isNormalCell=function(a,b){if(-1==a||-1==b){return false}return(!this.isFixedCell(a,b))};SBGrid.CT.DataGrid.prototype.sort=function(c,d,a,b){switch(this.m_nSortType){case SBGrid.DEF.SBST_ASC:return"asc";case SBGrid.DEF.SBST_DESC:return"desc";case SBGrid.DEF.SBST_USERSORT:return"usersort";case SBGrid.DEF.SBST_NONE:return"none"}};SBGrid.CT.DataGrid.prototype.setSort=function(o,f,n,d,b){if(o<this.fixedRows||n<this.fixedRows||n>=this.m_nRealRows){return}if(f<this.fixedCols||d<this.fixedCols||d>=this.cols){return}this.clearSelection();if(this.isSubtotalAll()){this.clearAllSubTotalRow()}if(this.m_nRealRows!=this.m_nMakeIndex){SBGrid.CT.DataGrid.PartiallyCount=this.m_nRealRows;if(!SBGrid.DEF.is_smartphone){if(this.m_nBottomRowCount>0){for(var l=this.m_nRealRows-this.m_nBottomRowCount;l<this.m_nRealRows;l++){for(var g=0;g<this.cols;g++){var e=this.getCell(l,g);if(null!=e){this.children.remove(e.id);SBGrid.DEF.__removeAll(e.id)}}}this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild)}this.makePartially();this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow()}else{for(var l=0;l<this.m_nRealRows;l++){for(var g=0;g<this.cols;g++){var e=this.getCell(l,g);if(null!=e){this.children.remove(e.id);SBGrid.DEF.__removeAll(e.id)}}}this.makeSmartPhoneGrid()}SBGrid.CT.DataGrid.PartiallyCount=100}var c=isFinite(o)?o:this.fixedRows;var m=isFinite(f)?f:this.fixedCols;var a=isFinite(n)?n:this.m_nRealRows-1;var h=isFinite(d)?d:this.cols-1;switch(b){case"asc":case"desc":this.m_nSortType="asc"==b?SBGrid.DEF.SBST_ASC:SBGrid.DEF.SBST_DESC;this.sortEx(m,c,a,this.m_nSortType);break;case"usersort":this.m_nSortType=SBGrid.DEF.SBST_USERSORT;this.sortUserType(c,m,a,h);break;default:this.m_nSortType=SBGrid.DEF.SBST_NONE;break}if(this.getRowHeader()==SBGrid.DEF.SBRH_SEQ||this.getRowHeader()==SBGrid.DEF.SBRH_REVERSESEQ){}this.defaultAttributeSetting()};SBGrid.CT.DataGrid.prototype.sortUserType=function(e,l,a,h){var b=l;var f=new Array();var m=null;while(b<=h){var d=this.m_htColSort[b];if(null==d||SBGrid.DEF.SBST_NONE==d){break}else{if(b==l){this.sortEx(b,e,a,d);this.colCellGroup(b,e,a,f)}else{var c=new Array();for(var g=0;g<f.length;g++){if(f[g][0]!=f[g][1]){this.sortEx(b,f[g][0],f[g][1],d);this.colCellGroup(b,f[g][0],f[g][1],c)}}f=c}}b++}};SBGrid.CT.DataGrid.prototype.colCellGroup=function(h,e,b,f){var l=null;var m=0;var a=0;var c;if(-1!=h){while(true){var d=this.getCell(e,h);if(null!=d){if(d.m_bIsSubTotal){e++;continue}else{c=e;l=SBGrid.CF.GridGetText(d);if(null==f[a]){f[a]=new Array()}f[a][0]=c;f[a][1]=c+m;break}}}for(var g=e+1;g<=b;g++){d=this.getCell(g,h);if(null!=d&&!d.m_bIsSubTotal){if(l==SBGrid.CF.GridGetText(d)){m++;if(null==f[a]){f[a]=new Array()}f[a][0]=c;f[a][1]=c+m}else{l=SBGrid.CF.GridGetText(d);m=0;c=g;a++;if(null==f[a]){f[a]=new Array()}f[a][0]=c;f[a][1]=c+m}}else{m++}}}else{f[0]=new Array();f[0][0]=e;f[0][1]=b}};SBGrid.CT.DataGrid.prototype.colCellGroupArray=function(b,g,e,r){for(var l=1;l<b.length;l++){var c=new Array();var n=0;var m=b[l];if(-1==m){continue}var p=0;while(true){if(null==r[p]){break}var a=r[p][0];var o=r[p][1];var q=this.getCell(a,m);var f=SBGrid.CF.GridGetText(q);for(var h=a;h<=o;h++){var d=this.getCell(h,m);if(d.m_bIsSubTotal){continue}strCurrentRowValue=SBGrid.CF.GridGetText(d);if(null==c[n]){c[n]=new Array();c[n][0]=h}if(f!=strCurrentRowValue){f=strCurrentRowValue;n++;c[n]=new Array();c[n][0]=h;c[n][1]=h}else{c[n][1]=h}}n++;p++}r=c}return r};SBGrid.CT.DataGrid.prototype.sortEx=function(w,v,d,f){if(v>=d){return}this.clearFiltering();var g,x=this.m_replaceString;if(x!=""&&x!="undefined"&&x!=null){g=x.split("?")}if(this.m_bIsSort){for(var r=0;r<this.m_xlRefNode.length;r++){var n=null;for(var q=this.fixedCols;q<this.cols;q++){var n=this.getCell(r+this.fixedRows,q);if(null!=n){if(this.isJsonRef()){this.m_arSortJson[r][q].bIsSelect=n.selected}else{this.m_arSortNodeList[r][q].bIsSelect=n.selected}}}if(null!=n){if(this.isJsonRef()){this.m_arSortJson[r].splice(this.m_arSortJson[r].length-1,1,this.getRowStatus(r+this.fixedRows))}else{this.m_arSortNodeList[r].splice(this.m_arSortNodeList[r].length-1,1,this.getRowStatus(r+this.fixedRows))}}}}else{this.m_arSortNodeList=null;this.m_arSortJson=null;this.m_arSortNodeList=new Array();this.m_arSortJson=new Array();for(var r=0;r<this.m_xlRefNode.length;r++){this.m_arSortNodeList[r]=new Array();this.m_arSortJson[r]=new Array();for(var q=this.fixedCols;q<this.cols;q++){var n=this.getCell(r+this.fixedRows,q);var c=false;if(null!=n){c=n.selected}var h=this.m_arColumn[q].getAttribute("ref");if(this.isJsonRef()){var t=this.m_arColumn[q].getAttribute("ref");var l=new Object();l[t]=this.m_xlRefNode[r][t];this.m_arSortJson[r][q]={Data:l,bIsSelect:c}}else{this.m_arSortNodeList[r][q]={Data:SBGrid.UT.XmlLib.selectSingleNode(this.m_xlRefNode.item(r),h),bIsSelect:c}}}var n=this.getCell(r+this.fixedRows,w);if(null!=n){if(this.isJsonRef()){this.m_arSortJson[r].push(this.getRowStatus(r+this.fixedRows))}else{this.m_arSortNodeList[r].push(this.getRowStatus(r+this.fixedRows))}}else{if(this.isJsonRef()){this.m_arSortJson[r].push(SBGrid.DEF.SBGS_NEW)}else{this.m_arSortNodeList[r].push(SBGrid.DEF.SBGS_NEW)}}}}var u=this.getSelectionMode();if(SBGrid.DEF.SBSM_LIST==u||SBGrid.DEF.SBSM_BYROW==u||SBGrid.DEF.SBSM_FREE==u){this.clearSelection()}var s=v-this.fixedRows;var o=d-this.fixedRows;var y;if(this.isJsonRef()){y=this.m_arSortJson.slice(s,o+1);this.m_arSortJson.splice(s,o-s+1)}else{y=this.m_arSortNodeList.slice(s,o+1);this.m_arSortNodeList.splice(s,o-s+1)}var e=false;var b=new Array();for(var r=0;r<y.length;r++){b[r]=new Array();var m;if(this.isJsonRef()){m=y[r][w].Data[this.m_arColumn[w].getAttribute("ref")]+""}else{m=SBGrid.DS.XMLStorage.getUniqueStorage().getValue(y[r][w].Data)}if(isFinite(m)){m=Number(m)}else{m=m;e=true}b[r][0]=m;b[r][1]=r}if(e){b.sort()}else{b.sort(SBGrid.DEF.numberorder)}this.m_strSortIconStatus="up";if(f==SBGrid.DEF.SBST_DESC){b.reverse();this.m_strSortIconStatus="down"}var a=s;for(var r=0;r<y.length;r++){if(this.isJsonRef()){this.m_arSortJson.splice(a,0,y[b[r][1]])}else{this.m_arSortNodeList.splice(a,0,y[b[r][1]])}a++}for(var r=this.fixedRows;r<this.m_nRealRows;r++){var p=false;for(var q=this.fixedCols;q<this.cols;q++){var n=this.getCell(r,q);if(null!=n){if(this.isJsonRef()){n.setJsonObject(this.m_arSortJson[r-this.fixedRows][q].Data)}else{n.setNodeElement(this.m_arSortNodeList[r-this.fixedRows][q].Data)}SBGrid.CF.GridSetTextRefresh(n,SBGrid.CF.GridGetText(n),g);if(SBGrid.DEF.SBSM_FREE==u){if(this.isJsonRef()){if(this.m_arSortJson[r-this.fixedRows][q].bIsSelect){this.addSelCells(r,q,n)}}else{if(this.m_arSortNodeList[r-this.fixedRows][q].bIsSelect){this.addSelCells(r,q,n)}}}p=true}}if(p){if(SBGrid.DEF.SBSM_LIST==u||SBGrid.DEF.SBSM_BYROW==u){if(this.isJsonRef()){if(this.m_arSortJson[r-this.fixedRows][this.fixedCols].bIsSelect){this.selectRow(r)}}else{if(this.m_arSortNodeList[r-this.fixedRows][this.fixedCols].bIsSelect){this.selectRow(r)}}}if(this.isJsonRef()){if(null!=this.m_arSortJson[r-this.fixedRows][q]){this.setRowStatus(r,this.m_arSortJson[r-this.fixedRows][q])}}else{if(null!=this.m_arSortNodeList[r-this.fixedRows][q]){this.setRowStatus(r,this.m_arSortNodeList[r-this.fixedRows][q])}}}}this.m_bIsSort=true;if(this.isPossibleFiltering()){this.createIndexesForFiltering();alert("Filtering Information rebuilding is complate!")}};SBGrid.CT.DataGrid.prototype.getSortShowIcon=function(d){if(null==this.m_objSortIcon){this.m_objSortIcon={heTable:null,heFristTd:null,heImgDiv:null,heBeforeCell:null,heBeforeCellData:null};this.m_objSortIcon.heTable=document.createElement("table");var g=this.m_objSortIcon.heTable;var e=document.createElement("tbody");g.appendChild(e);var f=document.createElement("tr");e.appendChild(f);this.m_objSortIcon.heFristTd=document.createElement("td");var c=this.m_objSortIcon.heFristTd;var b=document.createElement("td");f.appendChild(c);f.appendChild(b);g.border="0";g.cellPadding="0";g.cellSpacing="0";g.style.height=SBGrid.DEF.is_mozBrowser?"97%":"100%";jQuery(g).addClass("sbgrid_datagrid_InputButton_table");c.style.width="100%";jQuery(c).addClass("sbgrid_sort_Td");b.style.width="13px";b.style.height=SBGrid.DEF.is_mozBrowser?"98%":"100%";jQuery(b).addClass("sbgrid_sort_Td");this.m_objSortIcon.heImgDiv=document.createElement("div");b.appendChild(this.m_objSortIcon.heImgDiv)}if(this.m_objSortIcon.heBeforeCell!=d.m_heControl){if(null!=this.m_objSortIcon.heBeforeCell){this.m_objSortIcon.heBeforeCell.appendChild(this.m_objSortIcon.heBeforeCellData)}this.m_objSortIcon.heBeforeCell=d.m_heControl;this.m_objSortIcon.heBeforeCellData=d.m_heControl.lastChild;this.m_objSortIcon.heFristTd.appendChild(this.m_objSortIcon.heBeforeCellData);d.m_heControl.appendChild(this.m_objSortIcon.heTable)}if(null!=this.m_strSortIconStatus){var a="sbgrid_sort_"+this.m_strSortIconStatus;if(a!=this.m_objSortIcon.heImgDiv.className){jQuery(this.m_objSortIcon.heImgDiv).removeClass(this.m_objSortIcon.heImgDiv.className);jQuery(this.m_objSortIcon.heImgDiv).addClass(a)}a=null}};SBGrid.CT.DataGrid.prototype.getShowExplorerUI=function(objRectOfExplorerBarIcon){SBGrid.DEF.STR_SBGRID_ID=this.id;var objExplorerUI=document.getElementById("sb_explorerUI_top");if(!objExplorerUI){var bAttach=false;if(window.attachEvent){bAttach=true}objExplorerUI=document.createElement("div");objExplorerUI.setAttribute("id","sb_explorerUI_top");objExplorerUI.style.zIndex="1";var objDivParentSet;var objDivIcon;var objDivLabel;if(this.isPossibleFiltering()){objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivLabel=document.createElement("div");objDivLabel.appendChild(document.createTextNode("Filtering"));jQuery(objDivParentSet).addClass("sb_explorerUI_step1 align_bottom sb_explorerUI_flitering");jQuery(objDivIcon).addClass("sb_explorerUI_flitering_icon");jQuery(objDivLabel).addClass("sb_explorerUI_flitering_label");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivLabel);objDivParentSet.onmouseover=function(){eval(SBGrid.DEF.STR_SBGRID_ID+".getShowFilteringUI();")};objExplorerUI.appendChild(objDivParentSet)}if(this.isPossibleHideColumns()){objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivLabel=document.createElement("div");objDivLabel.appendChild(document.createTextNode("Hide Columns"));jQuery(objDivParentSet).addClass("sb_explorerUI_step1 sb_explorerUI_hide_column");jQuery(objDivIcon).addClass("sb_explorerUI_hide_column_icon");jQuery(objDivLabel).addClass("sb_explorerUI_hide_column_label");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivLabel);objDivParentSet.onmouseover=function(){eval(SBGrid.DEF.STR_SBGRID_ID+".getShowHideColumnUI();")};objExplorerUI.appendChild(objDivParentSet)}var objBody=document.getElementById(this.parentId);objBody.appendChild(objExplorerUI)}var nExplorerUILeft=objRectOfExplorerBarIcon.getX()+objRectOfExplorerBarIcon.getWidth()-13;var nExplorerUIBottom=objRectOfExplorerBarIcon.getBottom()+1;objExplorerUI.style.visibility="visible";objExplorerUI.style.left=String(nExplorerUILeft)+"px";objExplorerUI.style.top=String(nExplorerUIBottom)+"px"};SBGrid.CT.DataGrid.prototype.getShowHideColumnUI=function(){this.deleteShowFilteringUI();if(!(this.isPossibleHideColumns())){return}var objHideColumnUI=document.getElementById("sb_explorerUI_hide_column_top");if(!objHideColumnUI){objHideColumnUI=document.createElement("div");objHideColumnUI.setAttribute("id","sb_explorerUI_hide_column_top");objHideColumnUI.style.zIndex="1";var objDivParentSet;var objDivIcon;var objDivColumnName;for(var i=0;i<this.getCols();i++){objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivColumnName=document.createElement("div");objDivColumnName.appendChild(document.createTextNode(this.textMatrix(0,i)));jQuery(objDivParentSet).addClass("sb_explorerUI_hide_column_step1 sb_explorerUI_hide_column");jQuery(objDivIcon).addClass("sb_explorerUI_hide_column_status_icon");objDivIcon.setAttribute("id","sb_explorerUI_hide_column_status_icon_"+String(i));jQuery(objDivColumnName).addClass("sb_explorerUI_column_name");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivColumnName);objDivParentSet.onclick=function(event){var objTarget=event.target;if(objTarget.getAttribute("class")!="sb_explorerUI_hide_column_status_icon"){if(objTarget.getAttribute("class")!="sb_explorerUI_hide_column_step1 sb_explorerUI_hide_column"){objTarget=objTarget.parentNode}objTarget=objTarget.children[0]}var nHideColNum=objTarget.getAttribute("id");nHideColNum=nHideColNum.replace("sb_explorerUI_hide_column_status_icon_","");var objCol;var strEval="objCol = "+SBGrid.DEF.STR_SBGRID_ID+".m_arColumn["+String(nHideColNum)+"];";eval(strEval);if(!objCol){alert("ERROR LOCATION: getShowHideColumnUI(), objCol is not exist!!");return}var nHideColumnsCount;eval("nHideColumnsCount = "+SBGrid.DEF.STR_SBGRID_ID+".getHideColumnCount();");var strHiddenState;if(objCol.m_bHiddenState){strHiddenState="false"}else{var nColumnsCount;eval("nColumnsCount = "+SBGrid.DEF.STR_SBGRID_ID+".getCols();");if(nHideColumnsCount>=nColumnsCount-1){return}strHiddenState="true"}strEval=SBGrid.DEF.STR_SBGRID_ID+".setColHidden("+String(nHideColNum)+", "+strHiddenState+");";eval(strEval);if(objCol.m_bHiddenState){objTarget.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")";eval(SBGrid.DEF.STR_SBGRID_ID+".m_nHideColumnsCount++;")}else{objTarget.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")";eval(SBGrid.DEF.STR_SBGRID_ID+".m_nHideColumnsCount--;")}};objHideColumnUI.appendChild(objDivParentSet)}var objBody=document.getElementById(this.parentId);objBody.appendChild(objHideColumnUI)}var objExplorerUI=document.getElementById("sb_explorerUI_top");if(!objExplorerUI){alert("ExplorerBar UI is not exist!!")}var nObjHideColumnUILeft=objExplorerUI.offsetLeft+objExplorerUI.offsetWidth;var nObjHideColumnUIBottom=objExplorerUI.offsetTop+objExplorerUI.offsetHeight-22;objHideColumnUI.style.visibility="visible";objHideColumnUI.style.left=String(nObjHideColumnUILeft)+"px";objHideColumnUI.style.top=String(nObjHideColumnUIBottom)+"px";for(var i=0;i<this.getCols();i++){var objDivIcon=document.getElementById("sb_explorerUI_hide_column_status_icon_"+String(i));var objCol=this.m_arColumn[i];if(objCol){if(objCol.m_bHiddenState){objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")"}else{objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")"}}}};SBGrid.CT.DataGrid.prototype.getIndexDataOfSelectedColumn=function(e){var b=new SBGrid.DS.Collection();for(var a=1;a<this.getRows();a++){var d;var c=this.valueMatrix(a,e);if(b.exists(c)){d=b.item(c);if(SBGrid.DEF.arrBinarySearch(a,d)==-1){d.push(a)}}else{d=new Array();d.push(a)}b.add(c,d)}return b};SBGrid.CT.DataGrid.prototype.isItemPossibleControlAboutExecutedFiltering=function(h){var d=SBGrid.DEF.__deepCopy(this.m_clFilteringHistoryStack);var e=SBGrid.DEF.__deepCopy(d.keys());for(var c=1;c<e.length;c++){var g=e[c];var f=g.substring(0,g.indexOf("#"));if(f==this.m_nDownCol){d.remove(g)}}var b=this.getFilteringHistory(d);var a=SBGrid.DEF.arrIntersection(b,h);if(a.length==0){return false}else{return true}};SBGrid.CT.DataGrid.prototype.getShowFilteringUI=function(){this.deleteShowHideColumnUI();var nRowHeader=this.m_bRowHeader?1:0;if(!(this.isPossibleFiltering())){return}var objFilteringUI=document.getElementById("sb_explorerUI_flitering_top");var objDivParentSet;var objDivIcon;var objDivColumnName;if(objFilteringUI){while(objFilteringUI.firstChild){objFilteringUI.removeChild(objFilteringUI.firstChild)}}else{objFilteringUI=document.createElement("div");objFilteringUI.setAttribute("id","sb_explorerUI_flitering_top");objFilteringUI.style.zIndex="1";var objBody=document.getElementById(this.parentId);objBody.appendChild(objFilteringUI)}objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivColumnName=document.createElement("div");objDivColumnName.appendChild(document.createTextNode("Select All"));jQuery(objDivParentSet).addClass("sb_explorerUI_flitering_step1 align_bottom sb_explorerUI_flitering");jQuery(objDivIcon).addClass("sb_explorerUI_filtering_status_icon");objDivIcon.setAttribute("id","sb_explorerUI_filtering_status_icon_ALL");jQuery(objDivColumnName).addClass("sb_explorerUI_filtering_value");objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivColumnName);objDivParentSet.onclick=function(event){var nClickedColumnIndex;eval("nClickedColumnIndex = "+SBGrid.DEF.STR_SBGRID_ID+".m_nDownCol;");var nRows;eval("nRows = "+SBGrid.DEF.STR_SBGRID_ID+".getRows();");var objTarget=document.getElementById("sb_explorerUI_filtering_status_icon_ALL");objTarget.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")";var clIndexDataOfSelectedColumn;eval("clIndexDataOfSelectedColumn = "+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.item("+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.keys()[nClickedColumnIndex]);");for(var i=0;i<clIndexDataOfSelectedColumn.count();i++){var objDivIconTemp=document.getElementById("sb_explorerUI_filtering_status_icon_"+String(i));if(objDivIconTemp){objDivIconTemp.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")"}}var arKeyList;eval("arKeyList = SBGrid.DEF.__deepCopy("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack.keys());");for(var i=1;i<arKeyList.length;i++){var strKey=arKeyList[i];var nColumnIndex=strKey.substring(0,strKey.indexOf("#"));if(nColumnIndex==nClickedColumnIndex){eval(SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack.remove(strKey);")}}var arFilteringHistoryResult;eval("arFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");for(var q=0;q<arFilteringHistoryResult.length-1;q++){var strEval=SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arFilteringHistoryResult[q], false, true);";eval(strEval)}eval(SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arFilteringHistoryResult[arFilteringHistoryResult.length - 1], false, false);")};objFilteringUI.appendChild(objDivParentSet);var clIndexDataOfSelectedColumn=this.m_clIndexes.item(this.m_clIndexes.keys()[this.m_nDownCol-nRowHeader]);for(var i=0;i<clIndexDataOfSelectedColumn.count();i++){var strKey=clIndexDataOfSelectedColumn.keys()[i];var arRowIndexList=this.m_clIndexes.item(this.m_clIndexes.keys()[this.m_nDownCol-nRowHeader]).item(strKey);if(this.isItemPossibleControlAboutExecutedFiltering(SBGrid.DEF.__deepCopy(arRowIndexList))==false){continue}objDivParentSet=document.createElement("div");objDivIcon=document.createElement("div");objDivColumnName=document.createElement("div");objDivColumnName.appendChild(document.createTextNode(strKey));jQuery(objDivParentSet).addClass("sb_explorerUI_flitering_step1 sb_explorerUI_flitering");objDivParentSet.setAttribute("id","sb_explorerUI_flitering_"+String(i));jQuery(objDivIcon).addClass("sb_explorerUI_filtering_status_icon");objDivIcon.setAttribute("id","sb_explorerUI_filtering_status_icon_"+String(i));jQuery(objDivColumnName).addClass("sb_explorerUI_filtering_value");objDivColumnName.setAttribute("id","sb_explorerUI_filtering_value_"+String(i));objDivParentSet.appendChild(objDivIcon);objDivParentSet.appendChild(objDivColumnName);objDivParentSet.onclick=function(event){var nClickedColumnIndex;eval("nClickedColumnIndex = "+SBGrid.DEF.STR_SBGRID_ID+".m_nDownCol;");var nCols;eval("nCols = "+SBGrid.DEF.STR_SBGRID_ID+".getCols();");var nRows;eval("nRows = "+SBGrid.DEF.STR_SBGRID_ID+".getRows();");var nRowHeader;eval("nRowHeader = "+SBGrid.DEF.STR_SBGRID_ID+".m_bRowHeader ? 1:0;");var objTarget=event.target;if(objTarget.getAttribute("class")!="sb_explorerUI_filtering_value"){if(objTarget.getAttribute("class")!="sb_explorerUI_flitering_step1 sb_explorerUI_flitering"){objTarget=objTarget.parentNode}objTarget=objTarget.children[1]}var nIndexForKey=objTarget.getAttribute("id");nIndexForKey=nIndexForKey.replace("sb_explorerUI_filtering_value_","");var strKey=objTarget.firstChild.data;var arRowIndexList;eval("arRowIndexList = "+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.item("+SBGrid.DEF.STR_SBGRID_ID+".m_clIndexes.keys()[nClickedColumnIndex - nRowHeader]).item(strKey).slice(0);");var bIsHidden;eval("bIsHidden = "+SBGrid.DEF.STR_SBGRID_ID+".isHiddenAboutKey(strKey, nClickedColumnIndex - nRowHeader);");var arExecuteRowList;var bState=null;if(bIsHidden){objTarget.parentNode.children[0].style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")";var arBeforeFilteringHistoryResult;eval("arBeforeFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");eval(SBGrid.DEF.STR_SBGRID_ID+'.m_clFilteringHistoryStack.remove(nClickedColumnIndex.toString() + "#" + strKey);');var arAfterFilteringHistoryResult;eval("arAfterFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");arExecuteRowList=SBGrid.DEF.arrDifferenceOfSets(arAfterFilteringHistoryResult,arBeforeFilteringHistoryResult);bState=false}else{var objDivShowAllIcon=document.getElementById("sb_explorerUI_filtering_status_icon_ALL");objDivShowAllIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")";objTarget.parentNode.children[0].style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")";var arBeforeFilteringHistoryResult;eval("arBeforeFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");eval(SBGrid.DEF.STR_SBGRID_ID+'.m_clFilteringHistoryStack.add(nClickedColumnIndex.toString() + "#" + strKey, arRowIndexList);');var arAfterFilteringHistoryResult;eval("arAfterFilteringHistoryResult = "+SBGrid.DEF.STR_SBGRID_ID+".getFilteringHistory("+SBGrid.DEF.STR_SBGRID_ID+".m_clFilteringHistoryStack);");arExecuteRowList=SBGrid.DEF.arrDifferenceOfSets(arBeforeFilteringHistoryResult,arAfterFilteringHistoryResult);bState=true}for(var q=0;q<arExecuteRowList.length-1;q++){var strEval=SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arExecuteRowList[q], bState, true);";eval(strEval)}eval(SBGrid.DEF.STR_SBGRID_ID+".setRowHidden(arExecuteRowList[arExecuteRowList.length - 1], bState, false);")};var bIsHidden=this.isHiddenAboutKey(strKey,this.m_nDownCol-nRowHeader);if(bIsHidden){objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_UNCHECKICON+")"}else{objDivIcon.style.backgroundImage="url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.SB_SRC_CHECKICON+")"}objFilteringUI.appendChild(objDivParentSet)}var objExplorerUI=document.getElementById("sb_explorerUI_top");if(!objExplorerUI){alert("ExplorerBar UI is not exist!!")}var nObjFilteringUILeft=objExplorerUI.offsetLeft+objExplorerUI.offsetWidth;var nObjFilteringUIBottom=objExplorerUI.offsetTop+objExplorerUI.offsetHeight-42;objFilteringUI.style.visibility="visible";objFilteringUI.style.left=String(nObjFilteringUILeft)+"px";objFilteringUI.style.top=String(nObjFilteringUIBottom)+"px"};SBGrid.CT.DataGrid.prototype.deleteShowExplorerUI=function(){var a=document.getElementById("sb_explorerUI_top");if(a){a.style.visibility="hidden"}this.deleteShowHideColumnUI();this.deleteShowFilteringUI()};SBGrid.CT.DataGrid.prototype.deleteShowHideColumnUI=function(){var a=document.getElementById("sb_explorerUI_hide_column_top");if(a){a.style.visibility="hidden"}};SBGrid.CT.DataGrid.prototype.deleteShowFilteringUI=function(){var a=document.getElementById("sb_explorerUI_flitering_top");if(a){a.style.visibility="hidden"}};SBGrid.CT.DataGrid.prototype.getFilteringListOfColumn=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getFilteringListOfColumn","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getFilteringListOfColumn","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var b=this.m_bRowHeader?1:0;var a=this.m_clIndexes.item(this.m_clIndexes.keys()[c-b]);return a.keys()};SBGrid.CT.DataGrid.prototype.setFiltering=function(b,d,i,f){if(arguments.length<3){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof d)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof i!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setFiltering","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(f==null||f==undefined){f=false}var l=this.m_bRowHeader?1:0;var e=this.m_clIndexes.item(this.m_clIndexes.keys()[b-l]).item(d);var g;g=this.getFilteringHistory(this.m_clFilteringHistoryStack);if(i){this.m_clFilteringHistoryStack.add(b.toString()+"#"+d,e)}else{this.m_clFilteringHistoryStack.remove(b.toString()+"#"+d)}var c;c=this.getFilteringHistory(this.m_clFilteringHistoryStack);var h;if(i){h=SBGrid.DEF.arrDifferenceOfSets(g,c)}else{h=SBGrid.DEF.arrDifferenceOfSets(c,g)}for(var a=0;a<h.length-1;a++){this.setRowHidden(h[a],i,true)}this.setRowHidden(h[h.length-1],i,f)};SBGrid.CT.DataGrid.prototype.clearFiltering=function(){if(this.isPossibleFiltering()){this.initFilteringHistoryStack();for(var a=this.fixedRows;a<this.rows-1;a++){this.setRowHidden(a,false,false)}this.setRowHidden((this.rows-1),false,false)}};SBGrid.CT.DataGrid.prototype.deleteSortShowIcon=function(){if(null!=this.m_objSortIcon){this.m_objSortIcon.heBeforeCell.appendChild(this.m_objSortIcon.heBeforeCellData);var a=SBGrid.DEF.is_firefox?this.m_objSortIcon.heTable.parentNode:this.m_objSortIcon.heTable.parentElement;a.removeChild(this.m_objSortIcon.heTable);a=null;this.m_objSortIcon.heTable=null;this.m_objSortIcon.heFristTd=null;this.m_objSortIcon.heImgDiv=null;this.m_objSortIcon.heBeforeCell=null;this.m_objSortIcon.heBeforeCellData=null;this.m_objSortIcon=null;this.m_strSortIconStatus=null}};SBGrid.CT.DataGrid.prototype.sort=function(b,a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".sort","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".sort","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(a==null){a=this.m_nSortType}else{if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".sort","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}else{if((a!=SBGrid.DEF.SBST_ASC)&&(a!=SBGrid.DEF.SBST_DESC)){a=SBGrid.DEF.SBST_ASC}}}this.m_nSortType=a;this.dispatch("onbeforesort");if(null!=this.attribute.sortloading&&"true"==this.attribute.sortloading){this.showWait(true);window.setTimeout("SBGrid.getGrid('"+this.id+"').sortTimeout("+b+","+this.m_nSortType+");",0)}else{if(this.isSubtotalAll()){this.clearAllSubTotalRow()}this.sortEx(b,this.fixedRows,this.m_nRealRows-1,this.m_nSortType);this.defaultAttributeSetting();this.dispatch("onaftersort")}if(this.m_nSortType==SBGrid.DEF.SBST_ASC){this.m_nSortType=SBGrid.DEF.SBST_DESC}else{this.m_nSortType=SBGrid.DEF.SBST_ASC}if(this.m_nExplorerBarType==SBGrid.DEF.SBEB_SORT_SHOW||this.m_nExplorerBarType==SBGrid.DEF.SBEB_SORT_SHOW_MOVE){this.getSortShowIcon(this.getCell(this.m_nDownRow,b))}return true};SBGrid.CT.DataGrid.prototype.sortCaptionColumn=function(c,a){var b=this.getAttribute("cursor");if(b!="arrow"||SBGrid.DEF.bIsAfterMouseUpFlg==false){return false}return this.sort(c,a)};SBGrid.CT.DataGrid.prototype.sortTimeout=function(b,a){if(this.isSubtotalAll()){this.clearAllSubTotalRow()}this.sortEx(b,this.fixedRows,this.m_nRealRows-1,a);this.defaultAttributeSetting();this.dispatch("onaftersort");this.showWait(false)};SBGrid.CT.DataGrid.prototype.getColumnControl=function(a){if(null!=a&&a<this.m_arColumn.length){return this.m_arColumn[a]}};SBGrid.CT.DataGrid.prototype.getRowHeader=function(){var a=0;switch(this.rowheader){case"seq":a=SBGrid.DEF.SBRH_SEQ;break;case"reverseseq":a=SBGrid.DEF.SBRH_REVERSESEQ;break;case"select":a=SBGrid.DEF.SBRH_SELECT;break;case"update":a=SBGrid.DEF.SBRH_UPDATE;break}return a};SBGrid.CT.DataGrid.prototype.getColStatus=function(b){var a=this.getCell(0,b);if(a){return a.getColStatus()}return false};SBGrid.CT.DataGrid.prototype.setColStatus=function(c,a){var b=this.getCell(0,c);if(null!=b){b.setColStatus(a)}};SBGrid.CT.DataGrid.prototype.fixedcellischeck=function(b,c){if(!isFinite(b)||!isFinite(c)){return false}if(b>=this.fixedRows){return false}var a=this.getCell(b,c);if(null!=a&&SBGrid.DEF.SBIT_CHECK==a.m_fixedInputType){return a.m_fixedCheckStatus}return false};SBGrid.CT.DataGrid.prototype.fixedcellcheckbox=function(b,c){if(!isFinite(b)||!isFinite(c)){return false}if(b>=this.fixedRows){return false}var a=this.getCell(b,c);if(null!=a&&SBGrid.DEF.SBIT_CHECK==a.m_fixedInputType){return true}return false};SBGrid.CT.DataGrid.prototype.setFixedcellischeck=function(){var e=arguments;if(!isFinite(e[0])||!isFinite(e[1])){return}if(e[0]>=this.fixedRows){return}if(3==e.length){var b=this.getCell(e[0],e[1]);var a=this.m_arColumn[e[1]];if(null!=b&&null!=a&&SBGrid.DEF.SBIT_CHECK==b.m_fixedInputType){if(e[2]!=b.m_fixedCheckStatus){b.m_fixedCheckStatus=e[2];if(!b.m_fixedNoCheckAll&&SBGrid.DEF.SBIT_CHECK==a.getInputType()){for(var d=this.fixedRows;d<this.m_nRealRows;d++){var c=this.getCell(d,e[1]);if(null!=c){SBGrid.CF.GridSetFixedCheck(c,e[2])}}this.refreshCurrentModel(this.attribute.ref);if(e[2]){b.m_heControl.firstChild.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck;this.dispatch("onselect",SBGrid.DEF.m_event)}else{b.m_heControl.firstChild.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck;this.dispatch("ondeselect",SBGrid.DEF.m_event)}}}}}};SBGrid.CT.DataGrid.prototype.setFixedcellcheckbox=function(){var c=arguments;if(!isFinite(c[0])||!isFinite(c[1])){return}if(c[0]>=this.fixedRows){return}if(3==c.length){var b=this.getCell(c[0],c[1]);if(null!=b){if(c[2]){if(b.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUT){b.m_fixedInputType=SBGrid.DEF.SBIT_CHECK;var a=document.createElement("img");a.setAttribute("alt","");if(b.m_fixedCheckStatus){a.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck}else{a.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck}b.m_heControl.insertBefore(a,b.m_heControl.firstChild)}}else{if(b.m_fixedInputType==SBGrid.DEF.SBIT_CHECK){b.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;b.m_heControl.removeChild(b.m_heControl.firstChild)}}}}else{if(4==c.length){var b=this.getCell(c[0],c[1]);if(null!=b){b.m_fixedNoCheckAll=c[2];if(c[3]){if(b.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUT){b.m_fixedInputType=SBGrid.DEF.SBIT_CHECK;var a=document.createElement("img");a.setAttribute("alt","");if(b.m_fixedCheckStatus){a.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck}else{a.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck}b.m_heControl.insertBefore(a,b.m_heControl.firstChild)}}else{if(b.m_fixedInputType==SBGrid.DEF.SBIT_CHECK){b.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;b.m_heControl.removeChild(b.m_heControl.firstChild)}}}}}};SBGrid.CT.DataGrid.prototype.fixedcellbutton=function(b,c){if(this.isFixedCell(b,c)){var a=this.getCell(b,c);if(null!=a){if(a.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUT){return false}else{if(a.m_fixedInputType==SBGrid.DEF.SBIT_INPUTBUTTON){return true}}}}return false};SBGrid.CT.DataGrid.prototype.setFixedcellbutton=function(h,m,o){if(this.isFixedCell(h,m)){var i=this.getCell(h,m);if(null!=i){if(i.m_fixedInputType==SBGrid.DEF.SBIT_OUTPUT&&o){i.m_fixedInputType=SBGrid.DEF.SBIT_INPUTBUTTON;var n=SBGrid.DEF.is_ie?i.m_heControl.innerText:i.m_heControl.textContent;var b=(this.m_arColWidth[m]-22)+"px";var c="";var p="";if(SBGrid.DEF.is_mozBrowser){p="95%"}else{p="100%"}var q="<table cellpadding=0 cellspacing=0 border=0 height="+p+" style=\"font-family:굴림;font-size:9pt;\"><tr><td width='100%'>";c="";c+=i.getAttribute("font-family")?"font-family:"+i.getAttribute("font-family")+";":"";c+=i.getAttribute("font-size")?"font-size:"+i.getAttribute("font-size")+";":"";c+=i.getAttribute("font-weight")?"font-weight:"+i.getAttribute("font-weight")+";":"";c+=i.getAttribute("font-style")?"font-style:"+i.getAttribute("font-style")+";":"";c+=i.getAttribute("text-decoration")?"font-family:"+i.getAttribute("text-decoration")+";":"";c+=i.getAttribute("color")?"color:"+i.getAttribute("color")+";":"";c+=i.getAttribute("text-align")?"text-align:"+i.getAttribute("text-align")+";":"";var d="<div id='"+i.id+"_data' style=\""+c+"border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent; border-left-color:transparent;width:"+b+';overflow:hidden;">';d+='<span style="white-space:nowrap;">'+n+"</span>";d+="</div>";q+=d+"</td><td width='18px' style='height:100%'>";var f="";if(SBGrid.DEF.is_webkit){f="border-top-width:0px;border-bottom-width:0px;padding-top:0px;padding-bottom:0px;"}else{f="border-width:1px;"}var a="height:100%;"+f+"background-repeat:no-repeat;background-position:center;background-image:url("+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridButton+");";a=SBGrid.DEF.is_opera?a:a+"width:18px;";var l='<BUTTON style="'+a+'"></BUTTON>';q+=l+"</td></tr></table>";i.m_heControl.innerHTML=q}else{if(i.m_fixedInputType==SBGrid.DEF.SBIT_INPUTBUTTON&&!o){i.m_fixedInputType=SBGrid.DEF.SBIT_OUTPUT;var n=SBGrid.DEF.is_ie?i.m_heControl.innerText:i.m_heControl.textContent;var e=i.m_heControl.firstChild;var g='<span style="border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent; border-left-color:transparent;"></span>';n='<span style="white-space:nowrap;">'+n+"</span>";i.m_heControl.innerHTML=g+n}}}}};SBGrid.CT.DataGrid.prototype.__FFRowMove=function(){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px";this.m_heGridFFScrollRow.style.width=this.m_heGridWhole.clientWidth+"px";this.m_heGridFFBScrollRow.style.width=this.m_heGridWhole.clientWidth+"px";var a=0;var b=this.fixedRows+this.frozenRows;for(var c=0;c<b&&c<this.m_nRealRows;c++){if(null!=this.m_htRowHeight[c]){a+=this.m_htRowHeight[c]}else{a+=c<this.fixedRows?this.m_nRowHeight:this.dataHeight}}this.m_heGridFFScrollRow.style.height=a+"px";this.m_heGridFFNoScrollRow.style.height=a+"px"};SBGrid.CT.DataGrid.prototype.bottomRowMove=function(){var a=0;for(var b=1;b<=this.m_nBottomRowCount;b++){if(null!=this.m_htRowHeight[this.m_nRealRows-b]){a+=this.m_htRowHeight[this.m_nRealRows-b]}else{a+=this.dataHeight}}this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-a)+"px";this.m_heGridFFBScrollRow.style.height=a+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-a)+"px";this.m_heGridFFBNoScrollRow.style.height=a+"px"};SBGrid.CT.DataGrid.prototype.cellAttribute=function(){var b=arguments;if(""==b[0].trim()){return""}if(!isFinite(b[1])||!isFinite(b[2])){return""}if(!isFinite(b[3])){if(b[4]){return""}}if(isFinite(b[3])&&isFinite(b[4])){return""}else{var a=this.getCell(b[1],b[2]);var c=a.attribute[b[0]];if(null!=c){return c}}return""};SBGrid.CT.DataGrid.prototype.setCellAttribute=function(){var f=arguments;if(""==f[0].trim()){return}if(!isFinite(f[1])||!isFinite(f[2])){return}if(!isFinite(f[3])){if(f[4]){return}}if(isFinite(f[3])&&isFinite(f[4])){var g=f[1]<=f[3]?f[1]:f[3];var c=f[1]>f[3]?f[1]:f[3];var a=f[2]<=f[4]?f[2]:f[4];var h=f[2]>f[4]?f[2]:f[4];for(var e=g;e<=c;e++){for(var b=a;b<=h;b++){var d=this.getCell(e,b);if(null!=d&&""!=f[5]){this.setCellTargetAttribute(d,f[0],f[5])}}}}else{var d=this.getCell(f[1],f[2]);if(null!=d&&""!=f[3]){this.setCellTargetAttribute(d,f[0],f[3])}}};SBGrid.CT.DataGrid.prototype.cellFormat=function(a,c){var b=this.m_htCellFormat[this.id+"_"+a+"_"+c];b=null==strformat?"":b;return b};SBGrid.CT.DataGrid.prototype.setCellFormat=function(d,g,f){var e=this.id+"_"+d+"_"+g;var c=this.getCellById(e);var b;var a=this.m_replaceString;this.m_htCellFormat[e]=f;if(a!=""&&a!="undefined"&&a!=null){b=a.split("?")}if(null!=c){SBGrid.CF.GridSetTextRefresh(c,SBGrid.CF.GridGetText(c),b)}};SBGrid.CT.DataGrid.prototype.setCellTargetAttribute=function(c,b,d){switch(b){case"disabled":var a="true"==d;c.disabled=a;c.attribute[b]=d;a=null;break}c=null;b=null;d=null};SBGrid.CT.DataGrid.prototype.cellStyle=function(){return""};SBGrid.CT.DataGrid.prototype.setCellStyle=function(){var o=arguments;if(""==o[0].trim()){return}if(!isFinite(o[1])||!isFinite(o[2])){return}if(!isFinite(o[3])){if(o[4]){return}}if(SBGrid.DEF.SB_STYLELIST[o[0]]){var c="background-color"!=o[0]?" !important;":";";if(isFinite(o[3])&&isFinite(o[4])){if(-1!=o[0].indexOf("color")){var a=Number(o[5]);o[5]=isNaN(a)?o[5]:"#"+SBGrid.DEF.RGB_convert(a)}var e=o[1]<=o[3]?o[1]:o[3];var b=o[1]>o[3]?o[1]:o[3];var l=o[2]<=o[4]?o[2]:o[4];var g=o[2]>o[4]?o[2]:o[4];for(var h=e;h<=b;h++){if(null==this.m_arCellStyleTable[h]){this.m_arCellStyleTable[h]=new Array()}for(var f=l;f<=g;f++){var d=this.getCell(h,f);if(null!=d&&""!=o[5]){var n=this.m_arCellStyleTable[h][f];if(null!=n){n+=o[0]+":"+o[5]+c;this.m_arCellStyleTable[h][f]=n}else{n=o[0]+":"+o[5]+c;this.m_arCellStyleTable[h][f]=n}if(null!=d.m_heControl){var m=d.m_heControl.style.cssText;m+=";";d.m_heControl.style.cssText=(m+n)}}}}}else{if(-1!=o[0].indexOf("color")){var a=Number(o[3]);o[3]=isNaN(a)?o[3]:"#"+SBGrid.DEF.RGB_convert(a)}var d=this.getCell(o[1],o[2]);if(null!=d&&""!=o[3]){if(null==this.m_arCellStyleTable[o[1]]){this.m_arCellStyleTable[o[1]]=new Array()}var n=this.m_arCellStyleTable[o[1]][o[2]];if(null!=n){n+=o[0]+":"+o[3]+c;this.m_arCellStyleTable[o[1]][o[2]]=n}else{n=o[0]+":"+o[3]+c;this.m_arCellStyleTable[o[1]][o[2]]=n}if(null!=d.m_heControl){var m=d.m_heControl.style.cssText;m+=";";d.m_heControl.style.cssText=(m+n)}}}}};SBGrid.CT.DataGrid.prototype.rebuildStyle=function(){var d=arguments;if(1==d.length||3==d.length){return}if(0==d.length){for(var c=0;c<this.m_nRealRows;c++){for(var a=0;a<this.cols;a++){var b=this.getCell(c,a);if(null!=b){if(null==this.m_arCellStyleTable[c]){this.m_arCellStyleTable[c]=new Array()}var e=this.m_arCellStyleTable[c][a];if(null!=e){this.setCssText(b,e);this.m_arCellStyleTable[c][a]=null}}}}}else{if(2==d.length){if(null!=d[0]&&null!=d[1]){var b=this.getCell(d[0],d[1]);if(null!=b){if(null==this.m_arCellStyleTable[d[1]]){this.m_arCellStyleTable[d[1]]=new Array()}var e=this.m_arCellStyleTable[d[0]][d[1]];if(null!=e){this.setCssText(b,e);this.m_arCellStyleTable[d[0]][d[1]]=null}}}}else{if(4==d.length){if(null!=d[0]&&null!=d[1]&&null!=d[2]&&null!=d[3]){for(var c=d[0];c<=d[2];c++){for(var a=d[1];a<=d[3];a++){var b=this.getCell(c,a);if(null!=b){if(null==this.m_arCellStyleTable[c]){this.m_arCellStyleTable[c]=new Array()}var e=this.m_arCellStyleTable[c][a];if(null!=e){this.setCssText(b,e);this.m_arCellStyleTable[c][a]=null}}}}}}}}this.scrollTableReDraw()};SBGrid.CT.DataGrid.prototype.setCssText=function(a,c){if(!this.m_objScroll.bScrollEvent){if(null!=a.m_heControl){var b=a.m_heControl.style.cssText.toLowerCase();c=c.substring(0,c.indexOf(":"));b=b.replace(c,"");a.m_heControl.style.cssText=b}}};SBGrid.CT.DataGrid.prototype.allStyle=function(b,a){if(SBGrid.DEF.SB_STYLELIST[a]){switch(b){case"data":return this.cellStyle(a,this.fixedRows,this.fixedCols,this.m_nRealRows-1,this.cols-1);break;case"fixed":if(0<this.fixedCols){return this.cellStyle(a,0,0,this.m_nRealRows-1,this.fixedCols-1)}else{return this.cellStyle(a,0,0,this.fixedRows-1,this.cols-1)}break;case"all":return this.cellStyle(a,0,0,this.m_nRealRows-1,this.cols-1);break}}return""};SBGrid.CT.DataGrid.prototype.setAllStyle=function(b,a,c){if(SBGrid.DEF.SB_STYLELIST[a]){switch(b){case"data":this.setCellStyle(a,this.fixedRows,this.fixedCols,this.m_nRealRows-1,this.cols-1,c);break;case"fixed":this.setCellStyle(a,0,0,this.fixedRows-1,this.cols-1,c);if(0<this.fixedCols){this.setCellStyle(a,0,0,this.m_nRealRows-1,this.fixedCols-1,c)}break;case"all":this.setCellStyle(a,0,0,this.m_nRealRows-1,this.cols-1,c);break}}};SBGrid.CT.DataGrid.prototype.colStyle=function(c,b,a){if(null==c||(0>c||this.cols<=c)){return}if(SBGrid.DEF.SB_STYLELIST[a]){switch(b){case"data":if(c>=this.fixedCols){return this.cellStyle(a,this.fixedRows,c,this.m_nRealRows-1,c)}break;case"fixed":if(c<this.fixedCols){return this.cellStyle(a,0,c,this.m_nRealRows-1,c)}else{return this.cellStyle(a,0,c,this.fixedRows-1,c)}break;case"all":return this.cellStyle(a,0,c,this.m_nRealRows-1,c);break}}return""};SBGrid.CT.DataGrid.prototype.setColStyle=function(d,b,a,c){if(null==d||(0>d||this.cols<=d)){return}if(SBGrid.DEF.SB_STYLELIST[a]){switch(b){case"data":if(d>=this.fixedCols){this.setCellStyle(a,this.fixedRows,d,this.m_nRealRows-1,d,c)}break;case"fixed":if(d<this.fixedCols){this.setCellStyle(a,0,d,this.m_nRealRows-1,d,c)}else{this.setCellStyle(a,0,d,this.fixedRows-1,d,c)}break;case"all":this.setCellStyle(a,0,d,this.m_nRealRows-1,d,c);break}}};SBGrid.CT.DataGrid.prototype.rowStyle=function(a,c,b){if(SBGrid.DEF.SB_STYLELIST[b]){switch(c){case"data":if(a>=this.fixedRows){return this.cellStyle(b,a,this.fixedCols,a,this.cols-1)}break;case"fixed":if(a<this.fixedRows){return this.cellStyle(b,a,0,a,this.cols-1)}else{if(0<this.fixedCols){return this.cellStyle(b,a,0,a,this.fixedCols-1)}}break;case"all":return this.cellStyle(b,a,0,a,this.cols-1);break}}return""};SBGrid.CT.DataGrid.prototype.setRowStyle=function(a,c,b,d){if(SBGrid.DEF.SB_STYLELIST[b]){switch(c){case"data":if(a>=this.fixedRows){this.setCellStyle(b,a,this.fixedCols,a,this.cols-1,d)}break;case"fixed":if(a<this.fixedRows){this.setCellStyle(b,a,0,a,this.cols-1,d)}else{if(0<this.fixedCols){this.setCellStyle(b,a,0,a,this.fixedCols-1,d)}}break;case"all":this.setCellStyle(b,a,0,a,this.cols-1,d);break}}};SBGrid.CT.DataGrid.prototype.editControlHeight=function(b){if(!SBGrid.DEF.is_smartphone){var a=this.m_heGridWhole.clientHeight;var d=null!=this.m_heGridFFScrollRow.clientHeight?this.m_heGridFFScrollRow.clientHeight:0;var c=null!=this.m_heGridFFBScrollRow.clientHeight?this.m_heGridFFBScrollRow.clientHeight:0;if(b>(a-d-c)){return(a-d-c)}return b}return b};SBGrid.CT.DataGrid.prototype.getInputTopPosition=function(c){if(c<this.fixedCols+this.frozenCols){var b=this.m_heGridFFCol.offsetTop?this.m_heGridFFCol.offsetTop:0;return b}else{var a=null!=this.m_heGridFFScrollRow.clientHeight?this.m_heGridFFScrollRow.clientHeight:0;return a}};SBGrid.CT.DataGrid.prototype.getEditControl=function(){return this.m_objInput};SBGrid.CT.DataGrid.prototype.getAllowUserResize=function(b){if(null!=b&&-1!=b){var a=this.getColumnControl(b);if(null!=a){return a.getAttribute("allowuserresize")}}return this.allowUserResize};SBGrid.CT.DataGrid.prototype.setGridCursor=function(a){var b=this.getAttribute("cursor");if(null==b){b="arrow"}if(a==b){return}if(0>b.indexOf("resize")){this.m_strPrevCursor=b}this.setAttribute("cursor",a)};SBGrid.CT.DataGrid.prototype.restoreCursor=function(){if(SBGrid.DEF.bDragDrop){return}if(this.m_strPrevCursor.isEmpty()){this.m_strPrevCursor="arrow"}this.setAttribute("cursor",this.m_strPrevCursor)};SBGrid.CT.DataGrid.prototype.clearSelection=function(){if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var b=this.fixedRows;b<this.rows;b++){this.deSelectRow(b)}}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var b=this.fixedCols;b<this.cols;b++){this.deSelectCol(b)}}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){for(var d in this.m_htSelectCells){var a=this.m_htSelectCells[d];if(null!=a){delete this.m_htSelectCells[d];this.setCellSelect(a,false)}}}}}if(null!=this.m_arSelectRows){this.m_arSelectRows=new Array();this.selectedRows=0}if(null!=this.m_arSelectCols){this.m_arSelectCols=new Array()}if(null!=this.m_htSelectCells){for(var c in this.m_htSelectCells){delete this.m_htSelectCells[c]}}};SBGrid.CT.DataGrid.prototype.isSelected=function(b){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,b);return -1!=a?true:false};SBGrid.CT.DataGrid.prototype.setIsSelected=function(b,a){if(a){this.selectRow(b)}else{this.deSelectRow(b)}};SBGrid.CT.DataGrid.prototype.deSelectRow=function(d){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,d);if(-1!=a){SBGrid.DEF.arrRemoveAt(this.m_arSelectRows,a);for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCell(d,c);if(null!=b){this.setCellSelect(b,false)}}this.selectedRows=this.m_arSelectRows.length}if(this.m_bRowHeader&&this.getRowHeader()==SBGrid.DEF.SBRH_SELECT){var b=this.getCell(d,0);if(b!=null){SBGrid.CF.GridChangeRowHeadSelect(b,false)}}};SBGrid.CT.DataGrid.prototype.selectedRow=function(a){if(null!=a){if(null!=this.m_arSelectRows[a]){return this.m_arSelectRows[a]}}return -1};SBGrid.CT.DataGrid.prototype.selectRow=function(d){if(d<this.fixedRows||this.m_nRealRows<=d){return}var a=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,d);if(-1==a){this.m_arSelectRows.push(d);for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCell(d,c);if(null!=b){this.setCellSelect(b,true)}}this.selectedRows=this.m_arSelectRows.length}if(this.m_bRowHeader&&this.getRowHeader()==SBGrid.DEF.SBRH_SELECT){var b=this.getCell(d,0);if(b!=null){SBGrid.CF.GridChangeRowHeadSelect(b,true)}}};SBGrid.CT.DataGrid.prototype.deSelectCol=function(d){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectCols,d);if(-1!=a){SBGrid.DEF.arrRemoveAt(this.m_arSelectCols,a);for(var c=this.fixedRows;c<this.rows;c++){var b=this.getCell(c,d);if(null!=b){this.setCellSelect(b,false)}}}};SBGrid.CT.DataGrid.prototype.selectCol=function(d){var a=SBGrid.DEF.arrFind_Value(this.m_arSelectCols,d);if(-1==a){this.m_arSelectCols.push(d);for(var c=this.fixedRows;c<this.rows;c++){var b=this.getCell(c,d);if(null!=b){this.setCellSelect(b,true)}}}};SBGrid.CT.DataGrid.prototype.addSelCells=function(c,d,b){if(!b){return}var a=this.m_htSelectCells[b.id];if(null==a){this.m_htSelectCells[b.id]=b;this.setCellSelect(b,true)}};SBGrid.CT.DataGrid.prototype.removeSelCells=function(b){if(null==b||""==b){return}var a=this.m_htSelectCells[b];if(null!=a){delete this.m_htSelectCells[b];this.setCellSelect(a,false)}};SBGrid.CT.DataGrid.prototype.selectedCells=function(){var g=new SBGrid.DS.Collection();if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var c=0;c<this.m_arSelectRows.length;c++){var d=this.m_arSelectRows[c];for(var a=this.fixedCols;a<this.cols;a++){var b=this.getCell(c,a);if(null!=b){g.add(b.id,b)}}}return g}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var c=0;c<this.m_arSelectCols.length;c++){var f=this.m_arSelectCols[c];for(var a=this.fixedRows;a<this.m_nRealRows;a++){var b=this.getCell(a,c);if(null!=b){g.add(b.id,b)}}}return g}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){var g=new SBGrid.DS.Collection();for(var e in this.m_htSelectCells){var b=this.m_htSelectCells[e];if(null!=b){g.add(e,b)}}return g}}}return g};SBGrid.CT.DataGrid.prototype.multiSelectCells=function(a,e,n,q,l,d,c){var g=a<n?a:n;var b=a<n?n:a;var m=e<q?e:q;var f=e<q?q:e;var p=this.getSelectionMode();var o=this.fixedCols;if(SBGrid.DEF.SBSM_LIST==p||SBGrid.DEF.SBSM_BYROW==p||SBGrid.DEF.SBSM_FREE==p){if(l){if(this.fixedRows>n){g=this.fixedRows;b=a}else{if((this.fixedRows+this.frozenRows)<=n){g=a;b=(this.fixedRows+this.frozenRows)-1}}}else{if(d){if((this.m_nRealRows-this.frozenBottomRows)>n){g=this.m_nRealRows-this.frozenBottomRows;b=a}else{if((this.m_nRealRows-1)<=n){g=a;b=this.m_nRealRows-1}}}else{if((this.fixedRows+this.frozenRows)>n){g=(this.fixedRows+this.frozenRows);b=a}else{if((this.m_nRealRows-this.frozenBottomRows)<=n){g=a;b=(this.m_nRealRows-this.frozenBottomRows)-1}}}}}if(SBGrid.DEF.SBSM_BYCOL==p||SBGrid.DEF.SBSM_FREE==p){if(c){if(o>q){m=o;f=e}else{if((o+this.frozenCols)<=q){m=e;f=(o+this.frozenCols)-1}}}else{if((o+this.frozenCols)>q){m=o+this.frozenCols;f=e}}}if(SBGrid.DEF.SBSM_LIST==p||SBGrid.DEF.SBSM_BYROW==p){for(var h=this.fixedRows;h<this.m_nRealRows;h++){if(h>=g&&h<=b){this.selectRow(h)}else{this.deSelectRow(h)}}}else{if(SBGrid.DEF.SBSM_BYCOL==p){for(var h=o;h<this.cols;h++){if(h>=m&&h<=f){this.selectCol(h)}else{this.deSelectCol(h)}}}else{if(SBGrid.DEF.SBSM_FREE==p){this.clearSelection();this.selectCells(g,m,b,f)}}}};SBGrid.CT.DataGrid.prototype.select=function(){return};SBGrid.CT.DataGrid.prototype.setSelect=function(){var f=arguments;if(3==f.length||5==f.length){var d=this.fixedRows>f[0]?this.fixedRows:f[0];var b=3==f.length?d:(this.fixedRows>f[2]?this.fixedRows:f[2]);var e=this.fixedCols>f[1]?this.fixedCols:f[1];var c=3==f.length?e:(this.fixedCols>f[4]?this.fixedCols:f[4]);var a=3==f.length?f[2]:f[4];if(a){this.clearSelection();this.selectCells(d,e,b,c)}else{this.deSelectCells(d,e,b,c)}}};SBGrid.CT.DataGrid.prototype.deSelectCells=function(f,g,b,e){if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var d=f;d<=b;d++){this.deSelectRow(d)}}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var d=g;d<=e;d++){this.deSelectCol(d)}}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){for(var d=f;d<=b;d++){for(var a=g;a<=e;a++){var c=this.getCell(d,a);if(null!=c){this.removeSelCells(c.id)}}}}}}};SBGrid.CT.DataGrid.prototype.selectCells=function(f,g,b,e){if(!this.getAllowSelection()){f=b;g=e}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var d=f;d<=b;d++){this.selectRow(d)}}else{if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var d=g;d<=e;d++){this.selectCol(d)}}else{if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){var h=true;for(var d=f;d<=b;d++){for(var a=g;a<=e;a++){var c=this.getCell(d,a);if(null!=c){if(h){}else{}this.addSelCells(d,a,c)}}}}}}};SBGrid.CT.DataGrid.prototype.isRowHidden=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".isRowHidden","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".isRowHidden","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(true==this.m_arHiddenRowState[a]){return true}return false};SBGrid.CT.DataGrid.prototype.getMoveCell=function(d,f,a){var c=this.getCell(d,f);var b=d;var e=f;if(SBGrid.DEF.SBKE_NEXT==a){while(1){if(f==this.cols-1){f=this.fixedCols;d++}else{f++}if(d==this.rows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCell(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}else{if(SBGrid.DEF.SBKE_PREVIOUS==a){while(1){if(f==this.fixedCols){f=this.cols-1;d--}else{f--}if(d<this.fixedRows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCell(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}else{if(SBGrid.DEF.SBKE_MOVETOP==a){while(1){d--;if(d<this.fixedRows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCell(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}else{if(SBGrid.DEF.SBKE_MOVEBOTTOM==a){while(1){d++;if(d==this.rows){d=b;f=e;break}if(this.isRowHidden(d)||this.isColHidden(f)){continue}c=this.getCell(d,f);if(null==c||SBGrid.DEF.SBSM_HIDE!=c.mergeType){break}else{b=d;e=f}}}}}}return new SBGrid.DS.Point(f,d)};SBGrid.CT.DataGrid.prototype.moveTop=function(d){var c=this.getRow();var f=this.getCol();var e=c;var a=this.getMoveCell(c,f,SBGrid.DEF.SBKE_MOVETOP);c=a.m_nY;f=a.m_nX;if(c<this.fixedRows){return}this.setRowValue(c);this.setColValue(f);if(c!=e){this.dispatch("onrowchanged")}this.clearSelection();this.selectCells(c,f,c,f);var b=this.getCell(c,f);if(b){SBGrid.DEF.setFocus(b.id);this.dispatch("onentercell")}};SBGrid.CT.DataGrid.prototype.moveDown=function(d){var c=this.getRow();var f=this.getCol();var e=c;var a=this.getMoveCell(c,f,SBGrid.DEF.SBKE_MOVEBOTTOM);c=a.m_nY;f=a.m_nX;if(c>this.rows-1){return}this.setRowValue(c);this.setColValue(f);if(c!=e){this.dispatch("onrowchanged")}this.clearSelection();this.selectCells(c,f,c,f);var b=this.getCell(c,f);if(b){SBGrid.DEF.setFocus(b.id);this.dispatch("onenterCell")}};SBGrid.CT.DataGrid.prototype.funcMoveUp=function(a){this.moveTop(a)};SBGrid.CT.DataGrid.prototype.funcMoveDown=function(a){this.moveDown(a)};SBGrid.CT.DataGrid.prototype.funcMoveLeft=function(a){if(this.row==this.fixedRows&&this.col==this.fixedCols){return}else{this.dispatch("onprevious")}};SBGrid.CT.DataGrid.prototype.funcMoveRight=function(a){if(this.row==this.rows-1&&this.col==this.cols-1){return}else{this.dispatch("onnext")}};SBGrid.CT.DataGrid.prototype.closePopUp=function(){for(var a=0;a<this.cols;a++){var b=this.m_arColumn[a];if(null!=b){if(null!=b.m_objCombo){b.onBlur(SBGrid.DEF.m_event);b.m_objCombo.showItemList(false);b.m_objCombo.showItemListBar(false)}else{if(null!=b.m_objCalendar){this.m_bIsShowItem=false;b.m_objCalendar.setVisible(false)}}}}if(this.m_objInput){this.stopEditing()}};SBGrid.CT.DataGrid.prototype.stopEditing=function(){if(this.isEditing()){this.setCellEditText()}};SBGrid.CT.DataGrid.prototype.getColCombo=function(b){var a=this.m_arColumn[b];if(null!=a){return a.m_objCombo}return null};SBGrid.CT.DataGrid.prototype.setCellEditText=function(){var b=this.getEditRow();var d=this.getEditCol();var a=this.getCell(b,d);if(null!=a&&this.isNormalCell(b,d)){var c=this.getColumnControl(d);if(null!=c&&c.onAfterEdit()&&c.getRefNode()){this.eventCaptionClear()}else{if(null!=c.getRefNode()){c.setValue("");c.setText("")}this.dispatch("onafteredit");this.dispatch("onendedit");this.eventCaptionClear()}this.autoResizeHeight(b)}document.getElementById("SBHE_"+this.id+"_input").removeAttribute("title")};SBGrid.CT.DataGrid.prototype.editCell=function(){if(!this.isEditing()){this.setEditCell(SBGrid.DEF.m_event)}};SBGrid.CT.DataGrid.prototype.setEditCell=function(e){var d=this.getRow();var g=this.getCol();var b=this.m_bRowHeader?1:0;if(d>=0&&g>=0){var c=this.getCell(d,g);if(null!=c&&this.isNormalCell(d,g)){if(c.disabled||c.m_bIsSubTotal){return}var a=this.getColumnControl(g);e.capture="";if(null!=a){var f=a.getInputType();if(SBGrid.DEF.SBIT_COMBO==f){}else{if((SBGrid.DEF.SBIT_CHECK==f||SBGrid.DEF.SBIT_RADIO==f)&&(SBGrid.EVT.SPACE==e.keyCode||SBGrid.EVT.ENTER==e.keyCode)){if(SBGrid.DEF.SBIT_CHECK==f){a.setCheck(!a.getCheck())}else{a.selectRadio()}}else{if(a.getEditable()){this.dispatch("onbeforeedit");document.getElementById("SBHE_"+this.id+"_input").setAttribute("title",a.getAttribute("title"))}}}}}}};SBGrid.CT.DataGrid.prototype.isResizing=function(){return(this.getResizeType()!=SBGrid.DEF.SBRS_NONE)};SBGrid.CT.DataGrid.prototype.getResizeType=function(){if("v-resize"==this.getAttribute("cursor")&&this.m_bDown){return SBGrid.DEF.SBRS_HORZ}else{if("h-resize"==this.getAttribute("cursor")&&this.m_bDown){return SBGrid.DEF.SBRS_VERT}}return SBGrid.DEF.SBRS_NONE};SBGrid.CT.DataGrid.prototype.hitTestCell=function(d){if(this.m_bDown&&!(SBGrid.DEF.SBRS_NONE==this.getResizeType())){return}var c=this.getMouseRow();var g=this.getMouseCol();var b=this.getCell(c,g);if(null!=b&&this.isFixedCell(c,g)){if(!this.getAllowUserResize(g)){return}var f=d.clientX;var e=d.clientY;var a=this.getCellRect(c,g);if(f>=a.getRight()-6){this.setGridCursor("h-resize");return}if(e>=a.getBottom()-3&&e<=a.getBottom()+3&&0!=this.fixedCols){this.setGridCursor("v-resize");return}}this.restoreCursor()};SBGrid.CT.DataGrid.prototype.getControlRect=function(){var e=0;var c=0;var b=0;var a=0;var d=this.m_heControl;while(null!=d){e+=d.offsetLeft-(SBGrid.DEF.is_android?0:d.scrollLeft);c+=d.offsetTop-(SBGrid.DEF.is_android?0:d.scrollTop);d=d.offsetParent}b=this.m_heControl.offsetWidth;a=this.m_heControl.offsetHeight;return new SBGrid.DS.Rectangle(e,c,b,a)};SBGrid.CT.DataGrid.prototype.getCellRect=function(b,e){var i=0;var h=0;var f=0;var g=0;var c=this.getCell(b,e);if(null!=c){var a=c.m_heControl;if(null!=a){var d=a;while(null!=d){i+=d.offsetLeft;h+=d.offsetTop;if(this.m_heGridWhole==d){if(b<this.fixedRows&&e>=(this.fixedCols+this.frozenCols)){i-=d.scrollLeft}else{if(e<this.fixedCols&&b>=(this.fixedRows+this.frozenRows)){h-=d.scrollTop}}}else{i-=d.scrollLeft;h-=d.scrollTop}d=d.offsetParent}f=a.offsetWidth;g=a.offsetHeight}}return new SBGrid.DS.Rectangle(i,h,f,g)};SBGrid.CT.DataGrid.prototype.getCellContentRect=function(c,e){var d=this.getCell(c,e);if(null!=d){var b=d.getHtmlElement();var a=b;var i=0;var h=0;while(this.m_heControl!=a){i+=a.offsetLeft;h+=a.offsetTop;if(SBGrid.DEF.is_ie7){if(a.tagName=="BODY"||a.tagName=="body"){break}}a=a.offsetParent}if(SBGrid.DEF.is_ie8){i=i-parseInt(this.m_heControl.currentStyle.borderLeftWidth);h=h-parseInt(this.m_heControl.currentStyle.borderTopWidth)}i=i-this.m_heGridWhole.scrollLeft;if(!this.isFrozenRow(c)){h=h-this.m_heGridWhole.scrollTop}var f=b.offsetWidth-1;var g=b.offsetHeight-1;return new SBGrid.DS.Rectangle(i,h,f,g)}return null};SBGrid.CT.DataGrid.prototype.moveGridExpansion=function(){if(SBGrid.DEF.is_smartphone){if(this.bIsExpansion){var h=document.getElementById("SBHE_DATAGRID_EXPANSION_"+this.id);if(null!=h){var f=this.getControlRect();var g=f.getWidth();var e=f.getHeight();var b=window.scrollX+window.innerWidth-f.getX();var c=window.scrollY+window.innerHeight-f.getY();var d=(g>b)?b:g;var a=(e>c)?c:e;h.style.top=(a-20)+"px";h.style.left=(d-20)+"px"}}}};SBGrid.CT.DataGrid.prototype.remakeGrid=function(){var b=this.getRowCountFromInstance()+this.fixedRows;if(!SBGrid.DEF.is_smartphone){var e=this.m_bChangeFixedRows?0:this.fixedRows;var f=this.m_nMakeIndex;if(this.m_nBottomRowCount>0){this.m_nBottomRowCount=0;this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild)}this.physicalRemovePartRow(e,f-1);this.m_nMakeIndex=e;this.makePartially();this.m_objScroll.arTargetRow=new Array();for(var d=0;d<this.m_nRealRows;d++){this.m_objScroll.arTargetRow.push(d)}this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow()}else{for(var d=0;d<this.m_nRealRows;d++){for(var a=0;a<this.cols;a++){var c=this.getCell(d,a);if(null!=c){this.children.remove(c.id);SBGrid.DEF.__removeAll(c.id)}}}this.makeSmartPhoneGrid()}};SBGrid.CT.DataGrid.timer=null;SBGrid.CT.DataGrid.PartiallyCount=100;SBGrid.CT.DataGrid.prototype.makePartially=function(af){var L=null!=this.attribute.renderingrows?parseInt(this.attribute.renderingrows)+this.fixedRows:0;var e=parseInt(this.m_heControl.clientHeight/this.dataHeight)+10;e=e>L?e:L;this.m_objScroll.nMaxLength=e;this.m_nRealRows=this.rows=(null!=this.m_xlRefNode?this.fixedRows+this.m_xlRefNode.length+this.getSubTotalSize():this.fixedRows);var z=0;var T=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var a=this.fixedRows+this.frozenRows;var Y=this.fixedCols+this.frozenCols;var ae=false;if(this.m_nRealRows>a&&this.frozenBottomRows>0){ae=true}var ag=document.getElementById("SBHE_DATAGRID_WHOLE_TBODY"+this.id);var F=document.getElementById("SBHE_DATAGRID_FFS_TBODY"+this.id);var ab=document.getElementById("SBHE_DATAGRID_FFN_TBODY"+this.id);var f=document.getElementById("SBHE_DATAGRID_FFCOL_TBODY"+this.id);var d=(this.m_nRealRows-this.fixedRows-this.frozenRows-this.frozenBottomRows);var P=d<0?d:0;d=null;var ak=new Array();var N=new Array();var c=new Array();var g=new Array();var W=this.m_nMakeIndex;var aj=false;var b=false;var M=false;var R="";var o=SBGrid.DEF.is_ie?this.m_heControl.currentStyle.textAlign:window.getComputedStyle(this.m_heControl,null).textAlign;switch(o){case"center":R=" sbgrid_ac";break;case"right":R=" sbgrid_ar";break;default:R=" sbgrid_al";break}var D=null;if(SBGrid.DEF.is_chrome&&!this.isJsonRef()){D=new Array();for(var ac=0;ac<T;ac++){var n=new SBGrid.DS.Hashtable();var t=this.m_xlRefNode.item(ac).firstChild;while(t){if("#text"!=t.nodeName){n[t.nodeName]=t}t=t.nextSibling}D.push(n)}}for(var ac=this.m_nMakeIndex;z<e&&ac<this.m_nRealRows;ac++){if(ae&&ac>=(this.m_nRealRows-this.frozenBottomRows+P)){continue}var ad=false;var x=ac<this.fixedRows?this.m_nRowHeight:this.dataHeight;this.m_htRowHeight[ac]=x;if(x>0&&!(SBGrid.DEF.is_mozBrowser)){x--}if(null==this.m_arHiddenRowState[ac]){this.m_arHiddenRowState.push(false)}ak.push("<tr rowNum='"+this.id+"_"+ac+"' targetcell = 'who'>");if(ac<a){aj=true;b=true;N.push("<tr rowNum='"+this.id+"_"+ac+"' targetcell = 'ffs'>");c.push("<tr rowNum='"+this.id+"_"+ac+"' targetcell = 'ffn'>")}var K="";if(a<=ac){M=true;g.push("<tr rowNum='"+this.id+"_"+ac+"' targetcell = 'ffc'>")}var E;var U;if(this.fixedRows<=ac){if(this.isJsonRef()){U=this.m_xlRefNode[ac-this.fixedRows]}else{if(!SBGrid.DEF.is_chrome){E=this.m_xlRefNode.item(ac-this.fixedRows)}}if(""!=this.backColorAlternate&&((ac-this.fixedRows)%2)==1){ad=true}else{ad=false}}for(var aa=0;aa<this.cols;aa++){var C=true;if(ae&&ac>=(this.m_nRealRows-this.frozenBottomRows+P)){C=false}if(ac<this.fixedRows+this.frozenRows||aa<this.fixedCols+this.frozenCols){C=false}var Z=ac<this.fixedRows||aa<this.fixedCols;var A=!Z&&(ac<this.fixedRows+this.frozenRows||aa<this.fixedCols+this.frozenCols);var q=(ac<this.fixedRows+this.frozenRows&&aa>=this.fixedCols+this.frozenCols);var I=(ac<this.fixedRows+this.frozenRows&&aa<this.fixedCols+this.frozenCols);var S=(ac>=this.fixedRows)&&ac<(this.m_nRealRows-(this.frozenBottomRows+P));var G=this.m_arColumn[aa];var ai=G.getAttribute("type");var s=this.id+"_"+ac+"_"+aa;var l=null!=G.attribute["class"]?G.attribute["class"]:"";ak.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+ac+"' colNum='"+this.id+"_"+aa+"' cellId='"+this.id+"."+ac+"."+aa+"' targetcell = 'who' ");if(C){ak.push("id='SBHE_"+s+"' ")}if(aj){N.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+ac+"' colNum='"+this.id+"_"+aa+"' cellId='"+this.id+"."+ac+"."+aa+"' targetcell = 'ffs' ");if(q){N.push("id='SBHE_"+s+"' ")}if(A){N.push("frozencell='true' ")}}if(b&&aa<Y){c.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+ac+"' colNum='"+this.id+"_"+aa+"' cellId='"+this.id+"."+ac+"."+aa+"' targetcell = 'ffn' ");if(I){c.push("id='SBHE_"+s+"' ")}if(A){c.push("frozencell='true' ")}}else{b=false}if(M&&aa<Y){g.push("<td sbgrid_select='false' rowNum='"+this.id+"_"+ac+"' colNum='"+this.id+"_"+aa+"' cellId='"+this.id+"."+ac+"."+aa+"' targetcell = 'ffc' ");if(S){g.push("id='SBHE_"+s+"' ")}if(A){g.push("frozencell='true' ")}}else{M=false}var O=ad?this.id+"_altc ":this.id+"_dc ";O=Z?(S?this.id+"_fhc":this.id+"_fc "):(A?this.id+"_fnc ":O);ak.push("cellname='"+O+"'");N.push(aj?"cellname='"+O+"'":"");c.push(b?"cellname='"+O+"'":"");g.push(M?"cellname='"+O+"'":"");var Q=0==this.m_arColWidth[aa]||!G.visible?"none":"";var V=new SBGrid.DS.Hashtable();var y=null;var p=null;var J=null;V.height=x+"px";if(aj){y=new SBGrid.DS.Hashtable();y.height=x+"px"}if(b){p=new SBGrid.DS.Hashtable();p.height=x+"px"}if(M){J=new SBGrid.DS.Hashtable();J.height=x+"px"}ak.push(" class='");if(ac<this.fixedRows||aa<this.fixedCols){ak.push("sbgrid_datagrid_FixedCell ");ak.push("sbgrid_"+this.id+"_fixed ");ak.push(this.m_strClassFixed+"'");if(aj){N.push(" class='");N.push("sbgrid_datagrid_FixedCell ");N.push("sbgrid_"+this.id+"_fixed ");N.push(this.m_strClassFixed+"'")}if(b){c.push(" class='");c.push("sbgrid_datagrid_FixedCell ");c.push("sbgrid_"+this.id+"_fixed ");c.push(this.m_strClassFixed+"'")}if(M){g.push(" class='");g.push("sbgrid_datagrid_FixedCell ");g.push("sbgrid_"+this.id+"_fixed ");g.push(this.m_strClassFixed+"'")}}else{var h=false;var B=R;var ai=G.getAttribute("type");if("checkbox"==ai||"radio"==ai){B=" sbgrid_ac"}if(("inputdate"==ai||"inputbutton"==ai)){B+=" sbgrid_vat";if(SBGrid.DEF.is_mozBrowser){h=true}}ak.push("sbgrid_datagrid_DataCell");ak.push(B);ak.push(" sbgrid_"+this.id+"_col"+aa);ak.push(" sbgrid_"+this.id+"_data ");ak.push(this.m_strClassData+" "+l+"'");if(C&&ad){V["background-color"]=this.backColorAlternate}if(h){V.height=(x-2)+"px"}if(aj){N.push(" class='");N.push("sbgrid_datagrid_DataCell");N.push(B);N.push(" sbgrid_"+this.id+"_col"+aa);N.push(" sbgrid_"+this.id+"_data ");N.push(this.m_strClassData+" "+l+"'");if(q&&ad){y["background-color"]=this.backColorAlternate}if(""!=this.backColorFrozen){y["background-color"]=this.backColorFrozen}if(""!=this.foreColorFrozen){y.color=this.foreColorFrozen}if(h){y.height=(x-2)+"px"}}if(b){c.push(" class='");c.push("sbgrid_datagrid_DataCell");c.push(B);c.push(" sbgrid_"+this.id+"_col"+aa);c.push(" sbgrid_"+this.id+"_data ");c.push(this.m_strClassData+" "+l+"'");if(I&&ad){p["background-color"]=this.backColorAlternate}if(""!=this.backColorFrozen){p["background-color"]=this.backColorFrozen}if(""!=this.foreColorFrozen){p.color=this.foreColorFrozen}if(h){p.height=(x-2)+"px"}}if(M){g.push(" class='");g.push("sbgrid_datagrid_DataCell");g.push(B);g.push(" sbgrid_"+this.id+"_col"+aa);g.push(" sbgrid_"+this.id+"_data ");g.push(this.m_strClassData+" "+l+"'");if(I&&ad){J["background-color"]=this.backColorAlternate}if(""!=this.backColorFrozen){J["background-color"]=this.backColorFrozen}if(""!=this.foreColorFrozen){J.color=this.foreColorFrozen}if(h){J.height=(x-2)+"px"}}}var w="";if(!C){ak.push(" style='"+this.getStyleString(V)+"'>");ak.push("<span style='border-color:transparent'/></td>")}else{var r=null;var m=null;if(null!=G){if(this.m_bIsSort){if(this.isJsonRef()){m=this.m_arSortJson[ac-this.fixedRows][aa]}else{r=this.m_arSortNodeList[ac-this.fixedRows][aa]}}else{var ah=G.getAttribute("ref");if(this.isJsonRef()){m=U}else{if(SBGrid.DEF.is_chrome){r=D[ac-this.fixedRows][ah]}else{r=SBGrid.UT.XmlLib.selectSingleNode(E,ah)}}}if(this.isJsonRef()){w=m[ah]+""}else{if(null!=r){w=SBGrid.UT.XmlLib.getTextValue(r)}}}var v=this.getCellById(s);if(null!=v){if(s!=v.id){v=null}}v=null==v?new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell"):v;v.setElement(G);this.setLinkedData(v,r,m);SBGrid.CF.GridSetMergeType(v,G.m_bMerge);ak.push(" style='"+this.getStyleString(V)+"'>");ak.push(G.makeCellElement(w,this.m_arColWidth[aa],s,V,""));ak.push("</td>")}if(aj){w="";if(q){if(ac<this.fixedRows){var v=this.getCellById(s);if(null!=v){if(s!=v.id){v=null}}v=null==v?new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell"):v;v.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(v,G.m_bMerge);if(this.m_arCaption[ac][aa]){w=this.m_arCaption[ac][aa].newlineCharConvert()}N.push(" style='"+this.getStyleString(y)+"'>");N.push("<span style='border-color:transparent;'>");N.push('<span style="white-space:nowrap;">');N.push(w);N.push("</span>");N.push("</span>");N.push("</td>")}else{var r;var m;if(null!=G){if(this.m_bIsSort){if(this.isJsonRef()){m=this.m_arSortJson[ac-this.fixedRows][aa]}else{r=this.m_arSortNodeList[ac-this.fixedRows][aa]}}else{var ah=G.getAttribute("ref");if(this.isJsonRef()){m=U}else{if(SBGrid.DEF.is_chrome){r=D[ac-this.fixedRows][ah]}else{r=SBGrid.UT.XmlLib.selectSingleNode(E,ah)}}}if(null!=m){w=m[ah]+""}else{if(null!=r){w=SBGrid.UT.XmlLib.getTextValue(r)}}}var v=this.getCellById(s);if(null!=v){if(s!=v.id){v=null}}v=null==v?new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell"):v;v.setElement(G);this.setLinkedData(v,r,m);SBGrid.CF.GridSetMergeType(v,G.m_bMerge);N.push(" style='"+this.getStyleString(y)+"'>");N.push(G.makeCellElement(w,this.m_arColWidth[aa],s,y,""));N.push("</td>")}}else{N.push(" style='"+this.getStyleString(y)+"'>");N.push("<span style='border-color:transparent'/></td>")}}if(b){w="";if(I){if(ac<this.fixedRows){var v=this.getCellById(s);if(null!=v){if(s!=v.id){v=null}}v=null==v?new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell"):v;v.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(v,G.m_bMerge);if(this.m_arCaption[ac][aa]){w=this.m_arCaption[ac][aa].newlineCharConvert()}if(SBGrid.DEF.is_opera&&aa==0&&this.m_bRowHeader){c.push(" style='"+this.getStyleString(p)+"'>");c.push("<div style='border-color:transparent;'></div>")}else{c.push(" style='"+this.getStyleString(p)+"'>");c.push("<span style='border-color:transparent;'>");c.push('<span style="white-space:nowrap;">');c.push(w);c.push("</span>");c.push("</span>");c.push("</td>")}c.push("<span style='border-color:transparent;'></span>");c.push("</td>")}else{var r;var m;if(null!=G){var ah=G.getAttribute("ref");if(ah.isEmpty()){if(this.m_bRowHeader&&0==aa){if("seq"==this.rowheader){w=ac-this.fixedRows+1}else{if("reverseseq"==this.rowheader){w=T-(ac-this.fixedRows)}}}}else{if(this.isJsonRef()){m=U}else{if(SBGrid.DEF.is_chrome){r=D[ac-this.fixedRows][ah]}else{r=SBGrid.UT.XmlLib.selectSingleNode(E,ah)}}if(null!=m){w=m[ah]+""}else{if(null!=r){w=SBGrid.UT.XmlLib.getTextValue(r)}}}}var v=this.getCellById(s);if(null!=v){if(s!=v.id){v=null}}v=null==v?new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell"):v;v.setElement(G);this.setLinkedData(v,r,m);SBGrid.CF.GridSetMergeType(v,G.m_bMerge);if(aa<this.fixedCols&&!(this.m_bRowHeader&&0==aa)){c.push(" style='"+this.getStyleString(p)+"'>");c.push(w+"</td>")}else{c.push(" style='"+this.getStyleString(p)+"'>");c.push(G.makeCellElement(w,this.m_arColWidth[aa],s,p,""));c.push("</td>")}}}else{c.push(" style='"+this.getStyleString(p)+"'>");c.push("<span style='border-color:transparent;'></span>");c.push("</td>")}}if(M){w="";if(!S){g.push(" style='"+this.getStyleString(J)+"'>");g.push("<span style='border-color:transparent;'></span>");g.push("</td>")}else{var r=null;var m=null;if(null!=G){var ah=G.getAttribute("ref");if(ah.isEmpty()){if(this.m_bRowHeader&&0==aa){if("seq"==this.rowheader){w=ac-this.fixedRows+1}else{if("reverseseq"==this.rowheader){w=T-(ac-this.fixedRows)}}}}else{if(this.isJsonRef()){m=U}else{if(SBGrid.DEF.is_chrome){r=D[ac-this.fixedRows][ah]}else{r=SBGrid.UT.XmlLib.selectSingleNode(E,ah)}}if(null!=m){w=m[ah]+""}else{if(null!=r){w=SBGrid.UT.XmlLib.getTextValue(r)}}}}if(aa<this.fixedCols&&!(this.m_bRowHeader&&0==aa)){var v=this.getCellById(s);if(null!=v){if(s!=v.id){v=null}}v=null==v?new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell"):v;v.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(v,G.m_bMerge);g.push(" style='"+this.getStyleString(J)+"'>");g.push("<span style='border-color:transparent;'></span>");g.push('<span style="white-space:nowrap;">');g.push(w);g.push("</span>");g.push("</td>")}else{var v=this.getCellById(s);if(null!=v){if(s!=v.id){v=null}}v=null==v?new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell"):v;v.setElement(G);this.setLinkedData(v,r,m);SBGrid.CF.GridSetMergeType(v,G.m_bMerge);g.push(" style='"+this.getStyleString(J)+"'>");g.push(G.makeCellElement(w,this.m_arColWidth[aa],s,J,""));g.push("</td>")}}}}ak.push("</tr>");if(aj){N.push("</tr>")}if(b){c.push("</tr>")}if(M){g.push("</tr>")}this.m_nMakeIndex++;z++;aj=false;b=false;M=false}jQuery(ag).append(ak.join(""));jQuery(F).append(N.join(""));jQuery(ab).append(c.join(""));jQuery(f).append(g.join(""));ak=null;N=null;c=null;g=null;aj=null;b=null;M=null;for(var ac=W;ac<this.m_nMakeIndex;ac++){for(var aa=0;aa<this.cols;aa++){var s=this.id+"_"+ac+"_"+aa;var H=this.getCellById(s);if(null!=H){SBGrid.CF.GridInit(H)}}}this.m_objScroll.nStartRow=this.fixedRows+this.frozenRows;this.m_objScroll.nTopRow=this.m_objScroll.nStartRow;var X=this.m_nRealRows+this.m_objScroll.nStartRow-this.m_nMakeIndex-this.frozenBottomRows;this.m_objScroll.nBottomRow=this.m_nMakeIndex-1;this.m_objScroll.nEndRow=X;this.m_objScroll.bScrollEvent=this.m_nRealRows>this.m_objScroll.nMaxLength;if("false"==this.attribute.scrollmakecell){for(var aa=0;aa<this.cols;aa++){var G=this.m_arColumn[aa];var ah=G.getAttribute("ref");ah=""==ah?"fdsafdad":ah;var u=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset+"/"+ah);for(var ac=this.m_nMakeIndex;ac<this.m_nRealRows-this.frozenBottomRows;ac++){var s=this.id+"_"+ac+"_"+aa;if(aa<this.fixedCols){var v=new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell");v.m_objElement=this.m_objFixedCell;SBGrid.CF.GridSetMergeType(v,G.m_bMerge)}else{var r;var m;var v=new SBGrid.CT.DataGridCell(this,aa,s,ac,"softbowl:cell");v.m_objElement=G;if(this.isJsonRef()){U=this.m_xlRefNode[ac-this.fixedRows];v.m_jsonObject=U}else{v.m_xnNodeElement=u.item(ac-this.fixedRows)}SBGrid.CF.GridSetMergeType(v,G.m_bMerge)}}}}if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.m_heGridFFNoScrollRow.clientHeight+"px"}if(this._isVScroll()){if(null!=this.m_heGridFFScrollRow){this.m_heGridFFScrollRow.style.width=this.m_heGridWhole.clientWidth+"px"}if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.width=this.m_heGridWhole.clientWidth+"px"}}if(null==af){this.setSeqForRowHeader()}};SBGrid.CT.DataGrid.prototype.makeGrid=function(){this.m_xlRefNode=this.getControlNodeList();this.makeGuideLine();this.makeMoveColumnBar();this.m_heGridWhole=this.makeWholeGrid();this.m_heGridFFScrollRow=this.makeFixedFrozenScrollingRow();this.m_heGridFFNoScrollRow=this.makeFixedFrozenNoScrollingRow();this.m_heGridFFCol=this.makeFixedFrozenColumn();if(!SBGrid.DEF.is_smartphone){this.showWait(false);this.makePartially(true);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow();this.m_heGridMergeCell=this.makeMergeTable();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heGridFFCol){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.m_objScroll.bScrollEvent){for(var a=0;a<this.m_nRealRows;a++){this.m_objScroll.arTargetRow.push(a)}}this.m_heGridFFCol.style.top=this.getFixedFrozenRowHeight()+"px";this.scrollAttributeSetting()}else{this.m_heGridWhole=this.makeSmartPhoneGrid();this.m_heGridMergeCell=this.makeMergeTable()}};SBGrid.CT.DataGrid.prototype.makeGridCell=function(d,g){var c=this.m_arColumn[g];var i=c.getAttribute("ref");i=""==i?"fdsafdad":i;var h=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,this.nodeset+"/"+i);if(d>=this.m_nRealRows){return null}var a=this.id+"_"+d+"_"+g;var e=null;if(g<this.fixedCols){e=new SBGrid.CT.DataGridCell(this,g,a,d,"softbowl:cell");e.m_objElement=this.m_objFixedCell;SBGrid.CF.GridSetMergeType(e,c.m_bMerge)}else{var f;var b;e=new SBGrid.CT.DataGridCell(this,g,a,d,"softbowl:cell");e.m_objElement=c;if(this.isJsonRef()){jsonRowData=this.m_xlRefNode[d-this.fixedRows];e.m_jsonObject=jsonRowData}else{e.m_xnNodeElement=h.item(d-this.fixedRows)}SBGrid.CF.GridSetMergeType(e,c.m_bMerge)}return e};SBGrid.CT.DataGrid.prototype.resetScroll=function(){if(this.m_nReScrollPosition!=null){this.m_heGridWhole.scrolLTop=this.m_nReScrollPosition}else{this.m_heGridWhole.scrollTop=0}this.m_objScroll.heTargetTable.style.top="0px";this.m_objScroll.heTargetFFCTable.style.top="0px";this.m_nReScrollPosition=null};SBGrid.CT.DataGrid.prototype.scrollAttributeSetting=function(){this.m_objScroll.nScrollDivHeight=this.m_heGridWhole.offsetHeight;this.m_objScroll.heTargetTable=this.m_heGridWhole.firstChild;this.m_objScroll.heTargetFFCTable=this.m_heGridFFCol.firstChild;this.m_objScroll.nTargetHeight=this.m_objScroll.heTargetTable.offsetHeight};SBGrid.CT.DataGrid.prototype.makeGuideLine=function(){if(SBGrid.DEF.is_smartphone){var b=document.getElementById("SBHE_"+this.id+"_HLine");var a=document.getElementById("SBHE_"+this.id+"_VLine");var c=b.parentNode;var d=a.parentNode;c.removeChild(b);d.removeChild(a);c=null;d=null;b=null;a=null}else{this.m_heHGuideLine=document.getElementById("SBHE_"+this.id+"_HLine");this.m_heVGuideLine=document.getElementById("SBHE_"+this.id+"_VLine")}};SBGrid.CT.DataGrid.prototype.showWait=function(a){if(null==this.m_heWait){this.m_heWait=document.createElement("img");this.m_heWait.setAttribute("alt","");this.m_heWait.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgWait;jQuery(this.m_heWait).addClass("sbgrid_datagrid_LoadingImg");this.m_heControl.appendChild(this.m_heWait)}if(null!=this.m_heWait){this.m_heWait.style.left=(this.m_heControl.offsetWidth/2-75)+"px";this.m_heWait.style.top=(this.m_heControl.offsetHeight/2-17)+"px"}if(a){this.m_heWait.style.display="block";if(null!=this.m_heGridWhole){jQuery(this.m_heGridWhole).addClass("sbgrid_StatusDiv");if(null!=this.m_heGridFFCol){jQuery(this.m_heGridFFCol).addClass("sbgrid_StatusDiv")}}}else{this.m_heWait.style.display="";if(null!=this.m_heGridWhole){jQuery(this.m_heGridWhole).removeClass("sbgrid_StatusDiv");if(null!=this.m_heGridFFCol){jQuery(this.m_heGridFFCol).removeClass("sbgrid_StatusDiv")}}}};SBGrid.CT.DataGrid.prototype.makeMoveColumnBar=function(){if(SBGrid.DEF.is_smartphone){var b=document.getElementById("SBHE_"+this.id+"_MoveColBar");var a=b.parentNode;a.removeChild(b);a=null;b=null}else{this.m_heMoveColumnBar=document.getElementById("SBHE_"+this.id+"_MoveColBar")}};SBGrid.CT.DataGrid.prototype.makeWholeGrid=function(){var l;var b=false;this.m_htRowHeight=new SBGrid.DS.Hashtable();this.m_arHiddenRowState=new Array();if(SBGrid.DEF.is_smartphone){var e=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.id);var m=e.parentNode;m.removeChild(e);m=null;e=null;return null}else{var h=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.id);var a=new Array();var g=0;a[1]="<colgroup id='SBHE_DATAGRID_WHOLE_COLGROUP"+this.id+"'>";for(var f=0;f<this.m_arColWidth.length;f++){g+=this.m_arColWidth[f];a.push("<col style='width:"+this.m_arColWidth[f]+"px'/>")}a.push("</colgroup>");a.push("<tbody id='SBHE_DATAGRID_WHOLE_TBODY"+this.id+"'/>");a.push("</table>");a.push("</div>");var d=SBGrid.DEF.is_ie&&!(SBGrid.DEF.is_ie9)?"event.returnValue=false;":"event.preventDefault();";a[0]="<div id='SBHE_DATAGRID_WHOLE_"+this.id+"' class ='sbgrid_datagrid_GridWhole' onkeydown='"+d+'\' onscroll=\'SBGrid.DEF._W_onProcessEvent(event, "onscroll", "'+this.id+"\")'><table id='SBHE_DATAGRID_WHOLE_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='"+g+"px' class='sbgrid_datagrid_GridWhole_table' summary='"+this.getAttribute("summary")+"' >";h.innerHTML=a.join("");var c=h.firstChild;var m=h.parentNode;m.insertBefore(c,h);m.removeChild(h);a=null;g=null;return c}};SBGrid.CT.DataGrid.prototype.makeFixedFrozenScrollingRow=function(){var a=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_SCROLLING_ROW_"+this.id);if(SBGrid.DEF.is_smartphone){var e=a.parentNode;e.removeChild(a);e=null;a=null;return null}else{var d=new Array();var c=0;d[1]="<colgroup id='SBHE_DATAGRID_FFS_COLGROUP"+this.id+"'>";for(var b=0;b<this.m_arColWidth.length;b++){c+=this.m_arColWidth[b];d.push("<col style='width:"+this.m_arColWidth[b]+"px'/>")}d.push("</colgroup>");d.push("<tbody id='SBHE_DATAGRID_FFS_TBODY"+this.id+"'/>");d.push("</table>");d[0]="<table id='SBHE_DATAGRID_FFS_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='"+c+"px' class='sbgrid_datagrid_GridFFS_table'>";a.innerHTML=d.join("");d=null;c=null;a.style.width=this.m_heGridWhole.clientWidth+"px";a.style.height=((this.m_nRowHeight*this.fixedRows)+(this.dataHeight*this.frozenRows))+"px";return a}};SBGrid.CT.DataGrid.prototype.makeFixedFrozenNoScrollingRow=function(){var b=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_NOSCROLLING_ROW_"+this.id);if(SBGrid.DEF.is_smartphone){var e=b.parentNode;e.removeChild(b);e=null;b=null;return null}else{var d=new Array();var c=0;d[1]="<colgroup id='SBHE_DATAGRID_FFN_COLGROUP"+this.id+"'>";for(var a=0;a<(this.fixedCols+this.frozenCols);a++){c+=this.m_arColWidth[a];d.push("<col style='width:"+this.m_arColWidth[a]+"px'/>")}d.push("</colgroup>");d.push("<tbody id='SBHE_DATAGRID_FFN_TBODY"+this.id+"'/>");d.push("</table>");d[0]="<table id='SBHE_DATAGRID_FFNS_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='"+c+"px' class='sbgrid_datagrid_GridFFS_table'>";b.innerHTML=d.join("");d=null;c=null;b.style.width=this.getFixedFrozenColWidth()+"px";b.style.height=((this.m_nRowHeight*this.fixedRows)+(this.dataHeight*this.frozenRows))+"px"}return b};SBGrid.CT.DataGrid.prototype.makeFixedFrozenColumn=function(){var b=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var e=this.fixedCols+this.frozenCols;var a=this.fixedRows+this.frozenRows;var f=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_COL_"+this.id);if(SBGrid.DEF.is_smartphone){var d=f.parentNode;d.removeChild(f);d=null;f=null;return null}else{var h=new Array();var g=0;h[1]="<colgroup id='SBHE_DATAGRID_FFCOL_COLGROUP"+this.id+"'>";for(var c=0;c<(this.fixedCols+this.frozenCols);c++){g+=this.m_arColWidth[c];h.push("<col style='width:"+this.m_arColWidth[c]+"px'/>")}h.push("</colgroup>");h.push("<tbody id='SBHE_DATAGRID_FFCOL_TBODY"+this.id+"'/>");h.push("</table>");h[0]="<table id='SBHE_DATAGRID_FFC_TABLE_"+this.id+"' onselectstart='return false' cellpadding=0 cellspacing=0 border=0 width='"+g+"px' class='sbgrid_datagrid_GridWhole_table'>";f.innerHTML=h.join("");h=null;g=null;f.style.top=this.getFixedFrozenRowHeight()+"px";f.style.width=this.getFixedFrozenColWidth()+"px";f.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}return f};SBGrid.CT.DataGrid.prototype.makeFixedFrozenBottomNoScrollingRow=function(){var r;var s=new Array();if(null!=this.m_heGridFFBNoScrollRow){r=this.m_heGridFFBNoScrollRow}else{r=document.createElement("div")}r.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_BOTTOM_NOSCROLLING_ROW_"+this.id);jQuery(r).addClass("sbgrid_datagrid_GridFFB sbgrid_datagrid_LayoutDiv");r.style.width=this.getFixedFrozenColWidth()+"px";var g=new Array();g.push("<table onselectstart=\"return false\" cellpadding=0 cellspacing=0 border=0 class='sbgrid_datagrid_GridFFBN_table'>");g.push('<colgroup id="SBHE_DATAGRID_FFBN_COLGROUP'+this.id+'">');for(var A=0;A<(this.fixedCols+this.frozenCols);A++){g.push('<col style="width:'+this.m_arColWidth[A]+'px">')}g.push("</colgroup><tbody>");if(1>this.frozenBottomRows||this.m_nRealRows<=(this.fixedRows+this.frozenRows)){r.style.height="0px";g.push("<tr><td/></tr></tbody></table>");r.innerHTML=g.join("");this.m_heControl.appendChild(r);return r}var o=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var B=this.fixedCols+this.frozenCols;var H="";var H="";var u=(this.m_nRealRows-this.fixedRows-this.frozenRows-this.frozenBottomRows);var w=u<0?u:0;u=null;var F="";var q=SBGrid.DEF.is_ie?this.m_heControl.currentStyle.textAlign:window.getComputedStyle(this.m_heControl,null).textAlign;switch(q){case"center":F=" sbgrid_ac";break;case"right":F=" sbgrid_ar";break;default:F=" sbgrid_al";break}var c=true;for(var A=this.m_nRealRows-(this.frozenBottomRows+w);A<this.m_nRealRows;A++){var e=false;var f=A<this.fixedRows?this.m_nRowHeight:this.dataHeight;if(f>0&&!(SBGrid.DEF.is_mozBrowser)){if(c){f=f-2}else{f--}}g.push("<TR rowNum='"+this.id+"_"+A+"' targetcell='ffbn'>");var x;var y;if(this.fixedRows<=A){if(this.isJsonRef()){y=this.m_xlRefNode[A-this.fixedRows]}else{x=this.m_xlRefNode.item(A-this.fixedRows)}if(""!=this.backColorAlternate&&((A-this.fixedRows)%2)==1){e=true}else{e=false}}for(var z=0;z<B&&z<this.cols;z++){var m=new SBGrid.DS.Hashtable();var p=(z<this.fixedCols+this.frozenCols);var G=z>=this.fixedCols;var v=this.m_arColumn[z];var h=this.id+"_"+A+"_"+z;var a=null!=v.attribute["class"]?v.attribute["class"]:"";g.push("<TD sbgrid_select='false' class=");var d=" rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbn' ";if(p){d=' id="SBHE_'+h+"\" valign ='middle' rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbn' "}if(G){d+="frozencell = 'true' "}m.height=f+"px";if(A<this.fixedRows||z<this.fixedCols){if(c){g.push("'sbgrid_datagrid_BFixedCell ")}else{g.push("'sbgrid_datagrid_FixedCell ")}g.push("sbgrid_"+this.id+"_fixed ");g.push(this.m_strClassFixed+"'")}else{var E=F;var b=v.getAttribute("type");if("checkbox"==b||"radio"==b){E=" sbgrid_ac"}if(("inputdate"==b||"inputbutton"==b)){E+=" sbgrid_vat";if(SBGrid.DEF.is_mozBrowser){m.height=(f-2)+"px"}}if(c){g.push("'sbgrid_datagrid_BDataCell")}else{g.push("'sbgrid_datagrid_DataCell")}g.push(E);g.push(" sbgrid_"+this.id+"_col"+z);g.push(" sbgrid_"+this.id+"_data ");g.push(this.m_strClassData+" "+a+"'");m["background-color"]="";m.color="";m["background-color"]=p&&e?this.backColorAlternate:m["background-color"];m["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:m["background-color"];m.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:m.color}var C="";g.push(d);if(p){if(A<this.fixedRows){var t=this.getCellById(h);if(null!=t){if(h!=t.id){t=null}}t=null==t?new SBGrid.CT.DataGridCell(this,z,h,A,"softbowl:cell"):t;t.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(t,v.m_bMerge);if(this.m_arCaption[A][z]){C=this.m_arCaption[A][z].newlineCharConvert()}g.push("style='"+this.getStyleString(m)+"'>");if(!(A==0&&z==0&&this.m_bRowHeader)){g.push('<span style="white-space:nowrap;">'+C+"</span>")}g.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"></span>')}else{var D;var l;if(null!=v){var n=v.getAttribute("ref");if(n.isEmpty()){if(this.m_bRowHeader&&0==z){if("seq"==this.rowheader){C=A-this.fixedRows+1}else{if("reverseseq"==this.rowheader){C=o-(A-this.fixedRows)}}}}else{if(this.m_bIsSort){if(this.isJsonRef()){l=this.m_arSortJson[A-this.fixedRows][z]}else{D=this.m_arSortNodeList[A-this.fixedRows][z]}}else{if(this.isJsonRef()){l=y}else{D=SBGrid.UT.XmlLib.selectSingleNode(x,n)}}if(l!=null){C=y}else{if(null!=D){C=SBGrid.UT.XmlLib.getTextValue(D)}}}}var t=this.getCellById(h);if(null!=t){if(h!=t.id){t=null}}t=null==t?new SBGrid.CT.DataGridCell(this,z,h,A,"softbowl:cell"):t;t.setElement(v);this.setLinkedData(t,D,l);SBGrid.CF.GridSetMergeType(t,v.m_bMerge);s.push(t);if(z<this.fixedCols&&!(this.m_bRowHeader&&0==z)){g.push(C)}else{g.push("style='"+this.getStyleString(m)+"'>");g.push(v.makeCellElement(C,this.m_arColWidth[z],h,m))}}}else{g.push("style='"+this.getStyleString(m)+"'>");g.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"></div>')}g.push("</TD>")}g.push("</TR>");c=false}g.push("</tbody></TABLE>");r.innerHTML=g.join("");g=null;r.style.top=(this.m_heGridWhole.clientHeight-(this.dataHeight*this.m_nBottomRowCount))+"px";r.style.height=(this.dataHeight*this.m_nBottomRowCount)+"px";this.m_heControl.appendChild(r);for(var A=0;A<s.length;A++){SBGrid.CF.GridInit(s[A])}s=null;return r};SBGrid.CT.DataGrid.prototype.makeFixedFrozenBottomScrollingRow=function(){this.m_nBottomRowCount=0;var q=new Array();var b;if(null!=this.m_heGridFFBScrollRow){b=this.m_heGridFFBScrollRow}else{b=document.createElement("div")}var a=this.m_heGridWhole.clientHeight-(this.dataHeight*this.frozenBottomRows);b.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_BOTTOM_SCROLLING_ROW_"+this.id);jQuery(b).addClass("sbgrid_datagrid_GridFFB sbgrid_datagrid_LayoutDiv");b.style.width=this.m_heGridWhole.clientWidth+"px";var y=this._getTotalColWidth();var f=new Array();f.push("<table onselectstart='return false' cellpadding=0 cellspacing=0 border=0 class='sbgrid_datagrid_GridFFS_table' style='width:"+y+"px'>");f.push('<colgroup id="SBHE_DATAGRID_FFBS_COLGROUP'+this.id+'">');for(var A=0;A<this.cols;A++){f.push('<col style="width:'+this.m_arColWidth[A]+'px" >')}f.push("</colgroup><TBODY>");if(1>this.frozenBottomRows||this.m_nRealRows<=(this.fixedRows+this.frozenRows)){b.style.top="0px";b.style.height="0px";f.push("<tr><td/></tr></tbody></table>");b.innerHTML=f.join("");this.m_heControl.appendChild(b);return b}var s=(this.m_nRealRows-this.fixedRows-this.frozenRows-this.frozenBottomRows);var v=s<0?s:0;s=null;var E="";var o=SBGrid.DEF.is_ie?this.m_heControl.currentStyle.textAlign:window.getComputedStyle(this.m_heControl,null).textAlign;switch(o){case"center":E=" sbgrid_ac";break;case"right":E=" sbgrid_ar";break;default:E=" sbgrid_al";break}for(var A=this.m_nRealRows-(this.frozenBottomRows+v);A<this.m_nRealRows;A++){this.m_nBottomRowCount++;var e=false;var g=this.dataHeight;this.m_htRowHeight[A]=this.dataHeight;if(g>0&&!(SBGrid.DEF.is_mozBrowser)){if(1==this.m_nBottomRowCount){g=g-2}else{g--}}f.push("<TR rowNum='"+this.id+"_"+A+"' targetcell='ffbs'>");var w;var x;if(this.fixedRows<=A){if(this.isJsonRef()){x=this.m_xlRefNode[A-this.fixedRows]}else{w=this.m_xlRefNode.item(A-this.fixedRows)}if(""!=this.backColorAlternate&&((A-this.fixedRows)%2)==1){e=true}else{e=false}}for(var z=0;z<this.cols;z++){var m=new SBGrid.DS.Hashtable();var p=(z>=this.fixedCols+this.frozenCols);var u=this.m_arColumn[z];var h=this.id+"_"+A+"_"+z;var c=null!=u.attribute["class"]?u.attribute["class"]:"";f.push("<td sbgrid_select='false' class=");var t=" rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbs' ";if(p){t=' id="SBHE_'+h+"\" valign ='middle' rowNum='"+this.id+"_"+A+"' colNum='"+this.id+"_"+z+"'  cellId='"+this.id+"."+A+"."+z+"' targetcell = 'ffbs' "}t+="frozencell = 'true' ";m.height=g+"px";if(A<this.fixedRows||z<this.fixedCols){if(1==this.m_nBottomRowCount){f.push("'sbgrid_datagrid_BFixedCell ")}else{f.push("'sbgrid_datagrid_FixedCell ")}f.push("sbgrid_"+this.id+"_fixed ");f.push(this.m_strClassFixed+"'")}else{var D=E;var d=u.getAttribute("type");if("checkbox"==d||"radio"==d){D=" sbgrid_ac"}if(("inputdate"==d||"inputbutton"==d)){D+=" sbgrid_vat";if(SBGrid.DEF.is_mozBrowser){m.height=(g-2)+"px"}}if(1==this.m_nBottomRowCount){f.push("'sbgrid_datagrid_BDataCell")}else{f.push("'sbgrid_datagrid_DataCell")}f.push(D);f.push(" sbgrid_"+this.id+"_col"+z);f.push(" sbgrid_"+this.id+"_data ");f.push(this.m_strClassData+" "+c+"'");m["background-color"]="";m.color="";m["background-color"]=p&&e?this.backColorAlternate:m["background-color"];m["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:m["background-color"];m.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:m.color}f.push(t);var B="";if(p){var C;var l;if(null!=u){if(this.m_bIsSort){if(this.isJsonRef()){l=this.m_arSortJson[A-this.fixedRows][z]}else{C=this.m_arSortNodeList[A-this.fixedRows][z]}}else{var n=u.getAttribute("ref");if(this.isJsonRef()){l=x}else{C=SBGrid.UT.XmlLib.selectSingleNode(w,n)}}if(null!=l){B=l[n]+""}else{if(null!=C){B=SBGrid.UT.XmlLib.getTextValue(C)}}}var r=this.getCellById(h);if(null!=r){if(h!=r.id){r=null}}r=null==r?new SBGrid.CT.DataGridCell(this,z,h,A,"softbowl:cell"):r;r.setElement(u);this.setLinkedData(r,C,l);SBGrid.CF.GridSetMergeType(r,u.m_bMerge);q.push(r);var d=u.getAttribute("type");f.push("style='"+this.getStyleString(m)+"' >");f.push(u.makeCellElement(B,this.m_arColWidth[z],h,m))}else{f.push("style='"+this.getStyleString(m)+"' >");f.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');f.push('border-top-color:transparent; border-left-color:transparent;"></div>')}f.push("</TD>")}f.push("</TR>")}f.push("</TBODY></TABLE>");b.innerHTML=f.join("");f=null;b.style.top=(this.m_heGridWhole.clientHeight-(this.dataHeight*this.m_nBottomRowCount))+"px";b.style.height=(this.dataHeight*this.m_nBottomRowCount)+"px";this.m_heControl.appendChild(b);for(var A=0;A<q.length;A++){SBGrid.CF.GridInit(q[A])}q=null;return b};SBGrid.CT.DataGrid.prototype.makeSmartPhoneGrid=function(){var z=this.fixedCols+this.frozenCols;var q=document.getElementById("SBHE_DATAGRID_WHOLE_"+this.id);var r=false;var b=null;if(null!=q){var m=document.getElementById("SBHE_DATAGRID_WHOLE_TABLE_"+this.id);b=m.firstChild.cloneNode(true);q.removeChild(m);r=true}else{q=document.createElement("div");q.setAttribute("id","SBHE_DATAGRID_WHOLE_"+this.id);q.style.position="absolute";q.style.left="0px";q.style.top="0px";q.style.width="100%";q.style.height="100%";q.style.overflowX="hidden";q.style.overflowY="hidden"}var n='<table id="SBHE_DATAGRID_WHOLE_TABLE_'+this.id+'" cellpadding=0 cellspacing=0 border=0 style="table-layout:fixed;font-family:굴림;font-size:9pt;color:#000000;">';if(0!=this._getTotalColWidth()){n=n.insertAttribute("width",this._getTotalColWidth()+"px")}if(!r){var s='<colgroup id="SBHE_DATAGRID_WHOLE_COLGROUP'+this.id+'">';for(var y=0;y<this.cols;y++){s+='<col style="width:'+this.m_arColWidth[y]+'px">'}s+="</colgroup>";n+=s}var o=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;this.rows=this.fixedRows+o;this.m_nRealRows=this.rows;var D="";this.m_nMakeIndex=this.m_nRealRows;for(var y=0;y<this.m_nRealRows;y++){var c=false;var d=y<this.fixedRows?this.m_nRowHeight:this.dataHeight;var v="<TR rowNum='"+this.id+"_"+y+"'>";if(d>0&&!(SBGrid.DEF.is_mozBrowser)){d--}var u;if(this.fixedRows<=y){u=this.m_xlRefNode.item(y-this.fixedRows);if(""!=this.backColorAlternate&&((y-this.fixedRows)%2)==1){c=true}else{c=false}}for(var x=0;x<this.cols;x++){var h=new SBGrid.DS.Hashtable();var t=this.m_arColumn[x];var e=this.id+"_"+y+"_"+x;var B;B='<td onmousedown=" "onmousemove=" "onmouseup=" "ondblclick=" "onkeydown=" "onkeypress=" "onkeyup=" " id="SBHE_'+e+"\" valign='middle'>";h.height=d+"px";h.overflow="hidden";h["background-repeat"]="no-repeat";h["text-align"]=(""==this.getAttribute("text-align"))?"left":this.getAttribute("text-align");var p=this.getCellById(e);if(null!=p){if(e!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,x,e,y,"softbowl:cell"):p;p.setElement(t);SBGrid.CF.GridSetMergeType(p,t.m_bMerge);var A="";if(y<this.fixedRows||x<this.fixedCols){h["text-align"]="center";h["background-color"]="#D4D0C8";h["border-right-color"]="#6F6F5F";h["border-bottom-color"]="#6F6F5F";this.setBaseCellStyle(h,"fixed");h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}else{h["background-color"]="#FFFFFF";h["border-right-color"]="#D4D0C8";h["border-bottom-color"]="#D4D0C8";this.setColStyleInheritanceCell(h,x);this.setBaseCellStyle(h,"data");h["background-color"]=c?this.backColorAlternate:h["background-color"];if(x<z||y<(this.fixedRows+this.frozenRows)||y>=(this.m_nRealRows-this.frozenBottomRows)){h["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:h["background-color"]}h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}if(y<this.fixedRows){if(this.m_arCaption[y][x]){A=this.m_arCaption[y][x].newlineCharConvert()}B=B.insertAttribute("style",this.getStyleString(h));B+='<span style="white-space:nowrap;">'+A+"</span>"}else{if(null!=t){var l=t.getAttribute("ref");if(l.isEmpty()){if(this.m_bRowHeader&&0==x){if("seq"==this.rowheader){A=y-this.fixedRows+1}else{if("reverseseq"==this.rowheader){A=o-(y-this.fixedRows)}}}}else{var C;var g;if(this.isJsonRef()){g=jsonRowData}else{C=SBGrid.UT.XmlLib.selectSingleNode(u,l)}if(null!=g){A=g[l]+""}else{if(null!=C){A=SBGrid.UT.XmlLib.getTextValue(C)}}this.setLinkedData(p,C,g)}}if(x<this.fixedCols&&!(this.m_bRowHeader&&0==x)){B=B.insertAttribute("style",this.getStyleString(h));B+=A}else{var a=t.getAttribute("type");if("checkbox"==a||"radio"==a){h["text-align"]="center"}B=B.insertAttribute("style",this.getStyleString(h));B+=t.makeCellElement(A,this.m_arColWidth[x],e,h)}}B+="</TD>";v+=B}v+="</TR>";D+=v}for(var y=this.m_nRealRows;y<(this.m_nDefaultRows+this.fixedRows);y++){var d=y<this.fixedRows?20:this.dataHeight;var v="<TR>";for(var x=0;x<this.cols;x++){var h=new SBGrid.DS.Hashtable();var e=this.id+"_"+y+"_"+x;var B;B='<td onmousedown=" "onmousemove=" "onmouseup=" "ondblclick=" "onkeydown=" "onkeypress=" "onkeyup=" " id="SBHE_'+e+"\" valign='middle'>";h.height=d+"px";h.overflow="hidden";h["background-repeat"]="no-repeat";if(y<this.fixedRows||x<this.fixedCols){h["text-align"]="center";h["background-color"]="#D4D0C8";h["border-right-color"]="#6F6F5F";h["border-bottom-color"]="#6F6F5F";this.setBaseCellStyle(h,"fixed");h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}else{h["background-color"]="#FFFFFF";h["border-right-color"]="#D4D0C8";h["border-bottom-color"]="#D4D0C8";this.setColStyleInheritanceCell(h,x);this.setBaseCellStyle(h,"data");h["border-top-width"]="0px";h["border-left-width"]="0px";h["border-right-width"]="1px";h["border-bottom-width"]="1px";h["border-right-style"]="solid";h["border-bottom-style"]="solid"}B=B.insertAttribute("style",this.getStyleString(h));var w="<div>&nbsp;</div>";B+=w;B+="</TD>";v+=B}v+="</TR>";D+=v;this.rows++}var f=document.getElementById("SBHE_DATAGRID_EXPANSION_"+this.id);if(null==f){if(SBGrid.DEF.is_ie){f=document.createElement("<image onclick=\"SBGrid.CT.DataGrid.onClickExpansion(event, '"+this.id+"');\">")}else{f=document.createElement("image");f.setAttribute("onclick",'SBGrid.CT.DataGrid.onClickExpansion(event, "'+this.id+'")')}f.setAttribute("id","SBHE_DATAGRID_EXPANSION_"+this.id);f.setAttribute("src",SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridExpansion);f.style.position="absolute";f.style.top=(this.m_heControl.offsetHeight-20)+"px";f.style.left=(this.m_heControl.offsetWidth-20)+"px";if("visible"==this.getAttribute("overflow")||"hidden"==this.getAttribute("overflow")){f.style.display="none"}}n+=D;n+="</TABLE>";q.innerHTML=n;if(r){var m=document.getElementById("SBHE_DATAGRID_WHOLE_TABLE_"+this.id);m.insertBefore(b,m.firstChild)}else{this.m_heControl.appendChild(q);this.m_heControl.appendChild(f)}return q};SBGrid.CT.DataGrid.prototype.resize=function(a){if(null!=this.m_heGridWhole&&this.m_heGridFFScrollRow){this.m_heGridFFScrollRow.style.width=this.m_heGridWhole.clientWidth+"px";this.m_heGridFFScrollRow.scrollLeft=this.m_heGridWhole.scrollLeft;if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.width=this.m_heGridWhole.clientWidth+"px";this.m_heGridFFBScrollRow.scrollLeft=this.m_heGridWhole.scrollLeft}}if(null!=this.m_heGridWhole&&this.m_heGridFFCol){this.m_heGridFFCol.scrollTop=this.m_heGridWhole.scrollTop}};SBGrid.CT.DataGrid.prototype.onScroll=function(b){if(!SBGrid.DEF.is_smartphone){if(null!=this.m_heGridWhole&&this.m_heGridFFScrollRow){this.m_heGridFFScrollRow.scrollLeft=this.m_heGridWhole.scrollLeft;this.m_heGridFFBScrollRow.scrollLeft=this.m_heGridWhole.scrollLeft}if(null!=this.m_heGridWhole&&this.m_heGridFFCol){this.m_heGridFFCol.scrollTop=this.m_heGridWhole.scrollTop}var c=false;var a=false;if(this.vscroll.getPrevScrollPosition()!=this.m_heGridWhole.scrollTop){c=true}if(this.hscroll.getPrevScrollPosition()!=this.m_heGridWhole.scrollLeft){a=true}this.vscroll.setScrollPosition(this.m_heGridWhole.scrollTop);this.vscroll.setScrollMax(this.m_heGridWhole.scrollHeight-this.m_heGridWhole.clientHeight);if(c){if(this.m_heGridWhole.scrollTop==0){this.vscroll.dispatch("onscrollmin")}else{if(this.m_heGridWhole.scrollHeight-this.m_heGridWhole.clientHeight==this.m_heGridWhole.scrollTop){this.vscroll.dispatch("onscrollmax")}}}this.hscroll.setScrollPosition(this.m_heGridWhole.scrollLeft);this.hscroll.setScrollMax(this.m_heGridWhole.scrollWidth-this.m_heGridWhole.clientWidth);if(a){if(this.m_heGridWhole.scrollLeft==0){this.hscroll.dispatch("onscrollmin")}else{if(this.m_heGridWhole.scrollWidth-this.m_heGridWhole.clientWidth==this.m_heGridWhole.scrollLeft){this.hscroll.dispatch("onscrollmax")}}}this.stopEditing();if(!SBGrid.DEF.is_smartphone&&this.m_objScroll.bScrollEvent&&this.m_objScroll.nPosition!=this.m_heGridWhole.scrollTop){var d=this.m_objScroll.nPosition-this.m_heGridWhole.scrollTop;if(Math.abs(d)<80){this.scrolButtonClick(d,this.m_heGridWhole.scrollTop)}else{if(d>0){this.m_objScroll.heTargetTable.style.top=this.m_heGridWhole.scrollTop+"px";this.m_objScroll.heTargetFFCTable.style.top=this.m_heGridWhole.scrollTop+"px"}this.showWait(true);this.m_objScroll.arScrollLength.push(1);window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",200)}this.setTopBottomRowPosition()}this.m_bDown=false}};SBGrid.CT.DataGrid.prototype.onMouseDown=function(c){SBGrid.CT.Group.prototype.onMouseDown.call(this,c);if(!this.isDescendants(c.focus,true)){this.m_bDown=false;return}if(this._isShowCombo()&&!this.m_bIsShowCombo){this.m_bDown=false;return}this.m_bIsShowCombo=false;if(this.isScrollBar(c)){this._gridComboHidden();return}if(!this.isCell(c.target)&&!this.isDescendants(c.target)){this._gridComboHidden();return}if(3==c.button){this.m_bDown=false;this._gridComboHidden();return}this.m_nPrevX=c.x;this.m_nPrevY=c.y;if(-1==this.getMouseRow()||-1==this.getMouseCol()){return}var n=this.getAttribute("cursor");this.m_bLButtonDown=false;this.m_bDragStart=false;if("drag-move"==n){SBGrid.DEF.bDragDrop=true;this.m_bLButtonDown=true;return}else{if("h-resize"!=n&&"v-resize"!=n){this.restoreCursor()}else{this.m_bAfterResize=true}}var f=false;if(this.m_nDownRow!=this.getMouseRow()||this.m_nDownCol!=this.getMouseCol()){var d=this.m_arColumn[this.getMouseCol()];if(null!=d){var m=d.getInputType();if((SBGrid.DEF.SBIT_INPUTBUTTON==m||SBGrid.DEF.SBIT_INPUTDATE==m)&&d.inputDataPosition()<c.clientX){f=false}else{f=true}}else{f=true}}if(SBGrid.EVT.BUTTON_RIGHT!=c.button){this.m_bDown=true}if(!this.m_bIsShowItem&&this.isCell(c.target)){this.m_nDownRow=this.getMouseRow();this.m_nDownCol=this.getMouseCol()}var q=this.getRow();var e=this.getCol();this.setRowValue(this.m_nDownRow);this.setColValue(this.m_nDownCol);if(SBGrid.EVT.BUTTON_RIGHT!=c.button&&(this.isNormalCell(this.m_nDownRow,this.m_nDownCol)||this.isFixedCell(this.m_nDownRow,this.m_nDownCol))){c.capture=this.id}var g=this.getCell(this.m_nDownRow,this.m_nDownCol);if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&this.m_bIsExplorerBar){this.m_moveColInfo=c.hover;this.m_bIsFirstMoveColumn=true;var g=this.getCell(this.m_nDownRow,this.m_nDownCol)}if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&!this.getAllowBigSelection()){this.stopEditing();if(!this.m_bIsExplorerBar){this.clearSelection()}return}if(null!=g){if(!c.shiftKey){this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()){if(this.isNormalCell(this.m_nDownRow,this.m_nDownCol)){if(!c.ctrlKey){this.clearSelection()}if(!this.getAllowSelection()){this.clearSelection();this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}var b=SBGrid.DEF.arrFind_Value(this.m_arSelectRows,this.m_nDownRow);if(b>-1){this.deSelectRow(this.m_nDownRow)}else{this.selectRow(this.m_nDownRow)}}}else{if(this.isNormalCell(this.m_nDownRow,this.m_nDownCol)){var o=false;if(SBGrid.DEF.SBSM_FREE==this.getSelectionMode()){if(!c.ctrlKey){this.clearSelection()}else{if(!this.getAllowSelection()){this.clearSelection();this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}var p=this.m_htSelectCells[g.id];if(null!=p){this.removeSelCells(g.id);o=true}}}else{this.clearSelection()}if(!o){if(!this.getAllowSelection()){this.m_nPrevDownRow=this.m_nDownRow;this.m_nPrevDownCol=this.m_nDownCol}var l=(this.m_nPrevDownRow<this.m_nDownRow)?this.m_nPrevDownRow:this.m_nDownRow;var i=(this.m_nPrevDownRow<this.m_nDownRow)?this.m_nDownRow:this.m_nPrevDownRow;var h=(this.m_nPrevDownCol<this.m_nDownCol)?this.m_nPrevDownCol:this.m_nDownCol;var a=(this.m_nPrevDownCol<this.m_nDownCol)?this.m_nDownCol:this.m_nPrevDownCol;this.selectCells(l,h,i,a)}}}}if(!this.isFixedCell(this.m_nDownRow,this.m_nDownCol)&&!g.m_bIsSubTotal){if(f){this.dispatch("onentercell")}else{this.topScrollCell(this.m_nDownRow,false)}}if("h-resize"!=this.getAttribute("cursor")&&"v-resize"!=this.getAttribute("cursor")){if(q!=this.m_nDownRow){this.dispatch("onrowchanged")}if(e!=this.m_nDownCol){this.dispatch("oncolchanged")}}};SBGrid.CT.DataGrid.prototype.onMouseUp=function(a){this.m_bLButtonDown=false;SBGrid.CT.Group.prototype.onMouseUp.call(this,a);this.m_bDown=false;SBGrid.DEF.bIsAfterMouseUpFlg=true;if(!this.isCell(a.target)){return}};SBGrid.CT.DataGrid.prototype.onMouseMove=function(d){SBGrid.CT.Group.prototype.onMouseMove.call(this,d);var c=this.getMouseRow();var f=this.getMouseCol();var b=this.getCell(c,f);var e=this.getRow();var a=this.getCol();if(!this.isCell(d.target)&&SBGrid.DEF.SBRS_NONE==this.getResizeType()){this.restoreCursor();return}if(this.m_bLButtonDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&!this.m_bDragStart){this.m_bDragStart=true;this.m_bLButtonDown=false;d.capture="";d.drag=this.id;this.dispatch("ondragstart");return}if(this.getAllowUserResize()){if(SBGrid.DEF.SBRS_NONE==this.getResizeType()&&""==d.capture){this.hitTestCell(d)}var b=this.getCell(c,f);if(null!=b){if(!this.m_bDown&&""!=this.getAttribute("dragmode")&&"false"!=this.getAttribute("dragmode")&&this.isDragCellSelect(c,f,b)){this.setGridCursor("drag-move");this.m_bDragStart=true}else{this.m_bDragStart=false}}}};SBGrid.CT.DataGrid.prototype.onMouseWheel=function(b){if(0!=b.mouseWheel){SBGrid.CT.Group.prototype.onMouseWheel.call(this,b);if(!this.isCell(b.target)&&!this.isDescendants(b.target)){return}var a=this.getCell(this.m_nDownRow,this.m_nDownCol);if(null!=a&&((this.fixedCols+this.frozenCols)>a.col||(this.fixedRows+this.frozenRows)>a.row)){this.m_heGridWhole.scrollTop=this.m_heGridWhole.scrollTop-(b.mouseWheel*18)}this.closePopUp()}};SBGrid.CT.DataGrid.prototype.onClick=function(c){this.deleteShowExplorerUI();SBGrid.CT.Group.prototype.onClick.call(this,c);if(SBGrid.DEF.is_ie){if(null!=this.m_heGridFFScrollRow){this.m_heGridFFScrollRow.scrollTop=0}if(null!=this.m_heGridFFNScrollRow){this.m_heGridFFNScrollRow.scrollTop=0}}if(!this.isCell(c.target)&&!this.isDescendants(c.target)){return}var b=this.getCell(this.m_nDownRow,this.m_nDownCol);if(this.isScrollBar(c.target)==false){if(this.isFixedRow(this.m_nDownRow)){if(null!=b&&SBGrid.DEF.SBIT_CHECK==b.m_fixedInputType){return}if(this.getFixedRows()>1){if(this.getTextMatrix(this.m_nDownRow,this.m_nDownCol)!=this.getTextMatrix(this.getFixedRows()-1,this.m_nDownCol)){return}}if(this.isShowExplorerUI()){var d=this.getCellRect(this.m_nDownRow,this.m_nDownCol);this.getShowExplorerUI(d)}else{if(this.isSortable()){this.sortCaptionColumn(this.m_nDownCol)}}}}if(null!=b){if(this.getAllowBigSelection()&&this.isFixedCell(this.m_nDownRow,this.m_nDownCol)){this.clearSelection();if(0<this.fixedRows&&0<this.fixedCols&&0==this.m_nDownRow&&0==this.m_nDownCol){if(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode()){for(var a=this.fixedRows;a<this.rows;a++){this.selectRow(a)}}if(SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){for(var a=this.fixedCols;a<this.cols;a++){this.selectCol(a)}}}else{if(this.isFixedRow(this.m_nDownRow)&&SBGrid.DEF.SBSM_BYCOL==this.getSelectionMode()){this.selectCol(this.m_nDownCol)}else{if(this.isFixedCol(this.m_nDownCol)&&(SBGrid.DEF.SBSM_LIST==this.getSelectionMode()||SBGrid.DEF.SBSM_BYROW==this.getSelectionMode())){this.selectRow(this.m_nDownRow)}}}}}};SBGrid.CT.DataGrid.prototype.onDblClick=function(b){SBGrid.CT.Group.prototype.onDblClick.call(this,b);if(!this.isCell(b.target)){return}if(!this.isDescendants(b.focus,true)){return}if(!this.isEditing()){this.setEditCell(b)}if(this.getAutoSizeMouse()){if("h-resize"==this.getAttribute("cursor")){var a=this.childReturnObj(b.focus);if(null!=a){this.autoResizeWidth(a.col)}}this.restoreCursor()}};SBGrid.CT.DataGrid.prototype.onKeyUp=function(a){SBGrid.CT.Group.prototype.onKeyUp.call(this,a)};SBGrid.CT.DataGrid.prototype.onKeyDown=function(b){SBGrid.CT.Group.prototype.onKeyDown.call(this,b);var a=true;if(!this.isCell(b.target)&&this.id!=b.target){return}if(b.ctrlKey&&SBGrid.EVT.C==b.keyCode){this.dispatch("oncopy");return}if(b.ctrlKey&&SBGrid.EVT.V==b.keyCode){this.dispatch("onpaste");return}if(SBGrid.EVT.CONTROL==b.keyCode||SBGrid.EVT.SHIFT==b.keyCode||SBGrid.EVT.TAB==b.keyCode){return}if(null!=this.m_heControl&&"softbowl:input"!=b.pTarget.tag&&(SBGrid.EVT.LEFT==b.keyCode||SBGrid.EVT.RIGHT==b.keyCode)){this.m_heControl.focus()}if(this.isEditing()&&(SBGrid.EVT.ENTER==b.keyCode)){this.setCellEditText();a=false}if(!this.isEditing()&&a&&!this.m_bIsMaxLength&&(SBGrid.EVT.ENTER==b.keyCode||SBGrid.EVT.SPACE==b.keyCode||(SBGrid.EVT.ZERO<=b.keyCode&&SBGrid.EVT.NINE>=b.keyCode)||(SBGrid.EVT.A<=b.keyCode&&SBGrid.EVT.Z>=b.keyCode)||(96<=b.keyCode&&111>=b.keyCode)||(186<=b.keyCode&&222>=b.keyCode))){this.onFocus(b);this.setEditCell(b)}this.m_bIsMaxLength=false;if(!this.isEditing()){switch(b.keyCode){case SBGrid.EVT.LEFT:this.funcMoveLeft(b);break;case SBGrid.EVT.RIGHT:this.funcMoveRight(b);break;case SBGrid.EVT.UP:this.funcMoveUp(b);break;case SBGrid.EVT.DOWN:this.funcMoveDown(b);break;case SBGrid.EVT.HOME:if(!b.ctrlKey){}else{}break;case SBGrid.EVT.END:if(!b.ctrlKey){this.funcMoveEnd(b);break}else{this.funcMoveCtrlEnd(b);break}case SBGrid.EVT.PAGEUP:this.funcMovePageUp(b);break;case SBGrid.EVT.PAGEDOWN:this.funcMovePageDown(b);break}}this.selectKeyDown(b)};SBGrid.CT.DataGrid.prototype.funcMovePageUp=function(c){var a;if(!SBGrid.DEF.is_ie&&!SBGrid.DEF.is_opera){var d=this.m_heGridWhole;a=Math.round((d.offsetHeight/8)*7);var e=d.scrollTop;if(0<e-a){d.scrollTop=e-a}else{d.scrollTop=0}}if("true"==this.attribute.pageselection){if(null==a){a=Math.round((this.m_heGridWhole.offsetHeight/8)*7)}var b=this.row;while(a>0){b--;a-=null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}b=b<=this.fixedRows?this.fixedRows:b;this.setRow(b)}};SBGrid.CT.DataGrid.prototype.funcMovePageDown=function(c){if(!SBGrid.DEF.is_ie&&!SBGrid.DEF.is_opera){var d=this.m_heGridWhole;var a=Math.round((d.offsetHeight/8)*7);var e=d.scrollTop;d.scrollTop=e+a}if("true"==this.attribute.pageselection){if(null==a){a=Math.round((this.m_heGridWhole.offsetHeight/8)*7)}var b=this.row;while(a>0){b++;a-=null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}b=b>=(this.m_nRealRows-1)?(this.m_nRealRows-1):b;this.setRow(b)}};SBGrid.CT.DataGrid.prototype.onNext=function(a){this.stopEditing();var d=this.getRow();var g=this.getCol();var h=this.rows-1;var f=this.cols-1;var i=d;var b=g;var e=this.getMoveCell(d,g,SBGrid.DEF.SBKE_NEXT);d=e.m_nY;g=e.m_nX;if(d<this.fixedRows){return}this.setRowValue(d);this.setColValue(g);if(i!=d){this.dispatch("onrowchanged")}if(b!=g){this.dispatch("oncolchanged")}this.clearSelection();this.selectCells(d,g,d,g);var c=this.getCell(d,g);if(null!=c){SBGrid.DEF.setFocus(c.id);this.dispatch("onentercell");if(SBGrid.EVT.TAB==a.keyCode){this.setEditCell(a)}}};SBGrid.CT.DataGrid.prototype.onPrevious=function(a){this.stopEditing();var d=this.getRow();var g=this.getCol();var h=this.rows-1;var f=this.cols-1;var i=d;var b=g;var e=this.getMoveCell(d,g,SBGrid.DEF.SBKE_PREVIOUS);d=e.m_nY;g=e.m_nX;if(d<this.fixedRows){return}this.setRowValue(d);this.setColValue(g);if(i!=d){this.dispatch("onrowchanged")}if(b!=g){this.dispatch("oncolchanged")}this.clearSelection();this.selectCells(d,g,d,g);var c=this.getCell(d,g);if(null!=c){SBGrid.DEF.setFocus(c.id);this.dispatch("onentercell")}};SBGrid.CT.DataGrid.prototype.getMouseColPosition=function(d){var a,b;a=this.m_heControl.offsetLeft;b=this.m_heControl;while(null!=b){b=b.offsetParent;if(b==document.body){break}a+=b.offsetLeft}while(null!=b){if("HTML"==b.tagName){break}if(SBGrid.DEF.is_firefox){b=b.parentNode}else{b=b.parentElement}a-=b.scrollLeft;if("BODY"==b.tagName){break}}for(var c=0;c<(this.fixedCols+this.frozenCols);c++){if(a<d.clientX&&(a+this.m_arColWidth[c])>d.clientX){return c}a+=this.m_arColWidth[c]}a-=this.m_heGridWhole.scrollLeft;for(var c=(this.fixedCols+this.frozenCols);c<this.cols;c++){if(a<d.clientX&&(a+this.m_arColWidth[c])>d.clientX){return c}a+=this.m_arColWidth[c]}return -1};SBGrid.CT.DataGrid.prototype.colMove=function(c,b,a,d){if(this.fixedCols>b){return}switch(a){case"after":if((c+1)==this.cols){break}c++;case"before":default:break}if(this.fixedCols>c){return}this.moveColumn(b,c);d=null==d?true:d;if(d){this.refresh()}};SBGrid.CT.DataGrid.prototype.moveColumn=function(c,l){if(c==l){return}this.clearSelection();this.clearMerge();var g=this.m_arColumn[c];var y=new Array();var t=this.fixedCols+this.frozenCols;if((t<=c&&t<=l)||(t>c&&t>l)){var z;var d=false;if(c<l){z=l+1;if(this.cols==z||((t>c&&t>l)&&t==z)){d=true;z=l}}else{z=l}for(var v=0;v<this.m_nRealRows;v++){var A=this.getCell(v,c);var b=this.getCell(v,z);if(null!=A&&null!=b){y.push(A);var h=b.m_heControl;if(null!=h){if(SBGrid.DEF.is_firefox){h=h.parentNode}else{h=h.parentElement}if(d){h.appendChild(A.m_heControl)}else{h.insertBefore(A.m_heControl,b.m_heControl)}}}}}else{if(t<=c&&t>l){for(var v=0;v<this.m_nRealRows;v++){var A=this.getCell(v,c);var b=this.getCell(v,l);var e=this.getCell(v,(t-1));var f=this.getCell(v,t);if(null!=A&&null!=b&&null!=e&&null!=f){y.push(A);var x=e.m_heControl;if(null!=x){if(SBGrid.DEF.is_firefox){x=x.parentNode}else{x=x.parentElement}var h=f.m_heControl;if(SBGrid.DEF.is_firefox){h=h.parentNode}else{h=h.parentElement}x.insertBefore(A.m_heControl,b.m_heControl);if(A==f){f=this.getCell(v,(t+1));if(null!=f){h.insertBefore(e.m_heControl,f.m_heControl)}else{h.appendChild(e.m_heControl)}}else{h.insertBefore(e.m_heControl,f.m_heControl)}}}}}else{var z;var d=false;z=l+1;if(this.cols==z){d=true;z=l}for(var v=0;v<this.m_nRealRows;v++){var A=this.getCell(v,c);var b=this.getCell(v,z);var f=this.getCell(v,t);if(null!=A&&null!=b&&null!=f){y.push(A);var x=A.m_heControl;if(null!=x){if(SBGrid.DEF.is_firefox){x=x.parentNode}else{x=x.parentElement}var h=f.m_heControl;if(SBGrid.DEF.is_firefox){h=h.parentNode}else{h=h.parentElement}x.appendChild(f.m_heControl);if(d){h.appendChild(A.m_heControl)}else{h.insertBefore(A.m_heControl,b.m_heControl)}}}}}}if(c>l){for(var v=(c-1);v>=l;v--){var m=this.m_arColumn[v];var s=this.id+"_col_"+(v+1);m.id=s;m.attribute.id=s;if(m.m_nInputType==SBGrid.DEF.SBIT_COMBO){m.m_objCombo.m_nColId=s}this.children.add(s,m);SBGrid.DEF.__appendAll(s,m);for(var u=0;u<this.m_nRealRows;u++){var o=this.getCell(u,v);if(null!=o){var r=this.id+"_"+u+"_"+(v+1);o.col=v+1;o.id=r;o.attribute.id=r;if(o.m_heControl){var w=o.m_heControl;w.id="SBHE_"+r;w.setAttribute("cellId",this.id+"."+u+"."+(v+1));w.setAttribute("colNum",this.id+"_"+(v+1));if(this.isFrozenCell(u,(v+1))){w.setAttribute("frozencell","true")}else{w.setAttribute("frozencell","false")}w=null}if(o.m_heDataControl){o.m_heDataControl.id=r+"_data"}this.children.add(r,o);SBGrid.DEF.__appendAll(r,o)}}}}else{for(var v=(c+1);v<=l;v++){var m=this.m_arColumn[v];var s=this.id+"_col_"+(v-1);m.id=s;m.attribute.id=s;if(m.m_nInputType==SBGrid.DEF.SBIT_COMBO){m.m_objCombo.m_nColId=s}this.children.add(s,m);SBGrid.DEF.__appendAll(s,m);for(var u=0;u<this.m_nRealRows;u++){var o=this.getCell(u,v);if(null!=o){var r=this.id+"_"+u+"_"+(v-1);o.col=v-1;o.id=r;o.attribute.id=r;if(o.m_heControl){var w=o.m_heControl;w.id="SBHE_"+r;w.setAttribute("cellId",this.id+"."+u+"."+(v-1));w.setAttribute("colNum",this.id+"_"+(v-1));if(this.isFrozenCell(u,(v-1))){w.setAttribute("frozencell","true")}else{w.setAttribute("frozencell","false")}w=null}if(o.m_heDataControl){o.m_heDataControl.id=r+"_data"}this.children.add(r,o);SBGrid.DEF.__appendAll(r,o)}}}}var s=this.id+"_col_"+l;g.id=s;g.attribute.id=s;if(g.m_nInputType==SBGrid.DEF.SBIT_COMBO){g.m_objCombo.m_nColId=s}this.children.add(s,g);SBGrid.DEF.__appendAll(s,g);for(var u=0;u<this.m_nRealRows;u++){var o=y[u];if(null!=o){var r=this.id+"_"+u+"_"+l;o.col=l;o.id=r;o.attribute.id=r;if(o.m_heControl){var w=o.m_heControl;w.id="SBHE_"+r;w.setAttribute("cellId",this.id+"."+u+"."+l);w.setAttribute("colNum",this.id+"_"+l);if(this.isFrozenCell(u,l)){w.setAttribute("frozencell","true")}else{w.setAttribute("frozencell","false")}w=null}if(o.m_heDataControl){o.m_heDataControl.id=r+"_data"}this.children.add(r,o);SBGrid.DEF.__appendAll(r,o)}}if(this.m_bIsSort){var p=null;if(this.isJsonRef()){for(var v=0;v<this.m_arSortJson.length;v++){p=this.m_arSortJson[v][c];this.m_arSortJson[v].splice(c,1);this.m_arSortJson[v].splice(l,0,p)}}else{for(var v=0;v<this.m_arSortNodeList.length;v++){p=this.m_arSortNodeList[v][c];this.m_arSortNodeList[v].splice(c,1);this.m_arSortNodeList[v].splice(l,0,p)}}p=null}this.m_arColumn.splice(c,1);this.m_arColumn.splice(l,0,g);var B=this.m_arColWidth[c];this.m_arColWidth.splice(c,1);this.m_arColWidth.splice(l,0,B);B=this.m_arHiddenCol[c];this.m_arHiddenCol.splice(c,1);this.m_arHiddenCol.splice(l,0,B);var a=this.children.keys();for(var v=0;v<a.length;v++){var n=a[v];var q=this.getCellById(n);if(null!=q){SBGrid.CF.GridInit(q)}}for(var v=0;v<this.cols;v++){this.setColWidth(v,this.m_arColWidth[v])}this.defaultAttributeSetting();if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.onCapture=function(a){SBGrid.CT.Group.prototype.onCapture.call(this,a);var h=new SBGrid.DS.Point(a.clientX,a.clientY);var c=-1;var e=-1;if(this.m_bClearCaption){a.capture="";this.m_bClearCaption=false}else{if("onmouseup"==a.name){this.m_bMouseDrag=false;this.m_bLButtonDown=false;a.capture="";var d=this.getCell(this.m_nDownRow,this.m_nDownCol);if(null!=d){d.down=false}if(this.isResizing()){if(SBGrid.DEF.bIsResizeFlg){this.hideGuideLine();this.resizeCell(a);this.autoResizeHeight();this.restoreCursor();this.dispatch("onafteruserresize")}}else{if(this.isMoveColumn(true)){this.hideGuideColumn();var n=this.getMouseColPosition(a);if(this.m_nDownCol!=n&&-1!=n){if(this.m_nDownCol>=this.fixedCols&&n>=this.fixedCols){this.mouseCol=n;this.moveColumn(this.m_nDownCol,n);this.dispatch("onaftermovecolumn")}}this.m_bIsFirstMoveColumn=false}else{this.m_nOldX=-1;this.m_nOldY=-1}}this.m_bDown=false}else{if("onmousemove"==a.name){if(this.isMoveColumn()){if(this.m_bIsFirstMoveColumn){var n=this.getMouseColPosition(a);if(this.id==a.capture&&this.m_nDownCol!=n&&this.fixedCols<=n){this.dispatch("onbeforemovecolumn");this.m_bIsFirstMoveColumn=false}}this.drawMoveLine(a)}else{if(this.isResizing()){this.drawGuideLine(a);if(this.m_bAfterResize){this.m_bAfterResize=false;this.dispatch("onbeforeuserresize");SBGrid.DEF.bIsAfterMouseUpFlg=false}}else{if(this.m_bDown&&null!=a.ctrlKey&&null!=a.shiftKey){var l=this.getControlRect();if(this.isFixedCell(this.m_nDownRow,this.m_nDownCol)){return}if(!this.getAllowSelection()){var g=this.getRowHeader()>0?1:0;if(this.getMouseRow()>0&&(this.getMouseCol()-g)>=0){var f=this.getMouseRow();var i=this.getMouseCol();var m=this.getRow();var b=this.getCol();var d=this.getCell(f,i);if(null!=d){this.clearSelection();this.selectCells(f,i,f,i);this.setRowValue(f);this.setColValue(i);if("h-resize"!=this.getAttribute("cursor")&&"v-resize"!=this.getAttribute("cursor")){if(m!=this.m_nDownRow){this.dispatch("onrowchanged")}if(b!=this.m_nDownCol){this.dispatch("oncolchanged")}}this.dispatch("onentercell");SBGrid.DEF.setFocus(d.getId())}}return}this.onMouseDrag(a)}else{if(this.m_bMouseDrag){this.onMouseDrag(a)}}}}if(this.isResizing()||this.isMoveColumn()){a.defaultAction="cancel";a.propagate="stop"}}}}};SBGrid.CT.DataGrid.prototype.onMouseDrag=function(e){var h,a,d,f,g,c;d=this.getControlRect();if((this.fixedRows+this.frozenRows)>0||this.fixedCols+this.frozenCols>0){d.m_nX=d.getX()+this.getFixedFrozenColWidth();d.m_nY=d.getY()+this.getFixedFrozenRowHeight()}if(this.frozenBottomRows>0){for(var b=this.m_nRealRows-1;b>=(this.m_nRealRows-this.frozenBottomRows);b--){d.m_nBottom-=this.m_htRowHeight[b]}}h=this.getRow();a=this.getCol();f=(h>=this.fixedRows&&h<this.fixedRows+this.frozenRows)?true:false;c=(h>=this.m_nRealRows-this.frozenBottomRows&&h<this.m_nRealRows)?true:false;g=(a>=this.fixedCols&&a<this.fixedCols+this.frozenCols)?true:false;if(!g&&e.clientX>d.m_nRight){if(this._isHScroll()){this.dispatch("onscrolldown")}}if(!g&&e.clientX<d.m_nX){if(this._isHScroll()){this.dispatch("onscrollup")}}if(!f&&!c&&e.clientY>d.m_nBottom-13){this.m_bMouseDrag=true;if(this._isVScroll()){if(this.m_nMouseDragRow>=this.getMouseRow()){this.m_nMouseDragRow++}if(this.m_nMouseDragRow<this.m_nRealRows){this.topScrollCell(this.m_nMouseDragRow,true)}else{this.m_nMouseDragRow--}this.dispatch("onscrolldown")}else{this.m_nMouseDragRow=this.getMouseRow()}}else{if(!f&&!c&&e.clientY<d.m_nY){this.m_bMouseDrag=true;if(this._isVScroll()){if(this.getMouseRow()<this.fixedRows){this.m_nMouseDragRow--;this.topScrollCell(this.m_nMouseDragRow,true)}else{this.m_nMouseDragRow=this.getMouseRow()}this.dispatch("onscrollup")}else{if(this.getMouseRow()<this.fixedRows){this.m_nMouseDragRow--;this.topScrollCell(this.m_nMouseDragRow,true)}else{this.m_nMouseDragRow=this.getMouseRow()}}}else{if(this.getMouseRow()>=this.fixedRows){this.m_nMouseDragRow=this.getMouseRow()}}}if(!this.m_bIsShowItem){this.multiSelectCells(this.m_nDownRow,this.m_nDownCol,this.m_nMouseDragRow,this.getMouseCol(),f,c,g)}};SBGrid.CT.DataGrid.prototype.onFocus=function(a){SBGrid.CT.Group.prototype.onFocus.call(this,a)};SBGrid.CT.DataGrid.prototype.onBlur=function(a){SBGrid.CT.Group.prototype.onBlur.call(this,a);if(this.isEditing()&&a.target==this.m_objInput.getId()){this.setCellEditText()}if(!this.isDescendants(a.target,true)&&!this.isCell(a.target)){this.m_nDownRow=-1;this.m_nDownCol=-1}if(this.id==a.currentTarget&&-1==a.down.indexOf("combo")){this._gridComboHidden()}};SBGrid.CT.DataGrid.prototype._isShowCombo=function(){for(var b=0;b<this.m_arCombo.length;b++){var a=this.m_arCombo[b];if(true==a.visible){return true}}return false};SBGrid.CT.DataGrid.prototype._gridComboHidden=function(){for(var a=0;a<this.m_arColumn.length;a++){if(SBGrid.DEF.SBIT_COMBO==this.m_arColumn[a].m_nInputType){this.m_arColumn[a].m_objCombo.setVisible(false)}}};SBGrid.CT.DataGrid.prototype.onBeforeEdit=function(d){var b=this.getRow();var e=this.getCol();if(b<0&&e<0){return}var a=this.getCell(b,e);if(null!=a){if(this.isNormalCell(b,e)){var c=this.getColumnControl(e);if(null!=c&&c.onBeforeEdit()){this.m_nEditRow=b;this.m_nEditCol=e;this.dispatch("onstartedit")}}}};SBGrid.CT.DataGrid.prototype.onAfterEdit=function(){var b=this.getEditRow();var d=this.getEditCol();if(b<0&&d<0){return}var a=this.getCell(b,d);if(null!=a){if(this.isNormalCell(b,d)){this.m_bEditing=false;if(null!=this.m_objInput){this.m_objInput.setVisible(false)}if(null!=this.m_objTextArea){this.m_objTextArea.setVisible(false)}var c=this.m_arColumn[d];if(null!=c&&"true"==c.getAttribute("#update-text")){this.m_objUpdate.setUpdateFlag(SBGrid.DEF.SBCH_TEXT);this.m_objUpdate.setModifyRow(b);this.m_objUpdate.setModifyCol(d);this.m_objUpdate.setModifyText(c.getText());this.onCellChanged();this.refreshCurrentModel(this.attribute.ref)}SBGrid.DEF.setFocus(a.getId());this.m_nEditRow=-1;this.m_nEditCol=-1}}};SBGrid.CT.DataGrid.prototype.onCellChanged=function(){var b=this.m_objUpdate.getUpdateFlag();var a=this.m_objUpdate.getModifyRow();var c=this.m_objUpdate.getModifyCol();if(b&SBGrid.DEF.SBCH_TEXT){if(this.getColStatus(this.m_objUpdate.getModifyCol())){this.setRowStatus(a,this.getRowStatus(a)|SBGrid.DEF.SBGS_UPDATE)}this.m_bModify=true}else{if(b&SBGrid.DEF.SBCH_ROWINS){this.setRowStatus(a,this.getRowStatus(a)|SBGrid.DEF.SBGS_INSERT);this.m_bModify=true}else{if(b&SBGrid.DEF.SBCH_ROWDEL){this.m_bModify=true}}}};SBGrid.CT.DataGrid.prototype.topScrollCell=function(d,c){var g=this.m_objScroll;var f=0;var a=0;if(this.isFrozenRow(d)){return}if(g.nStartRow<=d){for(var b=g.nStartRow;b<d;b++){f+=this.m_arHiddenRowState[b]?0:null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}if(f<this.m_heGridWhole.scrollTop){this.m_heGridWhole.scrollTop=f;return}f+=this.m_arHiddenRowState[d]?0:null!=this.m_htRowHeight[d]?this.m_htRowHeight[d]:this.dataHeight;for(var b=0;b<(this.fixedRows+this.frozenRows);b++){a+=this.m_arHiddenRowState[d]?0:null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}for(var b=(this.m_nRealRows-this.m_nBottomRowCount);b<this.m_nRealRows;b++){a+=this.m_arHiddenRowState[d]?0:null!=this.m_htRowHeight[b]?this.m_htRowHeight[b]:this.dataHeight}var e=(this.m_heGridWhole.scrollTop+g.nScrollDivHeight-a);if(f>e){if(!c){g.nPosition+=(f-e)}this.m_heGridWhole.scrollTop+=(f-e)}}};SBGrid.CT.DataGrid.prototype.onEnterCell=function(d){var b=this.getRow();var e=this.getCol();var a=this.getCell(b,e);if(null!=a){if(0==d.keyCode){this.topScrollCell(b,false)}return}if(this.isNormalCell(b,e)){var c=this.getColumnControl(e);c.onEnterCell()}};SBGrid.CT.DataGrid.prototype.onLeaveCell=function(a){};SBGrid.CT.DataGrid.prototype.onStartEdit=function(d){var b=this.getEditRow();var e=this.getEditCol();var a=this.getCell(b,e);if(null!=a&&!a.getIsReadOnly()&&this.isNormalCell(b,e)){var c=this.getColumnControl(e);if(null!=c&&!c.disabled&&c.onStartEdit()){this.m_bEditing=true;a.setEditingMode(true)}}};SBGrid.CT.DataGrid.prototype.setIsReadOnly=function(){var d=arguments;if(d.length==3){var c=this.getCell(d[0],d[1]);if(null!=c){c.isReadOnly=d[2]}}else{if(d.length==5){for(var b=d[0];b<=d[2];b++){for(var a=d[1];a<=d[3];a++){var c=this.getCell(b,a);if(null!=c){c.isReadOnly=d[4]}}}}}};SBGrid.CT.DataGrid.prototype.isReadOnly=function(){var b=arguments;if(null!=b&&2<=b.lenght){var a=this.getCell(b[0],b[1]);if(null!=a){return(true==a.isReadOnly)?1:0}}return""};SBGrid.CT.DataGrid.prototype.colDisabled=function(b){var a=this.m_arColumn[b];if(null!=a){return a.disabled}};SBGrid.CT.DataGrid.prototype.setColDisabled=function(c,a){var b=this.m_arColumn[c];if(null!=b){b.disabled=a}};SBGrid.CT.DataGrid.prototype.onBeforeMoveColumn=function(a){};SBGrid.CT.DataGrid.prototype.onAfterMoveColumn=function(f){var e=this.m_objScroll.arTargetRow;for(var d=this.m_objScroll.nTopRow,a=0,g=this.m_objScroll.nBottomRow;d<=g;d++){for(var b=0;b<this.cols;b++){var c=this.getCell(e[d],b);if(null!=c){this.m_arTempMatrix[a].data[b]={first:c.m_heControl,last:c.m_heDataControl}}}a++}};SBGrid.CT.DataGrid.prototype.onAfterUserResize=function(a){SBGrid.DEF.bIsResizeFlg=false};SBGrid.CT.DataGrid.prototype.onBeforeUserResize=function(a){SBGrid.DEF.bIsResizeFlg=true};SBGrid.CT.DataGrid.prototype.drawMoveLine=function(c){var d=this.getMouseCol();var b=this.getCell(this.m_nDownRow,d);if(!b){return}var a=this.getCellContentRect(b.row,d);this.m_heMoveColumnBar.style.left=a.getX()+"px";this.m_heMoveColumnBar.style.width=a.getWidth()+"px";this.m_heMoveColumnBar.style.display="block"};SBGrid.CT.DataGrid.prototype.drawGuideLine=function(d){var b=this.getControlRect();if("h-resize"==this.getAttribute("cursor")){var c=d.clientX-b.getX();if(1>c){c=1}else{if(b.getWidth()-1<c){c=b.getWidth()-1}}this.m_heHGuideLine.style.left=c+"px";this.m_heHGuideLine.style.visibility="visible";this.m_resizeInfo.m_nCurX=c}else{if("v-resize"==this.getAttribute("cursor")){var a=d.clientY-b.getY();if(1>a){a=1}else{if(b.getHeight()-1<a){a=b.getHeight()-1}}this.m_heVGuideLine.style.top=a+"px";this.m_heVGuideLine.style.visibility="visible";this.m_resizeInfo.m_nCurY=a}}};SBGrid.CT.DataGrid.prototype.hideGuideColumn=function(){if(null!=this.m_heMoveColumnBar){this.m_heMoveColumnBar.style.display="none"}};SBGrid.CT.DataGrid.prototype.hideGuideLine=function(){if(null!=this.m_heHGuideLine){this.m_heHGuideLine.style.visibility="hidden"}if(null!=this.m_heVGuideLine){this.m_heVGuideLine.style.visibility="hidden"}};SBGrid.CT.DataGrid.prototype.resizeCell=function(n){var h=this.getCell(this.m_nDownRow,this.m_nDownCol);if(null!=h){var f;var t=this.m_nDownRow;var r=this.m_nDownCol;var o=0;var m=0;f=this.getCellRect(t,r);var c=this.getControlRect();var l=f.getX()-c.getX()+o;var i=f.getY()-c.getY()+m;var g=f.getWidth();var q=f.getHeight();if("h-resize"==this.getAttribute("cursor")){var b=Math.max(this.m_resizeInfo.m_nCurX-l,2);if(b>2){var p=this.colWidthMin;var s=this.colWidthMax;if(SBGrid.DEF.SBSM_MERGED==h.mergeType){if(1<h.m_nColSpan){r=r+h.m_nColSpan-1;var g=this.m_arColWidth[r]+(b-g);p=0==r&&this.m_bRowHeader?20:p;g=g<p?p:g;g=g>s?s:g;this.setColWidth(r,g)}else{p=0==r&&this.m_bRowHeader?20:p;b=b<p?p:b;b=b>s?s:b;this.setColWidth(r,b)}}else{p=0==r&&this.m_bRowHeader?20:p;b=b<p?p:b;b=b>s?s:b;this.setColWidth(r,b)}this.setExtendLastCol(this.extendLastCol)}}else{if("v-resize"==this.getAttribute("cursor")){var a=Math.max(this.m_resizeInfo.m_nCurY-i,19);if(a>this.rowHeightMin){var d=this.rowHeightMin;var e=this.rowHeightMax;if(SBGrid.DEF.SBSM_MERGED==h.mergeType){if(1<h.m_nRowSpan){t=t+h.m_nRowSpan-1;this.setRowHeight(t,this.m_htRowHeight[t]+(a-q))}else{a=b<d?d:a;a=b>e?e:a;this.setRowHeight(t,a)}}else{a=b<d?d:a;a=b>e?e:a;this.setRowHeight(t,a)}this.setMergeCellResize(t,(a-q))}}}this.gridSetTables()}};SBGrid.CT.DataGrid.prototype.setRowHeightMax=function(c){this.rowHeightMax=c;var b=false;for(var a=0;a<this.m_nRealRows;a++){if(null!=this.m_htRowHeight[a]&&c<this.m_htRowHeight[a]){if(a<this.fixedRows){this.setRowHeight(a,c,true);b=true}else{if(this.isPhysicalRow(a)){this.setRowHeight(a,c,true);b=true}else{this.m_htRowHeight[a]=c}}}else{if(null==this.m_htRowHeight[a]){this.m_htRowHeight[a]=c}}}if(b){this.rowHeightResize()}};SBGrid.CT.DataGrid.prototype.lockedUpHeight=function(a){if(!this.autoResize&&!a){var c=this.fixedRows;var d=this.m_nMakeIndex;for(var b=c;b<d;b++){this.setRowHeight(b,this.dataHeight,true)}}};SBGrid.CT.DataGrid.prototype.autoResizeHeight=function(g){if(!this.autoResize){return}if(g){this.m_htRowHeight[g]=this.dataHeight}var f=true;var e=new Array();for(var d=0;d<this.cols;d++){if(null!=this.m_arColumn[d]){if(!this.m_arColumn[d].m_bHiddenState){for(var b=this.fixedRows;b<this.rows;b++){if(this.isPhysicalRow(b)){if(f){this.m_htRowHeight[b]=this.dataHeight;e.push(b)}var c=this.getCell(b,d);if(null!=c&&SBGrid.DEF.SBSM_HIDE!=c.mergeType){var a=c.m_heDataControl;if(null!=a){var h=a.offsetHeight;if(this.m_htRowHeight[c.row]<h){this.m_htRowHeight[c.row]=h+4}}}}}f=false}}}for(var d=0;d<e.length;d++){this.setRowHeight(e[d],this.m_htRowHeight[e[d]],true)}};SBGrid.CT.DataGrid.prototype.autoResizeCaptionWidth=function(){var a=this.fixedRows,f=this.cols;for(var e=0;e<f;e++){this.m_arColWidth[e]=20}for(var b=0;b<a;b++){for(var e=0;e<f;e++){var c=this.getCell(b,e);if(null!=c){if(c.m_heControl!=null){for(k=0;k<c.m_heControl.childNodes.length;k++){if("SPAN"==c.m_heControl.childNodes.item(k).tagName){var d=(c.m_heControl.childNodes.item(k).offsetWidth)+20;if(this.m_arColWidth[c.col]<d){this.m_arColWidth[c.col]=d}}}}}}}for(var e=0;e<f;e++){this.setColWidth(e,this.m_arColWidth[e])}};SBGrid.CT.DataGrid.prototype.getAutoSizeMouse=function(){return this.autoSizeMouse};SBGrid.CT.DataGrid.prototype.setAutoSizeMouse=function(a){this.autoSizeMouse=a};SBGrid.CT.DataGrid.prototype.autoResizeWidth=function(h){if(this.autoSizeMouse){var e=h-1;var f=h+1;if(this.autoResize){this.setAutoResize(false)}for(var c=(e+1);c<f;c++){this.m_arColWidth[c]=20}for(var c=(e+1);c<f;c++){for(var a=this.fixedRows;a<this.rows;a++){var b=this.getCell(a,c);if(null!=b){if(b.m_heControl!=null){for(k=0;k<b.m_heControl.childNodes.length;k++){if("DIV"==b.m_heControl.childNodes.item(k).tagName){var g=b.m_heControl.childNodes.item(k).getAttribute("id");var d=jQuery("#"+g).children().prop("offsetWidth")+10;if(this.m_arColWidth[b.col]<d){this.m_arColWidth[b.col]=d}}}}}}}for(var c=(e+1);c<f;c++){this.setColWidth(c,this.m_arColWidth[c])}}};SBGrid.CT.DataGrid.prototype.colWidth=function(b){var a=0;if(null!=this.m_arColWidth[b]){a=this.m_arColWidth[b]}return a};SBGrid.CT.DataGrid.prototype.getColWidth=function(a){return this.colWidth(a)};SBGrid.CT.DataGrid.prototype.setColWidth=function(f,c,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setColWidth","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof f!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setColWidth","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setColWidth","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(a==null){a=false}if((0>f||this.cols<=f)){return}var b=this.m_arColumn[f];if(b.m_bHiddenState){this.m_arHiddenCol[f]=c;c=0}else{this.m_arHiddenCol[f]=c}if(!a){if(0==c){this.setColDisplay(f,"none")}else{this.setColDisplay(f,"block")}}this.m_arColWidth[f]=c;if(!a){this.setColGroupWidth(f,c);if(this.extendLastCol&&!this.m_objHeArea.bTotalHiddenCheck){this.setExtendLastCol(this.extendLastCol,true)}}for(var e=0;e<this.m_nRealRows;e++){var d=this.getCell(e,f);if(null!=d){if(0==c){d.mergeType=SBGrid.DEF.SBSM_COLHIDE}else{if(SBGrid.DEF.SBSM_COLHIDE==d.mergeType){if(!b.m_bMerge){d.mergeType=SBGrid.DEF.SBSM_LOCK}else{d.mergeType=SBGrid.DEF.SBSM_NORMAL}}}}}if(a){return}if(!this.m_objHeArea.bTotalHiddenCheck){this.gridSetTables()}};SBGrid.CT.DataGrid.prototype.gridSetTables=function(){var e=this.fixedCols+this.frozenCols;var b=this.fixedRows+this.frozenRows;var c=this._getTotalColWidth();var g=this.getFixedFrozenColWidth();var n=this.m_heGridWhole.firstChild;c=0>=c?"":c+"px";n.width=c;n.style.width="";var i=n.lastChild;var l;var f;var d;var o;var m;var h;var a;if(null!=this.m_heGridFFScrollRow){l=this.m_heGridFFScrollRow.firstChild;l.width=c;l.style.width="";f=l.lastChild;this.m_heGridFFNoScrollRow.style.width=g+"px";d=this.m_heGridFFNoScrollRow.firstChild;if(0!=g){d.width=g+"px"}this.m_heGridFFCol.style.width=g+"px";o=this.m_heGridFFCol.firstChild;if(0!=g){o.width=g+"px"}if(null!=this.m_heGridFFBScrollRow){if(null!=this.m_heGridFFBScrollRow.firstChild){m=this.m_heGridFFBScrollRow.firstChild;m.width=c+"px";m.style.width="";h=m.lastChild;this.m_heGridFFBNoScrollRow.style.width=g+"px";a=this.m_heGridFFBNoScrollRow.firstChild;if(0!=g){a.width=g+"px"}}}}if(!SBGrid.DEF.is_smartphone){if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.m_heGridFFNoScrollRow.clientHeight+"px";if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBScrollRow.clientHeight)+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBNoScrollRow.clientHeight)+"px"}}else{if(this.m_objHeArea.bChangeWidth){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px";if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBScrollRow.clientHeight)+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBNoScrollRow.clientHeight)+"px"}}}}};SBGrid.CT.DataGrid.prototype.gridToInstance=function(){var f=this.cols-1;if(this.isJsonRef()){}else{var e=SBGrid.DS.XMLStorage.getUniqueStorage().getInstanceSinglePart(null,this.nodeset);if(null!=e){e=e.parentNode}else{return}for(var c=this.fixedRows;c<this.m_nRealRows;c++){for(var a=f;a>=this.fixedCols;a--){var b=this.getCell(c,a);if(null!=b){var d=b.getNodeElement();if(null!=d){e.appendChild(d.parentNode);break}}}}this.m_xlRefNode=this.getControlNodeList()}};SBGrid.CT.DataGrid.prototype.colGroupNameSpace=function(){var m=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP"+this.id);var n=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP"+this.id);var l=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP"+this.id);var o=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP"+this.id);var d=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP"+this.id);for(var f=0;f<this.cols;f++){var c=(0==this.m_arColWidth[f]||!this.m_arColumn[f].visible)&&(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7)?"none":"";var p=m.children[f];if(null!=p){p.setAttribute("colNum",this.id+"_"+f);p.setAttribute("targetCol","who");p.style.display=c}if(!SBGrid.DEF.is_smartphone){var b=n.children[f];if(null!=b){b.setAttribute("colNum",this.id+"_"+f);b.setAttribute("targetCol","ffs");b.style.display=c}var h=l.children[f];if(null!=h){h.setAttribute("colNum",this.id+"_"+f);h.setAttribute("targetCol","ffn");h.style.display=c}var q=o.children[f];if(null!=q){q.setAttribute("colNum",this.id+"_"+f);q.setAttribute("targetCol","ffc");q.style.display=c}if(null!=e){var a=e.children[f];if(null!=a){a.setAttribute("colNum",this.id+"_"+f);a.setAttribute("targetCol","ffbs");a.style.display=c}var g=d.children[f];if(null!=g){g.setAttribute("colNum",this.id+"_"+f);g.setAttribute("targetCol","ffbn");g.style.display=c}}}}};SBGrid.CT.DataGrid.prototype.setColGroupWidth=function(f,b){if(!SBGrid.DEF.is_smartphone){jQuery('col[colNum="'+this.id+"_"+f+'"]').css("width",b+"px");if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){if(null!=this.m_htMergeColList[this.id+"_"+f]){var e=this.m_htMergeColList[this.id+"_"+f];jQuery('col[colNum="'+this.id+"_"+f+'"][targetCol="'+e.targetCol+'"]').css("width",(b+1)+"px");e=null}if(null!=this.m_htMergeFRColList[this.id+"_"+f]){var e=this.m_htMergeFRColList[this.id+"_"+f];jQuery('col[colNum="'+this.id+"_"+f+'"][targetCol="'+e.targetCol+'"]').css("width",(b+1)+"px");e=null}if(null!=this.m_htMergeFCColList[this.id+"_"+f]){var e=this.m_htMergeFCColList[this.id+"_"+f];jQuery('col[colNum="'+this.id+"_"+f+'"][targetCol="'+e.targetCol+'"]').css("width",(b+1)+"px");e=null}}if(SBGrid.DEF.is_ie9){if(null!=this.m_arIe9MergeCellWidth){for(var c=0;c<this.m_arIe9MergeCellWidth.length;c++){var d=this.m_arIe9MergeCellWidth[c];if(f==d.nLastCol){d.target.style.width=(this.getMergePartColWidth(d.nStartCol,d.nLastCol)+b)+"px"}}}}if(SBGrid.DEF.is_ie10){jQuery('td[colNum="'+this.id+"_"+f+'"]').width((b-1)+"px")}}else{var a=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP"+this.id);if(null!=a){a.children[f].style.width=b+"px";if(SBGrid.DEF.is_ie){a.children[f].style.pixelWidth--}}}};SBGrid.CT.DataGrid.prototype.setColGroupCount=function(c){if(!SBGrid.DEF.is_smartphone){var f=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP"+this.id);var g=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP"+this.id);if(this.frozenCols<c){var h=null;for(var d=(this.fixedCols+this.frozenCols);d<(this.fixedCols+c);d++){h=f.children[d];var a=h.cloneNode(true);a.setAttribute("targetCol","ffn");var m=h.cloneNode(true);m.setAttribute("targetCol","ffc");e.appendChild(a);g.appendChild(m);if(null!=b){var l=h.cloneNode(true);l.setAttribute("targetCol","ffbn");b.appendChild(l)}}h=null}else{for(var d=0;d<(this.frozenCols-c);d++){e.removeChild(e.lastChild);g.removeChild(g.lastChild);if(null!=b){b.removeChild(b.lastChild)}}}}};SBGrid.CT.DataGrid.prototype.setColGroupAddCol=function(e,f){var d=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP"+this.id);var h=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP"+this.id);var c=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP"+this.id);var i=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP"+this.id);var a=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP"+this.id);var l=document.createElement("col");l.style.width=String(f)+"px";if(!SBGrid.DEF.is_smartphone){l.setAttribute("colNum",this.id+"_"+e);var g=l.cloneNode(true);g.setAttribute("targetCol","who");d.appendChild(g);g=l.cloneNode(true);g.setAttribute("targetCol","ffs");h.appendChild(g);if(null!=b){g=l.cloneNode(true);g.setAttribute("targetCol","ffbs");b.appendChild(g)}if(this.cols<(this.fixedCols+this.frozenCols)){g=l.cloneNode(true);g.setAttribute("targetCol","ffn");c.appendChild(g);g=l.cloneNode(true);g.setAttribute("targetCol","ffc");i.appendChild(g);if(null!=b){g=l.cloneNode(true);g.setAttribute("targetCol","ffnc");a.appendChild(g)}}g=null;l=null}else{if(null!=d){d.appendChild(l.cloneNode(true))}}};SBGrid.CT.DataGrid.prototype.setColGroupInsertCol=function(g,h){var f=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP"+this.id);var m=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP"+this.id);var n=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP"+this.id);var d=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP"+this.id);var o=document.createElement("col");o.style.width=String(h)+"px";if(!SBGrid.DEF.is_smartphone){o.setAttribute("colNum",this.id+"_"+g);var l=o.cloneNode(true);l.setAttribute("targetCol","who");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=f.children[c];if(null!=a){a.setAttribute("colNum",p)}}f.insertBefore(l,f.children[g]);l=o.cloneNode(true);l.setAttribute("targetCol","ffs");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=m.children[c];if(null!=a){a.setAttribute("colNum",p)}}m.insertBefore(l,m.children[g]);if(null!=d){l=o.cloneNode(true);l.setAttribute("targetCol","ffbs");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=d.children[c];if(null!=a){a.setAttribute("colNum",p)}}d.insertBefore(l,d.children[g])}if(this.cols<(this.fixedCols+this.frozenCols)){l=o.cloneNode(true);l.setAttribute("targetCol","ffn");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=e.children[c];if(null!=a){a.setAttribute("colNum",p)}}e.insertBefore(l,e.children[g]);l=o.cloneNode(true);l.setAttribute("targetCol","ffc");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=n.children[c];if(null!=a){a.setAttribute("colNum",p)}}n.insertBefore(l,n.children[g]);if(null!=d){l=o.cloneNode(true);l.setAttribute("targetCol","ffbn");for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=b.children[c];if(null!=a){a.setAttribute("colNum",p)}}b.insertBefore(l,b.children[g])}}else{if(g<(this.fixedCols+this.frozenCols)){e.children[g].style.width=String(h)+"px";n.children[g].style.width=String(h)+"px";if(null!=d){for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=b.children[c];if(null!=a){a.setAttribute("colNum",p)}}b.children[g].style.width=String(h)+"px"}}}}else{if(null!=f){for(var c=g;c<this.cols;c++){var p=this.id+"_"+(c+1);var a=f.children[c];if(null!=a){a.setAttribute("colNum",p)}}f.insertBefore(o.cloneNode(true),f.children[g])}}o=null};SBGrid.CT.DataGrid.prototype.setColGroupRemoveCol=function(){var b=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP"+this.id);var d=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP"+this.id);var f=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP"+this.id);var a=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP"+this.id);var c=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP"+this.id);if(!SBGrid.DEF.is_smartphone){b.removeChild(b.lastChild);d.removeChild(d.lastChild);if(null!=c){c.removeChild(c.lastChild)}if(this.cols<=(this.fixedCols+this.frozenCols)){f.removeChild(f.lastChild);a.removeChild(a.lastChild);if(null!=c){e.removeChild(e.lastChild)}}}else{if(null!=b){b.removeChild(b.lastChild)}}};SBGrid.CT.DataGrid.prototype.setColGroupDeleteCol=function(g){var f=document.getElementById("SBHE_DATAGRID_WHOLE_COLGROUP"+this.id);var h=document.getElementById("SBHE_DATAGRID_FFS_COLGROUP"+this.id);var e=document.getElementById("SBHE_DATAGRID_FFN_COLGROUP"+this.id);var l=document.getElementById("SBHE_DATAGRID_FFCOL_COLGROUP"+this.id);var c=document.getElementById("SBHE_DATAGRID_FFBS_COLGROUP"+this.id);var b=document.getElementById("SBHE_DATAGRID_FFBN_COLGROUP"+this.id);if(!SBGrid.DEF.is_smartphone){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=f.children[d];if(null!=a){a.setAttribute("colNum",n)}}f.removeChild(f.children[g]);for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=h.children[d];if(null!=a){a.setAttribute("colNum",n)}}h.removeChild(h.children[g]);if(null!=c){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=c.children[d];if(null!=a){a.setAttribute("colNum",n)}}c.removeChild(c.children[g])}if(this.cols<=(this.fixedCols+this.frozenCols)){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=e.children[d];if(null!=a){a.setAttribute("colNum",n)}}e.removeChild(e.children[g]);for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=l.children[d];if(null!=a){a.setAttribute("colNum",n)}}l.removeChild(l.children[g]);if(null!=c){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=b.children[d];if(null!=a){a.setAttribute("colNum",n)}}b.removeChild(b.children[g])}}else{if(g<(this.fixedCols+this.frozenCols)){for(var d=g;d<(this.fixedCols+this.frozenCols);d++){var m=f.children[d+1];if(null!=m){e.children[d].style.width=m.style.width;l.children[d].style.width=m.style.width;if(null!=c){b.children[d].style.width=m.style.width}}}}}}else{if(null!=f){for(var d=(g+1);d<this.cols;d++){var n=this.id+"_"+(d-1);var a=f.children[d];if(null!=a){a.setAttribute("colNum",n)}}f.removeChild(f.children[g])}}};SBGrid.CT.DataGrid.prototype.setSeqForRowHeader=function(){var e=this.getRowHeader();if(e!=SBGrid.DEF.SBRH_SEQ&&e!=SBGrid.DEF.SBRH_REVERSESEQ){return}var c=String(this.m_nRealRows-this.fixedRows).length;if(c>1){if((c*10)>this.m_arColWidth[0]){this.setColWidth(0,c*10)}}else{if(20>this.m_arColWidth[0]){this.setColWidth(0,20)}}var d;var a;var b=this.seqRowHeader;if(e==SBGrid.DEF.SBRH_SEQ){a=this.fixedRows;while(a<=this.m_objScroll.nBottomRow){if(this.isPhysicalRow(a)){d=this.getCell(a,0);if(null!=d){SBGrid.CF.GridSetFixedWindowText(d,String(b));a++;b++}else{a++;b++}}else{a++;b++}}}else{if(e==SBGrid.DEF.SBRH_REVERSESEQ){a=this.m_nRealRows-1;while(a>=this.fixedRows){if(this.isPhysicalRow(a)){d=this.getCell(a,0);if(null!=d){SBGrid.CF.GridSetFixedWindowText(d,String(b));a--;b++}else{a--;b++}}else{a--;b++}}}}e=null;c=null;d=null;a=null;b=null};SBGrid.CT.DataGrid.prototype.setSeqRowHeader=function(a){this.seqRowHeader=a;this.setSeqForRowHeader()};SBGrid.CT.DataGrid.prototype.rowHeightResize=function(){var c=this.fixedCols+this.frozenCols;var b=this.fixedRows+this.frozenRows;var g=this.m_nRealRows-this.frozenBottomRows;var f=this.m_heGridWhole.firstChild.lastChild;var d;var a;var h;var e;var i;if(null!=this.m_heGridFFScrollRow){this.m_heGridFFScrollRow.style.height=this.getFixedFrozenRowHeight()+"px";d=this.m_heGridFFScrollRow.firstChild.lastChild;this.m_heGridFFNoScrollRow.style.height=this.getFixedFrozenRowHeight()+"px";a=this.m_heGridFFNoScrollRow.firstChild.lastChild;this.m_heGridFFCol.style.top=this.getFixedFrozenRowHeight()+"px";this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px";h=this.m_heGridFFCol.firstChild.lastChild}if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heGridFFBScrollRow.style.top=this.m_heGridWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";e=this.m_heGridFFBScrollRow.firstChild.lastChild;this.m_heGridFFBNoScrollRow.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heGridFFBNoScrollRow.style.top=this.m_heGridWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";i=this.m_heGridFFBNoScrollRow.firstChild.lastChild}if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.m_heGridFFNoScrollRow.clientHeight+"px";if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBScrollRow.clientHeight)+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBNoScrollRow.clientHeight)+"px"}}else{if(this.m_objHeArea.bChangeWidth){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px";if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBScrollRow.clientHeight)+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBNoScrollRow.clientHeight)+"px"}}}};SBGrid.CT.DataGrid.prototype.rowHeight=function(a){if(null!=a&&isFinite(a)){return this.m_htRowHeight[a]}};SBGrid.CT.DataGrid.prototype.getRowHeight=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getRowHeight","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getRowHeight","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}return this.rowHeight(a)};SBGrid.CT.DataGrid.prototype.setRowHeight=function(c,b,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setRowHeight","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowHeight","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowHeight","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(a==null){a=false}if(0>c||this.m_nRealRows<=c){return}this.m_htRowHeight[c]=parseInt(b);if(b>0){b--}jQuery('td[rowNum="'+this.id+"_"+c+'"]').css("height",b+"px");if(!a){this.rowHeightResize()}};SBGrid.CT.DataGrid.prototype.rowCellInitStyle=function(d,e,f,a){if(d<this.fixedRows||this.m_nRealRows<=d){return}var c=null;for(var b=this.fixedCols;b<this.cols;b++){c=this.getCell(d,b);if(null!=c){c.attribute[e]=f}}};SBGrid.CT.DataGrid.prototype.colCellInitStyle=function(f,d,e,a){var c=null;for(var b=this.fixedRows;b<this.m_nMakeIndex;b++){c=this.getCell(b,f);if(null!=c){c.attribute[d]=e}}};SBGrid.CT.DataGrid.prototype.cellInitStyle=function(c,f,d,e,a){var b=null;b=this.getCell(c,f);if(null!=b){if(a){b.attribute[d]=e}else{b.setAttribute(d,e)}}};SBGrid.CT.DataGrid.prototype.selectKeyDown=function(d){var e;var a;var b;var c;if(d.shiftKey){e=(this.m_nPrevDownRow<this.getRow())?this.m_nPrevDownRow:this.getRow();a=(this.m_nPrevDownRow<this.getRow())?this.getRow():this.m_nPrevDownRow;b=(this.m_nPrevDownCol<this.getCol())?this.m_nPrevDownCol:this.getCol();c=(this.m_nPrevDownCol<this.getCol())?this.getCol():this.m_nPrevDownCol}else{this.m_nPrevDownRow=this.getRow();this.m_nPrevDownCol=this.getCol();e=a=this.getRow();b=c=this.getCol()}this.clearSelection();this.selectCells(e,b,a,c);this.topScrollCell(this.getRow(),true)};SBGrid.CT.DataGrid.prototype.colAttribute=function(b,a){if(null==b||(0>b||this.cols<=b)){return}return this.m_arColumn[b].getAttribute(a)};SBGrid.CT.DataGrid.prototype.setColAttribute=function(d,a,c){if(null==d||(0>d||this.cols<=d)){return}this.m_arColumn[d].setAttribute(a,c);if(SBGrid.DEF.SB_STYLELIST[a]){var b=SBGrid.DEF.findToMakeStyleSheet("sbgrid_"+this.id+"_col"+d);SBGrid.UT.HtmlLib.setStyle(b,a,c)}};SBGrid.CT.DataGrid.prototype.reSetRowHidden=function(){for(var a=0;a<this.m_nRealRows&&a<this.m_arHiddenRowState.length;a++){if(true==this.m_arHiddenRowState[a]){this.setRowDisplay(a,"none");if(this.m_objScroll.bScrollEvent){this.setScrollDivRow(a,true)}}}};SBGrid.CT.DataGrid.prototype.getRowData=function(c){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getRowData","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getRowData","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var b=this.getCell(c,0);if(null!=b){if(this.m_bIsSort){var f=new Object();for(var a=this.fixedCols,e=this.cols;a<e;a++){var d=this.m_arColumn[a].getAttribute("ref");f[d]=this.getTextMatrix(c,a)}return f}else{return this.m_xlRefNode[c-this.fixedRows]}}return};SBGrid.CT.DataGrid.prototype.setRowData=function(c,h,e){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof h!="object"){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check if second parameter type is 'object'.",SBGrid.DEF.DEBUG_MODE);return}if(e==null){e=true}else{if(typeof e!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setRowData","Please check if 3rd parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}var b=this.getCell(c,0);if(null!=b){for(var a=this.fixedCols,g=this.cols;a<g;a++){var f=this.m_arColumn[a].getAttribute("ref");var d=h[f];if(h[f]=="string"){d=h[f]}else{if(h[f]==undefined){d=""}else{d=h[f].toString()}}this.setValueMatrix(c,a,d)}if(e){this.refresh()}}};SBGrid.CT.DataGrid.prototype.isHiddenAboutKey=function(e,c){var d;d=this.m_clIndexes.item(this.m_clIndexes.keys()[c]).item(e);var b=true;for(var a=0;a<d.length;a++){if(this.isRowHidden(d[a])==false){b=false;break}}return b};SBGrid.CT.DataGrid.prototype.getFilteringHistory=function(a){var e=SBGrid.DEF.__deepCopy(a);var f=e.keys();var d=e.item(f[0]);if(f.length<=1){return d.splice(0)}else{var c=1;while(c<f.length){var b=e.item(f[c]);d=SBGrid.DEF.arrDifferenceOfSets(d,b);c++}return d}};SBGrid.CT.DataGrid.prototype.rowHidden=function(a){return this.m_arHiddenRowState[a]};SBGrid.CT.DataGrid.prototype.setRowHidden=function(b,a,c){if(null==b||null==a||(0>b||this.m_nRealRows<=b)){return}if((null==this.m_arHiddenRowState[b]&&false==a)||this.m_arHiddenRowState[b]==a){return}this.m_arHiddenRowState[b]=a;if(a){this.setRowDisplay(b,"none",c);if(this.m_objScroll.bScrollEvent){this.setScrollDivRow(b,true)}}else{this.setRowDisplay(b,"",c);if(this.m_objScroll.bScrollEvent){this.setScrollDivRow(b,false)}}};SBGrid.CT.DataGrid.prototype.setRowDisplay=function(a,c,b){if(this.m_objScroll.bScrollEvent){this.setScrollDisplayRow(a,c,b)}else{jQuery('tr[rowNum="'+this.id+"_"+a+'"]').css("display",c)}};SBGrid.CT.DataGrid.prototype.setColDisplay=function(e,c){if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7||SBGrid.DEF.is_ie8||SBGrid.DEF.is_ie9){c="none"==c?"none":"block";jQuery('col[colNum="'+this.id+"_"+e+'"]').css("display",c);if(SBGrid.DEF.is_ie8||SBGrid.DEF.is_ie9){jQuery('td[colNum="'+this.id+"_"+e+'"]').css("display",c)}return}else{for(var b=0;b<this.m_nRealRows;b++){var a=this.getCell(b,e);if(null!=a){if(null!=a.m_heControl){var d=null!=a.m_heControl.lastChild&&null!=a.m_heControl.lastChild.tagName?a.m_heControl.lastChild:a.m_heControl;if("none"==c){d.style.display=c}else{d.style.display=""}}}}}};SBGrid.CT.DataGrid.prototype.setExtendlastcol=function(a,b){this.setExtendLastCol(a,b)};SBGrid.CT.DataGrid.prototype.setExtendLastCol=function(b,a){if(null==b||null==this.m_heGridWhole){return}this.extendLastCol=b;this.attribute.extendlastcol=b;var c;var l;var h=0;var f;var d=17;var g=0;for(var e=this.fixedCols;e<this.cols;e++){if(0==this.m_arColWidth[e]){continue}else{g++;c=e}}if(null==c){return}if(this._isVScroll()){l=true}else{l=false}for(var e=0;e<c;e++){h+=this.m_arColWidth[e]}var m=this._getGridWidth();if(h<m){f=(m-h)}else{b="false"}if(SBGrid.DEF.is_ie7){f-=(g+2)}switch(b){case"scroll":if(l){this.m_arColWidth[e]=f-d;if(a){this.setColGroupWidth(c,f-d)}else{this.setColWidth(c,f-d)}break}case"noscroll":this.m_arColWidth[e]=f;if(a){this.setColGroupWidth(c,f)}else{this.setColWidth(c,f)}break;case"false":default:if(a){this.setColGroupWidth(c,this.m_arHiddenCol[c])}else{this.setColWidth(c,this.m_arHiddenCol[c])}break}};SBGrid.CT.DataGrid.prototype.setEllipsis=function(a){if(null==this.m_heGridWhole){return}if(this.ellipsis!=a){this.ellipsis=a;for(var d=this.fixedRows;d<this.m_nRealRows;d++){for(var b=this.fixedCols;b<this.cols;b++){var c=this.getCell(d,b);if(null!=c){if(null!=c.m_heDataControl){if(a){if(SBGrid.DEF.is_firefox){}else{c.m_heDataControl.style.textOverflow="ellipsis"}}else{if(SBGrid.DEF.is_firefox){}else{c.m_heDataControl.style.textOverflow=""}}}}}}}};SBGrid.CT.DataGrid.prototype.getExplorerBar=function(){return this.m_nExplorerBarType};SBGrid.CT.DataGrid.prototype.setExplorerBar=function(a){switch(a){case"sort":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT;break;case"move":this.m_nExplorerBarType=SBGrid.DEF.SBEB_MOVE;break;case"sortshow":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT_SHOW;break;case"sortmove":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT_MOVE;break;case"sortshowmove":this.m_nExplorerBarType=SBGrid.DEF.SBEB_SORT_SHOW_MOVE;break;default:return}this.m_bIsExplorerBar=true;this.attribute.explorerbar=a;this.explorerbar=a};SBGrid.CT.DataGrid.prototype.getExplorerUI=function(){return this.m_nExplorerUIType};SBGrid.CT.DataGrid.prototype.setExplorerUI=function(a){switch(a){case"filteringshow":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING_SHOW;break;case"hideshow":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_HIDE_SHOW;break;case"filteringshowhideshow":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING_SHOW_HIDE_SHOW;break;case"filtering":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING;case"hide":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_HIDE;case"filteringhide":this.m_nExplorerUIType=SBGrid.DEF.SBEB_UI_FILTERING_HIDE;default:this.m_bIsExplorerUI=false;return}this.m_bIsExplorerUI=true;this.attribute.explorerui=a;this.explorerui=a};SBGrid.CT.DataGrid.prototype.isShowExplorerUI=function(){return this.m_bIsExplorerUI};SBGrid.CT.DataGrid.prototype.isMoveColumn=function(g){var c=false;if(this.isResizing()){return false}var b=this.m_bRowHeader?1:0;if(this.m_bDown&&this.m_nDownCol>=this.fixedCols&&this.isFixedCell(this.m_nDownRow,this.m_nDownCol)){var a=this.getExplorerBar();switch(a){case SBGrid.DEF.SBEB_MOVE:case SBGrid.DEF.SBEB_SORT_MOVE:case SBGrid.DEF.SBEB_SORT_SHOW_MOVE:case SBGrid.DEF.SBEB_FILTER_SHOW_MOVE:case SBGrid.DEF.SBEB_SORT_FILTER_SHOW_MOVE:case SBGrid.DEF.SBEB_HIDE_SHOW_MOVE:case SBGrid.DEF.SBEB_SORT_HIDE_SHOW_MOVE:case SBGrid.DEF.SBEB_FILTER_HIDE_SHOW_MOVE:case SBGrid.DEF.SBEB_SORT_FILTER_HIDE_SHOW_MOVE:c=true;break}}if(c){var h=this.getMouseCol();var f=this.getMouseRow();var e=this.getCell(f,h);if(null!=e){var d=e.mergeType;if(SBGrid.DEF.SBSM_HIDE==d||SBGrid.DEF.SBSM_MERGED==d){if(f!=this.m_nDownRow){c=false}}}}if(!c){return false}return true};SBGrid.CT.DataGrid.prototype._isVScroll=function(){return this.m_heGridWhole.clientHeight<this.m_heGridWhole.scrollHeight};SBGrid.CT.DataGrid.prototype._isHScroll=function(){var a=this.m_heGridWhole.clientWidth<this.m_heGridWhole.scrollWidth;if(null==this.m_objHeArea.bCheckWidth||this.m_objHeArea.bCheckWidth!=a){this.m_objHeArea.bChangeWidth=true}else{this.m_objHeArea.bChangeWidth=false}this.m_objHeArea.bCheckWidth=a;return a};SBGrid.CT.DataGrid.prototype._getGridHeight=function(){if(SBGrid.DEF.is_ie){return this.m_heControl.offsetHeight}else{return this.m_heControl.clientHeight}};SBGrid.CT.DataGrid.prototype._getGridWidth=function(){return this.m_heGridWhole.offsetWidth};SBGrid.CT.DataGrid.prototype._getTotalRowHeight=function(){var a=0;for(var b=0;b<this.m_nRealRows;b++){if(null!=this.m_htRowHeight[b]){a+=this.m_htRowHeight[b]}}return a};SBGrid.CT.DataGrid.prototype._getTotalColWidth=function(){var a=0;for(var b=0;b<this.cols;b++){if(b<this.m_arColWidth.length){a+=this.m_arColWidth[b]}}return a};SBGrid.CT.DataGrid.prototype._getBorder=function(a){switch(a){case"top":return parseInt(this.m_heControl.style.borderTopWidth);case"right":return parseInt(this.m_heControl.style.borderRightWidth);case"bottom":return parseInt(this.m_heControl.style.borderBottomWidth);case"left":return parseInt(this.m_heControl.style.borderLeftWidth);default:return 0}};SBGrid.CT.DataGrid.prototype.selectImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("selectimage")}return""};SBGrid.CT.DataGrid.prototype.setSelectImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.selectimage=b;if(SBGrid.DEF.SBIT_RADIO==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.unSelectImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("unselectimage")}return""};SBGrid.CT.DataGrid.prototype.setUnSelectImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.unselectimage=b;if(SBGrid.DEF.SBIT_RADIO==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.checkImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("checkimage")}return""};SBGrid.CT.DataGrid.prototype.unCheckImage=function(b){var a=this.m_arColumn[b];if(null!=a){return this.getAttribute("uncheckimage")}return""};SBGrid.CT.DataGrid.prototype.setUnCheckImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.uncheckimage=b;if(SBGrid.DEF.SBIT_CHECK==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.setCheckImage=function(c,b){var a=this.m_arColumn[c];if(null!=a){a.attribute.Checkimage=b;if(SBGrid.DEF.SBIT_CHECK==a.getInputType()){this.refreshCol(c)}}};SBGrid.CT.DataGrid.prototype.refreshCol=function(e){if(!SBGrid.DEF.is_smartphone){var d;var a=this.m_replaceString;if(a!=""&&a!="undefined"&&a!=null){d=a.split("?")}for(var c=this.fixedRows;c<this.fixedRows+this.frozenRows;c++){var b=this.getCell(c,e);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),d)}}for(var c=this.m_objScroll.nTopRow;c<=this.m_objScroll.nBottomRow;c++){var b=this.getCell(c,e);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),d)}}for(var c=this.m_nRealRows-this.m_nBottomRowCount;c<this.m_nRealRows;c++){var b=this.getCell(c,e);if(null!=b){SBGrid.CF.GridSetTextRefresh(b,SBGrid.CF.GridGetText(b),d)}}}};SBGrid.CT.DataGrid.prototype.setAttribute=function(a,c){SBGrid.CT.Group.prototype.setAttribute.call(this,a,c);switch(a){case"width":this.adjustWidth();this.m_nOriginWidth=SBGrid.DEF.is_smartphone?parseInt(c):0;break;case"height":this.adjustWidth();this.m_nOriginHeight=SBGrid.DEF.is_smartphone?parseInt(c):0;break;case"allowbigselection":this.allowBigSelection=("true"==c);break;case"allowselection":this.allowSelection=("true"==c);break;case"allowuserresize":this.allowUserResize=("true"==c);break;case"backcoloralternate":this.backColorAlternate=c;break;case"col":this.mouseCol=parseInt(c);break;case"dataheight":this.dataHeight=parseInt(c);this.setDataHeight(this.dataHeight);break;case"deleteflagimage":this.m_strDeleteFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHDelete:c);break;case"ellipsis":var b="true"==c?true:false;this.setEllipsis(b);break;case"extendlastcol":this.setExtendLastCol(c);break;case"explorerbar":this.setExplorerBar(c);break;case"explorerui":this.setExplorerUI(c);break;case"focuscolor":this.setFocusColor(c);break;case"insertflagimage":this.m_strInsertFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHInsert:c);break;case"multitotal":this.multiTotals="true"==c?true:false;break;case"normalflagimage":this.m_strNormalFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHNew:c);break;case"row":this.mouseRow=parseInt(c);break;case"rowheight":this.m_bIsRowHeight=true;this.m_nRowHeight=parseInt(c);break;case"subtotalposition":this.subtotalPosition=c;break;case"updateflagimage":this.m_strUpdateFlagImage=(""==c?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHUpdate:c);break;case"datatype":if(c=="delimeter"){if(this.jsonref==""){strJsonRef=this.id+"_delimeterData";this.attribute.jsonref=strJsonRef;this.jsonref=strJsonRef;arLightgrid.push({id:this.id,nodeset:this.nodeset,jsonref:this.id+"_delimeterData"});this.m_xlRefNode=this.getControlNodeList()}}else{}}};SBGrid.CT.DataGrid.prototype.adjustWidth=function(){if(!SBGrid.DEF.is_smartphone){if(null!=this.m_heGridWhole){if(0<this.frozenBottomRows){this.m_heGridFFCol.style.height=(this.m_heGridWhole.clientHeight-this.m_heGridFFNoScrollRow.clientHeight)+"px"}else{this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}this.__FFRowMove();this.bottomRowMove()}}};SBGrid.CT.DataGrid.prototype.setAllowBigSelection=function(a){this.attribute.allowbigselection=new String(a);this.allowBigSelection=a};SBGrid.CT.DataGrid.prototype.setAllowSelection=function(a){this.attribute.allowselection=new String(a);this.allowSelection=a};SBGrid.CT.DataGrid.prototype.setAllowUserResize=function(a){this.attribute.allowuserresize=new String(a);this.allowUserResize=a};SBGrid.CT.DataGrid.prototype.setColumBGColor=function(b){for(var d=this.fixedCols;d<this.cols;d++){var c=this.m_arColumn[d];var a=c.getDataPartBGColor();if(null==a||""==a){this.colCellInitStyle(d,"background-color","#ffffff",b)}else{this.colCellInitStyle(d,"background-color",a,b)}}};SBGrid.CT.DataGrid.prototype.setCellBCAColor=function(b,c){var a=this.getCell(b,c);if(null!=a.m_heControl){if((((b)-this.fixedRows)%2)==1){a.m_heControl.style.backgroundColor=this.backColorAlternate}else{a.m_heControl.style.backgroundColor=""}}};SBGrid.CT.DataGrid.prototype.setBackColorFrozen=function(b,a){if(null==a||!a){if(""!=b){this.attribute.backcolorfrozen=b;this.backColorFrozen=b;if(null==a){jQuery('td[rowNum^="'+this.id+'"][frozencell="true"]').css("background-color",b)}}}};SBGrid.CT.DataGrid.prototype.setForeColorFrozen=function(b,a){if(""!=b){this.attribute.foreColorFrozen=b;this.foreColorFrozen=b;if(null==a){jQuery('td[rowNum^="'+this.id+'"][frozencell="true"]').css("color",b)}}};SBGrid.CT.DataGrid.prototype.defaultAttributeStyleSetting=function(a){if(this.backColorAlternate){this.setBackColorAlternate(this.backColorAlternate,a)}if(this.backColorFrozen){this.setBackColorFrozen(this.backColorFrozen,a)}};SBGrid.CT.DataGrid.prototype.defaultAttributeSetting=function(a){this.defaultAttributeStyleSetting(a);this.reSetRowHidden();this.reSetColHidden();this.setAutoResize(this.autoResize,true);this.setExtendLastCol(this.extendLastCol);this.setExplorerBar(this.explorerbar);this.setExplorerUI(this.explorerui);this.setNewLineHeader();if(SBGrid.DEF.is_smartphone){this.extendGrid();if("visible"==this.getAttribute("overflow")){this.m_heControl.style.width=this.m_heGridWhole.firstChild.clientWidth+"px";this.m_heControl.style.height=this.m_heGridWhole.firstChild.clientHeight+"px";var b=document.getElementById("SBHE_DATAGRID_EXPANSION_"+this.id);b.style.display="none"}}};SBGrid.CT.DataGrid.prototype.setNewLineHeader=function(){if(this.m_bIsSort){var c=this.fixedRows;for(var b=this.fixedRows;b<this.m_nRealRows;b++){var a=this.getCell(b,0);if(null!=a&&!a.m_bIsSubTotal){if(this.isJsonRef()){this.setRowStatus(b,this.m_arSortJson[c-this.fixedRows][this.cols])}else{this.setRowStatus(b,this.m_arSortNodeList[c-this.fixedRows][this.cols])}c++}}}};SBGrid.CT.DataGrid.prototype.applyCellValign=function(){var d=null;var e=null;for(var c=this.fixedCols;c<this.cols;c++){var d=this.m_arColumn[c];if(null!=d){e=d.getAttribute("type");if(("inputdate"==e||"inputbutton"==e)){var b=null;for(var a=this.fixedRows;a<this.m_nRealRows;a++){b=this.getCell(a,c);if(null!=b){b.m_heControl.vAlign="top"}}b=null}}}objColl=null;e=null};SBGrid.CT.DataGrid.prototype.applyCellStyle=function(a){for(var e=0;e<this.m_nRealRows;e++){if(!this.isPhysicalRow(e)){continue}for(var c=0;c<this.cols;c++){var d=this.getCell(e,c);if(null!=d){for(var b in d.m_objCellStyle){if(SBGrid.DEF.SB_STYLELIST[b]){if(a){d.attribute[b]=d.m_objCellStyle[b]}else{d.setAttribute(b,d.m_objCellStyle[b])}}}}}}};SBGrid.CT.DataGrid.prototype.setNodeset=function(b){var a=this.attribute.nodeset;if(null!=a&&!a.isEmpty()){if(null!=SBGrid.DEF.SB_REF_ATTR[a]){SBGrid.DEF.SB_REF_ATTR[a][this.id]=null}}this.m_arUpdateDeleteList=new Array();this.attribute.nodeset=b;this.nodeset=b;if(null!=b&&!b.isEmpty()){if(null==SBGrid.DEF.SB_REF_ATTR[b]){SBGrid.DEF.SB_REF_ATTR[b]=new SBGrid.DS.Hashtable();SBGrid.DEF.SB_REF_ATTR[b][this.id]=this}else{SBGrid.DEF.SB_REF_ATTR[b][this.id]=this}this.m_bBinded=true}this.rebuild();this.m_xlRefNode=this.getControlNodeList()};SBGrid.CT.DataGrid.prototype.setFocusColor=function(a){if(""!=a.trim()){this.attribute.focuscolor=a;this.focusColor=a}};SBGrid.CT.DataGrid.prototype.setTableWidthChange=function(a){var c=this.m_heGridWhole.firstChild;var d;var b;if(null!=this.m_heGridFFScrollRow){d=this.m_heGridFFScrollRow.firstChild;heFFScrollTBody=d.firstChild}if(null!=this.m_heGridFFBScrollRow){b=this.m_heGridFFBScrollRow.firstChild}if(null!=c){c.style.width=a+"px"}if(null!=d){d.style.width=a+"px"}if(null!=b){b.style.width=a+"px"}};SBGrid.CT.DataGrid.prototype.physicalRemovePartRow=function(s,c,b){if(null==b){b=this.m_nRealRows}var o=this.fixedCols+this.frozenCols;var r=this.fixedRows+this.frozenRows;var g=b-this.frozenBottomRows;var l=this.frozenBottomRows-this.m_nBottomRowCount;var q=this.m_heGridWhole.firstChild;var f=q.lastChild;if(!SBGrid.DEF.is_smartphone){var e;var i;var p;var n;var h;var a;var d;if(null!=this.m_heGridFFScrollRow){e=this.m_heGridFFScrollRow.firstChild;i=e.lastChild;p=this.m_heGridFFNoScrollRow.firstChild.lastChild;n=this.m_heGridFFCol.firstChild.lastChild;h=this.m_heGridFFBScrollRow.firstChild;a=null!=h?h.lastChild:null;d=null!=this.m_heGridFFBNoScrollRow.firstChild?this.m_heGridFFBNoScrollRow.firstChild.lastChild:null}for(var t=c;t>=s;t--){if(null!=f.children[t]){f.removeChild(f.children[t]);if(t<(r)){if(null!=i.children[t]){i.removeChild(i.children[t])}}if(t<(r)&&null!=p){if(null!=p.children[t]){p.removeChild(p.children[t])}}if(t>=(r)&&null!=false){if(null!=n.children[t-r]){n.removeChild(n.children[t-r])}}}if(t>=g&&t>=r&&null!=a){var m=a.children[(t+1)-(g+l)];if(null!=m&&"undefined"!=m){a.removeChild(m)}if(null!=d.children[t-(g+l)]){d.removeChild(d.children[t-(g+l)])}l--;this.m_nBottomRowCount--}}}else{for(var t=c;t>=s;t--){f.removeChild(f.children[t])}}};SBGrid.CT.DataGrid.prototype.physicalRemoveCell=function(v,u){var p=this.fixedCols+this.frozenCols;var s=this.fixedRows+this.frozenRows;var i=this.m_nRealRows-this.frozenBottomRows;var r=this.m_heGridWhole.firstChild;var f=r.lastChild;if(!SBGrid.DEF.is_smartphone){var d;var m;var q;var n;var l;var a;var c;if(null!=this.m_heGridFFScrollRow){d=this.m_heGridFFScrollRow.firstChild;m=d.lastChild;q=this.m_heGridFFNoScrollRow.firstChild.lastChild;n=this.m_heGridFFCol.firstChild.lastChild;l=this.m_heGridFFBScrollRow.firstChild;a=l.lastChild;c=this.m_heGridFFBNoScrollRow.firstChild.lastChild}var g=f.children[v];if(null!=g){g.removeChild(g.children[u])}if(v<(s)){var e=m.children[v];if(null!=e){e.removeChild(e.children[u])}}if(u<p){if(v<(s)&&null!=q){var h=q.children[v];if(null!=h){h.removeChild(h.children[u])}}if(v>=(s)&&null!=false){var o=n.children[v-s];if(null!=o){o.removeChild(o.children[u])}}if(v>=i){var t=c.children[v-i];if(null!=t){t.removeChild(t.children[u])}}}if(v>=i){var b=a.children[v-i];if(null!=b){b.removeChild(b.children[u])}}}else{var g=f.children[v];if(null!=g){g.removeChild(g.children[u])}}};SBGrid.CT.DataGrid.prototype.physicalCreateCell=function(i,b,d,J,F,N,L,H){L=null==L?0:L;H=null==H?0:H;var U=null!=this.m_xlRefNode?this.m_xlRefNode.length:0;var X=this.fixedCols+this.frozenCols;var a=this.fixedRows+this.frozenRows;var z=this.m_nRealRows-this.frozenBottomRows;var M=this.m_heGridWhole.firstChild;var ab=M.lastChild;var s=i<this.fixedRows?this.m_nRowHeight:this.dataHeight;if(s>0&&!(SBGrid.DEF.is_mozBrowser)){s--}var Y=false;var K="";var m=SBGrid.DEF.is_ie?this.m_heControl.currentStyle.textAlign:window.getComputedStyle(this.m_heControl,null).textAlign;switch(m){case"center":K=" sbgrid_ac";break;case"right":K=" sbgrid_ar";break;default:K=" sbgrid_al";break}var B;var V;if(this.fixedRows<=(i+L)){if(this.isJsonRef()){V=this.m_xlRefNode[(i+L)-this.fixedRows]}else{B=this.m_xlRefNode.item((i+L)-this.fixedRows)}if(""!=this.backColorAlternate&&(((i+L)-this.fixedRows)%2)==1){Y=true}else{Y=false}}if(!SBGrid.DEF.is_smartphone){var t;var C;var Q;var e;var I;var T;var r;if(null!=this.m_heGridFFScrollRow){t=this.m_heGridFFScrollRow.firstChild;C=t.lastChild;Q=this.m_heGridFFNoScrollRow.firstChild.lastChild;e=this.m_heGridFFCol.firstChild.lastChild;I=this.m_heGridFFBScrollRow.firstChild;T=I.lastChild;r=this.m_heGridFFBNoScrollRow.firstChild.lastChild;if(null==C){C=document.createElement("tbody");t.appendChild(C)}if(null==Q){Q=document.createElement("tbody");this.m_heGridFFNoScrollRow.firstChild.appendChild(Q)}if(null==e){e=document.createElement("tbody");this.m_heGridFFCol.firstChild.appendChild(e)}if(null==T){T=document.createElement("tbody");I.appendChild(T)}if(null==r){r=document.createElement("tbody");this.m_heGridFFBNoScrollRow.firstChild.appendChild(r)}}var aa=false;var O=true;var W=true;if(this.m_nRealRows>this.fixedRows+this.frozenRows&&this.frozenBottomRows>0){aa=true}if(aa&&(i+L)>=z&&!N){O=false}var D=this.m_arColumn[b];var o=this.id+"_"+(i+L)+"_"+(b);var h=null!=D.attribute["class"]?D.attribute["class"]:"";if(O){var x=K;var ad=D.getAttribute("type");if("checkbox"==ad||"radio"==ad){x=" sbgrid_ac"}if(("inputdate"==ad||"inputbutton"==ad)){x+=" sbgrid_vat"}var Z=null;if(d){var c=document.createElement("tr");c.setAttribute("targetcell","who");c.setAttribute("rowNum",this.id+"_"+(i+L));if(null!=ab.children[i]){ab.insertBefore(c,ab.children[i]);Z=c}else{ab.appendChild(c);Z=c}}else{if(null!=ab.children[i]){Z=ab.children[i]}else{var c=document.createElement("tr");c.setAttribute("targetcell","who");c.setAttribute("rowNum",this.id+"_"+(i+L));ab.appendChild(c);Z=c}}if(null!=Z){var S="";var P=new SBGrid.DS.Hashtable();if(this.m_nRealRows>this.fixedRows+this.frozenCols&&this.frozenBottomRows>0){aa=true}if(aa&&i>=z){W=false}if(i<this.fixedRows+this.frozenRows||b<this.fixedCols+this.frozenCols){W=false}var ag=new Array();if(W){ag.push('<TD id="SBHE_'+o+"\" valign ='middle' rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'who' ")}else{ag.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'who' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){P.display="none"}}P.height=s+"px";ag.push(" class='");if(i<this.fixedRows||b<this.fixedCols){ag.push("sbgrid_datagrid_FixedCell ");ag.push("sbgrid_"+this.id+"_fixed ");ag.push(this.m_strClassFixed+"'")}else{ag.push("sbgrid_datagrid_DataCell");ag.push(x);ag.push(" sbgrid_"+this.id+"_col"+b);ag.push(" sbgrid_"+this.id+"_data ");ag.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"]}var q="";if(!W){ag.push(" style='"+this.getStyleString(P)+"'>");ag.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');ag.push('border-top-color:transparent; border-left-color:transparent;"></div>')}else{if(J){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}ag.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";ag.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");ag.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){ag.push('<span style="white-space:nowrap;"></span>')}ag.push("</div>")}else{var n;var l;if(null!=D){var ac=D.getAttribute("ref");if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=V[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}ag.push(" style='"+this.getStyleString(P)+"'>");ag.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}ag.push("</TD>");if(Z.children[b]){jQuery(Z.children[b]).before(ag.join(""))}else{jQuery(Z).append(ag.join(""))}}if(i<(a)&&null!=C){if(d){var c=document.createElement("tr");c.setAttribute("targetcell","ffs");c.setAttribute("rowNum",this.id+"_"+(i+L));if(null!=C.children[i]){C.insertBefore(c,C.children[i]);heFFScrollRow=c}else{C.appendChild(c);heFFScrollRow=c}}else{heFFScrollRow=i<a?C.children[i]:null;if(null==heFFScrollRow){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffs");C.appendChild(c);heFFScrollRow=c}}if(null!=heFFScrollRow){var S="";var P=new SBGrid.DS.Hashtable();var W=(i<this.fixedRows+this.frozenRows&&b>=this.fixedCols+this.frozenCols);var af=W&&(i>=this.fixedRows);var v=new Array();if(W){v.push('<TD id="SBHE_'+o+"\" valign ='middle' rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ");if(af){v.push("frozencell='true' ")}}else{v.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){P.display="none"}}P.height=s+"px";v.push(" class='");if(i<this.fixedRows||b<this.fixedCols){v.push("sbgrid_datagrid_FixedCell ");v.push("sbgrid_"+this.id+"_fixed ");v.push(this.m_strClassFixed+"'")}else{v.push("sbgrid_datagrid_DataCell");v.push(x);v.push(" sbgrid_"+this.id+"_col"+b);v.push(" sbgrid_"+this.id+"_data ");v.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}var q="";if(W){if(i<this.fixedRows){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,i,"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}v.push(" style='"+this.getStyleString(P)+"'>");v.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');v.push('border-top-color:transparent; border-left-color:transparent;"><span style="white-space:nowrap;">'+q+"</span></span>")}else{if(J){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}v.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";v.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");v.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){v.push('<span style="white-space:nowrap;"></span>')}v.push("</div>")}else{var n;var l;if(null!=D){var ac=D.getAttribute("ref");if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[V]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}v.push(" style='"+this.getStyleString(P)+"'>");v.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}else{v.push(" style='"+this.getStyleString(P)+"'>");v.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');v.push('border-top-color:transparent; border-left-color:transparent;"></div>')}v.push("</TD>");if(heFFScrollRow.children[b]){jQuery(heFFScrollRow.children[b]).before(v.join(""))}else{jQuery(heFFScrollRow).append(v.join(""))}}}}if(b<X){if(i<(a)&&null!=Q){if(d){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffn");if(null!=Q.children[i]){Q.insertBefore(c,Q.children[i]);heFFNoScrollRow=c}else{Q.appendChild(c);heFFNoScrollRow=c}}else{heFFNoScrollRow=i<a?Q.children[i]:null;if(null==heFFNoScrollRow){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffn");Q.appendChild(c);heFFNoScrollRow=c}}if(null!=heFFNoScrollRow){var S="";var P=new SBGrid.DS.Hashtable();var W=(i<this.fixedRows+this.frozenRows&&b<this.fixedCols+this.frozenCols);var af=W&&(i>=this.fixedRows&&b>=this.fixedCols);var A=new Array();if(W){A.push('<TD id="SBHE_'+o+"\" valign ='middle' rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffn' ");if(af){A.push("frozencell = 'true' ")}}else{A.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffn' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){P.display="none"}}P.height=s+"px";A.push(" class='");if(i<this.fixedRows||b<this.fixedCols){A.push("sbgrid_datagrid_FixedCell ");A.push("sbgrid_"+this.id+"_fixed ");A.push(this.m_strClassFixed+"'")}else{A.push("sbgrid_datagrid_DataCell");A.push(x);A.push(" sbgrid_"+this.id+"_col"+b);A.push(" sbgrid_"+this.id+"_data ");A.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}var q="";if(W){if(i<this.fixedRows){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}A.push(" style='"+this.getStyleString(P)+"'>");A.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');A.push('border-top-color:transparent; border-left-color:transparent;"><span style="white-space:nowrap;">'+q+"</span></span>")}else{var n;var l;if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+i}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(J){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){A.push(" style='"+this.getStyleString(P)+"'>");A.push(q)}else{if(b<this.fixedCols&&this.m_bRowHeader){A.push(" style='"+this.getStyleString(P)+"'>");A.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}else{A.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";A.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");A.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){A.push('<span style="white-space:nowrap;"></span>')}A.push("</div>")}}}else{if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){A.push(" style='"+this.getStyleString(P)+"'>");A.push(q)}else{A.push(" style='"+this.getStyleString(P)+"'>");A.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}}else{A.push(" style='"+this.getStyleString(P)+"'>");A.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');A.push('border-top-color:transparent; border-left-color:transparent;"></div>')}A.push("</TD>");if(heFFNoScrollRow.children[b]){jQuery(heFFNoScrollRow.children[b]).before(A.join(""))}else{jQuery(heFFNoScrollRow).append(A.join(""))}}}if(O&&i>=(a)&&null!=false&&null!=e){if(d){var c=document.createElement("tr");c.setAttribute("targetcell","ffc");c.setAttribute("rowNum",this.id+"_"+(i+L));if(null!=e.children[i-(a)]){e.insertBefore(c,e.children[i-(a)]);heFFColRow=c}else{e.appendChild(c);heFFColRow=c}}else{heFFColRow=(i-(a)>=0)?e.children[i-(a)]:null;if(null==heFFColRow){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffc");e.appendChild(c);heFFColRow=c}}if(null!=heFFColRow){var S="";var P=new SBGrid.DS.Hashtable();var W=(i>=this.fixedRows);W=i<(this.m_nRealRows-this.frozenBottomRows);var af=W&&(b>=this.fixedCols);var R=new Array();if(W){R.push('<TD id="SBHE_'+o+"\" valign ='middle'  rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ");if(af){R.push("frozencell='true' ")}}else{R.push("<TD  rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffs' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){P.display="none"}}P.height=s+"px";R.push(" class='");if(i<this.fixedRows||b<this.fixedCols){R.push("sbgrid_datagrid_FixedCell ");R.push("sbgrid_"+this.id+"_fixed ");R.push(this.m_strClassFixed+"'")}else{R.push("sbgrid_datagrid_DataCell");R.push(x);R.push(" sbgrid_"+this.id+"_col"+b);R.push(" sbgrid_"+this.id+"_data ");R.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}var q="";if(!W){R.push(" style ='"+this.getStyleString(P)+"'>");R.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');R.push('border-top-color:transparent; border-left-color:transparent;"></div>')}else{var n;var l;if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+1}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}R.push(" style ='"+this.getStyleString(P)+"'>");R.push(q)}else{if(J&&b>=this.fixedCols){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}R.push(" style ='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";R.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");R.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){R.push('<span style="white-space:nowrap;"></span>')}R.push("</div>")}else{if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}R.push(" style ='"+this.getStyleString(P)+"'>");R.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}R.push("</TD>");if(heFFColRow.children[b]){jQuery(heFFColRow.children[b]).before(R.join(""))}else{jQuery(heFFColRow).append(R.join(""))}R=null}}if(i>=(z)&&i>=a&&null!=r){var ae=null;if(d){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbn");if(null!=r.children[this.m_nBottomRowCount]){r.insertBefore(c,r.children[this.m_nBottomRowCount]);ae=c}else{r.appendChild(c);ae=c}}else{ae=i>=(z)?r.children[this.m_nBottomRowCount]:null;if(null==ae){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbn");r.appendChild(c);ae=c}}if(null!=ae){var S="";var P=new SBGrid.DS.Hashtable();var W=(b<this.fixedCols+this.frozenCols);var af=W&&(b>=this.fixedCols);var g=new Array();g.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffbn' ");if(W){g.push('id="SBHE_'+o+"\" valign ='middle' ");if(af){g.push("frozencell='true' ")}}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){P.display="none"}}P.height=s+"px";g.push(" class=");if(i<this.fixedRows||b<this.fixedCols){g.push("'sbgrid_datagrid_BFixedCell ");g.push("sbgrid_"+this.id+"_fixed ");g.push(this.m_strClassFixed+"'")}else{g.push("'sbgrid_datagrid_BDataCell");g.push(x);g.push(" sbgrid_"+this.id+"_col"+b);g.push(" sbgrid_"+this.id+"_data ");g.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P.color="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"];P.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:P.color}var q="";if(W){if(i<this.fixedRows){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}g.push(" style='"+this.getStyleString(P)+"'>");g.push('<span style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"><span style="white-space:nowrap;">'+q+"</span></span>")}else{var n;var l;if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+1}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(J){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){g.push(" style='"+this.getStyleString(P)+"'>");g.push(q)}else{if(b<this.fixedCols&&this.m_bRowHeader){g.push(" style='"+this.getStyleString(P)+"'>");g.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}else{g.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";g.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");g.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){g.push('<span style="white-space:nowrap;"></span>')}g.push("</div>")}}}else{if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){g.push(" style='"+this.getStyleString(P)+"'>");g.push(q)}else{g.push(" style='"+this.getStyleString(P)+"'>");g.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}}}else{g.push(" style='"+this.getStyleString(P)+"'>");g.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');g.push('border-top-color:transparent; border-left-color:transparent;"></div>')}g.push("</TD>");if(ae.children[b]){jQuery(ae.children[b]).before(g.join(""))}else{jQuery(ae).append(g.join(""))}}}}if(i>=(z)&&i>=a&&null!=T){var f=null;if(d){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbs");if(null!=T.children[this.m_nBottomRowCount]){T.insertBefore(c,T.children[this.m_nBottomRowCount]);f=c}else{T.appendChild(c);f=c}}else{f=i>=(z)?T.children[this.m_nBottomRowCount]:null;if(null==f){var c=document.createElement("tr");c.setAttribute("rowNum",this.id+"_"+(i+L));c.setAttribute("targetcell","ffbs");T.appendChild(c);f=c}}if(null!=f){var S="";var P=new SBGrid.DS.Hashtable();var W=(b>=this.fixedCols+this.frozenCols);var w=new Array();w.push("<TD rowNum='"+this.id+"_"+(i+L)+"' colNum='"+this.id+"_"+b+"' cellId='"+this.id+"."+(i+L)+"."+b+"' targetcell = 'ffbs' ");if(W){w.push('id="SBHE_'+o+"\" valign ='middle' frozencell='true' ")}if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(D.m_bHiddenState||0==this.m_arHiddenCol[b]){P.display="none"}}P.height=s+"px";w.push(" class=");if(i<this.fixedRows||b<this.fixedCols){w.push("'sbgrid_datagrid_BFixedCell ");w.push("sbgrid_"+this.id+"_fixed ");w.push(this.m_strClassFixed+"'")}else{w.push("'sbgrid_datagrid_BDataCell");w.push(x);w.push(" sbgrid_"+this.id+"_col"+b);w.push(" sbgrid_"+this.id+"_data ");w.push(this.m_strClassData+" "+h+"'");P["background-color"]="";P.color="";P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"];P.color=(""!=this.foreColorFrozen)?this.foreColorFrozen:P.color}var q="";if(W){if(J){if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}w.push(" style='"+this.getStyleString(P)+"'>");var G=this.autoResize?"break-word":"normal";w.push("<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; ");w.push("border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">');if(!this.autoResize){w.push('<span style="white-space:nowrap;"></span>')}w.push("</div>")}else{var n;var l;if(null!=D){var ac=D.getAttribute("ref");if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,(i+L),"softbowl:cell"):p;p.setElement(D);this.setLinkedData(p,n,l);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}w.push(" style='"+this.getStyleString(P)+"'>");w.push(D.makeCellElement(q,this.m_arColWidth[b],o,P))}}else{w.push(" style='"+this.getStyleString(P)+"'>");w.push('<div style="border-right-color:transparent; border-bottom-color:transparent; ');w.push('border-top-color:transparent; border-left-color:transparent;"></div>')}w.push("</TD>");if(f.children[b]){jQuery(f.children[b]).before(w.join(""))}else{jQuery(f).append(w.join(""))}}}}else{var P=new SBGrid.DS.Hashtable();var Z=null;if(d){var c=document.createElement("tr");if(null!=ab.children[i]){ab.insertBefore(c,ab.children[i]);Z=c}else{ab.appendChild(c);Z=c}}else{if(null!=ab.children[i]){Z=ab.children[i]}else{var c=document.createElement("tr");ab.appendChild(c);Z=c}}var D=this.m_arColumn[b];var o=this.id+"_"+i+"_"+b;var E;E='<td onmousedown=" "onmousemove=" "onmouseup=" "ondblclick=" "onkeydown=" "onkeypress=" "onkeyup=" " id="SBHE_'+o+"\" valign='middle'>";P.height=s+"px";P["text-align"]=(""==this.getAttribute("text-align"))?"left":this.getAttribute("text-align");P["border-right-style"]="solid";P["border-bottom-style"]="solid";P["border-right-width"]="1px";P["border-bottom-width"]="1px";P.overflow="hidden";if(true!=F){var p=this.getCellById(o);if(null!=p){if(o!=p.id){p=null}}p=null==p?new SBGrid.CT.DataGridCell(this,b,o,i,"softbowl:cell"):p;p.setElement(D);SBGrid.CF.GridSetMergeType(p,D.m_bMerge)}var q="";if(i<this.fixedRows||b<this.fixedCols){P["text-align"]="center";P["background-color"]="#D4D0C8";P["border-right-color"]="#6F6F5F";P["border-bottom-color"]="#6F6F5F";this.setBaseCellStyle(P,"fixed")}else{P["background-color"]="#FFFFFF";P["border-right-color"]="#D4D0C8";P["border-bottom-color"]="#D4D0C8";this.setColStyleInheritanceCell(P,b);this.setBaseCellStyle(P,"data");P["background-color"]=W&&Y?this.backColorAlternate:P["background-color"];if(i<(this.fixedRows+this.frozenRows)||b<(this.fixedCols+this.frozenCols)){P["background-color"]=(""!=this.backColorFrozen)?this.backColorFrozen:P["background-color"]}}if(i<this.fixedRows){if(this.m_arCaption[i][b]){q=this.m_arCaption[i][b].newlineCharConvert()}E=E.insertAttribute("style",this.getStyleString(P));E+=q}else{if(null!=D){var ac=D.getAttribute("ref");if(ac.isEmpty()){if(this.m_bRowHeader&&0==b){if("seq"==this.rowheader){q=i-this.fixedRows+1}else{if("reverseseq"==this.rowheader){q=U-(i-this.fixedRows)}}}}else{if(this.isJsonRef()){l=V}else{n=SBGrid.UT.XmlLib.selectSingleNode(B,ac)}if(null!=l){q=l[ac]+""}else{if(null!=n){q=SBGrid.UT.XmlLib.getTextValue(n)}}}}if(b<this.fixedCols&&!(this.m_bRowHeader&&0==b)){E=E.insertAttribute("style",this.getStyleString(P));E+=q}else{if(J&&b>=this.fixedCols){E=E.insertAttribute("style",this.getStyleString(P));var G=this.autoResize?"break-word":"normal";var u="<div id='"+o+"_data' style=\"border-right-color:transparent; border-bottom-color:transparent; border-top-color:transparent; border-left-color:transparent;word-wrap:"+G+';">';if(!this.autoResize){u+='<span style="white-space:nowrap;"></span>'}u+="</div>";var y=u;E+=y;S=y}else{if(true!=F){this.setLinkedData(p,n,l)}var ad=D.getAttribute("type");if("checkbox"==ad||"radio"==ad){P["text-align"]="center"}E=E.insertAttribute("style",this.getStyleString(P));E+=D.makeCellElement(q,this.m_arColWidth[b],o,P)}}}E+="</TD>";if(Z.children[b]){Z.innerHTML+=E;Z.insertBefore(Z.lastChild,Z.children[b])}else{Z.innerHTML+=E}}};SBGrid.CT.DataGrid.prototype.applyColStyleInheritanceCellCSS=function(){var b;for(var c=0;c<this.m_arColumn.length;c++){b=this.m_arColumn[c];if(null!=b){var f=b.attribute;var e=new Array();for(var a in f){if(SBGrid.DEF.SB_STYLELIST[a]){if("background-image"!=SBGrid.DEF.SB_STYLELIST[a]){e.push(a+":"+f[a]+";")}else{var d=f[a];if(-1==d.indexOf("url")&&-1==d.indexOf("URL")){e.push(a+":url("+f[a]+");")}else{e.push(a+":"+f[a]+";")}}}}SBGrid.DEF.makeStyleSheetClass("sbgrid_"+this.id+"_col"+c,e.join(""))}}};SBGrid.CT.DataGrid.prototype.setColStyleInheritanceCell=function(d,f,c){var b=this.m_arColumn[f];if(null!=b){var e=b.attribute;if("tag"==c){for(var a in e){if(SBGrid.DEF.SB_STYLELIST[a]){SBGrid.UT.HtmlLib.setStyle(d,a,e[a])}}}else{for(var a in b.attribute){if(SBGrid.DEF.SB_STYLELIST[a]){d[a]=b.attribute[a]}}}}};SBGrid.CT.DataGrid.prototype.getStyleString=function(c){var b=new Array();for(var a in c){if(SBGrid.DEF.SB_STYLELIST[a]){b.push((a+":"+c[a]+";"))}}return b.join("")};SBGrid.CT.DataGrid.prototype.userGridCss=function(){this.m_strClassFixed="";this.m_strClassFixed+=null!=this.attribute.datagrid_fixed?this.attribute.datagrid_fixed+" ":"";this.m_strClassFixed+=null!=this.attribute.datagrid_gridfixedcell?this.attribute.datagrid_gridfixedcell+" ":"";this.m_strClassFixed+=null!=this.attribute["datagrid_fixed-cell"]?this.attribute["datagrid_fixed-cell"]+" ":"";this.m_strClassData="";this.m_strClassData+=null!=this.attribute.datagrid_data?this.attribute.datagrid_data+" ":"";this.m_strCGInput="";this.m_strCGInput+=null!=this.attribute.datagrid_gridinput?this.attribute.datagrid_gridinput+" ":"";this.m_strCGInput+=null!=this.attribute.datagrid_input?this.attribute.datagrid_input+" ":"";this.m_strCGButton="";this.m_strCGButton+=null!=this.attribute.datagrid_gridbutton?this.attribute.datagrid_gridbutton+" ":""};SBGrid.CT.DataGrid.prototype.applyFocusColorCss=function(){var a=this.focusColor;if(null!=a&&""!=a){strStyle="background-color:"+a+" !important;"}else{strStyle="background-color:#3161C6 !important;";if("none"!=this.selectFontColorStyle){strStyle+="color:#ffffff !important;"}}SBGrid.DEF.makeStyleSheetClass("sbgrid_"+this.id+"_focusColor",strStyle)};SBGrid.CT.DataGrid.prototype.applyBaseCellCSS=function(c){var e;if("fixed"==c){e=this.m_htFixedStyle}else{e=this.m_htDataStyle}var d=new Array();for(var a in e){if(SBGrid.DEF.SB_STYLELIST[a]){if("background-image"!=SBGrid.DEF.SB_STYLELIST[a]){d.push(a+":"+e[a]+";")}else{var b=e[a];if(-1==b.indexOf("url")&&-1==b.indexOf("URL")){d.push(a+":url("+e[a]+");")}else{d.push(a+":"+e[a]+";")}}}}SBGrid.DEF.makeStyleSheetClass("sbgrid_"+this.id+"_"+c,d.join(""))};SBGrid.CT.DataGrid.prototype.setBaseCellStyle=function(c,b,e){var d;if("fixed"==b){d=this.m_htFixedStyle}else{d=this.m_htDataStyle}if(null==d){return}if("tag"==e){for(var a in d){if(SBGrid.DEF.SB_STYLELIST[a]){SBGrid.UT.HtmlLib.setStyle(c,a,d[a])}}}else{for(var a in d){if(SBGrid.DEF.SB_STYLELIST[a]){c[a]=d[a]}}}};SBGrid.CT.DataGrid.prototype._removeDivStyle=function(){this.m_heControl.style.textAlign=""};SBGrid.CT.DataGrid.prototype.loadExcel=function(a,c,q,b){if(arguments.length<4){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof c)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof q)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if 3rd parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".loadExcel","Please check if 4th parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(b==""){return}var r=q!=null?q:"json";var p=document.getElementById(a).value;if(null==this.m_heLodExcelForm){this.m_heLodExcelForm=document.getElementById(c);this.m_heLodExcelForm.setAttribute("enctype","multipart/form-data");this.m_heLodExcelForm.action=SBGrid.DEF.__getAppName()+b;this.m_heLodExcelForm.method="post";this.m_heLodExcelForm.target="SBHE___SB_LoadExcel";this.m_heLodExcelForm.style.top=this.getAttribute("top");this.m_heLodExcelForm.style.left=this.getAttribute("left");this.m_heLodExcelForm.style.width=this.getAttribute("width");this.m_heLodExcelForm.style.height=this.getAttribute("height")}if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){var v="<input type='hidden' name='nodeset'/>";v+="<input type='hidden' name='Type' id='SBHE___SB_ExcelLoad_Type' value='"+r+"'/>";v+="<input type='file' name='excel' value='"+p+"' />";this.m_heLodExcelForm.innerHTML=v}else{var u=document.createElement("input");u.type="hidden";u.name="nodeset";var d=document.createElement("input");d.type="hidden";d.name="Type";d.value=r;this.m_heLodExcelForm.appendChild(u);this.m_heLodExcelForm.appendChild(d)}if(null!=this.parent.m_heControl){this.parent.m_heControl.appendChild(this.m_heLodExcelForm)}if(this.isJsonRef()){if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){var s="<input type='hidden' name='targetGrid' value='"+this.m_strTargetGrid+"'/>";s+="<input type='hidden' name='gridJsonRef' value='"+m_strGridJsonReg+"'/>";this.m_heLodExcelForm.innerHTML=s}else{var e=document.createElement("input");e.type="hidden";e.name="targetGrid";e.value=this.m_strTargetGrid;var g=document.createElement("input");g.type="hidden";g.name="gridJsonRef";g.value=this.m_strGridJsonReg;this.m_heLodExcelForm.appendChild(e);this.m_heLodExcelForm.appendChild(g)}}var m=p;m=m.substring(m.lastIndexOf(".")+1,m.length).toLowerCase();if("xlsx"!=m&&"xls"!=m&&"cell"!=m){SBGrid.DEF.errorMsg("올바른 Excel File 형식이 아닙니다.");return}var h=document.SBHE_allElement.item(this.m_strTargetGrid);if(null!=h){var l=h.nodeset+"@";var o=true;for(var t=0;t<h.m_arColumn.length;t++){var f=h.m_arColumn[t].getAttribute("ref");if(""!=f.trim()){if(o){l+=f;o=false}else{l+=","+f}}}u.value=encodeURI(l+"@"+m)}else{SBGrid.DEF.errorMsg("Load Excel을 적용할 Target Grid가 존재하지 않습니다.");return}SBGrid.DEF.SBLE_GRID=this.m_strTargetGrid;SBGrid.DEF.SBLE_BUTTON=this;var n=document.getElementById("SBHE___SB_LoadExcel");if(n){n.setAttribute("targetGrid",this.m_strTargetGrid);if(n.attachEvent){n.attachEvent("onload",SBGrid.CT.Button.uploadComplete)}else{n.addEventListener("load",SBGrid.CT.Button.uploadComplete,false)}}this.m_heLodExcelForm.submit()};SBGrid.CT.DataGrid.prototype.saveExcel=function(strFileName,strAction){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".saveExcel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof strFileName)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcel","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof strFileName)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".saveExcel","Please check if first parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(strAction==""){return}var docDatagrid=SBGrid.UT.XmlLib.createXML("datagrid");var xnDatagrid=docDatagrid.firstChild;xnDatagrid.setAttribute("caption",this.caption);xnDatagrid.setAttribute("dataHeight",this.dataHeight);xnDatagrid.setAttribute("rowHeight",this.m_nRowHeight);var xnFixedCell=SBGrid.UT.XmlLib.createChild(xnDatagrid,"fixedcell");xnFixedCell.setAttribute("fontFamily",this.m_objFixedCell.attribute["font-family"]);xnFixedCell.setAttribute("fontSize",this.m_objFixedCell.attribute["font-size"]);xnFixedCell.setAttribute("fontWeight",this.m_objFixedCell.attribute["font-weight"]);xnFixedCell.setAttribute("fontStyle",this.m_objFixedCell.attribute["font-style"]);xnFixedCell.setAttribute("color",this.m_objFixedCell.attribute.color);xnFixedCell.setAttribute("textAlign",this.m_objFixedCell.attribute["text-align"]);xnFixedCell.setAttribute("textDecoration",this.m_objFixedCell.attribute["text-decoration"]);xnFixedCell.setAttribute("verticalAlign",this.m_objFixedCell.attribute["vertical-align"]);xnFixedCell.setAttribute("backgroundColor",this.m_objFixedCell.attribute["background-color"]);xnFixedCell.setAttribute("borderColor",this.m_objFixedCell.attribute["border-color"]);xnFixedCell.setAttribute("borderLeftColor",this.m_objFixedCell.attribute["border-left-color"]);xnFixedCell.setAttribute("borderTopColor",this.m_objFixedCell.attribute["border-top-color"]);xnFixedCell.setAttribute("borderRightColor",this.m_objFixedCell.attribute["border-right-color"]);xnFixedCell.setAttribute("borderBottomColor",this.m_objFixedCell.attribute["border-bottom-color"]);xnFixedCell.setAttribute("borderWidth",this.m_objFixedCell.attribute["border-width"]);xnFixedCell.setAttribute("borderLeftWidth",this.m_objFixedCell.attribute["border-left-width"]);xnFixedCell.setAttribute("borderTopWidth",this.m_objFixedCell.attribute["border-top-width"]);xnFixedCell.setAttribute("borderRightWidth",this.m_objFixedCell.attribute["border-right-width"]);xnFixedCell.setAttribute("borderBottomWidth",this.m_objFixedCell.attribute["border-bottom-width"]);xnFixedCell.setAttribute("borderStyle",this.m_objFixedCell.attribute["border-style"]);xnFixedCell.setAttribute("borderLeftStyle",this.m_objFixedCell.attribute["border-left-style"]);xnFixedCell.setAttribute("borderTopStyle",this.m_objFixedCell.attribute["border-top-style"]);xnFixedCell.setAttribute("borderRightStyle",this.m_objFixedCell.attribute["border-right-style"]);xnFixedCell.setAttribute("borderBottomStyle",this.m_objFixedCell.attribute["border-bottom-style"]);for(var i=this.fixedCols;i<this.cols;i++){var objColumn=this.m_arColumn[i];var xnCol=SBGrid.UT.XmlLib.createChild(xnDatagrid,"col");xnCol.setAttribute("ref",objColumn.attribute.ref);xnCol.setAttribute("width",this.m_arColWidth[i]);xnCol.setAttribute("fontFamily",objColumn.attribute["font-family"]);xnCol.setAttribute("fontSize",objColumn.attribute["font-size"]);xnCol.setAttribute("fontWeight",objColumn.attribute["font-weight"]);xnCol.setAttribute("fontStyle",objColumn.attribute["font-style"]);xnCol.setAttribute("color",objColumn.attribute.color);xnCol.setAttribute("textAlign",objColumn.attribute["text-align"]);xnCol.setAttribute("borderColor",objColumn.attribute["border-color"]);xnCol.setAttribute("borderWidth",objColumn.attribute["border-width"]);xnCol.setAttribute("borderStyle",objColumn.attribute["border-style"]);xnCol.setAttribute("verticalAlign",objColumn.attribute["vertical-align"]);xnCol.setAttribute("backgroundColor",objColumn.attribute["background-color"]);xnCol.setAttribute("textDecoration",objColumn.attribute["text-decoration"]);xnCol.setAttribute("borderLeftColor",objColumn.attribute["border-left-color"]);xnCol.setAttribute("borderTopColor",objColumn.attribute["border-top-color"]);xnCol.setAttribute("borderRightColor",objColumn.attribute["border-right-color"]);xnCol.setAttribute("borderBottomColor",objColumn.attribute["border-bottom-color"]);xnCol.setAttribute("borderLeftWidth",objColumn.attribute["border-left-width"]);xnCol.setAttribute("borderTopWidth",objColumn.attribute["border-top-width"]);xnCol.setAttribute("borderRightWidth",objColumn.attribute["border-right-width"]);xnCol.setAttribute("borderBottomWidth",objColumn.attribute["border-bottom-width"]);xnCol.setAttribute("borderLeftStyle",objColumn.attribute["border-left-style"]);xnCol.setAttribute("borderTopStyle",objColumn.attribute["border-top-style"]);xnCol.setAttribute("borderRightStyle",objColumn.attribute["border-right-style"]);xnCol.setAttribute("borderBottomStyle",objColumn.attribute["border-bottom-style"])}if(this.m_xlRefNode){if(this.isJsonRef()){var arrCloneJsonDt=new Array();for(var i=0;i<this.m_xlRefNode.length;i++){arrCloneJsonDt.push(this.m_xlRefNode[i])}}else{var xnData=SBGrid.UT.XmlLib.createChild(xnDatagrid,"data");for(var i=0;i<this.m_xlRefNode.length;i++){var xnRow=this.m_xlRefNode.item(i);xnData.appendChild(xnRow.cloneNode(true))}}}var xnExcelDownForm=document.getElementById("SBHE___SB_ExcelDownload");var xnExcelDownName=document.getElementById("SBHE___SB_ExcelDownload_Name");var xnExcelDownData=document.getElementById("SBHE___SB_ExcelDownload_Data");var xnExcelDownData1=document.getElementById("SBHE___SB_ExcelDownload_Data1");var xnExcelDownType=document.getElementById("SBHE___SB_ExcelDownload_Type");if(null!=xnExcelDownForm&&null!=xnExcelDownData){var strDocDatagrid="";var strDocDatagrid1="";if(this.isJsonRef()){strDocDatagrid=JSON.stringify(eval(this.jsonref));strDocDatagrid1=SBGrid.UT.XmlLib.serializeToString(docDatagrid);xnExcelDownData1.value=strDocDatagrid1;xnExcelDownType.value="json"}else{strDocDatagrid=SBGrid.UT.XmlLib.serializeToString(docDatagrid);xnExcelDownType.value="xml"}xnExcelDownName.value=strFileName;xnExcelDownData.value=strDocDatagrid;if(SBGrid.DEF.is_chromeFrame){var strPath=SBGrid.DS.XMLStorage.getUniqueStorage().m_objHttpClient.post(strAction,"Name="+SBGrid.UT.URIEncoder.encode(strFileName,"UTF-8")+"&Data="+SBGrid.UT.URIEncoder.encode(strDocDatagrid,"UTF-8"),false,"application/x-www-form-urlencoded","utf-8",false);var heTargetIframe=document.getElementById("SBHE___SB_SaveExcelFrame");if(null!=heTargetIframe){heTargetIframe.src=SBGrid.DEF.__getAppName()+"kr/co/softbowl/jsp/download.jsp?ExcelDown=true&strFilePath="+SBGrid.DEF.__getAppName()+strPath}}else{xnExcelDownForm.setAttribute("action",strAction);xnExcelDownForm.submit()}}};SBGrid.CT.DataGrid.onClickExpansion=function(a,i){var f=this.getCellById(i);var h=document.getElementById("SBHE_"+i);var d=document.getElementById("SBHE_DATAGRID_WHOLE_"+i);var e=document.getElementById("SBHE_DATAGRID_EXPANSION_"+i);if(null!=h){if(!f.bIsExpansion){f.bIsExpansion=true;h.style.width=d.scrollWidth+"px";h.style.height=d.scrollHeight+"px";e.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridReturn;var g=h.offsetLeft+h.offsetWidth;var m=h.offsetTop+h.offsetHeight;var b=window.scrollX+window.innerWidth;var l=window.scrollY+window.innerHeight;var c=((g)>b)&&0<b?b:(g);var n=((m)>l)&&0<l?l:(m);e.style.left=(c-h.offsetLeft-20)+"px";e.style.top=(n-h.offsetTop-20)+"px"}else{f.bIsExpansion=false;h.style.width=f.m_nOriginWidth+"px";h.style.height=f.m_nOriginHeight+"px";e.src=SBGrid.DEF.__getAppName()+SBGrid.DEF.imgGridExpansion;e.style.top=(h.offsetHeight-20)+"px";e.style.left=(h.offsetWidth-20)+"px"}window.setTimeout("SBGrid.getGrid('"+f.id+'\').dispatch("smartexpansion")',0)}};SBGrid.CT.DataGrid.prototype.smartexpansion=function(){};SBGrid.CT.DataGrid.prototype.extendGrid=function(){if(this.bIsExpansion){this.bIsExpansion=false;SBGrid.CT.DataGrid.onClickExpansion(event,this.id)}};SBGrid.CT.DataGrid.prototype.isMerge=function(b,c){if(null!=b&&null!=c){var a=this.getCell(b,c);if(null!=a){if(SBGrid.DEF.SBSM_MERGED==a.mergeType||SBGrid.DEF.SBSM_HIDE==a.mergeType){return true}return false}return false}return false};SBGrid.CT.DataGrid.prototype.merge=function(){this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_arMergeFixedRowList=new Array();this.m_arMergeFixedColList=new Array();this.m_arMergeList=new Array();this.m_htMergeFRColList=new SBGrid.DS.Hashtable();this.m_htMergeFCColList=new SBGrid.DS.Hashtable();this.m_htMergeColList=new SBGrid.DS.Hashtable();this.mergeFixedRows();this.mergeFixedCols();this.mergeDataCells()};SBGrid.CT.DataGrid.prototype.mergeArea=function(b,f,e){if(null==e||""==e){e=","}if(this.isMerge(b,f)){var a=this.getCell(b,f);if(null!=a){a=this.getCellById(a.mergeParentId);var c=a.m_heControl;var d=a.row+e+a.col+e;d+=(a.row+c.rowSpan-1)+e;d+=(a.col+c.colSpan-1);a=null;c=null;return d}return""}else{var a=this.getCell(b,f);if(null!=a){var d=(a.row+e+a.col+e+a.row+e+a.col);a=null;return d}return""}};SBGrid.CT.DataGrid.prototype.mergeByFree=function(c,a,b,d){return};SBGrid.CT.DataGrid.prototype.unmergeByFree=function(c,e){var b=this.getCell(c,e);if(null!=b){if(null!=b.mergeParent){for(var a=0;a<this.m_arMergeByFreeList.length;a++){if(this.m_arMergeByFreeList[a].id==b.mergeParentId){this.m_arMergeByFreeList.splice(a,1);var d=new Array();d.push(b.mergeParent);this.mergeCancellation(d);d=null;return}}}}};SBGrid.CT.DataGrid.prototype.unmergeByFreeAll=function(){this.mergeCancellation(this.m_arMergeByFreeList)};SBGrid.CT.DataGrid.prototype.mergeFreePartMakeCell=function(b,d,a,c){};SBGrid.CT.DataGrid.prototype.appendMergeCellMode=function(){this.setMergeCells(this.mergeCells);this.setMergeCellsFixedCols(this.mergeCellsFixedCols);this.setMergeCellsFixedRows(this.mergeCellsFixedRows)};SBGrid.CT.DataGrid.prototype.setMergeCellsFixedCols=function(a){if(this.autoMerge){if(this.mergeCellsFixedCols!=a){this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.m_htMergeFCColList=new SBGrid.DS.Hashtable()}this.mergeCellsFixedCols=a;this.mergeFixedCols()}else{this.mergeCellsFixedCols=a}};SBGrid.CT.DataGrid.prototype.setMergeCellsFixedRows=function(a){if(this.autoMerge){if(this.mergeCellsFixedRows!=a){this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.m_htMergeFRColList=new SBGrid.DS.Hashtable()}this.mergeCellsFixedRows=a;this.mergeFixedRows()}else{this.mergeCellsFixedRows=a}};SBGrid.CT.DataGrid.prototype.mergeDataCells=function(){var b=null;var a=null;if(0<this.frozenRows){if(0<this.frozenCols){this.mergePartMakeCell(this.fixedRows,this.fixedCols,this.fixedRows+this.frozenRows,(this.fixedCols+this.frozenCols),this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList)}this.mergePartMakeCell(this.fixedRows,(this.fixedCols+this.frozenCols),this.fixedRows+this.frozenRows,this.cols,this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList)}if(0<this.m_nBottomRowCount){if(0<this.frozenCols){this.mergePartMakeCell(this.m_nRealRows-this.m_nBottomRowCount,this.fixedCols,this.m_nRealRows,(this.fixedCols+this.frozenCols),this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList)}this.mergePartMakeCell(this.m_nRealRows-this.m_nBottomRowCount,(this.fixedCols+this.frozenCols),this.m_nRealRows,this.cols,this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList)}var c=this.m_objScroll;if(c.bScrollEvent){b=c.nTopRow;a=c.nBottomRow+1}else{b=this.fixedRows+this.frozenRows;a=this.m_nRealRows-this.m_nBottomRowCount}if(0<this.frozenCols){this.mergePartMakeCell(b,this.fixedCols,a,(this.fixedCols+this.frozenCols),this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList)}this.mergePartMakeCell(b,(this.fixedCols+this.frozenCols),a,this.cols,this.mergeCells,this.m_arMergeList,"cell",this.m_htMergeColList)};SBGrid.CT.DataGrid.prototype.mergeFixedCols=function(){var a=(this.m_bRowHeader)?1:0;if(0<(this.fixedRows+this.frozenRows)){this.mergePartMakeCell(0,a,this.fixedRows,this.fixedCols,this.mergeCellsFixedCols,this.m_arMergeFixedColList,null,this.m_htMergeFCColList)}if(0<this.m_nBottomRowCount){this.mergePartMakeCell(this.m_nRealRows-this.m_nBottomRowCount,a,this.m_nRealRows,this.fixedCols,this.mergeCellsFixedCols,this.m_arMergeFixedColList,null,this.m_htMergeFCColList)}this.mergePartMakeCell(this.fixedRows,a,this.m_nRealRows-this.m_nBottomRowCount,this.fixedCols,this.mergeCellsFixedCols,this.m_arMergeFixedColList,null,this.m_htMergeFCColList)};SBGrid.CT.DataGrid.prototype.mergeFixedRows=function(){if(0<(this.fixedCols+this.frozenCols)){this.mergePartMakeCell(0,0,this.fixedRows,(this.fixedCols+this.frozenCols),this.mergeCellsFixedRows,this.m_arMergeFixedRowList,null,this.m_htMergeFRColList)}this.mergePartMakeCell(0,(this.fixedCols+this.frozenCols),this.fixedRows,this.cols,this.mergeCellsFixedRows,this.m_arMergeFixedRowList,null,this.m_htMergeFRColList)};SBGrid.CT.DataGrid.prototype.mergeCol=function(b){var a=this.m_arColumn[b];if(null!=a){return a.m_bMerge}else{return false}};SBGrid.CT.DataGrid.prototype.setMergeCol=function(c,a){var b=this.m_arColumn[c];if(null!=b){b.m_bMerge=a}if(this.autoMerge){this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_htMergeColList=new SBGrid.DS.Hashtable();this.mergeDataCells()}};SBGrid.CT.DataGrid.prototype.mergeRow=function(c){if(null!=c){for(var b=0;b<this.cols;b++){var a=this.getCell(c,b);if(null!=a){if(SBGrid.DEF.SBSM_MERGED==a.mergeType||SBGrid.DEF.SBSM_HIDE==a.mergeType){return true}}else{return false}}return false}return false};SBGrid.CT.DataGrid.prototype.setMergeRow=function(d,a){for(var c=this.fixedCols;c<this.cols;c++){var b=this.getCell(d,c);if(null!=b){b.m_bMerge=a;if(a){b.mergeType=SBGrid.DEF.SBSM_NORMAL}else{b.mergeType=SBGrid.DEF.SBSM_LOCK}}}if(this.autoMerge){this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_htMergeColList=new SBGrid.DS.Hashtable();this.mergeDataCells()}};SBGrid.CT.DataGrid.prototype.makeMergeTable=function(){var e=document.createElement("div");jQuery(e).addClass("sbgrid_datagrid_MergeTable");var d=document.createElement("table");var c=document.createElement("tbody");var a=document.createElement("tr");var b=document.createElement("td");this.m_heControl.appendChild(e);e.appendChild(d);d.appendChild(c);c.appendChild(a);a.appendChild(b);return a};SBGrid.CT.DataGrid.prototype.gridStatusDiv=function(){if(null==this.m_heHiddenDiv){var a=document.createElement("div");jQuery(a).addClass("sbgrid_StatusDiv");this.m_heControl.insertBefore(a,this.m_heGridWhole.nextSibling);this.m_heControl.insertBefore(this.m_heGridFFCol,a);this.m_heHiddenDiv=a}};SBGrid.CT.DataGrid.prototype.makeScrollDiv=function(d,a){var c=this.m_heGridFFScrollRow.offsetHeight;var b=null!=this.m_xlRefNode?this.m_xlRefNode.length-this.frozenRows:0;b=b<0?0:b;if(null==d){d=document.createElement("div");jQuery(d).addClass("sbgrid_ScrollDiv")}if(a){d.style.height=(c+(b*this.dataHeight))+"px";this.m_heGridWhole.appendChild(d);this.m_heGridScrollDivCell=d;this.m_objScroll.nBottom=d.offsetHeight}else{d.style.height=(b*this.dataHeight)+"px";this.m_heGridFFCol.appendChild(d);this.m_heFFGridScrollDivCell=d}};SBGrid.CT.DataGrid.prototype.reSizeScrollDiv=function(){if(this.m_objScroll.bScrollEvent){var c=this.m_heGridFFScrollRow.offsetHeight;if(null!=this.m_heGridScrollDivCell){var e=this.fixedRows+this.frozenRows;var d=0;for(var a=e;a<this.m_nRealRows;a++){var b=this.m_htRowHeight[a];b=null!=b?b:this.dataHeight;d+=b}this.m_heGridScrollDivCell.style.height=(c+d)+"px";this.m_objScroll.nBottom=this.m_heGridScrollDivCell.offsetHeight;if(null!=this.m_heFFGridScrollDivCell){this.m_heFFGridScrollDivCell.style.height=(d)+"px"}}}else{if(null!=this.m_heGridScrollDivCell){this.m_heGridScrollDivCell.style.height="0px"}if(null!=this.m_heFFGridScrollDivCell){this.m_heFFGridScrollDivCell.style.height="0px"}}};SBGrid.CT.DataGrid.prototype.getMergePartRowHeight=function(d,b){var a=0;for(var c=d;c<b;c++){if(this.m_htRowHeight[c]){a+=this.m_htRowHeight[c]}else{a+=this.dataHeight}}return a};SBGrid.CT.DataGrid.prototype.getMergePartColWidth=function(a,d){var b=0;for(var c=a;c<d;c++){b+=this.m_arColWidth[c]}return b};SBGrid.CT.DataGrid.prototype.mergeCellTrPosition=function(a,d){var c=this.m_objScroll;if(a<(this.fixedRows+this.frozenRows)){return a}else{if(a>=(this.m_nRealRows-this.frozenBottomRows)){if(this.m_nRealRows<this.fixedRows+this.frozenRows+this.frozenBottomRows){return a-(this.fixedRows+this.frozenRows)}return a-(this.m_nRealRows-this.frozenBottomRows)}else{if(d<(this.fixedCols+this.frozenCols)){return a-c.nTopRow}else{var b=this.fixedRows+this.frozenRows;return b+(a-c.nTopRow)}}}};SBGrid.CT.DataGrid.prototype._gridLastCol=function(){var a=0;for(var b=this.fixedCols;b<this.cols;b++){if(0==this.m_arColWidth[b]){continue}else{a=b}}return a};SBGrid.CT.DataGrid.prototype.clearMerge=function(){if(0<this.m_arMergeList.length){this.m_bScrollMergeCell=true}this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.mergeCancellation(this.m_arMergeFixedColList,this.m_htMergeFCColList);this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_arMergeFixedRowList=new Array;this.m_arMergeFixedColList=new Array;this.m_arMergeByFreeList=new Array;this.m_htMergeFRColList=new SBGrid.DS.Hashtable();this.m_htMergeFCColList=new SBGrid.DS.Hashtable();this.m_htMergeColList=new SBGrid.DS.Hashtable();this.m_arMergeList=new Array;var a=this.getCaption();if(a.indexOf("|")!=-1){this.mergeFixedRows()}};SBGrid.CT.DataGrid.prototype.mergeCancellation=function(c,f){var d=(!(SBGrid.DEF.is_mozBrowser))?1:0;for(var t=0;t<c.length;t++){var m=c[t];if(null!=m){var A=m.row;var x=m.col;var y=m.m_heControl;var q=SBGrid.DEF.is_smartphone?A:this.mergeCellTrPosition(A,x);var w=m.m_nColSpan;var u=m.m_nRowSpan;var a=this.m_htRowHeight[A];a=null!=a?a:this.dataHeight;var p=a-d;y.style.height=p>-1?p+"px":"0px";y.rowSpan=1;y.colSpan=1;m.m_nRowSpan=1;m.m_nColSpan=1;var h=null;var l=null;if(SBGrid.DEF.is_firefox){h=y.parentNode;l=h.parentNode}else{h=y.parentElement;l=h.parentElement}for(var s=0;s<u;s++){var n=null;var b=l.children[q+s];for(var r=0;r<w;r++){if(0==s&&0==r){continue}if(null!=b.children[x+r]){n=b.children[x+r]}var g=this.getCell(A+s,x+r);if(null!=g){if(null==n){b.appendChild(g.m_heControl)}else{b.insertBefore(g.m_heControl,n)}g.mergeParentId=null;if(SBGrid.DEF.SBSM_LOCK!=g.mergeType){g.mergeType=SBGrid.DEF.SBSM_NORMAL}}}}m.mergeParentId=null;if(SBGrid.DEF.SBSM_LOCK!=m.mergeType){m.mergeType=SBGrid.DEF.SBSM_NORMAL}}}if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){for(var z in f){var o=f[z];jQuery('col[colNum="'+z+'"][targetCol="'+o.targetCol+'"]').css("width",(o.width)+"px")}}f=new SBGrid.DS.Hashtable();c=new Array();if(SBGrid.DEF.is_ie9){if(null!=this.m_arIe9MergeCellWidth){for(var t=0;t<this.m_arIe9MergeCellWidth.length;t++){var e=this.m_arIe9MergeCellWidth[t].target;var v=this.m_arIe9MergeCellWidth[t].width;e.style.width=v}this.m_arIe9MergeCellWidth=null}}};SBGrid.CT.DataGrid.prototype.setMergeCellResize=function(e,a){for(var d=0;d<this.cols;d++){for(var b=e;b>=0;b--){var c=this.getCell(b,d);if(null!=c){if(SBGrid.DEF.SBSM_HIDE==c.mergeType){continue}else{if(SBGrid.DEF.SBSM_MERGED==c.mergeType&&1<c.m_nRowSpan){var f=parseInt(c.m_heControl.style.height);c.m_heControl.style.height=(f+a)+"px"}else{if(SBGrid.DEF.SBSM_NORMAL==c.mergeType){break}}}}else{break}}}};SBGrid.CT.DataGrid.prototype.mergePartMakeCell=function(o,b,G,A,n,h,p,q){var y=(!(SBGrid.DEF.is_mozBrowser))?1:0;var x=this._gridLastCol();switch(n){case"never":break;case"bycol":var r=null;var F=null;var f=null;for(var L=b;L<A;L++){F=this.m_arColumn[L];for(var K=o;K<G;K++){var c=this.m_arHiddenRowState[K];if(c){continue}r=this.getCell(K,L);if(null!=r&&null!=F){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}f=r.m_heControl;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var D=SBGrid.CF.GridGetWindowText(r);var N=r.m_nRowSpan;var g=null;for(var H=K+N;H<G;H++){var c=this.m_arHiddenRowState[H];if(c){break}g=this.getCell(H,L);if(null!=g){var M=SBGrid.CF.GridGetWindowText(g);if(D==M&&SBGrid.DEF.SBSM_LOCK!=g.mergeType&&g.m_bMerge){B=true;g.mergeType=SBGrid.DEF.SBSM_HIDE;g.mergeParentId=r.id;this.m_heGridMergeCell.appendChild(g.m_heControl);N++}else{break}}else{break}}if(B){f.style.height=(this.getMergePartRowHeight(K,H)-y)+"px";f.rowSpan=N;if(SBGrid.DEF.SBSM_MERGED!=r.mergeType){h.push(r)}r.m_nRowSpan=N;r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id}g=null}f=null}r=null}}break;case"byrow":var r=null;var F=null;var f=null;for(var L=o;L<G;L++){for(var K=b;K<A;K++){F=this.m_arColumn[K];r=this.getCell(L,K);if(null!=r&&null!=F){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}f=r.m_heControl;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var v=false;var D=SBGrid.CF.GridGetWindowText(r);var N=r.m_nColSpan;var t=null;for(var H=K+N;H<A;H++){F=this.m_arColumn[H];t=this.getCell(L,H);if(null!=t&&null!=F){if(!F.m_bMerge){t.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==t.mergeType){t.mergeType=SBGrid.DEF.SBSM_NORMAL}}var P=SBGrid.CF.GridGetWindowText(t);if(D==P&&SBGrid.DEF.SBSM_LOCK!=t.mergeType&&t.m_bMerge){B=true;if(SBGrid.DEF.is_ie9){if(H==x){v=true}}t.mergeType=SBGrid.DEF.SBSM_HIDE;t.mergeParentId=r.id;if(null==q[this.id+"_"+H]){q[this.id+"_"+H]={targetCol:t.m_heControl.getAttribute("targetcell"),width:this.m_arColWidth[H]}}this.m_heGridMergeCell.appendChild(t.m_heControl);N++}else{break}}else{break}}if(B){f.colSpan=N;if(SBGrid.DEF.SBSM_MERGED!=r.mergeType){h.push(r)}r.m_nColSpan=N;r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id;if((SBGrid.DEF.is_ie9)&&v){var C=f.parentNode.parentNode;var l=C.querySelectorAll("td[colNum="+this.id+"_"+x+"]");if(0==l.length){var w=C.parentNode;var J=w.querySelector("col[colNum="+this.id+"_"+K+"]");if(null!=J){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:J,width:J.style.width,nStartCol:K,nLastCol:x});J.style.width=this.getMergePartColWidth(K,H)+"px"}}}}t=null}f=null}r=null}}break;case"bycolrec":var r=null;var F=null;var f=null;for(var L=b;L<A;L++){F=this.m_arColumn[L];for(var K=o;K<G;K++){var c=this.m_arHiddenRowState[K];if(c){continue}r=this.getCell(K,L);if(null!=r&&null!=F){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}f=r.m_heControl;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var D=SBGrid.CF.GridGetWindowText(r);var N=r.m_nRowSpan;var g=null;for(var H=K+N;H<G;H++){var c=this.m_arHiddenRowState[H];if(c){break}g=this.getCell(H,L);if(null!=g){var M=SBGrid.CF.GridGetWindowText(g);if(D==M&&SBGrid.DEF.SBSM_LOCK!=g.mergeType&&g.m_bMerge){B=true;g.mergeType=SBGrid.DEF.SBSM_HIDE;g.mergeParentId=r.id;this.m_heGridMergeCell.appendChild(g.m_heControl);N++}else{break}}else{break}}if(B){f.style.height=(this.getMergePartRowHeight(K,H)-y)+"px";f.rowSpan=N;if(SBGrid.DEF.SBSM_MERGED!=r.mergeType){h.push(r)}r.m_nRowSpan=N;r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id}g=null}f=null}r=null}}for(var L=o;L<G;L++){for(var K=b;K<A;K++){F=this.m_arColumn[K];r=this.getCell(L,K);if(null!=r&&null!=F){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}var f=null;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var v=false;var I=false;var D=SBGrid.CF.GridGetWindowText(r);f=r.m_heControl;var N=r.m_nColSpan;for(var H=K+N;H<A;H++){F=this.m_arColumn[H];var t=this.getCell(L,H);if(null!=t&&null!=F){if(!F.m_bMerge){t.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==t.mergeType){t.mergeType=SBGrid.DEF.SBSM_NORMAL}}var P=SBGrid.CF.GridGetWindowText(t);if(D==P&&SBGrid.DEF.SBSM_LOCK!=t.mergeType&&r.mergeType==t.mergeType&&r.m_nRowSpan==t.m_nRowSpan&&t.m_bMerge){if(SBGrid.DEF.is_ie9){if(H==x){v=true}}var E=t.m_heControl;if(SBGrid.DEF.SBSM_MERGED==t.mergeType){I=true}B=true;t.mergeType=SBGrid.DEF.SBSM_HIDE;t.mergeParentId=r.id;if(null==q[this.id+"_"+H]){q[this.id+"_"+H]={targetCol:t.m_heControl.getAttribute("targetcell"),width:this.m_arColWidth[H]}}this.m_heGridMergeCell.appendChild(E);E.rowSpan=1;N++}else{break}}else{break}}if(B){f.colSpan=N;r.m_nColSpan=N;if(!I){r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id;h.push(r)}if((SBGrid.DEF.is_ie9)&&v){var C=f.parentNode.parentNode;var l=C.querySelectorAll("td[colNum="+this.id+"_"+x+"]");if(0==l.length){var w=C.parentNode;var J=w.querySelector("col[colNum="+this.id+"_"+K+"]");if(null!=J){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:J,width:J.style.width,nStartCol:K,nLastCol:x});J.style.width=this.getMergePartColWidth(K,H)+"px"}}}}}f=null}r=null}}break;case"byrowrec":var F=null;var r=null;var f=null;for(var L=o;L<G;L++){for(var K=b;K<A;K++){F=this.m_arColumn[K];r=this.getCell(L,K);if(null!=r&&null!=F){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}f=r.m_heControl;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var v=false;var D=SBGrid.CF.GridGetWindowText(r);var N=r.m_nColSpan;var t=null;for(var H=K+N;H<A;H++){F=this.m_arColumn[H];t=this.getCell(L,H);if(null!=t&&null!=F){if(!F.m_bMerge){t.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==t.mergeType){t.mergeType=SBGrid.DEF.SBSM_NORMAL}}var P=SBGrid.CF.GridGetWindowText(t);if(D==P&&SBGrid.DEF.SBSM_LOCK!=t.mergeType&&t.m_bMerge){if(SBGrid.DEF.is_ie9){if(H==x){v=true}}B=true;t.mergeType=SBGrid.DEF.SBSM_HIDE;t.mergeParentId=r.id;if(null==q[this.id+"_"+H]){q[this.id+"_"+H]={targetCol:t.m_heControl.getAttribute("targetcell"),width:this.m_arColWidth[H]}}this.m_heGridMergeCell.appendChild(t.m_heControl);N++}else{break}}else{break}}if(B){f.colSpan=N;if(SBGrid.DEF.SBSM_MERGED!=r.mergeType){h.push(r)}r.m_nColSpan=N;r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id;if((SBGrid.DEF.is_ie9)&&v){var C=f.parentNode.parentNode;var l=C.querySelectorAll("td[colNum="+this.id+"_"+x+"]");if(0==l.length){var w=C.parentNode;var J=w.querySelector("col[colNum="+this.id+"_"+K+"]");if(null!=J){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:J,width:J.style.width,nStartCol:K,nLastCol:x});J.style.width=this.getMergePartColWidth(K,H)+"px"}}}}t=null}f=null}r=null}}for(var L=b;L<A;L++){F=this.m_arColumn[L];for(var K=o;K<G;K++){var c=this.m_arHiddenRowState[K];if(c){continue}r=this.getCell(K,L);if(null!=r){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}var f=null;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var I=false;D=SBGrid.CF.GridGetWindowText(r);f=r.m_heControl;var g=null;var N=r.m_nRowSpan;for(var H=K+N;H<G;H++){var c=this.m_arHiddenRowState[H];if(c){break}g=this.getCell(H,L);if(null!=g){var M=SBGrid.CF.GridGetWindowText(g);if(D==M&&SBGrid.DEF.SBSM_LOCK!=g.mergeType&&r.mergeType==g.mergeType&&r.m_nColSpan==g.m_nColSpan&&g.m_bMerge){var E=g.m_heControl;if(SBGrid.DEF.SBSM_MERGED==g.mergeType){E.style.width=this.m_arColWidth[L]+"px";I=true}B=true;g.mergeType=SBGrid.DEF.SBSM_HIDE;g.mergeParentId=r.id;this.m_heGridMergeCell.appendChild(E);E.colSpan=1;N++}else{break}}else{break}}if(B){f.style.height=(this.getMergePartRowHeight(K,H)-y)+"px";f.rowSpan=N;r.m_nRowSpan=N;if(!I){r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id;var z=0;var u=true;while(z<h.length){if(r.col<h[z].col){h.splice(z,0,r);u=false;break}z++}if(u){h.push(r)}}}}f=null}r=null}}break;case"byrestriccol":var r=null;var F=null;var f=null;for(var L=b;L<A;L++){F=this.m_arColumn[L];for(var K=o;K<G;K++){var c=this.m_arHiddenRowState[K];if(c){continue}r=this.getCell(K,L);if(null!=r&&null!=F){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}f=r.m_heControl;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var D=SBGrid.CF.GridGetWindowText(r);var N=r.m_nRowSpan;var g=null;var m=G;var e=this.getCell(K,L-1);if(null!=e){if(null!=e.mergeParentId){e=this.getCellById(e.mergeParentId)}if(L-1>=this.fixedCols){m=e.row+e.m_nRowSpan}}for(var H=K+N;H<G&&H<m;H++){var c=this.m_arHiddenRowState[H];if(c){break}g=this.getCell(H,L);if(null!=g){var M=SBGrid.CF.GridGetWindowText(g);if(D==M&&SBGrid.DEF.SBSM_LOCK!=g.mergeType&&g.m_bMerge){B=true;g.mergeType=SBGrid.DEF.SBSM_HIDE;g.mergeParentId=r.id;this.m_heGridMergeCell.appendChild(g.m_heControl);N++}else{break}}else{break}}if(B){f.style.height=(this.getMergePartRowHeight(K,H)-y)+"px";f.rowSpan=N;if(SBGrid.DEF.SBSM_MERGED!=r.mergeType){h.push(r)}r.m_nRowSpan=N;r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id}g=null}f=null}r=null}}break;case"byrestricrow":var r=null;var F=null;var f=null;for(var L=o;L<G;L++){for(var K=b;K<A;K++){F=this.m_arColumn[K];r=this.getCell(L,K);if(null!=r&&null!=F){if(!F.m_bMerge){r.mergeType=SBGrid.DEF.SBSM_LOCK;continue}else{if(SBGrid.DEF.SBSM_LOCK==r.mergeType){r.mergeType=SBGrid.DEF.SBSM_NORMAL}}f=r.m_heControl;if(SBGrid.DEF.SBSM_NORMAL==r.mergeType||SBGrid.DEF.SBSM_MERGED==r.mergeType){var B=false;var v=false;var D=SBGrid.CF.GridGetWindowText(r);var N=r.m_nColSpan;var t=null;var a=A;var O=this.getCell(L-1,K);if(null!=O){if(null!=O.mergeParentId){O=this.getCellById(O.mergeParentId)}if(L-1>=this.fixedRows){a=O.col+O.m_nColSpan}}for(var H=K+N;H<A&&H<a;H++){F=this.m_arColumn[H];t=this.getCell(L,H);if(null!=t&&null!=F){if(!F.m_bMerge){t.mergeType=SBGrid.DEF.SBSM_LOCK;break}else{if(SBGrid.DEF.SBSM_LOCK==t.mergeType){t.mergeType=SBGrid.DEF.SBSM_NORMAL}}var P=SBGrid.CF.GridGetWindowText(t);if(D==P&&SBGrid.DEF.SBSM_LOCK!=t.mergeType&&t.m_bMerge){B=true;if(SBGrid.DEF.is_ie9){if(H==x){v=true}}t.mergeType=SBGrid.DEF.SBSM_HIDE;t.mergeParentId=r.id;if(null==q[this.id+"_"+H]){q[this.id+"_"+H]={targetCol:t.m_heControl.getAttribute("targetcell"),width:this.m_arColWidth[H]}}this.m_heGridMergeCell.appendChild(t.m_heControl);N++}else{break}}else{break}}if(B){f.colSpan=N;if(SBGrid.DEF.SBSM_MERGED!=r.mergeType){h.push(r)}r.m_nColSpan=N;r.mergeType=SBGrid.DEF.SBSM_MERGED;r.mergeParentId=r.id;if((SBGrid.DEF.is_ie9)&&v){var C=f.parentNode.parentNode;var l=C.querySelectorAll("td[colNum="+this.id+"_"+x+"]");if(0==l.length){var w=C.parentNode;var J=w.querySelector("col[colNum="+this.id+"_"+K+"]");if(null!=J){if(null==this.m_arIe9MergeCellWidth){this.m_arIe9MergeCellWidth=new Array()}this.m_arIe9MergeCellWidth.push({target:J,width:J.style.width,nStartCol:K,nLastCol:x});J.style.width=this.getMergePartColWidth(K,H)+"px"}}}}t=null}f=null}r=null}}break}if(SBGrid.DEF.is_ie6||SBGrid.DEF.is_ie7){for(var s in q){var d=q[s];jQuery('col[colNum="'+s+'"][targetCol="'+d.targetCol+'"]').css("width",(d.width+1)+"px")}}};SBGrid.CT.DataGrid.prototype.setCellTooltip=function(b,d,c){if(null==b||null==d||null==c){if(null!=window.console){console.log("setCellTooltip()에 대한 올바른 인자값이 아닙니다.")}return}var a=this.getCell(b,d);if(null!=a){if(null!=a.m_heControl){a.m_heControl.title=c}}};SBGrid.CT.DataGrid.prototype.getCellTooltip=function(b,c){if(null==b||null==c){if(null!=window.console){console.log("getCellTooltip()에 대한 올바른 인자값이 아닙니다.")}return""}var a=this.getCell(b,c);if(null!=a){if(null!=a.m_heControl){return a.m_heControl.title}}};SBGrid.CT.DataGrid.prototype.isPhysicalRow=function(a){if((a>=this.fixedRows&&a<this.fixedRows+this.frozenRows)||(a>=this.m_objScroll.nTopRow&&a<=this.m_objScroll.nBottomRow)||(a>=this.m_nRealRows-this.frozenBottomRows&&a<this.m_RealRows)){return true}return false};SBGrid.CT.DataGrid.prototype.scrolButtonClick=function(e,d){if(this.mbScrollRock){return}this.m_bScrollRock=true;this.m_objScroll.nPosition=d;var c=d+this.m_objScroll.nScrollDivHeight/2;var b=this.m_objScroll.nTargetTop+this.m_objScroll.nTargetHeight/2;var a=Math.ceil((Math.abs(e)/this.dataHeight));if(0>e&&this.m_objScroll.bDownProcess){if(b-c<0){this.scrollUpDownTable(true,a)}}else{if(this.m_objScroll.bUpProcess){if(b-c>0){this.scrollUpDownTable(false,a)}}}this.m_bScrollRock=false};SBGrid.CT.DataGrid.prototype.isScrollPosition=function(a){var b=this.m_objScroll;if(b.bScrollEvent){return b.nTopRow<=a&&a<=b.nBottomRow}b=null;return false};SBGrid.CT.DataGrid.prototype.setScrollDivRow=function(c,a){if(a){var b=parseInt(this.m_heGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b-this.m_htRowHeight[c]):b-this.dataHeight;this.m_heGridScrollDivCell.style.height=b+"px";if(null!=this.m_heGridFFCol){b=parseInt(this.m_heFFGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b-this.m_htRowHeight[c]):b-this.dataHeight;this.m_heFFGridScrollDivCell.style.height=b+"px"}}else{var b=parseInt(this.m_heGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b+this.m_htRowHeight[c]):b+this.dataHeight;this.m_heGridScrollDivCell.style.height=b+"px";if(null!=this.m_heGridFFCol){b=parseInt(this.m_heFFGridScrollDivCell.style.height);b=null!=this.m_htRowHeight[c]?(b+this.m_htRowHeight[c]):b+this.dataHeight;this.m_heFFGridScrollDivCell.style.height=b+"px"}}};SBGrid.CT.DataGrid.prototype.setScrollDisplayRow=function(e,b,f){var g=this.m_objScroll;var a=null;if("none"==b){for(var d=0;d<g.arTargetRow.length;d++){if(g.arTargetRow[d]==e){a=this.isScrollPosition(d);if(a&&!f){this.gridCellUnInit(g.nTopRow,g.nBottomRow)}else{if(!f){if(null==this.m_scrollSetTime){this.gridCellUnInit(g.nTopRow,g.nBottomRow);this.m_scrollSetTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);SBGrid.getGrid('"+this.id+"').m_scrollSetTime = null;",0)}}}g.arTargetRow.splice(d,1);if(g.nEndRow>g.nStartRow){g.nEndRow--}break}}}else{var c=true;for(var d=0;d<g.arTargetRow.length;d++){if(g.arTargetRow[d]==e){return}}for(var d=0;d<g.arTargetRow.length;d++){if(g.arTargetRow[d]>e){a=this.isScrollPosition(d);if(a&&!f){this.gridCellUnInit(g.nTopRow,g.nBottomRow)}else{if(!f){if(null==this.m_scrollSetTime){this.gridCellUnInit(g.nTopRow,g.nBottomRow);this.m_scrollSetTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);SBGrid.getGrid('"+this.id+"').m_scrollSetTime = null;",0)}}}g.arTargetRow.splice(d,0,e);if(g.nEndRow<this.m_nRealRows-g.nMaxLength){g.nEndRow++}c=false;break}}if(c){a=this.isScrollPosition(d);if(a&&!f){this.gridCellUnInit(g.nTopRow,g.nBottomRow)}else{if(!f){if(null==this.m_scrollSetTime){this.gridCellUnInit(g.nTopRow,g.nBottomRow);this.m_scrollSetTime=window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);SBGrid.getGrid('"+this.id+"').m_scrollSetTime = null;",0)}}}g.arTargetRow.push(e);if(g.nEndRow<this.m_nRealRows-g.nMaxLength){g.nEndRow++}}}if(a&&!f){this.scrollTableReDraw()}};SBGrid.CT.DataGrid.prototype.scrollUpDownTable=function(a,b){this.clearMerge();var c=null;var d=null;var e=this.m_objScroll;this.gridCellUnInit(e.nTopRow,e.nBottomRow);if(a){b=b>((e.arTargetRow.length)-this.frozenBottomRows-1)-e.nBottomRow?((e.arTargetRow.length)-this.frozenBottomRows-1)-e.nBottomRow:b;e.nTargetTop=e.nTargetTop+(this.dataHeight*b);c=e.nTopRow+b;d=e.nBottomRow+b}else{b=b>e.nTopRow-this.fixedRows?e.nTopRow-this.fixedRows:b;e.nTargetTop=e.nTargetTop-(this.dataHeight*b);c=e.nTopRow-b;d=e.nBottomRow-b}e.heTargetTable.style.top=e.nTargetTop+"px";e.heTargetFFCTable.style.top=e.nTargetTop+"px";e.nTopRow=c;e.nBottomRow=d;this.scrollTableReDraw();e.bUpProcess=this.fixedRows+this.frozenRows!=c;e.bDownProcess=((e.arTargetRow.length)-this.frozenBottomRows-1)!=d;if(this.autoResize){this.autoResizeHeight();this.reSizeScrollDiv();this.scrollAttributeSetting()}if(this.m_bScrollMergeCell){this.m_bScrollMergeCell=false;this.merge()}};SBGrid.CT.DataGrid.prototype.scrollingGrid=function(c){this.closePopUp();var n=this.m_objScroll;if(n.arScrollLength.length>1){n.arScrollLength.shift();return}if(this.mbScrollRock){return}this.m_bScrollRock=true;if(c){this.clearMerge()}this.showWait(false);var d=null;var f=null;n.nPosition=this.m_heGridWhole.scrollTop;var g=n.nPosition+(n.nScrollDivHeight/2)-(n.nTargetHeight/2);var a=null;if(this.autoResize){var e=g;var b=0;for(var l=0;l<this.m_nRealRows;l++){var h=this.m_htRowHeight[l];h=null!=h?h:this.dataHeight;e-=h;if(e<=0){break}b++}a=b+this.frozenRows}else{a=parseInt(g/this.dataHeight)+this.frozenRows}if(a<n.nStartRow){a=n.nStartRow}else{if(a>n.nEndRow){a=n.nEndRow}}this.gridCellUnInit(n.nTopRow,n.nBottomRow);d=a;f=n.nBottomRow-n.nTopRow+a;if(this.autoResize){var m=(a);var e=0;for(var l=this.fixedRows+this.frozenRows;l<m;l++){var h=this.m_htRowHeight[l];h=null!=h?h:this.dataHeight;e+=h}n.nTargetTop=e}else{n.nTargetTop=this.dataHeight*(a-this.fixedRows-this.frozenRows)}n.heTargetTable.style.top=n.nTargetTop+"px";n.heTargetFFCTable.style.top=n.nTargetTop+"px";n.nTopRow=d;n.nBottomRow=f;n.arScrollLength=new Array();this.scrollTableReDraw();n.bUpProcess=this.fixedRows+this.frozenRows!=d;n.bDownProcess=(this.m_nRealRows-this.frozenBottomRows-1)!=f;if(this.autoResize){this.autoResizeHeight();this.reSizeScrollDiv();this.scrollAttributeSetting()}if(this.m_bScrollMergeCell){this.m_bScrollMergeCell=false;this.merge()}if(null!=this.m_heGridWhole&&this.m_heGridFFScrollRow){this.m_heGridFFScrollRow.scrollLeft=this.m_heGridWhole.scrollLeft;this.m_heGridFFBScrollRow.scrollLeft=this.m_heGridWhole.scrollLeft}this.m_bScrollRock=false;this.m_bDown=false};SBGrid.CT.DataGrid.prototype.setTableMatrix=function(b,g){var f=this.m_objScroll.arTargetRow;this.m_arTempMatrix=new Array();var a=0;for(var e=b;e<=g;e++){this.m_arTempMatrix.push({data:new Array(),hidden:false});for(var c=0;c<this.cols;c++){var d=this.getCell(f[e],c);if(null!=d){this.m_arTempMatrix[a].data[c]={first:d.m_heControl,last:d.m_heDataControl}}}a++}a=null;f=null};SBGrid.CT.DataGrid.prototype.gridCellUnInit=function(a,f){var e=this.m_objScroll.arTargetRow;for(var d=a;d<=f;d++){if(this.autoResize){jQuery("td[rowNum='"+this.id+"_"+d+"']").attr("rowNum","").css("height",(this.dataHeight-1)+"px")}for(var b=0;b<this.cols;b++){var c=this.getCell(e[d],b);if(null!=c){SBGrid.CF.GridUnInit(c)}}}e=null};SBGrid.CT.DataGrid.prototype.scrollTableReDraw=function(){if(!this.m_objScroll.bScrollEvent){return}var g=this.m_objScroll.arTargetRow;var x=this.m_objScroll.nTopRow;x=x<this.m_objScroll.nStartRow?this.m_objScroll.nStartRow:x;var b=this.m_objScroll.nBottomRow;var e=null;var c=0;var f;var y=this.m_replaceString;if(y!=""&&y!="undefined"&&y!=null){f=y.split("?")}var a=new Array();for(var t=0;t<this.cols;t++){if((SBGrid.DEF.is_ie)&&(!SBGrid.DEF.is_ie7)){if(this.m_arColumn[t].m_bHiddenState||0==this.m_arHiddenCol[t]){a[t]="display:none;"}else{a[t]=""}}else{a[t]=""}}for(var t=x;t<=b&&t<g.length;t++){var A=g[t];var q=this.m_objGroup[A];var p=null!=this.m_htRowHeight[A]?this.m_htRowHeight[A]:this.dataHeight;p=!(SBGrid.DEF.is_mozBrowser)&&p>0?p-1:p;if(""!=this.backColorAlternate&&(((A)-this.fixedRows)%2)==1){e=true}else{e=false}for(var s=0;s<this.cols;s++){var m=this.m_arColumn[s];if(SBGrid.DEF.is_mozBrowser&&(SBGrid.DEF.SBIT_INPUTBUTTON==m.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==m.m_nInputType)){p-=2}var n=this.getCell(A,s);if("true"==this.attribute.scrollmakecell){n=this.makeGridCell(A,s)}if(null!=n){if(s==0){if(this.m_arTempMatrix[c].hidden){var r=this.m_arTempMatrix[c].data[s].first;if(SBGrid.DEF.is_firefox){r.parentNode.style.display=""}else{r.parentNode.style.display=""}}}var l=this.m_arTempMatrix[c].data[s];l.first.id="SBHE_"+this.id+"_"+(A)+"_"+s;l.first.setAttribute("rowNum",this.id+"_"+A);if(null!=l.last){l.last.id=this.id+"_"+(A)+"_"+s+"_data"}var d=new Array();var z=this.isFrozenCell(A,s);var u="";d[0]="height:"+p+"px;"+u;d[1]=(this.fixedCols<=s)&&e&&""!=this.backColorAlternate?"background-color:"+this.backColorAlternate+";":"";d[1]=z&&""!=this.backColorFrozen?"background-color:"+this.backColorFrozen+";":d[1];d[2]=z&&""!=this.foreColorFrozen?"color:"+this.foreColorFrozen+";":"";d[3]="";if(null!=this.m_arCellStyleTable[A]){d[3]=null!=this.m_arCellStyleTable[A][s]?this.m_arCellStyleTable[A][s]:""}d[4]=a[s];l.first.style.cssText=d.join("");SBGrid.CF.GridInit(n);if(null!=q&&s==this.groupCol&&0<this.group){if(null!=n.m_heControl){var o=n.m_heControl.firstChild.firstChild.firstChild.firstChild;var u=(18*q.depth)+"px";var w=null!=this.m_objGroup[A+1]&&(q.depth+1)==this.m_objGroup[A+1].depth;o.className=w?(q.collapsed?this.m_objTreeClass.plus:this.m_objTreeClass.subtraction):this.m_objTreeClass.normal;o.style.width=u;o.setAttribute("row",A);q.isChild=w;q.heControl=o}}if(this.fixedCols<=s){this.setCellSelect(n,n.selected);SBGrid.CF.GridSetTextRefresh(n,SBGrid.CF.GridGetText(n),f)}else{if(null!=n.text&&""!=n.text){SBGrid.CF.GridSetFixedWindowText(n,n.text)}else{if(s==0&&this.m_bRowHeader){if("seq"==this.rowheader){var v=String(A-this.fixedRows+1);SBGrid.CF.GridSetFixedWindowText(n,v)}else{if("reverseseq"==this.rowheader){var v=String(this.m_nRealRows-A);SBGrid.CF.GridSetFixedWindowText(n,v)}}}}}}}c++}if(c!=this.m_arTempMatrix.length){for(var t=c;t<this.m_arTempMatrix.length;t++){this.m_arTempMatrix[t].hidden=true;var h=this.m_arTempMatrix[t].data[0].first;if(SBGrid.DEF.is_firefox){h.parentNode.style.display="none"}else{h.parentNode.style.display="none"}}}x=null;b=null;c=null;g=null;a=null};SBGrid.CT.DataGrid.prototype.scrollingCellStyle=function(b,c){var a=this.getCell(b,c);if(null!=a){if(null!=a.m_heControl){if(""!=this.backColorAlternate&&((b-this.fixedRows)%2)==1){strBGColor=this.backColorAlternate}else{strBGColor=""}a.m_heControl.style.backgroundColor=strBGColor;if(j<(this.fixedCols+this.frozenCols)){if(""!=this.backColorFrozen){a.m_heControl.style.backgroundColor=this.backColorFrozen}if(""!=this.foreColorFrozen){a.m_heControl.style.color=this.foreColorFrozen}}}}};SBGrid.CT.DataGrid.prototype.applyScrollCellStyle=function(b){if(null!=b){for(var a in b.m_objCellStyle){if(SBGrid.DEF.SB_STYLELIST[a]){b.setAttribute(a,b.m_objCellStyle[a])}}}};SBGrid.CT.DataGrid.prototype.reSetScrollRowVisible=function(c,a){for(var b=c;b<=a;b++){if(true==this.m_arHiddenRowState[b]){this.setRowDisplay(b,"")}}};SBGrid.CT.DataGrid.prototype.reSetScrollRowHidden=function(c,a){for(var b=c;b<=a;b++){if(true==this.m_arHiddenRowState[b]){this.setRowDisplay(b,"none")}}};SBGrid.CT.DataGrid.prototype.isJsonRef=function(){if(this.jsonref!=null&&this.jsonref!=""){return true}else{return false}};SBGrid.CT.DataGrid.prototype.setLinkedData=function(b,a,c){if(this.isJsonRef()){b.setJsonObject(c)}else{b.setNodeElement(a)}};SBGrid.CT.DataGrid.prototype.setCellSelect=function(f,a,c){if(!c){f.selected=a}var g=f.m_heControl;if(null!=g){var b=g.getAttribute("sbgrid_select");var e=this.attribute.cellfocusclass;if(a&&"true"!=b){var d=jQuery(g);if(null!=e&&f.row==this.row&&f.col==this.col){d.addClass(e)}else{d.addClass("sbgrid_"+this.id+"_focusColor")}d.attr("sbgrid_select","true")}else{if(!a&&"false"!=b){var d=jQuery(g);if(null!=e){d.removeClass(e)}d.removeClass("sbgrid_"+this.id+"_focusColor").attr("sbgrid_select","false")}}b=null}g=null};SBGrid.CT.DataGrid.prototype.setOverflowGrid=function(a){switch(a){case"visible":this.m_heControl.style.overflowX="visible";this.m_heControl.style.overflowY="visible";if(null!=this.m_heGridWhole){this.m_heGridWhole.style.overflowX="visible";this.m_heGridWhole.style.overflowY="visible"}this.resetHeightOverflow(a);break;case"hidden":this.m_heControl.style.overflowX="hidden";this.m_heControl.style.overflowY="hidden";if(null!=this.m_heGridWhole){this.m_heGridWhole.style.overflowX="hidden";this.m_heGridWhole.style.overflowY="hidden"}this.resetHeightOverflow(a);break;case"scroll":this.m_heControl.style.overflowX="hidden";this.m_heControl.style.overflowY="hidden";this.resetHeightOverflow(a);this.setScrollGrid(this.attribute.scroll);break;default:break}};SBGrid.CT.DataGrid.prototype.resetHeightOverflow=function(b){if(null!=this.m_heGridWhole){var c=this.m_heGridWhole.firstChild;if("visible"==b){var a=document.getElementById("SBHE_"+this.id+"_VLine").clientHeight;this.m_heControl.style.height=(c.clientHeight+a)+"px";this.m_heControl.style.width=(c.clientWidth+a)+"px"}else{this.m_heControl.style.width=this.getAttribute("width");this.m_heControl.style.height=this.getAttribute("height")}}};SBGrid.CT.DataGrid.prototype.setScrollGrid=function(a){if(null!=this.m_heGridWhole){switch(a){case"vertical":this.m_heGridWhole.style.overflowX="hidden";this.m_heGridWhole.style.overflowY="scroll";break;case"horizontal":this.m_heGridWhole.style.overflowX="scroll";this.m_heGridWhole.style.overflowY="hidden";break;case"both":this.m_heGridWhole.style.overflowX="scroll";this.m_heGridWhole.style.overflowY="scroll";break;case"autovscroll":this.m_heGridWhole.style.overflowX="hidden";this.m_heGridWhole.style.overflowY="auto";break;case"autohscroll":this.m_heGridWhole.style.overflowX="auto";this.m_heGridWhole.style.overflowY="hidden";break;case"none":this.m_heGridWhole.style.overflowX="visible";this.m_heGridWhole.style.overflowY="visible";break;default:this.m_heGridWhole.style.overflowX="auto";this.m_heGridWhole.style.overflowY="auto";break}}};SBGrid.CT.DataGrid.prototype.createDefaultHtmlTag=function(d,n,c){var q=document.getElementById(d);var e=document.getElementById("SBHE_"+n);if(!e){e=document.createElement("div");e.setAttribute("id","SBHE_"+n)}else{for(var g=e.childNodes.length-1;g>0;g--){var o=e.childNodes.item(g);e.removeChild(o)}}e.setAttribute("class","sbgrid_boxsizing sbgrid_datagrid");e.setAttribute("ondblclick","");e.setAttribute("onkeydown","");e.setAttribute("onkeyup","");e.setAttribute("onmousedown","");e.setAttribute("onmousemove","");e.setAttribute("onmouseup","");e.setAttribute("style",c);var p=document.getElementById("SBHE_"+n+"_HLine");if(!p){p=document.createElement("div");p.setAttribute("id","SBHE_"+n+"_HLine")}jQuery(p).addClass("sbgrid_datagrid_HLine");e.appendChild(p);var m=document.getElementById("SBHE_"+n+"_VLine");if(!m){m=document.createElement("div");m.setAttribute("id","SBHE_"+n+"_VLine")}jQuery(m).addClass("sbgrid_datagrid_VLine");e.appendChild(m);var h=document.getElementById("SBHE_"+n+"_MoveColBar");if(!h){h=document.createElement("div");h.setAttribute("id","SBHE_"+n+"_MoveColBar")}jQuery(h).addClass("sbgrid_datagrid_MoveColBar");e.appendChild(h);var l=document.getElementById("SBHE_DATAGRID_WHOLE_"+n);if(!l){l=document.createElement("div");l.setAttribute("id","SBHE_DATAGRID_WHOLE_"+n)}jQuery(l).addClass("sbgrid_datagrid_GridWhole");jQuery(l).addClass("sbgrid_datagrid_LayoutDiv");e.appendChild(l);var f=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_SCROLLING_ROW_"+n);if(!f){f=document.createElement("div");f.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_SCROLLING_ROW_"+n)}jQuery(f).addClass("sbgrid_datagrid_GridFFS");jQuery(f).addClass("sbgrid_datagrid_LayoutDiv");e.appendChild(f);var b=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_NOSCROLLING_ROW_"+n);if(!b){b=document.createElement("div");b.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_NOSCROLLING_ROW_"+n)}jQuery(b).addClass("sbgrid_datagrid_GridFFS");jQuery(b).addClass("sbgrid_datagrid_LayoutDiv");e.appendChild(b);var a=document.getElementById("SBHE_DATAGRID_FIXED_FROZEN_COL_"+n);if(!a){a=document.createElement("div");a.setAttribute("id","SBHE_DATAGRID_FIXED_FROZEN_COL_"+n)}jQuery(a).addClass("sbgrid_datagrid_GridFFC");jQuery(a).addClass("sbgrid_datagrid_LayoutDiv");e.appendChild(a);q.appendChild(e);SBGrid.DEF.__attachEventHandler("SBHE_"+n)};SBGrid.CT.DataGrid.initEngine=function(a){if(SBGrid.DEF.bParsed){return}SBGrid.DEF.__initWindow();SBGrid.DEF.__initDocument();SBGrid.DEF.__initWindowAndDocSize();if(SBGrid.DEF.is_ie7){var d=null;for(var c=0;c<document.styleSheets.length;c++){var d=document.styleSheets[c];if(-1!=d.href.indexOf("Sbgrid_default.css")){break}}d.removeRule(1);d.addRule(".sbgrid_boxsizing","behavior:url('"+SBGrid.DEF.__getAppName()+"kr/co/softbowl/css/boxsizing.htc');box-sizing:border-box;",0)}SBGrid.DS.SBHtml=new SBGrid.CT.HtmlHtml(null,"html","xhtml:html","xfs");SBGrid.DS.SBHead=new SBGrid.CT.HtmlHead("html","head","xhtml:head");SBGrid.DS.SBBody=new SBGrid.CT.HtmlBody("html","","","","",true,"",false,a,-1,"scroll","","","","","","","auto","","xhtml:body","visible");SBGrid.DS.XMLStorage.getUniqueStorage();SBGrid.DS.JsonStorage.getUniqueStorage();SBGrid.DS.XMLStorage.getUniqueStorage().initChildren();SBGrid.DEF.setFocus("body");SBGrid.DS.XMLStorage.getUniqueStorage().initTabIndex();if(SBGrid.DEF.is_smartphone){jQuery("#"+a).css("-webkit-tap-highlight-color","rgba(0,0,0,0)")}if("visible"==SBGrid.DS.SBBody.getAttribute("visibility")){var b=document.getElementById(a);b.style.visibility="visible"}};SBGrid.CT.DataGrid.prototype.addItem=function(){this.addRow(true,false,false)};SBGrid.CT.DataGrid.prototype.removeItem=function(){this.removeRow(true,false)};SBGrid.CT.DataGrid.prototype.insertItem=function(c,d,e,b,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".insertItem","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".insertItem","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if((typeof d)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".insertItem","Please check if second parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}else{if(d!="above"&&d!="below"&&d!=""){SBGrid.DEF.APIerrorMsg(this.id+".insertItem","Please check second parameter's value.",SBGrid.DEF.DEBUG_MODE);return}}if(e==null){e=false}if(b==null){b=false}if(a==null){a=false}this.insertRow(c,d,e,b,a)};SBGrid.CT.DataGrid.prototype.deleteItem=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".deleteItem","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".deleteItem","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.deleteRow(a,false,false,false)};SBGrid.CT.DataGrid.prototype.getRows=function(){return this.rows};SBGrid.CT.DataGrid.prototype.getCols=function(){return this.cols};SBGrid.CT.DataGrid.prototype.getFixedRows=function(){return this.fixedRows};SBGrid.CT.DataGrid.prototype.getFixedCols=function(){return this.fixedCols};SBGrid.CT.DataGrid.prototype.getRowStatus=function(b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getRowStatus","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getRowStatus","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.getCell(b,0);if(a){return a.getStatus()}else{SBGrid.DEF.APIerrorMsg(this.id+".getRowStatus","Please check if first parameter's value is valid row number.",SBGrid.DEF.DEBUG_MODE);return}return 0};SBGrid.CT.DataGrid.prototype.addStatus=function(b,a){switch(a){case"insert":this.setRowStatus(b,this.getRowStatus(b)|SBGrid.DEF.SBGS_INSERT);break;case"update":this.setRowStatus(b,this.getRowStatus(b)|SBGrid.DEF.SBGS_UPDATE);break;case"delete":this.setRowStatus(b,this.getRowStatus(b)|SBGrid.DEF.SBGS_DELETE);break}};SBGrid.CT.DataGrid.prototype.clearStatus=function(){this.m_arUpdateDeleteList=new Array();for(var a=this.fixedRows;a<this.m_nRealRows;a++){this.setRowStatus(a,SBGrid.DEF.SBGS_NEW)}};SBGrid.CT.DataGrid.prototype.removeStatus=function(e,b){if(e+1<this.fixedRows){return}var d;switch(b){case"insert":d=SBGrid.DEF.SBGS_INSERT;break;case"update":d=SBGrid.DEF.SBGS_UPDATE;break;case"delete":d=SBGrid.DEF.SBGS_DELETE;break;default:return;break}var a=this.getRowStatus(e);var c=a&(~d);this.setRowStatus(e,c)};SBGrid.CT.DataGrid.prototype.rowStatus=function(a){return this.getRowStatus(a)};SBGrid.CT.DataGrid.prototype.setRowStatus=function(d,a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setRowStatus","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowStatus","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(a==null){a=0}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setRowStatus","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}for(var c=0;c<this.cols;c++){var b=this.getCell(d,c);if(b){b.setStatus(a);if(0==c&&this.m_bRowHeader&&SBGrid.DEF.SBRH_UPDATE==this.getRowHeader()){SBGrid.CF.GridChangeRowHeadUpdate(b,a)}}}};SBGrid.CT.DataGrid.prototype.getGridStatusAll=function(c){if(null==c){c=""}var b;var d=this.attribute.colsep;var h=this.attribute.rowsep;b="m"+d+"rownum";var g=this.m_bRowHeader?1:0;for(var f=0+g;f<this.cols;f++){var a=this.m_arColumn[f].getAttribute("ref");if(a==null||a==""){continue}b+=d;b+=a}b+=h;for(var f=this.fixedRows;f<this.m_nRealRows;f++){b+=c;b+=d;b+=String(f);for(var e=0+g;e<this.cols;e++){var a=this.m_arColumn[f].getAttribute("ref");if(a==null||a==""){continue}b+=d;b+=SBGrid.CF.GridGetText(this.getCell(f,e))}b+=h}return b};SBGrid.CT.DataGrid.prototype.getGridStatus=function(c,g){var b;var m="";var h;var f=this.attribute.colsep;var a=this.attribute.rowsep;switch(c){case"insert":b=1;break;case"delete":b=4;break;case"update":b=2;break;default:b=0;break}if(null==g){m="rownum"}else{m=String(g)}h="m"+f+m;var o=this.m_bRowHeader?1:0;for(var e=0+o;e<this.cols;e++){var l=this.m_arColumn[e].getAttribute("ref");if(l==null||l==""){continue}h+=f;h+=l}h+=a;if(0==b||4==b){for(var e=0;e<this.m_arUpdateDeleteList.length;e++){h+=this.m_arUpdateDeleteList[e]}}for(var e=this.fixedRows;e<this.m_nRealRows;e++){var n=this.getRowStatus(e);if(3==n){n=1}else{if(4<n&&7>n){n=4}}if(0<n&&(n==b||0==b)){switch(n){case 1:h+="i";break;case 2:h+="u";break;case 4:h+="d";break}h+=f;h+=String(e);for(var d=0+o;d<this.cols;d++){var l=this.m_arColumn[d].getAttribute("ref");if(l==null||l==""){continue}h+=f;h+=SBGrid.CF.GridGetText(this.getCell(e,d))}h+=a}}return h};SBGrid.CT.DataGrid.prototype.setMergeCells=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setMergeCells","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof a)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setMergeCells","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}if(this.autoMerge){if(this.mergeCells!=a){this.mergeCancellation(this.m_arMergeList,this.m_htMergeColList);this.m_htMergeColList=new SBGrid.DS.Hashtable()}this.mergeCells=a;this.mergeDataCells()}else{this.mergeCells=a}};SBGrid.CT.DataGrid.prototype.getMergeCells=function(){return this.mergeCells};SBGrid.CT.DataGrid.prototype.getMergeCellsFixedCols=function(){return this.mergeCellsFixedCols};SBGrid.CT.DataGrid.prototype.getMergeCellsFixedRows=function(){return this.mergeCellsFixedRows};SBGrid.CT.DataGrid.prototype.isColHidden=function(b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".isColHidden","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".isColHidden","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}var a=this.m_arColumn[b];if(null!=a){return a.m_bHiddenState}};SBGrid.CT.DataGrid.prototype.colHidden=function(a){if(null==a||(0>a||this.cols<=a)){return false}return this.m_arColumn[a].m_bHiddenState};SBGrid.CT.DataGrid.prototype.getColHidden=function(a){return this.colHidden(a)};SBGrid.CT.DataGrid.prototype.reSetColHidden=function(a){if(a==null){a=false}else{if(typeof a!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".reSetColHidden","Please check if parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}this.m_objHeArea.bTotalHiddenCheck=true;for(var b=0;b<this.cols;b++){var c=this.m_arColumn[b];if(null!=c){this.setColHidden(b,c.m_bHiddenState,a)}}this.gridSetTables();this.m_objHeArea.bTotalHiddenCheck=false};SBGrid.CT.DataGrid.prototype.setColHidden=function(d,c,a){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setColHidden","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setColHidden","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setColHidden","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}if(0>d||this.cols<=d){return}if(a==null){a=false}if(c){this.m_arColumn[d].m_bHiddenState=c;var b=this.m_arHiddenCol[d];this.setColWidth(d,0,a);this.m_arHiddenCol[d]=b}else{this.m_arColumn[d].m_bHiddenState=c;if(0==this.m_arHiddenCol[d]){this.setColWidth(d,0,a)}else{this.setColWidth(d,this.m_arHiddenCol[d],a)}}if(!this.m_objHeArea.bTotalHiddenCheck){this.clearMerge();if(this.autoMerge){this.merge()}}};SBGrid.CT.DataGrid.prototype.getHideColumnCount=function(){this.setHideColumnCount();return this.m_nHideColumnsCount};SBGrid.CT.DataGrid.prototype.setHideColumnCount=function(){this.m_nHideColumnsCount=0;for(var a=0;a<this.getCols();a++){var b=this.m_arColumn[a];if(null!=b){if(b.m_bHiddenState){this.m_nHideColumnsCount+=1}}}};SBGrid.CT.DataGrid.prototype.getAutoResize=function(){return this.autoResize};SBGrid.CT.DataGrid.prototype.setAutoResize=function(g,h){if(g==null){g=true}else{if(typeof g!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setAutoResize","Please check if first parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(h==null){g=false}else{if(typeof h!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setAutoResize","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}}if(SBGrid.DEF.is_smartphone){this.autoResize=g;this.attribute.autoresize=String(g);if(this.autoResize){if(null!=this.m_heGridWhole.firstChild){this.m_heGridWhole.firstChild.style.tableLayout="auto"}}else{if(null!=this.m_heGridWhole.firstChild){this.m_heGridWhole.firstChild.style.tableLayout="fixed"}}return}if(this.autoResize!=g){this.autoResize=g;this.attribute.autoresize=String(g);var e=this.autoResize?"break-word":"normal";for(var q=this.fixedCols;q<this.cols;q++){for(var p=this.fixedRows;p<this.m_nRealRows;p++){if(this.isPhysicalRow(p)){var l=this.getCell(p,q);if(null!=l){var b=l.m_heDataControl;if(null!=b){b.style.wordWrap=e;var u=null;if(!SBGrid.DEF.is_ie){u=b.textContent}else{u=b.innerText}if(this.autoResize){b.innerHTML=u}else{b.innerHTML='<span style="white-space:nowrap;">'+u+"</span>"}}}}}}}this.autoResizeHeight();this.lockedUpHeight(h);var r=this.fixedCols+this.frozenCols;var t=this.fixedRows+this.frozenRows;var f=this.m_nRealRows-this.frozenBottomRows;var d=this.m_heGridWhole.firstChild.lastChild;var n;var s;var o;var a;var c;if(null!=this.m_heGridFFScrollRow){this.m_heGridFFScrollRow.style.height=this.getFixedFrozenRowHeight()+"px";n=this.m_heGridFFScrollRow.firstChild.lastChild;this.m_heGridFFNoScrollRow.style.height=this.getFixedFrozenRowHeight()+"px";s=this.m_heGridFFNoScrollRow.firstChild.lastChild;this.m_heGridFFCol.style.top=this.getFixedFrozenRowHeight()+"px";var m=this.getFixedFrozenRowHeight();if(this.m_heGridWhole.clientHeight-m<0){this.m_heGridFFCol.style.height=m+"px"}else{this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}o=this.m_heGridFFCol.firstChild.lastChild}if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heGridFFBScrollRow.style.top=this.m_heGridWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";a=this.m_heGridFFBScrollRow.firstChild.lastChild;this.m_heGridFFBNoScrollRow.style.height=this.getFrozenBottomRowHeight()+"px";this.m_heGridFFBNoScrollRow.style.top=this.m_heGridWhole.clientHeight-this.getFrozenBottomRowHeight()+"px";c=this.m_heGridFFBNoScrollRow.firstChild.lastChild}if(!h){if(this._isHScroll()&&this.m_objHeArea.bChangeWidth){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.m_heGridFFNoScrollRow.clientHeight+"px";if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBScrollRow.clientHeight)+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBNoScrollRow.clientHeight)+"px"}}else{if(this.m_objHeArea.bChangeWidth){this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px";if(null!=this.m_heGridFFBScrollRow){this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBScrollRow.clientHeight)+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBNoScrollRow.clientHeight)+"px"}}}}};SBGrid.CT.DataGrid.prototype.getBackColorAlternate=function(){return this.backColorAlternate};SBGrid.CT.DataGrid.prototype.setBackColorAlternate=function(g,b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setBackColorAlternate","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}else{if(b==null){b=false}if((typeof g)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setBackColorAlternate","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}else{if(g==""){SBGrid.DEF.APIerrorMsg(this.id+".setBackColorAlternate","Please check parameter's value.",SBGrid.DEF.DEBUG_MODE);return}else{this.attribute.backcoloralternate=g;this.backColorAlternate=g;if(!b){var e=false;if(""!=this.backColorFrozen){e=true}var h=!e?this.fixedRows:this.fixedRows+this.frozenRows;var a=!e?this.fixedCols:this.fixedCols+this.frozenCols;if(!e){for(var f=this.fixedCols;f<this.cols;f++){for(var d=this.fixedRows;d<h;d++){this.setCellBCAColor(d,f)}for(var d=this.m_nRealRows-this.m_nBottomRowCount;d<this.m_nRealRows;d++){this.setCellBCAColor(d,f)}}}if(this.m_objScroll.bScrollEvent){h=this.m_objScroll.nTopRow;var c=this.m_objScroll.nBottomRow;for(var f=h;f<=c;f++){for(var d=a;d<this.cols;d++){this.setCellBCAColor(f,d)}}}else{for(var f=h;f<this.m_nRealRows-this.m_nBottomRowCount;f++){for(var d=a;d<this.cols;d++){this.setCellBCAColor(f,d)}}}}}}}};SBGrid.CT.DataGrid.prototype.getDataHeight=function(){return this.dataHeight};SBGrid.CT.DataGrid.prototype.setDataHeight=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setDataHeight","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setDataHeight","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(0<a){var c=null;for(var b=this.fixedRows;b<this.m_nRealRows;b++){c=this.getCell(b,0);if(null!=c){this.setRowHeight(b,a)}c=null}this.dataHeight=a}};SBGrid.CT.DataGrid.prototype.setRowHeightMin=function(c){this.rowHeightMin=c;var b=false;for(var a=0;a<this.m_nRealRows;a++){if(null!=this.m_htRowHeight[a]&&c>this.m_htRowHeight[a]){if(a<this.fixedRows){this.setRowHeight(a,c,true);b=true}else{if(this.isPhysicalRow(a)){this.setRowHeight(a,c,true);b=true}else{this.m_htRowHeight[a]=c}}}else{if(null==this.m_htRowHeight[a]){this.m_htRowHeight[a]=c}}}if(b){this.rowHeightResize()}};SBGrid.CT.DataGrid.prototype.getFrozenCols=function(){return this.frozenCols};SBGrid.CT.DataGrid.prototype.setFrozenCols=function(u){if(u.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenCols","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof u!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenCols","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}u=parseInt(u);this.stopEditing();if(this.frozenCols==u||this.cols<(u+this.fixedCols)||0>u){return}this.clearSelection();this.clearMerge();if(!SBGrid.DEF.is_smartphone){if(this.frozenCols<u){this.setColGroupCount(u);var n=this.m_heGridFFCol.firstChild.lastChild;var s=this.m_heGridFFNoScrollRow.firstChild.lastChild;var c=this.m_heGridFFBNoScrollRow.firstChild.lastChild;var l=this.fixedCols;for(var q=(l+this.frozenCols);q<(l+u);q++){for(var p=0;p<this.m_nRealRows;p++){var g=this.getCell(p,q);if(null!=g&&null!=g.m_heControl){var f=0;var o=g.m_heControl;var b=o.cloneNode(false);b.id="";if(SBGrid.DEF.is_firefox){var r=o.parentNode;f=r.rowIndex;r.insertBefore(b,o)}else{var r=o.parentElement;f=r.rowIndex;r.insertBefore(b,o)}var d;if(p<this.fixedRows+this.frozenRows){o.setAttribute("targetcell","ffn");d=s.children[p];d.appendChild(o)}else{if(p>=(this.m_nRealRows-this.frozenBottomRows)){o.setAttribute("targetcell","ffbn");d=c.children[p-(this.m_nRealRows-this.frozenBottomRows)];d.appendChild(o)}else{o.setAttribute("targetcell","ffc");o.setAttribute("frozencell","true");o.setAttribute("cellname",this.id+"_fnc");d=n.children[f-(this.fixedRows+this.frozenRows)];d.appendChild(o)}}}}}}else{this.setColGroupCount(u);var e=this.m_heGridWhole.firstChild.lastChild;var n=this.m_heGridFFCol.firstChild.lastChild;var m=this.m_heGridFFScrollRow.firstChild.lastChild;var a=this.m_heGridFFBScrollRow.firstChild.lastChild;for(var q=(this.fixedCols+this.frozenCols-1);q>=(this.fixedCols+u);q--){for(var p=0;p<this.m_nRealRows;p++){var g=this.getCell(p,q);if(null!=g&&null!=g.m_heControl){var o=g.m_heControl;var d;if(p<this.fixedRows+this.frozenRows){o.setAttribute("targetcell","ffs");d=m.children[p];var h=d.children[q];d.insertBefore(o,h);d.removeChild(h)}else{if(p>=(this.m_nRealRows-this.frozenBottomRows)){o.setAttribute("targetcell","ffbs");d=a.children[p-(this.m_nRealRows-this.frozenBottomRows)];var h=d.children[q];d.insertBefore(o,h);d.removeChild(h)}else{var f=0;if(SBGrid.DEF.is_firefox){var r=o.parentNode;f=r.rowIndex}else{var r=o.parentElement;f=r.rowIndex}f+=(this.fixedRows+this.frozenRows);d=e.children[f];var h=d.children[q];d.insertBefore(o,h);d.removeChild(h)}}}}}}this.frozenCols=u;var t=this.getFixedFrozenColWidth();this.m_heGridFFNoScrollRow.style.width=t+"px";this.m_heGridFFNoScrollRow.firstChild.width=t;this.m_heGridFFCol.style.width=t+"px";this.m_heGridFFCol.firstChild.width=t;if(0<this.frozenBottomRows){this.m_heGridFFBNoScrollRow.style.width=t+"px";this.m_heGridFFBNoScrollRow.firstChild.width=t}this.defaultAttributeSetting();if(0<this.frozenBottomRows){this.m_heGridFFCol.style.height=(this.m_heGridWhole.clientHeight-this.m_heGridFFNoScrollRow.clientHeight)+"px"}else{this.m_heGridFFCol.style.height=this.m_heGridWhole.clientHeight-this.getFixedFrozenRowHeight()+"px"}this.m_heGridFFBScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBScrollRow.clientHeight)+"px";this.m_heGridFFBNoScrollRow.style.top=(this.m_heGridWhole.clientHeight-this.m_heGridFFBNoScrollRow.clientHeight)+"px"}else{this.frozenCols=u;this.defaultAttributeSetting()}if(this.autoMerge){this.merge()}};SBGrid.CT.DataGrid.prototype.getFrozenRows=function(){return this.frozenRows};SBGrid.CT.DataGrid.prototype.setFrozenRows=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenRows","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.stopEditing();if(this.frozenRows==a||this.m_nRealRows-this.frozenBottomRows<(a+this.fixedRows)||0>a){return}this.frozenRows=a;this.attribute.frozenrows=String(a);this.rebuild()};SBGrid.CT.DataGrid.prototype.getFrozenBottomRows=function(){return this.frozenBottomRows};SBGrid.CT.DataGrid.prototype.setFrozenBottomRows=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenBottomRows","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setFrozenBottomRows","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.stopEditing();if(this.frozenBottomRows==a||(this.m_nRealRows-this.frozenRows)<(a+this.fixedRows)||0>a){return}this.frozenBottomRows=a;this.attribute.frozenbottomrows=String(a);this.rebuild();var f;var b=this.m_replaceString;if(b!=""&&b!="undefined"&&b!=null){f=b.split("?")}for(var e=this.m_nRealRows-this.m_nBottomRowCount;e<this.m_nRealRows;e++){for(var c=this.fixedCols;c<this.cols;c++){var d=this.getCell(e,c);if(null!=d){SBGrid.CF.GridSetTextRefresh(d,SBGrid.CF.GridGetText(d),f)}}}};SBGrid.CT.DataGrid.prototype.getCaption=function(){return this.attribute.caption};SBGrid.CT.DataGrid.prototype.setCaption=function(e){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setCaption","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof e)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setCaption","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}this.caption=e;this.attribute.caption=e;var b=e.split("|");this.m_arCaption=new Array();for(var d=0;d<b.length;d++){this.m_arCaption[d]=new Array();var g=b[d];var f=g.split("^");if(this.m_bRowHeader){this.m_arCaption[d][0]=" "}for(var a=0;a<f.length&&a<this.cols;a++){this.m_arCaption[d][(this.m_bRowHeader)?a+1:a]=f[a]}}if(this.fixedRows!=this.m_arCaption.length){this.rebuild();return}this.mergeCancellation(this.m_arMergeFixedRowList,this.m_htMergeFRColList);this.m_htMergeFRColList=new SBGrid.DS.Hashtable();this.m_arMergeFixedRowList=new Array;for(var d=0;d<this.fixedRows;d++){for(var a=0;a<this.cols;a++){var c=this.getCell(d,a);if(null!=c){SBGrid.CF.GridSetFixedWindowText(c,this.m_arCaption[d][a].newlineCharConvert())}}}this.mergeFixedRows()};SBGrid.CT.DataGrid.prototype.setSubTotalPosition=function(a){this.subtotalPosition=a};SBGrid.CT.DataGrid.prototype.getSubTotalPosition=function(){return this.subtotalPosition};SBGrid.CT.DataGrid.prototype.setDataStyle=function(a){this.m_htDataStyle=a;this.applyBaseCellCSS("data")};SBGrid.CT.DataGrid.prototype.setFixedStyle=function(a){this.m_htFixedStyle=a;this.applyBaseCellCSS("fixed")};SBGrid.CT.DataGrid.prototype.getDataStyle=function(){if(null==this.m_htDataStyle){this.m_htDataStyle=new SBGrid.DS.Hashtable()}return this.m_htDataStyle};SBGrid.CT.DataGrid.prototype.getFixedStyle=function(a){if(null==this.m_htFixedStyle){this.m_htFixedStyle=new SBGrid.DS.Hashtable()}return this.m_htFixedStyle};SBGrid.CT.DataGrid.prototype.setDataAttribute=function(b,a){if(null==this.m_htDataStyle){this.m_htDataStyle=new SBGrid.DS.Hashtable()}if("background-image"==b){if(!a.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){a="url("+a+")"}}this.m_htDataStyle[b]=a;this.applyBaseCellCSS("data")};SBGrid.CT.DataGrid.prototype.setFixedAttribute=function(b,a){if(null==this.m_htFixedStyle){this.m_htFixedStyle=new SBGrid.DS.Hashtable()}if("background-image"==b){if(!a.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){a="url("+a+")"}}this.m_htFixedStyle[b]=a;this.applyBaseCellCSS("fixed")};SBGrid.CT.DataGrid.prototype.getDataAttribute=function(a){if(null==this.m_htDataStyle){this.m_htDataStyle=new SBGrid.DS.Hashtable()}if("background-image"==a){if(!strName.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){strName="url("+strName+")"}}return this.m_htDataStyle[a]};SBGrid.CT.DataGrid.prototype.getFixedAttribute=function(a){if(null==this.m_htFixedStyle){this.m_htFixedStyle=new SBGrid.DS.Hashtable()}if("background-image"==a){if(!strName.isRegular(/(url\()|(url(\s+)\()|(URL\()|(URL(\s+)\()/g)){strName="url("+strName+")"}}return this.m_htFixedStyle[a]};SBGrid.CT.DataGrid.prototype.getGroupLevel=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".getGroupLevel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".getGroupLevel","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=this.m_objGroup[a]){return this.m_objGroup[a].depth}return 0};SBGrid.CT.DataGrid.prototype.setGroupLevel=function(a,b){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevel","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevel","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof b!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevel","Please check if second parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=a&&null!=b&&"NaN"!=b){if(null!=this.m_objGroup[a]){this.m_objGroup[a].depth=b}else{this.m_objGroup[a]={depth:b,collapsed:false,heControl:null,isChild:false}}}};SBGrid.CT.DataGrid.prototype.getGroupCol=function(){return this.groupCol};SBGrid.CT.DataGrid.prototype.setGroupCol=function(a){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCol","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof a!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCol","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}this.groupCol=a};SBGrid.CT.DataGrid.prototype.getGroupLevelCol=function(){return this.groupLevelCol};SBGrid.CT.DataGrid.prototype.setGroupLevelCol=function(d){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevelCol","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof d!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupLevelCol","Please check if parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(null!=d&&0<=d){this.groupLevelCol=d;if(this.isJsonRef()){var f="";var a=this.m_arColumn[d];if(null!=a){if(null!=a.attribute.ref){f=a.attribute.ref}}if(f==""){return}var h=null;var e="";for(var c=0;c<this.m_xlRefNode.length;c++){h=this.m_xlRefNode[c];e=h[f];this.setGroupLevel((this.fixedRows+c),parseInt(e))}}else{var b=this.nodeset;if((b.length-1)!=b.lastIndexOf("/")){b+="/"}var a=this.m_arColumn[d];if(null!=a){if(null!=a.attribute.ref){b+=a.attribute.ref}}var g=SBGrid.DS.XMLStorage.getUniqueStorage().getInstancePart(null,b);if(null!=g){for(var c=0;c<g.length;c++){var l=SBGrid.UT.XmlLib.getTextValue(g.item(c));this.setGroupLevel((this.fixedRows+c),parseInt(l))}}}}};SBGrid.CT.DataGrid.prototype.getGroup=function(){var a="";switch(this.group){case 0:a="none";break;case 1:a="symbols";break;case 2:a="complete";break;case 3:a="symbolsleaf";break;case 4:a="completeleaf";break;case 5:a="nodrawing";break;default:a="none";break}return a};SBGrid.CT.DataGrid.prototype.setGroup=function(b){if(arguments.length<1){SBGrid.DEF.APIerrorMsg(this.id+".setGroup","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if((typeof b)!="string"){SBGrid.DEF.APIerrorMsg(this.id+".setGroup","Please check if parameter's type is 'string'.",SBGrid.DEF.DEBUG_MODE);return}var f=this.group;switch(b){case"none":this.group=0;break;case"symbols":this.group=1;break;case"complete":this.group=2;break;case"symbolsleaf":this.group=3;break;case"completeleaf":this.group=4;break;case"nodrawing":this.group=5;break;default:var d=parseInt(b);if("NaN"==d){this.group=0}else{this.group=d}}var e=this.m_nOldGroupCol;if(null!=e){e=this.m_nOldGroupCol!=this.groupCol&&0!=f}else{e=false}var g=5==this.group?"":"sbgrid_group_plus";var a=5==this.group?"":"sbgrid_group_subtraction";var c=2<this.group?"":"sbgrid_group_normal";this.m_objTreeClass={plus:g,subtraction:a,normal:c};if(null==f||f==this.group){if(0==f){return}this.groupRefresh(true,e,g,a,c,true);this.m_nOldGroupCol=this.groupCol;return}if(0!=f&&0==this.group){this.groupRefresh(true,true,g,a,c,false);this.m_nOldGroupCol=this.groupCol;return}else{if(0!=f&&0!=this.group){this.groupRefresh(true,e,g,a,c,true);this.m_nOldGroupCol=this.groupCol;return}}this.groupRefresh(false,e,g,a,c,true);this.m_nOldGroupCol=this.groupCol};SBGrid.CT.DataGrid.prototype.getGroupCollapsed=function(a){if(null!=this.m_objGroup[a]){return this.m_objGroup[a].collapsed}return false};SBGrid.CT.DataGrid.prototype.setGroupCollapsed=function(c,g){if(arguments.length<2){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCollapsed","Please check parameter's counts.",SBGrid.DEF.DEBUG_MODE);return}if(typeof c!="number"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCollapsed","Please check if first parameter's type is 'number'.",SBGrid.DEF.DEBUG_MODE);return}if(typeof g!="boolean"){SBGrid.DEF.APIerrorMsg(this.id+".setGroupCollapsed","Please check if second parameter's type is 'boolean'.",SBGrid.DEF.DEBUG_MODE);return}var p=null;if(null!=c&&null!=g){if(null!=this.m_objGroup[c]){p=this.m_objScroll;var f=this.m_objGroup[c];var l=f.collapsed;f.collapsed=g;if(this.group>0){if(l!=g){for(var e=c-1;e!=0;e--){var b=this.m_objGroup[e];if(null!=b){if(f.depth>b.depth&&b.collapsed){f.heControl.className=f.isChild?g?this.m_objTreeClass.plus:this.m_objTreeClass.subtraction:this.m_objTreeClass.normal;return}else{if(1==b.depth){break}}}}if(g){if(f.isChild){this.dispatch("oncollapse")}if(p.bScrollEvent){this.gridCellUnInit(p.nTopRow,p.nBottomRow)}var m=c+1;var h=f.depth;while((null!=this.m_objGroup[m])&&(h<this.m_objGroup[m].depth)){if(m==(c+1)){f.heControl.className=this.m_objTreeClass.plus}if(p.bScrollEvent){this.setRowHidden(m,g,true)}else{this.setRowHidden(m,g)}m++}if(p.bScrollEvent){this.scrollTableReDraw()}}else{if(f.isChild){this.dispatch("onexpanded")}if(p.bScrollEvent){this.gridCellUnInit(p.nTopRow,p.nBottomRow)}var m=c+1;var h=f.depth;var d=true;var o=h;while((null!=this.m_objGroup[m])&&(h<this.m_objGroup[m].depth)){var n=this.m_objGroup[m];if(m==(c+1)){f.heControl.className=this.m_objTreeClass.subtraction}if(d){if(p.bScrollEvent){this.setRowHidden(m,g,true)}else{this.setRowHidden(m,g)}}if(n.isChild&&g!=n.collapsed){o=n.depth;if(null!=this.m_objGroup[m+1]&&n.depth<this.m_objGroup[m+1].depth){d=false}}else{if((n.isChild&&d)||(null!=this.m_objGroup[m+1]&&o>=this.m_objGroup[m+1].depth)){d=true}}m++}if(p.bScrollEvent){this.scrollTableReDraw()}}}}}else{this.m_objGroup[c]={depth:1,collapsed:g,heControl:null,isChild:false}}}if(p){if(p.bScrollEvent&&(SBGrid.DEF.is_ie||SBGrid.DEF.is_opera)){var a=parseInt(this.m_objScroll.heTargetTable.style.top);if(this.m_objScroll.nPosition>a){this.m_objScroll.heTargetTable.style.top=this.m_heGridWhole.scrollTop+"px";this.m_objScroll.heTargetFFCTable.style.top=this.m_heGridWhole.scrollTop+"px";this.showWait(true);this.m_objScroll.arScrollLength.push(1);window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",100)}}else{this.reSizeScrollDiv()}}};SBGrid.CT.DataGrid.prototype.setGroupImage=function(b,d){var c=document.styleSheets[0];var a=SBGrid.DEF.is_ie?c.rules[2+b]:c.cssRules[2+b];a.style.backgroundImage="url("+d+")"};SBGrid.CT.DataGrid.prototype.groupRefresh=function(s,n,a,w,e,q){if(n){var f=this.m_arColumn[this.m_nOldGroupCol];var g=null;if(null!=f){if(SBGrid.DEF.SBIT_INPUTBUTTON==f.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==f.m_nInputType){g=true}else{g=false}}if(null!=g){if(g){for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCell(r,this.m_nOldGroupCol);if(null!=l&&null!=l.m_heControl){l.m_heControl.style.overflow="";var v=l.m_heControl.firstChild.firstChild.firstChild;var m=v.firstChild;m.nextSibling.style.paddingLeft="";v.removeChild(m)}}}else{for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCell(r,this.m_nOldGroupCol);if(null!=l&&null!=l.m_heControl){l.m_heControl.style.overflow="";var A=l.m_heControl.firstChild;var p=A.firstChild.firstChild.lastChild.firstChild;l.m_heControl.appendChild(p);l.m_heControl.removeChild(A)}}}}if(q){this.groupRefresh(false,false,a,w,e)}return}if(s){for(var r=this.fixedRows;r<this.m_nRealRows;r++){var o=this.m_objGroup[r];if(null!=o&&null!=o.heControl){var x=o.heControl;var u=null!=this.m_objGroup[r+1]&&(o.depth+1)==this.m_objGroup[r+1].depth;x.style.width=(18*o.depth)+"px";x.className=u?(o.collapsed?a:w):e;o.isChild=u}}}else{var f=this.m_arColumn[this.groupCol];var g=null;if(null!=f){if(SBGrid.DEF.SBIT_INPUTBUTTON==f.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==f.m_nInputType){g=true}else{g=false}}if(null!=g){if(g){var z=document.createElement("TD");for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCell(r,this.groupCol);if(null!=l&&null!=l.m_heControl){l.m_heControl.style.overflow="hidden";var v=l.m_heControl.firstChild.firstChild.firstChild;var m=v.firstChild;var o=this.m_objGroup[r];if(null!=o){var t=(18*o.depth)+"px";var b=z.cloneNode(false);var u=null!=this.m_objGroup[r+1]&&(o.depth+1)==this.m_objGroup[r+1].depth;b.className=u?(o.collapsed?a:w):e;b.style.width=t;b.setAttribute("row",r);b.setAttribute("gridId",this.id);v.insertBefore(b,m);m.style.paddingLeft="2px";o.isChild=u;o.heControl=b;b.onclick=function(){var B=parseInt(this.getAttribute("row"));var D=this.getAttribute("gridId");var C=document.SBHE_allElement.item(D);if(null!=C){var i=C.getGroupCollapsed(B);C.setGroupCollapsed(B,!i)}}}}}}else{for(var r=this.fixedRows;r<this.m_nRealRows;r++){var l=this.getCell(r,this.groupCol);if(null!=l&&null!=l.m_heControl){l.m_heControl.style.overflow="hidden";var p=l.m_heControl.firstChild;var o=this.m_objGroup[r];if(null!=o){var d=document.createElement("TABLE");l.m_heControl.appendChild(d);var h=document.createElement("TBODY");d.appendChild(h);var y=document.createElement("TR");h.appendChild(y);var c=document.createElement("TD");c.style.paddingLeft="2px";var t=(18*o.depth)+"px";var b=c.cloneNode(false);y.appendChild(b);y.appendChild(c);d.border=0;d.cellSpacing=0;d.cellPadding=0;d.className="sbgrid_datagrid_InputButton_table";d.style.height=SBGrid.DEF.is_mozBrowser?"98%":"100%";var u=null!=this.m_objGroup[r+1]&&(o.depth+1)==this.m_objGroup[r+1].depth;b.className=u?(o.collapsed?a:w):e;b.style.width=t;b.setAttribute("row",r);b.setAttribute("gridId",this.id);c.appendChild(p);o.isChild=u;o.heControl=b;b.onclick=function(){var B=parseInt(this.getAttribute("row"));var D=this.getAttribute("gridId");var C=document.SBHE_allElement.item(D);if(null!=C){var i=C.getGroupCollapsed(B);C.setGroupCollapsed(B,!i)}}}}}}}}};SBGrid.CT.DataGrid.prototype.addRows=function(b){var l=this.rows;var h=null;var f=false;if(typeof(b)=="number"||typeof(b)=="string"){h=parseInt(b)}else{if(typeof(b)=="object"){h=b.length;f=true}}if(h==null||h==0){return false}if(!this.isJsonRef()&&!this.hasInstance()){return false}this.stopEditing();this.clearSelection();var g=l-this.fixedRows;for(var e=0;e<h;e++){this.addRowHasInstanceEx();if(f){this.m_xlRefNode[g++]=b[e];for(var d=this.fixedCols;d<this.cols;d++){var c=this.getCell(l,d);var a=this.m_arColumn[d];var m=a.getAttribute("ref");if(null!=c){this.setValueMatrix(l,d,b[e][m])}}}l++}this.m_bIsSort=false;this.scrollingGrid();if(this.m_objScroll.bScrollEvent){this.reSizeScrollDiv()}if(!SBGrid.DEF.is_smartphone){this.__FFRowMove();this.bottomRowMove()}return true};SBGrid.CT.DataGrid.prototype.addRowHasInstanceEx=function(){var b;var l;if(this.m_objScroll.nMaxLength<=this.m_nMakeIndex){this.m_objScroll.bScrollEvent=true;this.m_objScroll.nEndRow++;if(null==this.m_objScroll.arTargetRow||this.m_nRealRows!=this.m_objScroll.arTargetRow.length){this.m_objScroll.arTargetRow=new Array();for(var g=0;g<this.m_nRealRows;g++){this.m_objScroll.arTargetRow.push(g)}this.m_objScroll.arTargetRow.push(this.m_nRealRows)}else{this.m_objScroll.arTargetRow.push(this.m_nRealRows)}}else{this.m_objScroll.bScrollEvent=false;this.m_objScroll.nBottomRow++;this.m_objScroll.nTargetHeight+=this.dataHeight;this.m_nMakeIndex++}var h=true;var n=this.m_nRealRows-this.frozenBottomRows;if(this.m_nRealRows>=(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){if(!this.m_objScroll.bScrollEvent){this.physicalRemovePartRow(n,n)}}if(this.rows==this.m_nRealRows){this.rows++}this.m_nRealRows++;this.m_htRowHeight[this.m_nRealRows-1]=this.dataHeight;this.m_xlRefNode=this.getControlNodeList();this.makeScrollDiv(this.m_heGridScrollDivCell,true);if(null!=this.m_heGridFFCol){this.makeScrollDiv(this.m_heFFGridScrollDivCell,false)}if(this.m_nRealRows>(this.fixedRows+this.frozenRows+this.frozenBottomRows)&&this.frozenBottomRows>0){var e;for(var g=0;g<this.cols;g++){e=this.getCell(n,g);if(null!=e){if(this.m_objScroll.bScrollEvent){e.attribute["background-color"]=null}else{this.physicalCreateCell(n,g,h,e.m_bIsSubTotal,true)}h=false}}if(!this.m_objScroll.bScrollEvent){for(var g=0;g<this.cols;g++){e=this.getCell(n,g);if(null!=e){SBGrid.CF.GridInit(e)}}}if(null!=e){this.setRowStatus(n,e.rowstatus)}}for(var g=0;g<this.cols;g++){if(this.m_objScroll.bScrollEvent){var d=this.m_arColumn[g];var m=d.getAttribute("ref");if(this.isJsonRef()){l=this.m_xlRefNode[this.m_nRealRows-1-this.fixedRows]}else{b=this.m_xlRefNode.item(this.m_nRealRows-1-this.fixedRows)}var a=this.id+"_"+(this.m_nRealRows-1)+"_"+g;if(g<this.fixedCols){var e=this.getCellById(a);if(null!=e&&a!=e.id){e=null}e=null==e?new SBGrid.CT.DataGridCell(this,g,a,this.m_nRealRows-1,"softbowl:cell"):e;e.setElement(this.m_objFixedCell);SBGrid.CF.GridSetMergeType(e,d.m_bMerge)}else{var f;var c;if(this.isJsonRef()){c=l}else{f=SBGrid.UT.XmlLib.selectSingleNode(b,m)}var e=this.getCellById(a);if(null!=e&&a!=e.id){e=null}e=null==e||a!=e.id?new SBGrid.CT.DataGridCell(this,g,a,this.m_nRealRows-1,"softbowl:cell"):e;e.setElement(d);this.setLinkedData(e,f,c);SBGrid.CF.GridSetMergeType(e,d.m_bMerge)}}else{this.physicalCreateCell(this.m_nRealRows-1,g,false,false)}}if(!this.m_objScroll.bScrollEvent){for(var g=0;g<this.cols;g++){var e=this.getCell(this.m_nRealRows-1,g);if(null!=e){SBGrid.CF.GridInit(e)}}this.m_objScroll.arTargetRow.push(this.m_nRealRows-1)}else{this.setTableMatrix(this.m_objScroll.nTopRow,this.m_objScroll.nBottomRow);this.m_heGridFFBScrollRow.removeChild(this.m_heGridFFBScrollRow.firstChild);this.m_heGridFFBNoScrollRow.removeChild(this.m_heGridFFBNoScrollRow.firstChild);this.m_heGridFFBScrollRow=this.makeFixedFrozenBottomScrollingRow();this.m_heGridFFBNoScrollRow=this.makeFixedFrozenBottomNoScrollingRow()}if(this.m_nRealRows>(this.fixedRows+this.frozenRows)&&this.frozenBottomRows>0&&!this.m_objScroll.bScrollEvent){this.m_nBottomRowCount++}};SBGrid.CT.DataGrid.prototype.rePositionScrollBar=function(){if(SBGrid.DEF.is_chromeFrame){this.m_nReScrollPosition=this.vscroll.getPrevScrollPosition()}else{this.m_nReScrollPosition=this.vscroll.getPrevScrollPosition()}this.showWait(true);this.m_objScroll.arScrollLength.push(1);window.setTimeout("SBGrid.getGrid('"+this.id+"').scrollingGrid(true);",200)};SBGrid.CT.DataGrid.prototype.destroy=function(){SBGrid.DEF.__removeEventHandler("SBHE_"+this.id);var e=document.getElementById(this.parentId);var h=document.getElementById("SBHE_"+this.id);if(h){e.removeChild(h)}for(var d=0,b=this.m_arColumn.length;d<b;d++){var c=this.m_arColumn[d];if(c.getAttribute("type")=="combo"){var f="SBHE_"+c.m_objCombo.id+"_allitem";document.body.removeChild(document.getElementById(f))}}var a=this.children.keys();for(var d=0;d<this.children.count();d++){var g=this.children.item(a[d]);g=null}this.children.removeAll();SBGrid.DEF.destroy(this,this.id);document.SBHE_allElement.removeAll();delete document.SBHE_allElement;document.SBHE_controls.removeAll();delete document.SBHE_controls;SBGrid.DEF.bParsed=false};SBGrid.CT.DataGrid.prototype.setCellDisabled=function(b,d,c){var a=this.getCell(b,d);a.setDisabled(c)};SBGrid.CT.DataGrid.prototype.getCellDisabled=function(b,c){var a=this.getCell(b,c);return a.getDisabled()};SBGrid.CT.GridCell=function(b,c,f,m,n,i,e,d,o,a,g,l,h){if(!n){return}SBGrid.CT.Caption.call(this,b,"","","","","",false,"",c,f,false,m,n,-1,i,e,d,o,a,g,l,h);this.boolstate=false;this.m_objColumn=this.parent.getColumnControl(this.col);this.m_bUserAddCell=false;this.m_xnNodeElement;this.m_nBeforeSelectRow=0};SBGrid.CT.GridCell.prototype=new SBGrid.CT.Caption;SBGrid.CT.GridCell.prototype.init=function(){SBGrid.CT.Caption.prototype.init.call(this)};SBGrid.CT.GridCell.prototype.inputDataPosition=function(){var c=this.getRefElement();if(c){var d=c.getHtmlElement();var a=d.offsetLeft+d.clientWidth-18;var b=d;while(null!=b){if(SBGrid.DEF.is_firefox){b=b.parentNode}else{b=b.parentElement}if("DIV"==b.tagName){a+=b.offsetLeft}a-=b.scrollLeft;if("BODY"==b.tagName){break}}return a}return 0};SBGrid.CT.GridCell.prototype.getBoolState=function(){var a=this.getRefElement();if(a){var d=SBGrid.CF.GridGetText(a);var c=this.getTrueValue();var b=this.getFalseValue();if(d==c){this.boolstate=true}else{if(d==b){this.boolstate=false}else{this.boolstate=false}}return this.boolstate}};SBGrid.CT.GridCell.prototype.setBoolState=function(f,d,a,e){this.boolstate=f;var c=this.getRefElement();if(c){if(d){SBGrid.CF.GridSetText(c,strValue)}var b=c.m_heControl.firstChild;if(b){if(SBGrid.DEF.SBIT_CHECK==this.getInputType()){b.src=f?this.getAttribute("checkimage"):this.getAttribute("uncheckimage")}else{if(SBGrid.DEF.SBIT_RADIO==this.getInputType()){b.src=f?this.getAttribute("selectimage"):this.getAttribute("unselectimage")}}}}};SBGrid.CT.GridCell.prototype.getCheck=function(){return this.getBoolState()};SBGrid.CT.GridCell.prototype.setCheck=function(e){var a=this.getRefElement();if(a){if(SBGrid.DEF.SBIT_CHECK==this.getInputType()){var c=e?this.getTrueValue():this.getFalseValue();this.setBoolState(e);SBGrid.CF.GridSetText(a,c);var b=a.row;var d=a.col;if(this.parent.getColStatus(d)){this.parent.setRowStatus(b,a.rowstatus|SBGrid.DEF.SBGS_UPDATE)}if(e){this.dispatch("onselect")}else{this.dispatch("ondeselect")}this.dispatch("onvaluechanged")}}};SBGrid.CT.GridCell.prototype.selectRadio=function(){var c=this.getRefElement();if(c){if(SBGrid.CF.GridGetText(c)==this.getTrueValue()){return}if(this.m_nBeforeSelectRow!=c.row){if(SBGrid.DEF.SBIT_RADIO==this.getInputType()){var e=this.parent;var d=c.row;var h=c.col;for(var b=e.fixedRows;b<e.m_nRealRows;b++){var g=e.getCell(b,h);if(null!=g){SBGrid.CF.GridSetText(g,this.getFalseValue())}}if(e.fixedRows<=this.m_nBeforeSelectRow){var a=e.getCell(this.m_nBeforeSelectRow,h);if(null!=a){SBGrid.CF.GridSetBoolState(a,false)}}this.m_nBeforeSelectRow=d;var f=this.getTrueValue();this.setBoolState(true);SBGrid.CF.GridSetText(c,f);if(this.parent.getColStatus(h)){this.parent.setRowStatus(d,c.rowstatus|SBGrid.DEF.SBGS_UPDATE)}this.dispatch("onselect");this.dispatch("onvaluechanged")}}}};SBGrid.CT.GridCell.prototype.onFocus=function(c){SBGrid.CT.Group.prototype.onFocus.call(this,c);if(!SBGrid.DEF.is_smartphone){var f=this.row;var l=this.col;var g=this.getRefElement();if(g){f=g.row;l=g.col}var a=this.parent;var d=a.m_heGridWhole;var q=a.isFrozenCell(f,l);if(a.isNormalCell(f,l)&&!a.isScrollBar(c)&&!q){var e=this.getHtmlElement();if(null!=e){var m=new SBGrid.DS.Rectangle(e.offsetLeft,e.offsetTop,e.offsetWidth,e.offsetHeight);var h=m.getRight();var p=m.getBottom();var o=m.getX();var n=m.getY();var b=a.getFixedFrozenRowHeight();var i=a.getFixedFrozenColWidth();if(l<a.fixedCols+a.frozenCols){n+=b;p+=b}if(d.scrollLeft>o-i){d.scrollLeft=o-i}if(h>d.offsetWidth-(a._isVScroll()?17:0)+d.scrollLeft){d.scrollLeft=h-(d.offsetWidth-(a._isVScroll()?17:0))}}}if(!q){if(d&&a.m_heGridFFScrollRow){a.m_heGridFFScrollRow.scrollLeft=d.scrollLeft}if(d&&a.m_heGridFFBScrollRow){a.m_heGridFFBScrollRow.scrollLeft=d.scrollLeft}}if(d&&a.m_heGridFFCol){a.m_heGridFFCol.scrollTop=d.scrollTop}}};SBGrid.CT.GridFixedCell=function(c,g,d,f,e,b,a){if(!f){return}SBGrid.CT.GridCell.call(this,c,g,d,"",f,"","","",-1,"",e,b,a)};SBGrid.CT.GridFixedCell.prototype=new SBGrid.CT.GridCell;SBGrid.CT.GridFixedCell.prototype.onClick=function(b){SBGrid.CT.GridCell.prototype.onClick.call(this,b);var a=this.getRefElement();if(a){switch(a.m_fixedInputType){case SBGrid.DEF.SBIT_CHECK:this.parent.setFixedcellischeck(a.row,a.col,!a.m_fixedCheckStatus);break;case SBGrid.DEF.SBIT_INPUTBUTTON:if((b.target==this.getId())&&(this.inputDataPosition()<b.clientX)){this.dispatch("onfixedbuttonclick")}break;default:break}}};SBGrid.CT.GridFixedCell.create=function(a,f){var b="";var c=false;var h="";var g="visible";var e="";for(var d=0;d<f.count();d++){var l=f.keys()[d];switch(l){case"class":b=f.item("class");break;case"disabled":if("true"==f.item("disabled")){c=true}break;case"id":h=f.item("id");break;case"visibility":g=f.item("visibility");break;default:if(!SBGrid.DEF.SB_STYLELIST[l]){e+=l+":"+f.item(l)+"; "}break}}return new SBGrid.CT.GridFixedCell(a,b,c,h,"softbowl:gridfixedcell",g,e)};SBGrid.CT.GridInput=function(s,u,q,l,h,D,N,f,J,o,c,b,H,r,t,d,i,I,G,n,C,p,L,E,g,z,K,a,v,A,m,y,F,e,x,M,B,w){if(!d){return}SBGrid.CT.Input.call(this,s,u,q,l,h,D,N,f,J,o,c,b,H,r,t,d,i,I,G,n,C,p,L,E,g,z,K,a,v,A,m,y,F,e,x,"",M,B,w);this.m_isGridInput=true;this.m_bDependentCtl=true;this.m_bEndEdit=false};SBGrid.CT.GridInput.prototype=new SBGrid.CT.Input;SBGrid.CT.GridInput.prototype.init=function(){SBGrid.CT.Input.prototype.init.call(this)};SBGrid.CT.GridInput.prototype.onBlur=function(a){SBGrid.CT.Group.prototype.onBlur.call(this,a);this.m_heControl.style.visibility="hidden"};SBGrid.CT.GridInput.prototype.onKeyDown=function(a){SBGrid.CT.Input.prototype.onKeyDown.call(this,a);if(this.m_bEndEdit){this.m_bEndEdit=false;this.parent.dispatch("onnext")}};SBGrid.CT.GridInput.prototype.getFormat=function(){return this.objFormat};SBGrid.CT.GridInput.create=function(w,B){var z="";var u="";var p="";var o="";var A="";var W="";var l="";var R=false;var s=false;var e=false;var b=true;var F=true;var v="";var y=false;var f="";var g="";var Q="";var O="";var r=false;var L="exclude";var t=-1;var U=-1;var M=9007199254740992;var m="";var I="default";var S="";var a="";var C=false;var J="";var q=0;var H="none";var N="";var h=false;var E="";var V="softbowl:input";var K=false;var D="visible";var d="";for(var T=0;T<B.count();T++){var c=B.keys()[T];switch(c){case"alert":z=B.item(c);break;case"help":u=B.item(c);break;case"hint":p=B.item(c);break;case"accesskey":o=B.item(c);break;case"autonext":if("true"==B.item(c)){A=true}break;case"bind":W=B.item(c);break;case"class":l=B.item(c);break;case"disabled":if("true"==B.item(c)){R=true}break;case"dragmode":if("true"==B.item(c)){s=true}case"dropmode":if("true"==B.item(c)){e=true}break;case"editable":if("false"==B.item(c)){b=false}break;case"editmenu":if("false"==B.item(c)){F=false}break;case"format":v=B.item(c);break;case"decimalformatinsert":y=B.item(c);break;case"id":f=B.item(c);break;case"imemode":g=B.item(c);break;case"inputtype":Q=B.item(c);break;case"invalidcharacters":O=B.item(c);break;case"isemptyformatted":if("true"==B.item(c)){r=true}break;case"mask":L=B.item(c);break;case"maxbyte":t=parseInt(B.item(c));break;case"maxlength":U=parseInt(B.item(c));break;case"navindex":M=parseInt(B.item(c));break;case"pastemode":I=B.item(c);break;case"ref":S=B.item(c);break;case"jsonref":a=B.item(c);break;case"required":if("true"==B.item(c)){C=true}break;case"roundmode":J=B.item(c);break;case"roundposition":q=parseInt(B.item(c));break;case"showmask":if("true"==B.item(c)){h=true}break;case"tag":V=B.item(c);break;case"validateformat":if("true"==B.item(c)){K=true}break;case"visibility":D=B.item(c);break;default:if(!SBGrid.DEF.SB_STYLELIST[c]){d+=c+":"+B.item(c)+"; "}break}}var x=new SBGrid.CT.GridInput(w,z,u,p,o,A,W,l,R,s,e,b,F,v,y,f,g,Q,O,r,L,t,U,M,m,I,S,a,C,J,q,H,N,h,E,V,K,D,d);var G=x.parent.m_heControl;var P=x.parent.m_strCGInput;var n=document.createElement("input");SBGrid.CT.GridInput.createAttribute(n,B);n.setAttribute("id","SBHE_"+f);if(null==P){P=""}jQuery(n).addClass("sbgrid_datagrid_Input "+P);G.appendChild(n);if(n.attachEvent){n.attachEvent("onblur",SBGrid.DEF._W_onBlurEvent)}else{n.addEventListener("blur",SBGrid.DEF._W_onBlurEvent,false)}return x};SBGrid.CT.GridInput.createAttribute=function(b,a){b=SBGrid.CT.TextArea.createAttribute(b,a);return b};SBGrid.CT.GridTextArea=function(a,b){if(!b){return}SBGrid.CT.Input.call(this,strParentId,"","","","",false,"","",false,false,false,false,false,"",false,"","","","",false,"",-1,-1,-1,"","","","","",-1,"","",false,"","",false,"")};SBGrid.CT.GridTextArea.prototype=new SBGrid.CT.Input;SBGrid.CT.GridCombo=function(v,y,u,q,p,S,c,i,m,O,N,r,e,K,l,g,s,F,U,G,o,D,P,a,H,C,B,J,t,E,R,h,A,Q,L,b,x,M,w,z,d,f,n,I,T){if(!g){return}this.createDefaultComboHtmlTag(v,g);SBGrid.CT.Select1.call(this,v,y,u,q,p,S,c,i,m,O,N,r,e,K,l,g,s,F,U,G,o,D,"","",H,C,B,J,t,E,R,h,"hidden",Q,L,b,x,M,w,"minimal",d,f,n,I);this.m_heControl=document.getElementById("SBHE_"+this.id);this.m_heControl.style.position="absolute";this.m_heControl.style.zIndex=100;this.m_heControl.style.borderWidth="0";this.m_objTargetCol=null;this.m_nColId=T;this.m_bGridCombo=true};SBGrid.CT.GridCombo.prototype=new SBGrid.CT.Select1;SBGrid.CT.GridCombo.prototype.init=function(){SBGrid.CT.Select1.prototype.init.call(this);if(null!=this.m_objTargetCol){this.m_objTargetCol.choices=this.choices}};SBGrid.CT.GridCombo.prototype.refresh=function(){if(this.isnodeset){if(this.equlsChangeNode()){this.reBuild();this.applySelectCell()}else{this.applySelectCell()}}SBGrid.CT.Group.prototype.refresh.call(this);var a=this.label;if(null==this.label){a="";this.label=""}else{if("true"==this.getAttribute("showvalue")){a=" ["+this.value+"]     "+a}}this.m_objInput.setWindowText(a)};SBGrid.CT.GridCombo.prototype.showComboRefresh=function(){if(null==this.m_objConnectControl){return}var a=null;if(SBGrid.DEF.is_ie){a=this.m_objConnectControl.m_heDataControl.outerText}else{a=this.m_objConnectControl.m_heDataControl.textContent}this.m_objInput.setWindowText(a)};SBGrid.CT.GridCombo.prototype.setNodeset=function(b){if(this.isnodeset){var a=this.m_objTargetCol;if(null!=a){a.m_strComboNodeSet=b}this.nodeset=b;a=null}};SBGrid.CT.GridCombo.prototype.setHeControlGridPosition=function(b,a){this.setPosition(a);this.m_objInput.setWindowText(SBGrid.CF.GridGetWindowText(b));this.m_objConnectControl=b};SBGrid.CT.GridCombo.prototype.getLableByValue=function(d){for(var b=0;b<this.itemLength;b++){if(this.isnodeset){var c=this.item(b).row;var e=this.item(b).col;var a=this.getLabelValue(c,e);if(d==a.value){strText=a.label;if(null!=strText){if("true"==this.getAttribute("showvalue")){strText=" ["+d+"]     "+strText}return strText}else{return""}}}else{if(d==SBGrid.CF.GetValue(this.item(b))){strText=SBGrid.CF.GetLabel(this.item(b));if(null!=strText){if("true"==this.getAttribute("showvalue")){strText=" ["+d+"]     "+strText}return strText}else{return""}}}}return""};SBGrid.CT.GridCombo.prototype.setLable=function(a){this.label=a};SBGrid.CT.GridCombo.prototype.setValue=function(a){this.value=a};SBGrid.CT.GridCombo.prototype.onSelect=function(e){if(-1==this.m_nSelectedRow&&-1==this.m_nSelectedCol){return}var c=this.getCell(this.m_nSelectedRow,this.m_nSelectedCol);if(null!=c){var b=this.m_objConnectControl;var f=b.parent;f.dispatch("onselect");var g=SBGrid.CF.GridGetWindowText(this.m_objConnectControl);var a=SBGrid.CF.GetLabel(c);var d=SBGrid.CF.GetValue(c);if(g!=a){SBGrid.CF.GridSetText(this.m_objConnectControl,d);f.setRowStatus(b.row,b.getStatus()|SBGrid.DEF.SBGS_UPDATE);f.refreshCurrentModel();this.setLable(a);this.setValue(d);if("true"==this.getAttribute("showvalue")){a=" ["+d+"]  "+a}this.m_objInput.setWindowText(a);f.dispatch("onvaluechanged")}}};SBGrid.CT.GridCombo.prototype.onKeyDown=function(a){SBGrid.CT.Select1.prototype.onKeyDown.call(this,a);a.stopPropagation()};SBGrid.CT.GridCombo.prototype.createDefaultComboHtmlTag=function(a,h){var c=document.getElementById("SBHE_"+a);var f=document.getElementById("SBHE_"+a+"_"+h);if(!f){f=document.createElement("div");f.setAttribute("id","SBHE_"+h)}f.setAttribute("class","sbgrid_select sbgrid_boxsizing sbgrid_datagrid_Combo gridcombo");f.setAttribute("style","");var l=document.createElement("table");l.setAttribute("cellpadding","0");l.setAttribute("cellspacing","0");l.setAttribute("style","width:100%; height:100%;");var d=document.createElement("tr");var g=document.createElement("td");g.setAttribute("valign","middle");var i=document.createElement("input");i.setAttribute("class","sbgrid_combo_input gridcombo_ccomboinput");i.setAttribute("id","SBHE_"+h+".input");i.setAttribute("readonly","");var e=document.createElement("td");e.setAttribute("align","center");e.setAttribute("class","sbgrid_combo_button_td");e.setAttribute("id","SBHE_"+h+"_img");e.setAttribute("valign","top");var b=document.createElement("button");b.setAttribute("class","sbgrid_combo_button gridcombo_ccombobutton");b.setAttribute("id","SBHE_"+h+".button");e.appendChild(b);g.appendChild(i);d.appendChild(g);d.appendChild(e);l.appendChild(d);f.appendChild(l);c.appendChild(f);b.onclick=function(){return false};if(window.attachEvent){f.attachEvent("onblur",SBGrid.DEF._W_onBlurEvent);b.attachEvent("onclick",function(){return false})}else{f.addEventListener("blur",SBGrid.DEF._W_onBlurEvent,false)}};SBGrid.CT.GridButton=function(b,f,c,e,d,a){if(!e){return}SBGrid.CT.Button.call(this,b,"","","","","",false,"",f,c,false,"","","",e,-1,"","","",-1,false,"",d,a)};SBGrid.CT.GridButton.prototype=new SBGrid.CT.Button;SBGrid.CT.GridButton.prototype.init=function(){SBGrid.CT.Button.prototype.init.call(this)};SBGrid.CT.GridButton.prototype.applyDefaultStyle=function(){SBGrid.CT.Caption.prototype.applyDefaultStyle.call(this);if(this.attribute["border-style"]){if(!this.attribute["border-width"]){this.m_heControl.style.borderWidth="1px"}}else{this.m_heControl.style.borderWidth=""}};SBGrid.CT.GridCol=function(A,X,F,x,c,n,T,W,a,L,b,G,z,g,i,h,v,N,O,p,y,D,Y,M,t,U,R,B,J,s,Q,ab,K,l,P,Z,V,d,r,u,f,I,q,C,m,E,o,H,aa,S,e){if(!g){return}SBGrid.CT.GridCell.call(this,A,n,W,z,g,Y,Y,M,t,P,Z,H,e);this.attribute.allowuserresize=X;this.attribute.autonext=String(F);this.attribute.checkimage=(x.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgCheck:x);this.attribute.checkvalue=c;this.attribute.cospan=T;this.attribute.editable=a;this.attribute.editmenu=L;this.attribute.editmode=b;this.attribute.explorerbar=G;this.attribute.imemode=i;this.attribute.itemcount=h;this.attribute.key=v;this.attribute.loadtype=N;this.attribute.mask=O;this.attribute.maxbyte=String(p);this.attribute.maxlength=String(y);this.attribute.pastemode=D;this.attribute.rowspan=U;this.attribute.savetype=R;this.attribute.secretendposition=B;this.attribute.secretmark=J;this.attribute.secretstartposition=s;this.attribute.selectimage=(Q.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRadio:Q);this.attribute.showmask=ab;this.attribute.showtoday=K;this.attribute.showvalue=l;this.attribute.type=V;this.attribute.title=C;this.attribute.uncheckimage=(m.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnCheck:m);this.attribute.unselectimage=(E.isEmpty()?SBGrid.DEF.__getAppName()+SBGrid.DEF.imgUnRadio:E);this.attribute.validateformat=o;this.attribute.ref=Y;this.attribute.calc=aa;this.attribute.validate=S;this.attribute.imageUri=d;this.attribute.imageWidth=r;this.attribute.imageHeight=u;this.attribute.imageStyle=f;this.attribute.imageClick=I;this.attribute.imageAlt=q;this.choices=null;this.m_bMerge=true;this.m_nInputType;this.m_bInputKey;this.m_strTrueValue;this.m_strFalseValue;this.m_bHiddenState=false;this.m_bEditable=a;this.m_strComboNodeSet=null;this.m_bIsCellCombo=false;this.m_objButton=null;this.m_objCombo=null;this.m_objCalendar=null;this.m_strButtonCss=null;this.m_strTrueValue="true";this.m_strFalseValue="false";if(c&&!c.isEmpty()){var w=c.split(",");if(2==w.length){this.m_strTrueValue=w[0];this.m_strFalseValue=w[1]}}};SBGrid.CT.GridCol.prototype=new SBGrid.CT.GridCell;SBGrid.CT.GridCol.prototype.init=function(){SBGrid.CT.GridCell.prototype.init.call(this);switch(this.getAttribute("type")){case"output":this.m_nInputType=SBGrid.DEF.SBIT_OUTPUT;break;case"input":this.m_nInputType=SBGrid.DEF.SBIT_INPUT;break;case"combo":this.m_nInputType=SBGrid.DEF.SBIT_COMBO;break;case"inputbutton":this.m_nInputType=SBGrid.DEF.SBIT_INPUTBUTTON;break;case"inputdate":this.m_nInputType=SBGrid.DEF.SBIT_INPUTDATE;this.attribute.format=""==this.attribute.format?"yyyy-mm-dd":this.attribute.format;break;case"checkbox":this.m_nInputType=SBGrid.DEF.SBIT_CHECK;break;case"radio":this.m_nInputType=SBGrid.DEF.SBIT_RADIO;break;case"image":this.m_nInputType=SBGrid.DEF.SBIT_IMAGE;break}if(SBGrid.DEF.SBIT_INPUTBUTTON==this.m_nInputType||SBGrid.DEF.SBIT_INPUTDATE==this.m_nInputType){if(null==this.m_objButton){this.m_objButton=new SBGrid.CT.GridButton(this.id,"",false,this.id+".button","softbowl:gridbutton","visible");this.m_objButton.init();this.m_strButtonCss=null!=this.attribute.col_gridbutton?this.attribute.col_gridbutton:""}if(SBGrid.DEF.SBIT_INPUTDATE==this.m_nInputType){if(null==this.m_objCalendar){this.m_objCalendar=this.createChild("softbowl:calendar","id:"+this.id+".calendar;border-style:solid;left:100;top:100;width:200;height:150;visibility:hidden;showtoday:"+this.getAttribute("showtoday")+";")}}}else{if(SBGrid.DEF.SBIT_COMBO==this.m_nInputType){for(var a=0;a<this.parent.m_arCombo.length;a++){if(this.id==this.parent.m_arCombo[a].m_nColId){this.m_objCombo=this.parent.m_arCombo[a];this.m_strComboNodeSet=this.m_objCombo.nodeset;this.m_objCombo.m_objTargetCol=this}}if(null==this.m_objCombo){}}}this.disabled="true"==this.attribute.disabled?true:false};SBGrid.CT.GridCol.prototype.setDataPartBGColor=function(a){this.attribute["background-color"]=a};SBGrid.CT.GridCol.prototype.getDataPartBGColor=function(){return this.attribute["background-color"]};SBGrid.CT.GridCol.prototype.getUseButton=function(){switch(this.getAttribute("type")){case"inputbutton":case"inputdate":return true;default:return false}};SBGrid.CT.GridCol.prototype.getInputType=function(){return this.m_nInputType};SBGrid.CT.GridCol.prototype.setInputType=function(a){this.m_nInputType=a};SBGrid.CT.GridCol.prototype.getImageUri=function(){return this.attribute.imageUri};SBGrid.CT.GridCol.prototype.getImageClickFuncName=function(){return this.attribute.imageClick};SBGrid.CT.GridCol.prototype.getImageWidth=function(){return this.attribute.imageWidth};SBGrid.CT.GridCol.prototype.getImageHeight=function(){return this.attribute.imageHeight};SBGrid.CT.GridCol.prototype.getImageStyle=function(){return this.attribute.imageStyle};SBGrid.CT.GridCol.prototype.getImageAlt=function(){return this.attribute.imageAlt};SBGrid.CT.GridCol.prototype.isDisplayValueType=function(){switch(this.getAttribute("type")){case"output":case"input":case"combo":case"inputbutton":case"inputdate":case"seq":case"reverseseq":return true;case"checkbox":case"radio":case"select":case"update":return false}};SBGrid.CT.GridCol.prototype.getEditable=function(){return this.m_bEditable};SBGrid.CT.GridCol.prototype.setEditable=function(a){this.m_bEditable=a};SBGrid.CT.GridCol.prototype.getTrueValue=function(){return this.m_strTrueValue};SBGrid.CT.GridCol.prototype.getFalseValue=function(){return this.m_strFalseValue};SBGrid.CT.GridCol.prototype.makeCellElement=function(c,e,d,a,b){c=c+"";if(SBGrid.DS.XMLStorage.getUniqueStorage().getInstance().preserveWhitespace){c=c.replace(/\s/g,"&nbsp;")}switch(this.getAttribute("type")){case"output":case"input":return this._makeOutput(c,d);case"image":return this._makeImage(c,d);case"combo":return this._makeCombo(c,d);case"inputbutton":case"inputdate":return this._makeInputButton(c,e,d,a,b);case"checkbox":return this._makeCheckbox(c);case"radio":return this._makeRadio(c);case"select":return this._makeRowHeaderSelect(c);case"update":return this._makeRowHeaderUpdate(c);case"seq":case"reverseseq":return this._makeRowHeaderSpan(c)}};SBGrid.CT.GridCol.prototype.showCalendar=function(i){var f=this.parent.getCell(this.parent.row,this.parent.col);if(null==f){f=this.getRefElement()}else{this.setRefElement(f)}if(null!=f){if(i){this.m_objCalendar.parent=this;var m=nViewportHeight;var p=nViewportWidth;var c=0;var a=0;var e=this.m_heControl;if(null!=e){if(this.getClientLeft(true)+this.m_objCalendar.m_heControl.offsetWidth>p){a=(this.getClientLeft(true)-(this.m_objCalendar.m_heControl.offsetWidth-e.offsetWidth))}else{a=this.getClientLeft(true)}if(this.getClientTop(true)+e.offsetHeight+this.m_objCalendar.m_heControl.offsetHeight>m){c=(this.getClientTop(true)-this.m_objCalendar.m_heControl.offsetHeight)}else{c=(this.getClientTop(true)+e.offsetHeight)}}this.m_objCalendar.setAttribute("top",c+"px");this.m_objCalendar.setAttribute("left",a+"px");var o=SBGrid.CF.GridGetWindowText(f);if(""!=o){var l=this.getAttribute("format");l=l.replace(/\W/g,"");o=o.replace(/\W/g,"");var h=null;var d=null;var b=null;var n=l.indexOf("y");if(-1!=n&&"y"==l.charAt(n+3)){h=Number(o.substr(n,4))}var q=l.indexOf("m");if(-1!=q&&"m"==l.charAt(q+1)){d=Number(o.substr(q,2))}var g=l.indexOf("d");if(-1!=g&&"d"==l.charAt(g+1)){b=Number(o.substr(g,2))}if(null!=h&&h>99){this.m_objCalendar.year=h.toString()}if(null!=d&&d>0){this.m_objCalendar.month=d.toString()}if(null!=b&&b>0){this.m_objCalendar.day=b.toString()}this.m_objCalendar.refresh()}else{this.m_objCalendar.setToday()}}this.parent.m_bIsShowItem=i;this.m_objCalendar.setVisible(i)}};SBGrid.CT.GridCol.prototype.onClick=function(b){SBGrid.CT.GridCell.prototype.onClick.call(this,b);var a=this.getRefElement();if(this.disabled||null==a||a.m_bIsSubTotal||a.getIsReadOnly()){return}switch(this.getInputType()){case SBGrid.DEF.SBIT_CHECK:this.setCheck(!this.getCheck());this.parent.refreshCurrentModel(this.parent.attribute.ref);break;case SBGrid.DEF.SBIT_RADIO:this.selectRadio();this.parent.refreshCurrentModel(this.parent.attribute.ref);break;case SBGrid.DEF.SBIT_INPUTBUTTON:if((b.target==this.getId())&&(this.inputDataPosition()<b.clientX)){this.dispatch("onbuttonclick")}break;case SBGrid.DEF.SBIT_INPUTDATE:if((b.target==this.getId())&&(this.inputDataPosition()<b.clientX)){this.dispatch("onbuttonclick");if(this.m_objCalendar.visible){this.parent.m_bIsShowItem=false;this.m_objCalendar.setVisible(false)}else{this.showCalendar(true)}}break;default:break}};SBGrid.CT.GridCol.prototype.onAfterEdit=function(event){var bChange=false;var nRow=this.parent.getEditRow();var nCol=this.parent.getEditCol();var objCell=this.parent.getCell(nRow,nCol);if(null==objCell){return false}var nInputType=this.getInputType();if(SBGrid.DEF.SBIT_INPUT==nInputType||SBGrid.DEF.SBIT_TEXTAREA==nInputType||SBGrid.DEF.SBIT_INPUTBUTTON==nInputType||SBGrid.DEF.SBIT_INPUTDATE==nInputType||SBGrid.DEF.SBIT_INPUTSPIN==nInputType){var objInput=this.parent.getEditControl();var objFormat=objInput.getFormat();var strPrevText=SBGrid.CF.GridGetText(objCell);var strEditText;if(SBGrid.DEF.SBIT_TEXTAREA==nInputType){}else{var strIsEmptyFormatted=objCell.getAttribute("isemptyformatted");if(!strIsEmptyFormatted||strIsEmptyFormatted.isEmpty()){strIsEmptyFormatted=this.getAttribute("isemptyformatted")}if((!strEditText||strEditText.isEmpty())&&"true"!=strIsEmptyFormatted){strEditText=objInput.getWindowText()}if(this.getAttribute("validate")!=""){var strValidate=this.getAttribute("validate");if(""!=strValidate){if(strEditText==null||strEditText=="undifined"||strEditText==""){strEditText=0}var strValidateName=strValidate.substring(0,strValidate.indexOf("("));var strValidateParam="(this.parent.id, "+nRow.toString()+", "+nCol.toString()+",'"+strEditText+"');";strValidate=strValidateName+strValidateParam;var strResult=eval(strValidate);strEditText=strResult}}if(objFormat){if(strPrevText!=strEditText){var bAutoCData=false;if(objFormat.getFormatExist()){if("include"==this.getAttribute("mask")){strEditText=objFormat.m_heControl.value}else{strEditText=objFormat.m_strInputRealityData}if(this.getAttribute("validate")!=""){var strValidate=this.getAttribute("validate");if(""!=strValidate){if(strEditText==null||strEditText=="undifined"||strEditText==""){strEditText=0}var strValidateName=strValidate.substring(0,strValidate.indexOf("("));var strValidateParam="(this.parent.id, "+nRow.toString()+", "+nCol.toString()+","+strEditText+");";strValidate=strValidateName+strValidateParam;var strResult=eval(strValidate);strEditText=strResult}}SBGrid.CF.GridSetText(objCell,strEditText,true,bAutoCData)}else{SBGrid.CF.GridSetText(objCell,strEditText,true,bAutoCData)}SBGrid.CF.GridSetWindowText(objCell,strEditText);this.dispatch("onbeforecalc",event);for(var i=0;i<this.parent.cols;i++){var objColumn=this.parent.getColumnControl(i);var strCalc=objColumn.getAttribute("calc");if(""!=strCalc){var objCalcCell=this.parent.getCell(nRow,i);var objCalcCol=objCalcCell.getElement();var strCalc=objCalcCol.getAttribute("calc");if(""!=strCalc){var strCalcName=strCalc.substring(0,strCalc.indexOf("("));var strCalcParam="(this.parent.id, "+nRow.toString()+", "+i.toString()+");";strCalc=strCalcName+strCalcParam;var strResult=eval(strCalc);if(null!=strResult){SBGrid.CF.GridSetText(objCalcCell,strResult)}}}}this.dispatch("onaftercalc",event);this.setAttribute("#update-text","true");this.dispatch("onafteredit",event);this.dispatch("onvaluechanged",event);this.dispatch("onendedit",event);bChange=true}else{this.setAttribute("#update-text","");bChange=false}return bChange}}}return false};SBGrid.CT.GridCol.prototype.onBeforeEdit=function(a){var g=this.getInputType();if(SBGrid.DEF.SBIT_INPUT==g||SBGrid.DEF.SBIT_TEXTAREA==g||SBGrid.DEF.SBIT_INPUTBUTTON==g||SBGrid.DEF.SBIT_INPUTDATE==g||SBGrid.DEF.SBIT_INPUTSPIN==g){var b=this.parent.getRow();var f=this.parent.getCol();if(SBGrid.DEF.SBIT_TEXTAREA==g){}else{var l=0;var c=this.parent.getCell(b,f);var m=this.parent.getCellContentRect(b,f);if(SBGrid.DEF.SBIT_INPUTBUTTON==g||SBGrid.DEF.SBIT_INPUTDATE==g||SBGrid.DEF.SBIT_INPUTSPIN==g){l=18;m.setWidth(m.getWidth()-l)}var d=this.parent.getEditControl();var n=this.parent.editControlHeight(m.getHeight());if(n<m.getHeight()){m.setY(this.parent.getInputTopPosition(f));m.setHeight(n);nBttomRowHeight=null}d.setPosition(m);if((c.m_heControl.offsetWidth-l)<=d.m_heControl.offsetWidth){d.m_heControl.style.width=(m.getWidth()-(d.m_heControl.offsetWidth-(c.m_heControl.offsetWidth-l))-2)+"px"}if(c.m_heControl.offsetHeight<=d.m_heControl.offsetHeight){d.m_heControl.style.height=(m.getHeight()-(d.m_heControl.offsetHeight-c.m_heControl.offsetHeight)-2)+"px"}var h=this.getAttribute("format");h=null!=this.parent.m_htCellFormat[c.id]?this.parent.m_htCellFormat[c.id]:h;d.attribute.format=h;d.setAttribute("autonext",this.attribute.autonext);d.setAttribute("maxbyte",this.attribute.maxbyte);d.setAttribute("maxlength",this.attribute.maxlength);var i=d.getFormat();var h=h;var e=SBGrid.CF.GridGetText(c);if(""!=h){i.m_strInputRealityData=e;i.init(h)}else{d.m_heControl.style.imeMode="auto"}if(!SBGrid.DEF.is_ie7&&!SBGrid.DEF.is_ie8){if(-1!=this.attribute.secretstartposition||-1!=this.attribute.secretendposition){d.m_heControl.type="password"}else{d.m_heControl.type="text"}}d.setEditText(e);this.m_bInputKey=false}return true}return false};SBGrid.CT.GridCol.prototype.onStartEdit=function(b){var c=this.getInputType();if(SBGrid.DEF.SBIT_INPUT==c||SBGrid.DEF.SBIT_TEXTAREA==c||SBGrid.DEF.SBIT_INPUTBUTTON==c||SBGrid.DEF.SBIT_INPUTDATE==c||SBGrid.DEF.SBIT_INPUTSPIN==c){var a=this.parent.getRow();var f=this.parent.getCol();if(SBGrid.DEF.SBIT_TEXTAREA==c){}else{var e=this.parent.getEditControl();if(null!=e){SBGrid.DS.SBBody.m_heControl.onselectstart=new Function("return true");e.setVisible(true,true);window.setTimeout('SBGrid.DEF.setFocus("'+e.getId()+'")',0);var d=e.m_heControlInput.getAttribute("id");window.setTimeout('document.getElementById("'+d+'").select()',0)}}return true}return false};SBGrid.CT.GridCol.prototype.setDisabled=function(b,a){};SBGrid.CT.GridCol.prototype.setAttribute=function(a,b){SBGrid.CT.GridCell.prototype.setAttribute.call(this,a,b);switch(a){case"disabled":if("true"==b){this.disabled=true}else{if("false"==b){this.disabled=false}}break;case"editable":if("true"==b){this.m_bEditable=true}else{if("false"==b){this.m_bEditable=false}}break}};SBGrid.CT.GridCol.prototype.onFocus=function(g){SBGrid.CT.GridCell.prototype.onFocus.call(this,g);if(SBGrid.DEF.SBIT_COMBO==this.getInputType()){var f=this.getRefElement();if(null!=f){if(this.m_objCombo.isnodeset){var c=f.getAttribute("nodeset");var e=f.getAttribute("jsonnodeset");if(null!=c){this.m_objCombo.nodeset=c;this.m_objCombo.refresh()}else{if(null!=e){this.m_objCombo.jsonnodeset=e;this.m_objCombo.refresh()}else{if(null!=this.m_strComboNodeSet&&this.m_strComboNodeSet!=this.m_objCombo.nodeset){this.m_objCombo.nodeset=this.m_strComboNodeSet;this.m_objCombo.refresh()}}}}var b=this.parent.getCellContentRect(f.row,f.col);this.m_objCombo.setHeControlGridPosition(f,b);if(!this.disabled&&!f.getIsReadOnly()){this.parent.m_bIsShowCombo=true;this.m_objCombo.setVisible(true);this.m_objCombo.dispatch("onfocus")}var a=null;for(var d=0;d<f.m_heControl.childNodes.length;d++){a=f.m_heControl.childNodes.item(d);if("DIV"==a.tagName){a.style.width="98%";a.style.overflow="hidden"}}}}};SBGrid.CT.GridCol.prototype.onBlur=function(a){SBGrid.CT.GridCell.prototype.onBlur.call(this,a);if(SBGrid.DEF.SBIT_INPUTDATE==this.getInputType()&&-1==a.down.indexOf("calendar")){this.parent.m_bIsShowItem=false;this.m_objCalendar.setVisible(false)}if(SBGrid.DEF.SBIT_COMBO==this.getInputType()&&-1==a.down.indexOf(this.m_objCombo.id)){this.m_objCombo.setVisible(false)}this.parent._gridComboHidden()};SBGrid.CT.GridCol.prototype.onDaySelect=function(c){var b=this.parent.getRow();var f=this.parent.getCol();var a=this.parent.getCell(b,f);if(null!=a){var d=SBGrid.CF.GridGetText(a);if(""==this.m_objCalendar.day){return}var e=(this.m_objCalendar.year).toString()+(parseInt(this.m_objCalendar.month)>9?(this.m_objCalendar.month).toString():"0"+this.m_objCalendar.month)+(parseInt(this.m_objCalendar.day)>9?(this.m_objCalendar.day).toString():"0"+this.m_objCalendar.day);if(d!=e){SBGrid.CF.GridSetText(a,e);a.setWindowText(e);this.parent.setRowStatus(a.row,this.parent.getRowStatus(a.row)|SBGrid.DEF.SBGS_UPDATE);if("true"!=this.getAttribute("skipvaluechanged")){this.dispatch("onvaluechanged")}this.parent.refreshCurrentModel()}this.showCalendar(false)}};SBGrid.CT.GridCol.prototype.getColType=function(){return this.m_nInputType};SBGrid.CT.GridCol.prototype.defaultAction=function(b,a){SBGrid.CT.GridCell.prototype.defaultAction.call(this,b,a);switch(b){case"onbuttonclick":break;case"onhidepopup":if(this.m_objCalendar){this.parent.m_bIsShowItem=false;this.showCalendar(false);break}case"ondayselect":this.onDaySelect();break;case"onselect":break}};SBGrid.CT.GridCol.prototype._makeImage=function(a,b){var c="";c="<div class='sbgrid_datagrid_Image' height='100%' width='100%' id='"+b+"_data'><img src='"+a+"' align='center' alt='"+a+"'></img></div>";return c};SBGrid.CT.GridCol.prototype._makeOutput=function(g,a){if(null==g){g=""}g=g.formatting(this.getAttribute("format"));if(""!=g&&(-1!=this.attribute.secretendposition||-1!=this.attribute.secretstartposition)){var d=-1==this.attribute.secretstartposition?0:this.attribute.secretstartposition;var b=-1==this.attribute.secretendposition?g.length:this.attribute.secretendposition;if(b>d){var m=this.attribute.secretmark;var h=g.substr(0,d);var e=g.substr(b,g.length);for(var f=d;f<b;f++){h+=m}g=h+e;m=null;h=null;e=null}d=null;b=null}var n=this.parent.autoResize?"break-word":"normal";var c="";if(this.parent.ellipsis){c="text-overflow:ellipsis;"}var l=new Array();l.push("<div class='sbgrid_datagrid_Output' id='"+a+"_data' style=\"word-wrap:"+n+";"+c+'">');if(this.parent.autoResize){l.push(g.newlineCharConvert())}else{l.push('<span style="white-space:nowrap;">'+g+"</span>")}l.push("</div>");n=null;c=null;return l.join("")};SBGrid.CT.GridCol.prototype._makeCombo=function(a,b){return"<div class='sbgrid_datagrid_Combo' id='"+b+'_data\'><span style="white-space:nowrap;"></span></div>'};SBGrid.CT.GridCol.prototype._makeInputButton=function(u,s,d,g,m){if(null==u){u=""}u=u.formatting(this.getAttribute("format"));if(""!=u&&(-1!=this.attribute.secretendposition||-1!=this.attribute.secretstartposition)){var p=-1==this.attribute.secretstartposition?0:this.attribute.secretstartposition;var n=-1==this.attribute.secretendposition?u.length:this.attribute.secretendposition;if(n>p){var r=this.attribute.secretmark;var a=u.substr(0,p);var f=u.substr(n,u.length);for(var q=p;q<n;q++){a+=r}u=a+f;r=null;a=null;f=null}}var e=this.parent.autoResize?"break-word":"normal";var c="";if(this.parent.ellipsis){c="text-overflow:ellipsis;"}var b="";var l=("tag"==m);var o=SBGrid.DEF.is_mozBrowser?"98%":"100%";var t=new Array();t.push("<table class='sbgrid_datagrid_InputButton_table' cellpadding=0 cellspacing=0 border=0 style=\"height:"+o+";\"><tr><td width='100%'>");t.push("<div class='sbgrid_datagrid_InputButtonDiv' id='"+d+"_data' style=\"");t.push("word-wrap:"+e+";"+c+'">');if(this.parent.autoResize){t.push(u.newlineCharConvert())}else{t.push('<span style="white-space:nowrap;">'+u+"</span>")}t.push("</div>");t.push("</td><td width='18px' style='height:100%'>");var h="";h+=SBGrid.DEF.is_opera?"":"width:18px;";var v=(null!=this.parent.m_strCGButton||null!=this.m_strButtonCss)?"sbgrid_datagrid_IsInputButton":"sbgrid_datagrid_InputButton";t.push("<BUTTON class='"+v+" "+this.parent.m_strCGButton+" "+this.m_strButtonCss);t.push("' id='"+d+"_button' style=\""+h+'" onclick="return false;"></BUTTON>');t.push("</td></tr></table>");return t.join("")};SBGrid.CT.GridCol.prototype._makeCheckbox=function(a){var b="";if(this.m_strTrueValue==a){b="<img src='"+this.getAttribute("checkimage")+"' alt='"+this.id+"' >"}else{b="<img src='"+this.getAttribute("uncheckimage")+"' alt='"+this.id+"'>"}return b};SBGrid.CT.GridCol.prototype._makeRadio=function(a){var b="";b="<img src='"+this.getAttribute("unselectimage")+"'>";return b};SBGrid.CT.GridCol.prototype._makeRowHeaderSelect=function(a){var b="";b="<img src='"+SBGrid.DEF.__getAppName()+SBGrid.DEF.imgRHBlank+"'>";return b};SBGrid.CT.GridCol.prototype._makeRowHeaderUpdate=function(a){var b="";b="<div style='position:relative;left:0px;top:0px;height:100%;width:100%;overflow:hidden;background-image:url("+this.parent.m_strNormalFlagImage+");background-position:center center;'></div>";return b};SBGrid.CT.GridCol.prototype._makeRowHeaderSpan=function(a){var b="<span>"+a+"</span>";return b};SBGrid.CT.GridCol.create=function(B,H,R){var Z=true;var G=true;var y="";var c=H.item("checkvalue")?H.item("checkvalue"):"true,false";var p="";var V=1;var Y=false;var a=true;var N=true;var b="";var I="";var A="";var h="";var n="";var l=-1;var x=true;var P="";var Q="";var r=-1;var z=-1;var E="default";var aa="";var O="";var v=0;var W=1;var T="auto";var C=-1;var L="";var u=-1;var S="";var ad=false;var M=false;var m=false;var X="output";var d="";var t="";var w="";var g="";var K="";var s="";var D="";var o="";var F="";var q=false;var J="visible";var ac="";var f="";var U="";for(var ab=0;ab<H.count();ab++){var e=H.keys()[ab];switch(e){case"allowuserresize":if("false"==H.item(e)){Z=false}break;case"autonext":if("false"==H.item(e)){G=false}break;case"checkimage":y=H.item(e);break;case"checkvalue":c=H.item(e);break;case"class":p=H.item(e);break;case"colspan":V=parseInt(H.item(e));break;case"disabled":if("true"==H.item(e)){Y=true}break;case"editable":if("false"==H.item(e)){a=false}break;case"editmode":if("false"==H.item(e)){N=false}break;case"explorerbar":I=H.item(e);case"format":A=H.item(e);break;case"id":h=H.item(e);break;case"imemode":n=H.item(e);break;case"itemcount":l=parseInt(H.item(e));break;case"key":if("false"==H.item(e)){x=false}break;case"loadtype":P=H.item(e);break;case"mask":Q=H.item(e);break;case"showtoday":if("true"==H.item(e)){M=true}break;case"maxbyte":r=parseInt(H.item(e));break;case"maxlength":z=parseInt(H.item(e));break;case"pastemode":E=H.item(e);break;case"ref":aa=H.item(e);break;case"roundmode":strRoundmode=H.item(e);break;case"roundposition":v=parseInt(H.item(e));break;case"rowspan":W=parseInt(H.item(e));break;case"savetype":T=H.item(e);break;case"secretendposition":C=parseInt(H.item(e));break;case"secretmark":L=H.item(e);break;case"secretstartposition":u=parseInt(H.item(e));break;case"selectimage":S=H.item(e);break;case"showmask":if("true"==H.item(e)){ad=true}break;case"showvalue":if("true"==H.item(e)){m=true}break;case"type":X=H.item(e);break;case"imageUri":d=H.item(e);break;case"imageWidth":t=H.item(e);break;case"imageHeight":w=H.item(e);break;case"imageStyle":g=H.item(e);break;case"imageClick":K=H.item(e);break;case"imageAlt":s=H.item(e);break;case"title":D=H.item(e);break;case"uncheckimage":o=H.item(e);break;case"unselectimage":F=H.item(e);break;case"validateformat":if("true"==H.item(e)){q=true}break;case"visibility":J=H.item(e);break;case"calc":ac=H.item(e);break;case"validate":U=H.item(e);break;default:if(!SBGrid.DEF.SB_STYLELIST[e]){f+=e+":"+H.item(e)+"; "}break}}return new SBGrid.CT.GridCol(B,Z,G,y,c,p,V,Y,a,N,b,I,A,h,n,l,x,P,Q,r,z,E,aa,O,v,W,T,C,L,u,S,ad,M,m,R,"softbowl:col",X,d,t,w,g,K,s,D,o,F,q,J,ac,U,f)};SBGrid.CT.ContextMenu=function(a,f,e,d,c,g,b){if(!f){return}SBGrid.CT.Element.call(this,a,f,e);this.m_strNodeset=d;this.m_strLabel=c;this.m_strFunctionName=g;this.m_bEvent=b};SBGrid.CT.ContextMenu.prototype=new SBGrid.CT.Element;SBGrid.CT.ContextMenu.prototype.createContextMenu=function(nLeft,nTop){var strRef=this.m_strNodeset;var objInstance=SBGrid.DS.XMLStorage.getUniqueStorage().getInstance();var xlNode;var bCheckInstance=false;if(objInstance){var xnRoot=objInstance.documentElement;if(xnRoot){xlNode=xnRoot.selectNodes(strRef);if(xlNode){for(var i=0;i<xlNode.length;i++){var xnNode=xlNode.item(i);var xnLabel=xnNode.selectSingleNode(this.m_strLabel);var xnFunction=xnNode.selectSingleNode(this.m_strFunctionName);if(xnLabel&&xnFunction){bCheckInstance=true;break}}}}}if(!bCheckInstance){return}var xnContextMenu=document.createElement("table");xnContextMenu.id="SBHE___SB_ContextMenu";xnContextMenu.cellSpacing=0;xnContextMenu.cellPadding=0;xnContextMenu.style.position="absolute";xnContextMenu.style.left=nLeft+"px";xnContextMenu.style.top=nTop+"px";xnContextMenu.style.border="1px solid #A0A0A0";xnContextMenu.style.backgroundColor="#F0F0F0";xnContextMenu.style.fontFamily=SBGrid.DEF.Lan_DefaultFontFamily;xnContextMenu.style.fontSize="9pt";xnContextMenu.style.color="#000000";xnContextMenu.style.cursor="default";var xnContextMenuTbody=document.createElement("tbody");for(var i=0;i<xlNode.length;i++){var xnNode=xlNode.item(i);var xnLabel=xnNode.selectSingleNode(this.m_strLabel);var xnFunction=xnNode.selectSingleNode(this.m_strFunctionName);if(!xnLabel||!xnFunction){continue}var strLabel=SBGrid.UT.XmlLib.getTextValue(xnLabel);var strFunction=SBGrid.UT.XmlLib.getTextValue(xnFunction);if(strFunction==""){var xnContextMenuTR1=document.createElement("tr");var xnContextMenuTD11=document.createElement("td");xnContextMenuTD11.style.width="28px";xnContextMenuTD11.style.height="1px";var xnContextMenuTD12=document.createElement("td");xnContextMenuTD12.style.width="1px";xnContextMenuTD12.style.backgroundColor="#E2E3E3";var xnContextMenuTD13=document.createElement("td");xnContextMenuTD13.style.width="1px";xnContextMenuTD13.style.backgroundColor="#FFFFFF";var xnContextMenuTD14=document.createElement("td");xnContextMenuTD14.style.width="120px";xnContextMenuTD14.style.backgroundColor="#E2E3E3";xnContextMenuTR1.appendChild(xnContextMenuTD11);xnContextMenuTR1.appendChild(xnContextMenuTD12);xnContextMenuTR1.appendChild(xnContextMenuTD13);xnContextMenuTR1.appendChild(xnContextMenuTD14);xnContextMenuTbody.appendChild(xnContextMenuTR1);var xnContextMenuTR2=document.createElement("tr");var xnContextMenuTD21=document.createElement("td");xnContextMenuTD21.style.width="28px";xnContextMenuTD21.style.height="1px";var xnContextMenuTD22=document.createElement("td");xnContextMenuTD22.style.width="1px";xnContextMenuTD22.style.backgroundColor="#E2E3E3";var xnContextMenuTD23=document.createElement("td");xnContextMenuTD23.style.width="1px";xnContextMenuTD23.style.backgroundColor="#FFFFFF";var xnContextMenuTD24=document.createElement("td");xnContextMenuTD24.style.width="120px";xnContextMenuTD24.style.backgroundColor="#FFFFFF";xnContextMenuTR2.appendChild(xnContextMenuTD21);xnContextMenuTR2.appendChild(xnContextMenuTD22);xnContextMenuTR2.appendChild(xnContextMenuTD23);xnContextMenuTR2.appendChild(xnContextMenuTD24);xnContextMenuTbody.appendChild(xnContextMenuTR2)}else{var xnContextMenuTR=document.createElement("tr");xnContextMenuTR.setAttribute("function",strFunction);xnContextMenuTR.onmouseover=function(){this.style.backgroundColor="#D3E9FE"};xnContextMenuTR.onmouseout=function(){this.style.backgroundColor=""};xnContextMenuTR.onclick=function(){try{if(SBGrid.DS.SBBody.children.item("__SB_ContextMenu").m_bEvent){SBGrid.DS.SBBody.dispatch("onmenu",this.getAttribute("function"))}else{eval(this.getAttribute("function")+"()")}window.top.document.body.removeChild(window.top.document.getElementById("SBHE___SB_ContextMenu"))}catch(e){window.top.document.body.removeChild(window.top.document.getElementById("SBHE___SB_ContextMenu"))}};var xnContextMenuTD1=document.createElement("td");xnContextMenuTD1.style.width="28px";xnContextMenuTD1.style.height="23px";var xnContextMenuTD2=document.createElement("td");xnContextMenuTD2.style.width="1px";xnContextMenuTD2.style.backgroundColor="#E2E3E3";var xnContextMenuTD3=document.createElement("td");xnContextMenuTD3.style.width="1px";xnContextMenuTD3.style.backgroundColor="#FFFFFF";var xnContextMenuTD4=document.createElement("td");xnContextMenuTD4.style.width="120px";xnContextMenuTD4.style.paddingLeft="5px";xnContextMenuTD4.style.paddingRight="10px";var xnContextMenuText=document.createElement("nobr");xnContextMenuText.innerHTML=strLabel;xnContextMenuTD4.appendChild(xnContextMenuText);xnContextMenuTR.appendChild(xnContextMenuTD1);xnContextMenuTR.appendChild(xnContextMenuTD2);xnContextMenuTR.appendChild(xnContextMenuTD3);xnContextMenuTR.appendChild(xnContextMenuTD4);xnContextMenuTbody.appendChild(xnContextMenuTR)}}xnContextMenu.appendChild(xnContextMenuTbody);window.top.document.body.appendChild(xnContextMenu)};